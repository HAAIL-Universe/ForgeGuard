# Diff Log (overwrite each cycle)

## Cycle Metadata
- Timestamp: 2026-02-15T19:27:46+00:00
- Branch: master
- HEAD: ceb988f83e66f094035eb31168aed612e537a451
- BASE_HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
- Diff basis: staged

## Cycle Status
- Status: COMPLETE

## Summary
- Phase 12: Build Target and File Writing
- Create git_client for clone/add/commit/push
- Parse file blocks from builder output writefiles to disk
- Create BuildTargetModal component and file tree panel

## Files Changed (staged)
- Forge/Contracts/builder_contract.md
- Forge/Contracts/phases.md
- Forge/Contracts/physics.yaml
- Forge/Contracts/schema.md
- Forge/evidence/audit_ledger.md
- Forge/evidence/updatedifflog.md
- app/api/routers/builds.py
- app/clients/git_client.py
- app/repos/build_repo.py
- app/services/build_service.py
- db/migrations/008_build_targets.sql
- tests/test_build_repo.py
- tests/test_build_service.py
- tests/test_builds_router.py
- tests/test_git_client.py
- web/src/__tests__/BuildTargetModal.test.tsx
- web/src/components/BuildTargetModal.tsx
- web/src/pages/BuildProgress.tsx
- web/src/pages/ProjectDetail.tsx

## git status -sb
    ## master...origin/master [ahead 3]
    M  Forge/Contracts/builder_contract.md
    M  Forge/Contracts/phases.md
    M  Forge/Contracts/physics.yaml
    M  Forge/Contracts/schema.md
    M  Forge/evidence/audit_ledger.md
    M  Forge/evidence/updatedifflog.md
    M  app/api/routers/builds.py
    A  app/clients/git_client.py
    M  app/repos/build_repo.py
    M  app/services/build_service.py
    A  db/migrations/008_build_targets.sql
    M  tests/test_build_repo.py
    M  tests/test_build_service.py
    M  tests/test_builds_router.py
    A  tests/test_git_client.py
    A  web/src/__tests__/BuildTargetModal.test.tsx
    A  web/src/components/BuildTargetModal.tsx
    M  web/src/pages/BuildProgress.tsx
    M  web/src/pages/ProjectDetail.tsx

## Verification
- Static: Python and TypeScript compile clean
- Runtime: 281 backend tests pass
- Behavior: 61 frontend tests pass
- Contract: physics and schema updated first

## Notes (optional)
- W1 secret warnings are false positives

## Next Steps
- Phase 13: Multi-Turn Builder
- Phase 14: Pause Resume Interjection

## Minimal Diff Hunks
    diff --git a/Forge/Contracts/builder_contract.md b/Forge/Contracts/builder_contract.md
    index 2b43966..85cd9c1 100644
    --- a/Forge/Contracts/builder_contract.md
    +++ b/Forge/Contracts/builder_contract.md
    @@ -35,6 +35,26 @@ ProjectRoot/              ÔåÉ git root, builder's working directory
     - `forge.json` lives at the project root.
     - The `Forge/` folder may be deleted after the project build is complete. No project code may import from or depend on files inside `Forge/`.
     
    +### 0.1) File block output format (mandatory for autonomous builds)
    +
    +When the builder is operating as a ForgeGuard autonomous build agent (not a human-interactive session), all file creation MUST use the following canonical format so the orchestrator can parse and write files to disk:
    +
    +```
    +=== FILE: path/to/file.py ===
    +```python
    +<file contents>
    +```
    +=== END FILE ===
    +```
    +
    +**Rules:**
    +- The path after `FILE:` is relative to the project root (e.g., `app/main.py`, `tests/test_health.py`).
    +- One file per block. Multiple files = multiple blocks.
    +- The code fence inside the block (` ```lang `) is optional but recommended for readability.
    +- If updating an existing file, emit the full file content (the orchestrator overwrites).
    +- Do NOT emit partial files or diffs -- always emit the complete file.
    +- The `=== END FILE ===` delimiter MUST appear on its own line after the file content.
    +
     ---
     
     ## 1) Contract read gate (mandatory)
    diff --git a/Forge/Contracts/phases.md b/Forge/Contracts/phases.md
    index f5bfde5..e9c0542 100644
    --- a/Forge/Contracts/phases.md
    +++ b/Forge/Contracts/phases.md
    @@ -385,3 +385,279 @@ Canonical phase plan. Each phase is self-contained, shippable, and auditable. Th
     - `USER_INSTRUCTIONS.md` covers the full project creation and build workflow
     - All tests pass
     - `run_audit.ps1` passes all checks
    +
    +---
    +
    +## Phase 12 -- Build Target & File Writing
    +
    +**Objective:** The builder actually writes files. Users choose a build target -- a new GitHub repo, an existing GitHub repo, or a local file path -- and the builder's output is parsed into discrete files and written to that target in real time. This replaces the current "stream text only" behaviour.
    +
    +**Background:** Currently the builder streams its entire output as raw text chunks. No files are created anywhere. The user's intention was always that builds produce real, usable code in a real repository or directory.
    +
    +**Deliverables:**
    +
    +- **Build target selection** (backend + frontend):
    +  - `build_target_type` enum: `github_new`, `github_existing`, `local_path`
    +  - `POST /projects/{id}/build` extended: accepts `target_type` and `target_ref` (repo name for new, repo full_name for existing, absolute path for local)
    +  - For `github_new`: call GitHub API to create an empty repo under the user's account, clone it locally to a temp working directory
    +  - For `github_existing`: clone the repo to a temp working directory (shallow clone, default branch)
    +  - For `local_path`: validate the path exists (or create it), use directly as the working directory
    +  - Store target info on the `builds` table: `target_type`, `target_ref`, `working_dir`
    +
    +- **DB migration 008** -- `build_targets`:
    +  - Add columns to `builds`: `target_type VARCHAR(20)`, `target_ref TEXT`, `working_dir TEXT`
    +
    +- **File parser in build_service.py**:
    +  - Builder directive updated to instruct the LLM to emit file blocks in a canonical format:
    +    ```
    +    === FILE: path/to/file.py ===
    +    ```python
    +    <file contents>
    +    ```
    +    === END FILE ===
    +    ```
    +  - `_parse_file_blocks(accumulated_text)` -- extracts file path + content from builder output
    +  - When a file block is detected:
    +    1. Write the file to the working directory on disk
    +    2. Emit `file_created` WS event with `{ path, size_bytes, language }`
    +    3. Log the file write to build_logs
    +  - Handle file updates (same path written twice = overwrite with latest)
    +
    +- **Git operations** (for GitHub targets):
    +  - After each phase completes audit, stage + commit all new/modified files with message `"forge: Phase N complete"`
    +  - After build completes, push all commits to the remote
    +  - `app/clients/git_client.py` -- thin wrapper around `asyncio.subprocess` for git clone, add, commit, push (no heavy git library dependency)
    +
    +- **Frontend: Build target picker** (shown before build starts):
    +  - Three-option card selector: "New GitHub Repo" / "Existing GitHub Repo" / "Local Directory"
    +  - For new repo: text input for repo name (validated against GitHub naming rules)
    +  - For existing repo: repo picker modal (reuse existing component)
    +  - For local: text input for absolute path with validation
    +  - Selected target stored in build state and sent with `POST /projects/{id}/build`
    +
    +- **Frontend: File tree panel** on BuildProgress page:
    +  - New collapsible panel (left column, below phase checklist) showing files created so far
    +  - Tree structure mirroring directory hierarchy
    +  - Each file shows: path, size, language icon
    +  - Updates in real-time via `file_created` WS events
    +  - Click a file to expand and see a syntax-highlighted preview of its content (read from build logs or a dedicated endpoint)
    +
    +- **API for file retrieval**:
    +  - `GET /projects/{id}/build/files` -- list all files written during the build
    +  - `GET /projects/{id}/build/files/{path}` -- retrieve content of a specific file
    +
    +**Schema coverage:**
    +- [x] builds (extended with target columns)
    +- [x] build_logs (Phase 9)
    +- [ ] No new tables -- file metadata derived from build_logs + filesystem
    +
    +**Exit criteria:**
    +- User can select "New GitHub Repo" and the build creates the repo + writes files into it
    +- User can select "Existing GitHub Repo" and the build writes files into the cloned repo
    +- User can select "Local Directory" and files are written to that path
    +- Files appear in the file tree panel in real-time as the builder creates them
    +- After each phase audit pass, files are committed with a phase-specific message
    +- After build completion (GitHub targets), all commits are pushed to the remote
    +- File content is retrievable via API
    +- All existing tests still pass + new tests for file parsing, git operations, and target selection
    +- `run_audit.ps1` passes all checks
    +
    +---
    +
    +## Phase 13 -- Multi-Turn Builder & Structured Build Plan
    +
    +**Objective:** Convert the builder from a single streaming call to a multi-turn conversation. The builder emits a structured plan at the start, and after audit failures the audit feedback is injected back into the conversation so the builder can self-correct. This gives the builder full context of what it's already done, what failed, and why.
    +
    +**Background:** Currently `_run_build()` creates `messages = [{"role":"user","content": directive}]` and makes one `stream_agent()` call. The audit runs but its feedback is never sent back to the builder. The builder has no ability to self-correct -- it just gets a loop count incremented and the build eventually fails. Real builds took ~7 iterations because the diff log retained TODO placeholders that the auditor kept flagging.
    +
    +**Deliverables:**
    +
    +- **Structured build plan emission**:
    +  - Update builder directive (system prompt / builder_contract.md) to instruct the LLM:
    +    > Before writing any code, emit a `=== BUILD PLAN ===` block listing all tasks you will perform, grouped by phase. Each task should be a single line: `- [ ] Task description`. End the plan with `=== END BUILD PLAN ===`.
    +  - `_parse_build_plan(text)` in build_service.py -- extracts task list from the plan block
    +  - Emit `build_plan` WS event: `{ tasks: [{ id, description, phase, status }] }`
    +  - As the builder works, detect task completion signals (`=== TASK DONE: <id> ===`) and emit `task_complete` WS events
    +  - Frontend: Build Plan checklist panel in BuildProgress (right column, above activity feed), showing all tasks with check/pending/fail icons, updating in real-time
    +
    +- **Multi-turn conversation loop**:
    +  - Replace single `stream_agent()` call with a conversation loop:
    +    ```
    +    messages = [{"role": "user", "content": directive}]
    +    while not build_complete:
    +        async for chunk in stream_agent(..., messages=messages):
    +            # accumulate, parse files, detect signals
    +        messages.append({"role": "assistant", "content": accumulated_text})
    +        
    +        if phase_complete_detected:
    +            audit_result = await _run_inline_audit(...)
    +            if audit_result == "PASS":
    +                # continue to next phase
    +                messages.append({"role": "user", "content": f"Audit PASSED for {phase}. Proceed to the next phase."})
    +            else:
    +                # loopback with audit feedback
    +                messages.append({"role": "user", "content": f"Audit FAILED for {phase}.\n\nAudit feedback:\n{audit_detail}\n\nFix the issues identified above and re-submit {phase}."})
    +    ```
    +  - The conversation grows with each turn -- the builder sees everything it's already produced + audit results
    +  - No separate database table for "state" -- the conversation history IS the state
    +
    +- **Audit feedback forwarding**:
    +  - `_run_inline_audit()` updated to return audit detail (not just PASS/FAIL) -- the full auditor response including specific findings
    +  - Return type changes from `str` to `AuditResult` dataclass: `{ verdict: str, detail: str, findings: list[str] }`
    +  - On FAIL: the audit detail is appended to messages so the builder knows exactly what to fix
    +  - Emit `audit_fail` WS event extended with `{ findings: [...] }` so the frontend can show what failed
    +
    +- **Context window management**:
    +  - Track total conversation tokens (input + output across turns)
    +  - If conversation approaches model context limit (200K for Opus), truncate earlier turns while preserving: (1) original directive, (2) last 2 turns, (3) all audit feedback messages
    +  - `_compact_messages(messages, max_tokens)` helper for intelligent truncation
    +  - Log a warning when compaction occurs
    +
    +- **Builder directive updates**:
    +  - Update `Forge/Contracts/builder_contract.md` with file block format instructions
    +  - Add task signal format to builder_directive template
    +  - Instruct builder to emit `=== PHASE SIGN-OFF: PASS ===` only after ALL tasks for a phase are complete and the code is ready for audit
    +
    +**Schema coverage:**
    +- No new tables -- conversation state is in-memory during build execution
    +
    +**Exit criteria:**
    +- Builder emits a structured plan at the start of the build
    +- Plan tasks are shown in the UI and checked off as they're completed
    +- After an audit failure, the audit feedback is sent back to the builder as a new conversation turn
    +- The builder successfully self-corrects based on audit feedback (verifiable in test with mocked responses)
    +- Conversation history grows across turns with full context preservation
    +- Context compaction triggers when approaching model limits (tested with mocked large conversations)
    +- All existing tests still pass + new tests for plan parsing, multi-turn loop, audit feedback injection, context compaction
    +- `run_audit.ps1` passes all checks
    +
    +---
    +
    +## Phase 14 -- Build Pause, Resume & User Interjection
    +
    +**Objective:** When the builder hits a configurable failure threshold on a single phase, the build pauses instead of dying. The user sees what went wrong and can choose to: retry (with or without a message to the builder), skip the phase, or abort. The user can also proactively interject at any time during the build to send guidance to the builder.
    +
    +**Background:** Currently at `MAX_LOOP_COUNT = 3`, `_fail_build()` fires with "RISK_EXCEEDS_SCOPE" and the build is dead. The user can only start over. With Option D (multi-turn loopback + pause at threshold), the builder auto-corrects for the first N failures (Phase 13). When it still can't pass, it pauses and asks the human for help. The user can also press a button to interject mid-build at any time.
    +
    +**Deliverables:**
    +
    +- **Build pause mechanism** (backend):
    +  - New build status: `paused` (joins existing: `pending`, `running`, `completed`, `failed`, `cancelled`)
    +  - DB migration 009: add `paused_at TIMESTAMPTZ`, `pause_reason TEXT`, `pause_phase TEXT` to `builds` table
    +  - When `loop_count >= PAUSE_THRESHOLD` (configurable, default 3) on a single phase:
    +    1. Set build status to `paused` with reason and phase
    +    2. Emit `build_paused` WS event: `{ phase, loop_count, audit_findings, options: ["retry", "retry_with_message", "skip_phase", "abort"] }`
    +    3. The background task enters an `asyncio.Event` wait state (does not exit, preserving conversation context in memory)
    +  - `PAUSE_THRESHOLD` configurable via env var (default 3), replaces the hard `MAX_LOOP_COUNT` constant
    +
    +- **Resume endpoints** (backend):
    +  - `POST /projects/{id}/build/resume` -- resume a paused build
    +    - Body: `{ "action": "retry" | "skip" | "abort", "message": "optional user message" }`
    +    - `retry`: append user message (if any) + "Please retry this phase, fixing the issues above." to conversation, set event, builder continues
    +    - `retry_with_message`: same as retry but user's message is mandatory and is prepended to the retry instruction
    +    - `skip`: append "Phase skipped by user. Proceed to the next phase." to conversation, advance phase, set event
    +    - `abort`: call `_fail_build()` with "Build aborted by user at {phase}"
    +  - The `asyncio.Event` is signalled, the background task wakes up and reads the action
    +
    +- **Proactive interjection** (backend):
    +  - `POST /projects/{id}/build/interject` -- send a message to the builder mid-build (while status is `running`)
    +    - Body: `{ "message": "user guidance text" }`
    +    - Sets an interjection flag; at the next natural break point (after current chunk batch), the builder pauses streaming, appends the user message to conversation, and resumes with a new `stream_agent()` call that includes the user's guidance
    +    - Emit `build_interjection` WS event: `{ message, injected_at }`
    +  - Interjection queue: if multiple messages sent before the builder reaches a break point, they're concatenated into a single injection
    +
    +- **Frontend: Pause UI** on BuildProgress page:
    +  - When `build_paused` event received, show a modal/overlay:
    +    - Header: "Build paused ÔÇö audit failed {loop_count} times on {phase}"
    +    - Audit findings list (from the last audit failure)
    +    - Four action buttons:
    +      - **Retry** -- "Let the builder try again"
    +      - **Retry with guidance** -- expands a text input where user types a message, then sends `retry_with_message`
    +      - **Skip phase** -- "Skip this phase and continue" (with warning that skipped phases may cause issues)
    +      - **Abort build** -- "Stop the build entirely" (with confirmation dialog)
    +    - The user's typed message is sent as part of the resume request and injected into the builder's conversation
    +
    +- **Frontend: Interjection button** on BuildProgress page:
    +  - Small "Send message to builder" button (or chat input) visible while build is `running`
    +  - Opens a text input; on submit, calls `POST /projects/{id}/build/interject`
    +  - Activity feed shows "You: {message}" entry when interjection is sent
    +  - Activity feed shows "Builder acknowledged interjection" when it's processed
    +
    +- **Frontend: Paused state styling**:
    +  - Build status badge shows "Paused" in amber/yellow
    +  - Phase checklist shows the paused phase with a pause icon
    +  - Activity feed shows "Build paused ÔÇö awaiting user input" entry
    +
    +- **Timeout safeguard**:
    +  - If a build is paused for longer than 30 minutes (configurable via `BUILD_PAUSE_TIMEOUT_MINUTES`), automatically abort with "Build timed out while paused"
    +  - Background task uses `asyncio.wait_for(event.wait(), timeout=1800)`
    +
    +**Schema coverage:**
    +- [x] builds (extended with pause columns)
    +
    +**Exit criteria:**
    +- Build pauses after 3 audit failures on a single phase instead of dying
    +- Pause UI shows audit findings and four action options
    +- "Retry" resumes the build and the builder attempts the phase again
    +- "Retry with guidance" injects the user's message into the builder's conversation before retrying
    +- "Skip phase" advances to the next phase
    +- "Abort" stops the build with a clear status message
    +- Proactive interjection works mid-build -- user can send guidance at any time
    +- Interjection message appears in the builder's next conversation turn
    +- Paused build times out after 30 minutes if no action taken
    +- Activity feed shows all pause/resume/interjection events
    +- All existing tests still pass + new tests for pause/resume, interjection, timeout, and all action types
    +- `run_audit.ps1` passes all checks
    +
    +---
    +
    +## Phase 15 -- Builder Intelligence Hardening
    +
    +**Objective:** End-to-end integration testing and refinement of the multi-turn builder pipeline. Validate that the full flow -- target selection ÔåÆ build plan ÔåÆ file writing ÔåÆ audit ÔåÆ self-correction ÔåÆ pause/resume ÔåÆ push -- works reliably. Harden edge cases, tune prompts, and ensure the builder produces genuinely usable code.
    +
    +**Deliverables:**
    +
    +- **Integration test suite** (`tests/test_build_integration.py`):
    +  - Full build lifecycle with mocked agent: target selection ÔåÆ plan emission ÔåÆ file blocks ÔåÆ phase sign-off ÔåÆ audit pass ÔåÆ next phase ÔåÆ completion ÔåÆ git push
    +  - Audit failure ÔåÆ self-correction loop (mock agent returns fixed output on second turn)
    +  - Audit failure ÔåÆ pause threshold ÔåÆ user retry with message ÔåÆ builder succeeds
    +  - Audit failure ÔåÆ pause ÔåÆ user skip ÔåÆ next phase
    +  - Audit failure ÔåÆ pause ÔåÆ user abort
    +  - Proactive interjection mid-build ÔåÆ message appears in conversation ÔåÆ builder adjusts
    +  - Context compaction trigger with large conversation
    +  - File overwrite (same path written twice)
    +  - Build target: local path (file writing verified on disk)
    +  - Build target: GitHub new repo (mocked GitHub API + git operations)
    +
    +- **Prompt tuning**:
    +  - Refine builder_contract.md file block format instructions based on real LLM output patterns
    +  - Refine auditor_prompt.md to reduce false positives (especially the diff log TODO issue)
    +  - Add examples of correct file block format to the builder directive
    +  - Tune PAUSE_THRESHOLD default based on testing (may adjust from 3)
    +
    +- **Edge case hardening**:
    +  - Builder emits malformed file blocks ÔåÆ graceful fallback (log warning, don't crash)
    +  - Builder never emits PHASE_COMPLETE_SIGNAL ÔåÆ timeout per phase (configurable, default 10 minutes)
    +  - Network error during git push ÔåÆ retry with backoff, then pause build with error details
    +  - Working directory cleanup on build completion/failure/cancellation
    +  - Concurrent builds per user prevention (existing rate limit enforcement)
    +  - Large file handling (>1MB file blocks) ÔåÆ warn but still write
    +
    +- **Observability**:
    +  - Build summary endpoint enhanced with: total turns, total audit attempts, files written count, git commits made, interjections received
    +  - Build logs searchable/filterable in the frontend (search bar on activity feed)
    +
    +- **Documentation**:
    +  - Update `USER_INSTRUCTIONS.md` with: build target options, how to use interjection, what happens on audit failure, pause/resume flow
    +  - Update `Forge/Contracts/builder_contract.md` with finalised file block format and plan format
    +
    +**Exit criteria:**
    +- All integration tests pass with mocked agent responses
    +- A real build (manual test) successfully creates a GitHub repo, writes files, passes audits, and pushes
    +- No crashes on malformed builder output
    +- Phase timeout triggers correctly
    +- Git push failures are handled gracefully
    +- Working directories are cleaned up
    +- `USER_INSTRUCTIONS.md` is comprehensive and accurate
    +- All tests pass (backend + frontend)
    +- `run_audit.ps1` passes all checks
    diff --git a/Forge/Contracts/physics.yaml b/Forge/Contracts/physics.yaml
    index b5337ec..f8e7053 100644
    --- a/Forge/Contracts/physics.yaml
    +++ b/Forge/Contracts/physics.yaml
    @@ -161,6 +161,8 @@ paths:
           messages_from_server:
             type: "audit_update"
             payload: AuditRunSummary
    +        type: "file_created"
    +        payload: BuildFileEvent
     
       # -- Projects (Phase 8) -------------------------------------------
     
    @@ -267,11 +269,16 @@ paths:
         post:
           summary: "Start a build (validates contracts exist, spawns builder)"
           auth: bearer
    +      request:
    +        target_type: string (required, enum: github_new, github_existing, local_path)
    +        target_ref: string (required, repo name / full_name / absolute path)
           response:
             id: uuid
             project_id: uuid
             phase: string
             status: string
    +        target_type: string
    +        target_ref: string
             started_at: datetime
             created_at: datetime
     
    @@ -298,6 +305,23 @@ paths:
             error_detail: string | null
             created_at: datetime
     
    +  /projects/{project_id}/build/files:
    +    get:
    +      summary: "List all files written during the build"
    +      auth: bearer
    +      response:
    +        items: BuildFile[]
    +
    +  /projects/{project_id}/build/files/{path}:
    +    get:
    +      summary: "Retrieve content of a specific file written during the build"
    +      auth: bearer
    +      response:
    +        path: string
    +        content: string
    +        size_bytes: integer
    +        language: string
    +
       /projects/{project_id}/build/logs:
         get:
           summary: "Paginated build logs"
    @@ -422,12 +446,20 @@ schemas:
         message: string
         created_at: datetime
     
    +  BuildFile:
    +    path: string
    +    size_bytes: integer
    +    language: string
    +    created_at: datetime
    +
       BuildStatus:
         id: uuid
         project_id: uuid
         phase: string
         status: string
         loop_count: integer
    +    target_type: string | null
    +    target_ref: string | null
         started_at: datetime | null
         completed_at: datetime | null
         error_detail: string | null
    diff --git a/Forge/Contracts/schema.md b/Forge/Contracts/schema.md
    index e68e84e..6871701 100644
    --- a/Forge/Contracts/schema.md
    +++ b/Forge/Contracts/schema.md
    @@ -183,6 +183,9 @@ CREATE TABLE builds (
         project_id      UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
         phase           VARCHAR(100) NOT NULL DEFAULT 'Phase 0',
         status          VARCHAR(20) NOT NULL DEFAULT 'pending',
    +    target_type     VARCHAR(20),
    +    target_ref      TEXT,
    +    working_dir     TEXT,
         started_at      TIMESTAMPTZ,
         completed_at    TIMESTAMPTZ,
         loop_count      INTEGER NOT NULL DEFAULT 0,
    @@ -192,6 +195,7 @@ CREATE TABLE builds (
     ```
     
     `status` values: `pending`, `running`, `completed`, `failed`, `cancelled`
    +`target_type` values: `github_new`, `github_existing`, `local_path`, `null` (legacy builds)
     
     ```sql
     CREATE INDEX idx_builds_project_id ON builds(project_id);
    @@ -275,4 +279,8 @@ db/migrations/
       002_projects.sql
       003_builds.sql
       004_build_costs.sql
    +  005_questionnaire_state.sql
    +  006_user_api_key.sql
    +  007_audit_llm_toggle.sql
    +  008_build_targets.sql
     ```
    diff --git a/Forge/evidence/audit_ledger.md b/Forge/evidence/audit_ledger.md
    index 8732f2e..7228b1e 100644
    --- a/Forge/evidence/audit_ledger.md
    +++ b/Forge/evidence/audit_ledger.md
    @@ -3779,3 +3779,195 @@ Outcome: SIGNED-OFF (awaiting AUTHORIZED)
     W1: WARN -- Potential secrets found: sk-
     W2: PASS -- audit_ledger.md exists and is non-empty.
     W3: PASS -- All physics paths have corresponding handler files.
    +
    +---
    +## Audit Entry: Phase 12 -- - Build Target & File Writing: builder writes real files to a chosen target -- Iteration 81
    +Timestamp: 2026-02-15T19:26:20Z
    +AEM Cycle: Phase 12 -- - Build Target & File Writing: builder writes real files to a chosen target
    +Outcome: FAIL
    +
    +### Checklist
    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/builds.py, app/repos/build_repo.py, app/services/build_service.py, Forge/Contracts/builder_contract.md, Forge/Contracts/phases.md, Forge/Contracts/physics.yaml, Forge/Contracts/schema.md, Forge/evidence/updatedifflog.md, tests/test_build_repo.py, tests/test_build_service.py, tests/test_builds_router.py, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx. Claimed but not in diff: _write_file_block, app/api/routers/builds.py (StartBuildRequest, app/clients/git_client.py (NEW), app/repos/build_repo.py (target params, app/services/build_service.py (file parsing, BuildFile schema), db/migrations/008_build_targets.sql (NEW), detection), file endpoints, file endpoints), file_created WS handler), Forge/Contracts/builder_contract.md (┬º0.1 file block output format), Forge/Contracts/phases.md (Phases 12-15 appended), Forge/Contracts/physics.yaml (build target params, Forge/Contracts/schema.md (builds table target columns, get_build_file_logs), git ops), migration 008), target create), target handling, tests/test_build_repo.py (new tests for file logs, tests/test_build_service.py (new tests for file parsing, tests/test_builds_router.py (new tests for target params, tests/test_git_client.py (NEW), web/src/__tests__/BuildTargetModal.test.tsx (NEW), web/src/components/BuildTargetModal.tsx (NEW), web/src/pages/BuildProgress.tsx (file tree panel, web/src/pages/ProjectDetail.tsx (target picker integration), writing.
    +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    +- A5 Diff Log Gate:         PASS -- No TODO: placeholders in updatedifflog.md.
    +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    +- A7 Verification order:    FAIL -- Missing verification keywords: Static, Runtime, Behavior, Contract.
    +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    +
    +### Fix Plan (FAIL items)
    +- A1: FAIL -- Unclaimed in diff: app/api/routers/builds.py, app/repos/build_repo.py, app/services/build_service.py, Forge/Contracts/builder_contract.md, Forge/Contracts/phases.md, Forge/Contracts/physics.yaml, Forge/Contracts/schema.md, Forge/evidence/updatedifflog.md, tests/test_build_repo.py, tests/test_build_service.py, tests/test_builds_router.py, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx. Claimed but not in diff: _write_file_block, app/api/routers/builds.py (StartBuildRequest, app/clients/git_client.py (NEW), app/repos/build_repo.py (target params, app/services/build_service.py (file parsing, BuildFile schema), db/migrations/008_build_targets.sql (NEW), detection), file endpoints, file endpoints), file_created WS handler), Forge/Contracts/builder_contract.md (┬º0.1 file block output format), Forge/Contracts/phases.md (Phases 12-15 appended), Forge/Contracts/physics.yaml (build target params, Forge/Contracts/schema.md (builds table target columns, get_build_file_logs), git ops), migration 008), target create), target handling, tests/test_build_repo.py (new tests for file logs, tests/test_build_service.py (new tests for file parsing, tests/test_builds_router.py (new tests for target params, tests/test_git_client.py (NEW), web/src/__tests__/BuildTargetModal.test.tsx (NEW), web/src/components/BuildTargetModal.tsx (NEW), web/src/pages/BuildProgress.tsx (file tree panel, web/src/pages/ProjectDetail.tsx (target picker integration), writing.
    +- A7: FAIL -- Missing verification keywords: Static, Runtime, Behavior, Contract.
    +
    +### Files Changed
    +- _write_file_block
    +- app/api/routers/builds.py (StartBuildRequest
    +- app/clients/git_client.py (NEW)
    +- app/repos/build_repo.py (target params
    +- app/services/build_service.py (file parsing
    +- BuildFile schema)
    +- db/migrations/008_build_targets.sql (NEW)
    +- detection)
    +- file endpoints
    +- file endpoints)
    +- file_created WS handler)
    +- Forge/Contracts/builder_contract.md (┬º0.1 file block output format)
    +- Forge/Contracts/phases.md (Phases 12-15 appended)
    +- Forge/Contracts/physics.yaml (build target params
    +- Forge/Contracts/schema.md (builds table target columns
    +- get_build_file_logs)
    +- git ops)
    +- migration 008)
    +- target create)
    +- target handling
    +- tests/test_build_repo.py (new tests for file logs
    +- tests/test_build_service.py (new tests for file parsing
    +- tests/test_builds_router.py (new tests for target params
    +- tests/test_git_client.py (NEW)
    +- web/src/__tests__/BuildTargetModal.test.tsx (NEW)
    +- web/src/components/BuildTargetModal.tsx (NEW)
    +- web/src/pages/BuildProgress.tsx (file tree panel
    +- web/src/pages/ProjectDetail.tsx (target picker integration)
    +- writing
    +
    +### Notes
    +W1: WARN -- Potential secrets found: sk-, token=
    +W2: PASS -- audit_ledger.md exists and is non-empty.
    +W3: PASS -- All physics paths have corresponding handler files.
    +
    +---
    +## Audit Entry: Phase 12 -- - Build Target & File Writing -- Iteration 82
    +Timestamp: 2026-02-15T19:26:30Z
    +AEM Cycle: Phase 12 -- - Build Target & File Writing
    +Outcome: FAIL
    +
    +### Checklist
    +- A1 Scope compliance:      PASS -- git diff matches claimed files exactly (19 files).
    +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    +- A5 Diff Log Gate:         FAIL -- updatedifflog.md contains TODO: placeholders.
    +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    +
    +### Fix Plan (FAIL items)
    +- A5: FAIL -- updatedifflog.md contains TODO: placeholders.
    +
    +### Files Changed
    +- app/api/routers/builds.py
    +- app/clients/git_client.py
    +- app/repos/build_repo.py
    +- app/services/build_service.py
    +- db/migrations/008_build_targets.sql
    +- Forge/Contracts/builder_contract.md
    +- Forge/Contracts/phases.md
    +- Forge/Contracts/physics.yaml
    +- Forge/Contracts/schema.md
    +- Forge/evidence/audit_ledger.md
    +- Forge/evidence/updatedifflog.md
    +- tests/test_build_repo.py
    +- tests/test_build_service.py
    +- tests/test_builds_router.py
    +- tests/test_git_client.py
    +- web/src/__tests__/BuildTargetModal.test.tsx
    +- web/src/components/BuildTargetModal.tsx
    +- web/src/pages/BuildProgress.tsx
    +- web/src/pages/ProjectDetail.tsx
    +
    +### Notes
    +W1: WARN -- Potential secrets found: sk-, token=
    +W2: PASS -- audit_ledger.md exists and is non-empty.
    +W3: PASS -- All physics paths have corresponding handler files.
    +
    +---
    +## Audit Entry: Phase 12 -- - Build Target & File Writing: builder writes real files to a chosen target -- Iteration 83
    +Timestamp: 2026-02-15T19:27:15Z
    +AEM Cycle: Phase 12 -- - Build Target & File Writing: builder writes real files to a chosen target
    +Outcome: SIGNED-OFF (awaiting AUTHORIZED)
    +
    +### Checklist
    +- A1 Scope compliance:      PASS -- git diff matches claimed files exactly (19 files).
    +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    +- A5 Diff Log Gate:         PASS -- No TODO: placeholders in updatedifflog.md.
    +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    +
    +### Files Changed
    +- app/api/routers/builds.py
    +- app/clients/git_client.py
    +- app/repos/build_repo.py
    +- app/services/build_service.py
    +- db/migrations/008_build_targets.sql
    +- Forge/Contracts/builder_contract.md
    +- Forge/Contracts/phases.md
    +- Forge/Contracts/physics.yaml
    +- Forge/Contracts/schema.md
    +- Forge/evidence/audit_ledger.md
    +- Forge/evidence/updatedifflog.md
    +- tests/test_build_repo.py
    +- tests/test_build_service.py
    +- tests/test_builds_router.py
    +- tests/test_git_client.py
    +- web/src/__tests__/BuildTargetModal.test.tsx
    +- web/src/components/BuildTargetModal.tsx
    +- web/src/pages/BuildProgress.tsx
    +- web/src/pages/ProjectDetail.tsx
    +
    +### Notes
    +W1: WARN -- Potential secrets found: sk-, token=
    +W2: PASS -- audit_ledger.md exists and is non-empty.
    +W3: PASS -- All physics paths have corresponding handler files.
    +
    +---
    +## Audit Entry: Phase 12 -- - Build Target & File Writing -- Iteration 84
    +Timestamp: 2026-02-15T19:27:21Z
    +AEM Cycle: Phase 12 -- - Build Target & File Writing
    +Outcome: FAIL
    +
    +### Checklist
    +- A1 Scope compliance:      PASS -- git diff matches claimed files exactly (19 files).
    +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    +- A5 Diff Log Gate:         FAIL -- updatedifflog.md contains TODO: placeholders.
    +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    +
    +### Fix Plan (FAIL items)
    +- A5: FAIL -- updatedifflog.md contains TODO: placeholders.
    +
    +### Files Changed
    +- app/api/routers/builds.py
    +- app/clients/git_client.py
    +- app/repos/build_repo.py
    +- app/services/build_service.py
    +- db/migrations/008_build_targets.sql
    +- Forge/Contracts/builder_contract.md
    +- Forge/Contracts/phases.md
    +- Forge/Contracts/physics.yaml
    +- Forge/Contracts/schema.md
    +- Forge/evidence/audit_ledger.md
    +- Forge/evidence/updatedifflog.md
    +- tests/test_build_repo.py
    +- tests/test_build_service.py
    +- tests/test_builds_router.py
    +- tests/test_git_client.py
    +- web/src/__tests__/BuildTargetModal.test.tsx
    +- web/src/components/BuildTargetModal.tsx
    +- web/src/pages/BuildProgress.tsx
    +- web/src/pages/ProjectDetail.tsx
    +
    +### Notes
    +W1: WARN -- Potential secrets found: sk-, token=
    +W2: PASS -- audit_ledger.md exists and is non-empty.
    +W3: PASS -- All physics paths have corresponding handler files.
    diff --git a/Forge/evidence/updatedifflog.md b/Forge/evidence/updatedifflog.md
    index a9722d8..d697312 100644
    --- a/Forge/evidence/updatedifflog.md
    +++ b/Forge/evidence/updatedifflog.md
    @@ -1,7369 +1,20238 @@
    -# Diff Log (overwrite each cycle)
    +´╗┐# Diff Log (overwrite each cycle)
     
     ## Cycle Metadata
    -- Timestamp: 2026-02-15T18:16:39+00:00
    +- Timestamp: 2026-02-15T19:27:19+00:00
     - Branch: master
    -- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    -- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    +- HEAD: ceb988f83e66f094035eb31168aed612e537a451
    +- BASE_HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
     - Diff basis: staged
     
     ## Cycle Status
    -- Status: COMPLETE
    +- Status: IN_PROCESS
     
     ## Summary
    -- Removed phase_breakdown from questionnaire (7 sections),Added build/phases endpoint parsing phases contract,Enhanced build WS events with token data in phase_complete and build_complete,Rewrote BuildProgress.tsx with two-column layout: phase checklist + metrics + activity feed
    +- TODO: 1-5 bullets (what changed, why, scope).
     
     ## Files Changed (staged)
    +- Forge/Contracts/builder_contract.md
    +- Forge/Contracts/phases.md
    +- Forge/Contracts/physics.yaml
    +- Forge/Contracts/schema.md
     - Forge/evidence/audit_ledger.md
    -- Forge/evidence/test_runs_latest.md
     - Forge/evidence/updatedifflog.md
    -- Forge/scripts/run_audit.ps1
    -- USER_INSTRUCTIONS.md
    -- app/api/routers/auth.py
     - app/api/routers/builds.py
    -- app/api/routers/projects.py
    -- app/clients/llm_client.py
    -- app/config.py
    -- app/repos/audit_repo.py
    -- app/repos/user_repo.py
    -- app/services/audit_service.py
    +- app/clients/git_client.py
    +- app/repos/build_repo.py
     - app/services/build_service.py
    -- app/services/project_service.py
    -- db/migrations/006_user_api_key.sql
    -- tests/test_audit_service.py
    -- tests/test_auth_router.py
    +- db/migrations/008_build_targets.sql
    +- tests/test_build_repo.py
     - tests/test_build_service.py
    -- tests/test_llm_client.py
    -- tests/test_project_service.py
    -- tests/test_projects_router.py
    -- web/src/App.tsx
    -- web/src/__tests__/App.test.tsx
    -- web/src/__tests__/Build.test.tsx
    -- web/src/components/AppShell.tsx
    -- web/src/components/ContractProgress.tsx
    -- web/src/components/QuestionnaireModal.tsx
    -- web/src/context/AuthContext.tsx
    -- web/src/pages/BuildComplete.tsx
    +- tests/test_builds_router.py
    +- tests/test_git_client.py
    +- web/src/__tests__/BuildTargetModal.test.tsx
    +- web/src/components/BuildTargetModal.tsx
     - web/src/pages/BuildProgress.tsx
     - web/src/pages/ProjectDetail.tsx
    -- web/src/pages/Settings.tsx
    -- web/vite.config.ts
     
     ## git status -sb
    -    ## master...origin/master [ahead 2]
    +    ## master...origin/master [ahead 3]
    +    M  Forge/Contracts/builder_contract.md
    +    M  Forge/Contracts/phases.md
    +    M  Forge/Contracts/physics.yaml
    +    M  Forge/Contracts/schema.md
         MM Forge/evidence/audit_ledger.md
    -    M  Forge/evidence/test_runs_latest.md
    -    MM Forge/evidence/updatedifflog.md
    -    M  Forge/scripts/run_audit.ps1
    -    M  USER_INSTRUCTIONS.md
    -    M  app/api/routers/auth.py
    +    M  Forge/evidence/updatedifflog.md
         M  app/api/routers/builds.py
    -    M  app/api/routers/projects.py
    -    M  app/clients/llm_client.py
    -    M  app/config.py
    -    M  app/repos/audit_repo.py
    -    M  app/repos/user_repo.py
    -    M  app/services/audit_service.py
    +    A  app/clients/git_client.py
    +    M  app/repos/build_repo.py
         M  app/services/build_service.py
    -    M  app/services/project_service.py
    -    A  db/migrations/006_user_api_key.sql
    -    M  tests/test_audit_service.py
    -    M  tests/test_auth_router.py
    +    A  db/migrations/008_build_targets.sql
    +    M  tests/test_build_repo.py
         M  tests/test_build_service.py
    -    M  tests/test_llm_client.py
    -    MM tests/test_project_service.py
    -    MM tests/test_projects_router.py
    -    MM web/src/App.tsx
    -    MM web/src/__tests__/App.test.tsx
    -    M  web/src/__tests__/Build.test.tsx
    -    M  web/src/components/AppShell.tsx
    -    AM web/src/components/ContractProgress.tsx
    -    M  web/src/components/QuestionnaireModal.tsx
    -    MM web/src/context/AuthContext.tsx
    -    M  web/src/pages/BuildComplete.tsx
    +    M  tests/test_builds_router.py
    +    A  tests/test_git_client.py
    +    A  web/src/__tests__/BuildTargetModal.test.tsx
    +    A  web/src/components/BuildTargetModal.tsx
         M  web/src/pages/BuildProgress.tsx
    -    MM web/src/pages/ProjectDetail.tsx
    -    A  web/src/pages/Settings.tsx
    -    M  web/vite.config.ts
    +    M  web/src/pages/ProjectDetail.tsx
     
     ## Verification
    -- Static: pylance 0 errors on all changed files,Runtime: boot.ps1 runs without errors,Behavior: vitest 49/49 pass,Contract: phases contract parsing matches schema.md phase structure
    +- TODO: verification evidence (static -> runtime -> behavior -> contract).
     
     ## Notes (optional)
    -- PhaseProgressBar/BuildLogViewer still exist but no longer used by BuildProgress
    +- TODO: blockers, risks, constraints.
     
     ## Next Steps
    -- Watcher sign-off
    +- TODO: next actions (small, specific).
     
     ## Minimal Diff Hunks
    +    diff --git a/Forge/Contracts/builder_contract.md b/Forge/Contracts/builder_contract.md
    +    index 2b43966..85cd9c1 100644
    +    --- a/Forge/Contracts/builder_contract.md
    +    +++ b/Forge/Contracts/builder_contract.md
    +    @@ -35,6 +35,26 @@ ProjectRoot/              ├ö├Ñ├ë git root, builder's working directory
    +     - `forge.json` lives at the project root.
    +     - The `Forge/` folder may be deleted after the project build is complete. No project code may import from or depend on files inside `Forge/`.
    +     
    +    +### 0.1) File block output format (mandatory for autonomous builds)
    +    +
    +    +When the builder is operating as a ForgeGuard autonomous build agent (not a human-interactive session), all file creation MUST use the following canonical format so the orchestrator can parse and write files to disk:
    +    +
    +    +```
    +    +=== FILE: path/to/file.py ===
    +    +```python
    +    +<file contents>
    +    +```
    +    +=== END FILE ===
    +    +```
    +    +
    +    +**Rules:**
    +    +- The path after `FILE:` is relative to the project root (e.g., `app/main.py`, `tests/test_health.py`).
    +    +- One file per block. Multiple files = multiple blocks.
    +    +- The code fence inside the block (` ```lang `) is optional but recommended for readability.
    +    +- If updating an existing file, emit the full file content (the orchestrator overwrites).
    +    +- Do NOT emit partial files or diffs -- always emit the complete file.
    +    +- The `=== END FILE ===` delimiter MUST appear on its own line after the file content.
    +    +
    +     ---
    +     
    +     ## 1) Contract read gate (mandatory)
    +    diff --git a/Forge/Contracts/phases.md b/Forge/Contracts/phases.md
    +    index f5bfde5..e9c0542 100644
    +    --- a/Forge/Contracts/phases.md
    +    +++ b/Forge/Contracts/phases.md
    +    @@ -385,3 +385,279 @@ Canonical phase plan. Each phase is self-contained, shippable, and auditable. Th
    +     - `USER_INSTRUCTIONS.md` covers the full project creation and build workflow
    +     - All tests pass
    +     - `run_audit.ps1` passes all checks
    +    +
    +    +---
    +    +
    +    +## Phase 12 -- Build Target & File Writing
    +    +
    +    +**Objective:** The builder actually writes files. Users choose a build target -- a new GitHub repo, an existing GitHub repo, or a local file path -- and the builder's output is parsed into discrete files and written to that target in real time. This replaces the current "stream text only" behaviour.
    +    +
    +    +**Background:** Currently the builder streams its entire output as raw text chunks. No files are created anywhere. The user's intention was always that builds produce real, usable code in a real repository or directory.
    +    +
    +    +**Deliverables:**
    +    +
    +    +- **Build target selection** (backend + frontend):
    +    +  - `build_target_type` enum: `github_new`, `github_existing`, `local_path`
    +    +  - `POST /projects/{id}/build` extended: accepts `target_type` and `target_ref` (repo name for new, repo full_name for existing, absolute path for local)
    +    +  - For `github_new`: call GitHub API to create an empty repo under the user's account, clone it locally to a temp working directory
    +    +  - For `github_existing`: clone the repo to a temp working directory (shallow clone, default branch)
    +    +  - For `local_path`: validate the path exists (or create it), use directly as the working directory
    +    +  - Store target info on the `builds` table: `target_type`, `target_ref`, `working_dir`
    +    +
    +    +- **DB migration 008** -- `build_targets`:
    +    +  - Add columns to `builds`: `target_type VARCHAR(20)`, `target_ref TEXT`, `working_dir TEXT`
    +    +
    +    +- **File parser in build_service.py**:
    +    +  - Builder directive updated to instruct the LLM to emit file blocks in a canonical format:
    +    +    ```
    +    +    === FILE: path/to/file.py ===
    +    +    ```python
    +    +    <file contents>
    +    +    ```
    +    +    === END FILE ===
    +    +    ```
    +    +  - `_parse_file_blocks(accumulated_text)` -- extracts file path + content from builder output
    +    +  - When a file block is detected:
    +    +    1. Write the file to the working directory on disk
    +    +    2. Emit `file_created` WS event with `{ path, size_bytes, language }`
    +    +    3. Log the file write to build_logs
    +    +  - Handle file updates (same path written twice = overwrite with latest)
    +    +
    +    +- **Git operations** (for GitHub targets):
    +    +  - After each phase completes audit, stage + commit all new/modified files with message `"forge: Phase N complete"`
    +    +  - After build completes, push all commits to the remote
    +    +  - `app/clients/git_client.py` -- thin wrapper around `asyncio.subprocess` for git clone, add, commit, push (no heavy git library dependency)
    +    +
    +    +- **Frontend: Build target picker** (shown before build starts):
    +    +  - Three-option card selector: "New GitHub Repo" / "Existing GitHub Repo" / "Local Directory"
    +    +  - For new repo: text input for repo name (validated against GitHub naming rules)
    +    +  - For existing repo: repo picker modal (reuse existing component)
    +    +  - For local: text input for absolute path with validation
    +    +  - Selected target stored in build state and sent with `POST /projects/{id}/build`
    +    +
    +    +- **Frontend: File tree panel** on BuildProgress page:
    +    +  - New collapsible panel (left column, below phase checklist) showing files created so far
    +    +  - Tree structure mirroring directory hierarchy
    +    +  - Each file shows: path, size, language icon
    +    +  - Updates in real-time via `file_created` WS events
    +    +  - Click a file to expand and see a syntax-highlighted preview of its content (read from build logs or a dedicated endpoint)
    +    +
    +    +- **API for file retrieval**:
    +    +  - `GET /projects/{id}/build/files` -- list all files written during the build
    +    +  - `GET /projects/{id}/build/files/{path}` -- retrieve content of a specific file
    +    +
    +    +**Schema coverage:**
    +    +- [x] builds (extended with target columns)
    +    +- [x] build_logs (Phase 9)
    +    +- [ ] No new tables -- file metadata derived from build_logs + filesystem
    +    +
    +    +**Exit criteria:**
    +    +- User can select "New GitHub Repo" and the build creates the repo + writes files into it
    +    +- User can select "Existing GitHub Repo" and the build writes files into the cloned repo
    +    +- User can select "Local Directory" and files are written to that path
    +    +- Files appear in the file tree panel in real-time as the builder creates them
    +    +- After each phase audit pass, files are committed with a phase-specific message
    +    +- After build completion (GitHub targets), all commits are pushed to the remote
    +    +- File content is retrievable via API
    +    +- All existing tests still pass + new tests for file parsing, git operations, and target selection
    +    +- `run_audit.ps1` passes all checks
    +    +
    +    +---
    +    +
    +    +## Phase 13 -- Multi-Turn Builder & Structured Build Plan
    +    +
    +    +**Objective:** Convert the builder from a single streaming call to a multi-turn conversation. The builder emits a structured plan at the start, and after audit failures the audit feedback is injected back into the conversation so the builder can self-correct. This gives the builder full context of what it's already done, what failed, and why.
    +    +
    +    +**Background:** Currently `_run_build()` creates `messages = [{"role":"user","content": directive}]` and makes one `stream_agent()` call. The audit runs but its feedback is never sent back to the builder. The builder has no ability to self-correct -- it just gets a loop count incremented and the build eventually fails. Real builds took ~7 iterations because the diff log retained TODO placeholders that the auditor kept flagging.
    +    +
    +    +**Deliverables:**
    +    +
    +    +- **Structured build plan emission**:
    +    +  - Update builder directive (system prompt / builder_contract.md) to instruct the LLM:
    +    +    > Before writing any code, emit a `=== BUILD PLAN ===` block listing all tasks you will perform, grouped by phase. Each task should be a single line: `- [ ] Task description`. End the plan with `=== END BUILD PLAN ===`.
    +    +  - `_parse_build_plan(text)` in build_service.py -- extracts task list from the plan block
    +    +  - Emit `build_plan` WS event: `{ tasks: [{ id, description, phase, status }] }`
    +    +  - As the builder works, detect task completion signals (`=== TASK DONE: <id> ===`) and emit `task_complete` WS events
    +    +  - Frontend: Build Plan checklist panel in BuildProgress (right column, above activity feed), showing all tasks with check/pending/fail icons, updating in real-time
    +    +
    +    +- **Multi-turn conversation loop**:
    +    +  - Replace single `stream_agent()` call with a conversation loop:
    +    +    ```
    +    +    messages = [{"role": "user", "content": directive}]
    +    +    while not build_complete:
    +    +        async for chunk in stream_agent(..., messages=messages):
    +    +            # accumulate, parse files, detect signals
    +    +        messages.append({"role": "assistant", "content": accumulated_text})
    +    +        
    +    +        if phase_complete_detected:
    +    +            audit_result = await _run_inline_audit(...)
    +    +            if audit_result == "PASS":
    +    +                # continue to next phase
    +    +                messages.append({"role": "user", "content": f"Audit PASSED for {phase}. Proceed to the next phase."})
    +    +            else:
    +    +                # loopback with audit feedback
    +    +                messages.append({"role": "user", "content": f"Audit FAILED for {phase}.\n\nAudit feedback:\n{audit_detail}\n\nFix the issues identified above and re-submit {phase}."})
    +    +    ```
    +    +  - The conversation grows with each turn -- the builder sees everything it's already produced + audit results
    +    +  - No separate database table for "state" -- the conversation history IS the state
    +    +
    +    +- **Audit feedback forwarding**:
    +    +  - `_run_inline_audit()` updated to return audit detail (not just PASS/FAIL) -- the full auditor response including specific findings
    +    +  - Return type changes from `str` to `AuditResult` dataclass: `{ verdict: str, detail: str, findings: list[str] }`
    +    +  - On FAIL: the audit detail is appended to messages so the builder knows exactly what to fix
    +    +  - Emit `audit_fail` WS event extended with `{ findings: [...] }` so the frontend can show what failed
    +    +
    +    +- **Context window management**:
    +    +  - Track total conversation tokens (input + output across turns)
    +    +  - If conversation approaches model context limit (200K for Opus), truncate earlier turns while preserving: (1) original directive, (2) last 2 turns, (3) all audit feedback messages
    +    +  - `_compact_messages(messages, max_tokens)` helper for intelligent truncation
    +    +  - Log a warning when compaction occurs
    +    +
    +    +- **Builder directive updates**:
    +    +  - Update `Forge/Contracts/builder_contract.md` with file block format instructions
    +    +  - Add task signal format to builder_directive template
    +    +  - Instruct builder to emit `=== PHASE SIGN-OFF: PASS ===` only after ALL tasks for a phase are complete and the code is ready for audit
    +    +
    +    +**Schema coverage:**
    +    +- No new tables -- conversation state is in-memory during build execution
    +    +
    +    +**Exit criteria:**
    +    +- Builder emits a structured plan at the start of the build
    +    +- Plan tasks are shown in the UI and checked off as they're completed
    +    +- After an audit failure, the audit feedback is sent back to the builder as a new conversation turn
    +    +- The builder successfully self-corrects based on audit feedback (verifiable in test with mocked responses)
    +    +- Conversation history grows across turns with full context preservation
    +    +- Context compaction triggers when approaching model limits (tested with mocked large conversations)
    +    +- All existing tests still pass + new tests for plan parsing, multi-turn loop, audit feedback injection, context compaction
    +    +- `run_audit.ps1` passes all checks
    +    +
    +    +---
    +    +
    +    +## Phase 14 -- Build Pause, Resume & User Interjection
    +    +
    +    +**Objective:** When the builder hits a configurable failure threshold on a single phase, the build pauses instead of dying. The user sees what went wrong and can choose to: retry (with or without a message to the builder), skip the phase, or abort. The user can also proactively interject at any time during the build to send guidance to the builder.
    +    +
    +    +**Background:** Currently at `MAX_LOOP_COUNT = 3`, `_fail_build()` fires with "RISK_EXCEEDS_SCOPE" and the build is dead. The user can only start over. With Option D (multi-turn loopback + pause at threshold), the builder auto-corrects for the first N failures (Phase 13). When it still can't pass, it pauses and asks the human for help. The user can also press a button to interject mid-build at any time.
    +    +
    +    +**Deliverables:**
    +    +
    +    +- **Build pause mechanism** (backend):
    +    +  - New build status: `paused` (joins existing: `pending`, `running`, `completed`, `failed`, `cancelled`)
    +    +  - DB migration 009: add `paused_at TIMESTAMPTZ`, `pause_reason TEXT`, `pause_phase TEXT` to `builds` table
    +    +  - When `loop_count >= PAUSE_THRESHOLD` (configurable, default 3) on a single phase:
    +    +    1. Set build status to `paused` with reason and phase
    +    +    2. Emit `build_paused` WS event: `{ phase, loop_count, audit_findings, options: ["retry", "retry_with_message", "skip_phase", "abort"] }`
    +    +    3. The background task enters an `asyncio.Event` wait state (does not exit, preserving conversation context in memory)
    +    +  - `PAUSE_THRESHOLD` configurable via env var (default 3), replaces the hard `MAX_LOOP_COUNT` constant
    +    +
    +    +- **Resume endpoints** (backend):
    +    +  - `POST /projects/{id}/build/resume` -- resume a paused build
    +    +    - Body: `{ "action": "retry" | "skip" | "abort", "message": "optional user message" }`
    +    +    - `retry`: append user message (if any) + "Please retry this phase, fixing the issues above." to conversation, set event, builder continues
    +    +    - `retry_with_message`: same as retry but user's message is mandatory and is prepended to the retry instruction
    +    +    - `skip`: append "Phase skipped by user. Proceed to the next phase." to conversation, advance phase, set event
    +    +    - `abort`: call `_fail_build()` with "Build aborted by user at {phase}"
    +    +  - The `asyncio.Event` is signalled, the background task wakes up and reads the action
    +    +
    +    +- **Proactive interjection** (backend):
    +    +  - `POST /projects/{id}/build/interject` -- send a message to the builder mid-build (while status is `running`)
    +    +    - Body: `{ "message": "user guidance text" }`
    +    +    - Sets an interjection flag; at the next natural break point (after current chunk batch), the builder pauses streaming, appends the user message to conversation, and resumes with a new `stream_agent()` call that includes the user's guidance
    +    +    - Emit `build_interjection` WS event: `{ message, injected_at }`
    +    +  - Interjection queue: if multiple messages sent before the builder reaches a break point, they're concatenated into a single injection
    +    +
    +    +- **Frontend: Pause UI** on BuildProgress page:
    +    +  - When `build_paused` event received, show a modal/overlay:
    +    +    - Header: "Build paused ├ö├ç├Â audit failed {loop_count} times on {phase}"
    +    +    - Audit findings list (from the last audit failure)
    +    +    - Four action buttons:
    +    +      - **Retry** -- "Let the builder try again"
    +    +      - **Retry with guidance** -- expands a text input where user types a message, then sends `retry_with_message`
    +    +      - **Skip phase** -- "Skip this phase and continue" (with warning that skipped phases may cause issues)
    +    +      - **Abort build** -- "Stop the build entirely" (with confirmation dialog)
    +    +    - The user's typed message is sent as part of the resume request and injected into the builder's conversation
    +    +
    +    +- **Frontend: Interjection button** on BuildProgress page:
    +    +  - Small "Send message to builder" button (or chat input) visible while build is `running`
    +    +  - Opens a text input; on submit, calls `POST /projects/{id}/build/interject`
    +    +  - Activity feed shows "You: {message}" entry when interjection is sent
    +    +  - Activity feed shows "Builder acknowledged interjection" when it's processed
    +    +
    +    +- **Frontend: Paused state styling**:
    +    +  - Build status badge shows "Paused" in amber/yellow
    +    +  - Phase checklist shows the paused phase with a pause icon
    +    +  - Activity feed shows "Build paused ├ö├ç├Â awaiting user input" entry
    +    +
    +    +- **Timeout safeguard**:
    +    +  - If a build is paused for longer than 30 minutes (configurable via `BUILD_PAUSE_TIMEOUT_MINUTES`), automatically abort with "Build timed out while paused"
    +    +  - Background task uses `asyncio.wait_for(event.wait(), timeout=1800)`
    +    +
    +    +**Schema coverage:**
    +    +- [x] builds (extended with pause columns)
    +    +
    +    +**Exit criteria:**
    +    +- Build pauses after 3 audit failures on a single phase instead of dying
    +    +- Pause UI shows audit findings and four action options
    +    +- "Retry" resumes the build and the builder attempts the phase again
    +    +- "Retry with guidance" injects the user's message into the builder's conversation before retrying
    +    +- "Skip phase" advances to the next phase
    +    +- "Abort" stops the build with a clear status message
    +    +- Proactive interjection works mid-build -- user can send guidance at any time
    +    +- Interjection message appears in the builder's next conversation turn
    +    +- Paused build times out after 30 minutes if no action taken
    +    +- Activity feed shows all pause/resume/interjection events
    +    +- All existing tests still pass + new tests for pause/resume, interjection, timeout, and all action types
    +    +- `run_audit.ps1` passes all checks
    +    +
    +    +---
    +    +
    +    +## Phase 15 -- Builder Intelligence Hardening
    +    +
    +    +**Objective:** End-to-end integration testing and refinement of the multi-turn builder pipeline. Validate that the full flow -- target selection ├ö├Ñ├å build plan ├ö├Ñ├å file writing ├ö├Ñ├å audit ├ö├Ñ├å self-correction ├ö├Ñ├å pause/resume ├ö├Ñ├å push -- works reliably. Harden edge cases, tune prompts, and ensure the builder produces genuinely usable code.
    +    +
    +    +**Deliverables:**
    +    +
    +    +- **Integration test suite** (`tests/test_build_integration.py`):
    +    +  - Full build lifecycle with mocked agent: target selection ├ö├Ñ├å plan emission ├ö├Ñ├å file blocks ├ö├Ñ├å phase sign-off ├ö├Ñ├å audit pass ├ö├Ñ├å next phase ├ö├Ñ├å completion ├ö├Ñ├å git push
    +    +  - Audit failure ├ö├Ñ├å self-correction loop (mock agent returns fixed output on second turn)
    +    +  - Audit failure ├ö├Ñ├å pause threshold ├ö├Ñ├å user retry with message ├ö├Ñ├å builder succeeds
    +    +  - Audit failure ├ö├Ñ├å pause ├ö├Ñ├å user skip ├ö├Ñ├å next phase
    +    +  - Audit failure ├ö├Ñ├å pause ├ö├Ñ├å user abort
    +    +  - Proactive interjection mid-build ├ö├Ñ├å message appears in conversation ├ö├Ñ├å builder adjusts
    +    +  - Context compaction trigger with large conversation
    +    +  - File overwrite (same path written twice)
    +    +  - Build target: local path (file writing verified on disk)
    +    +  - Build target: GitHub new repo (mocked GitHub API + git operations)
    +    +
    +    +- **Prompt tuning**:
    +    +  - Refine builder_contract.md file block format instructions based on real LLM output patterns
    +    +  - Refine auditor_prompt.md to reduce false positives (especially the diff log TODO issue)
    +    +  - Add examples of correct file block format to the builder directive
    +    +  - Tune PAUSE_THRESHOLD default based on testing (may adjust from 3)
    +    +
    +    +- **Edge case hardening**:
    +    +  - Builder emits malformed file blocks ├ö├Ñ├å graceful fallback (log warning, don't crash)
    +    +  - Builder never emits PHASE_COMPLETE_SIGNAL ├ö├Ñ├å timeout per phase (configurable, default 10 minutes)
    +    +  - Network error during git push ├ö├Ñ├å retry with backoff, then pause build with error details
    +    +  - Working directory cleanup on build completion/failure/cancellation
    +    +  - Concurrent builds per user prevention (existing rate limit enforcement)
    +    +  - Large file handling (>1MB file blocks) ├ö├Ñ├å warn but still write
    +    +
    +    +- **Observability**:
    +    +  - Build summary endpoint enhanced with: total turns, total audit attempts, files written count, git commits made, interjections received
    +    +  - Build logs searchable/filterable in the frontend (search bar on activity feed)
    +    +
    +    +- **Documentation**:
    +    +  - Update `USER_INSTRUCTIONS.md` with: build target options, how to use interjection, what happens on audit failure, pause/resume flow
    +    +  - Update `Forge/Contracts/builder_contract.md` with finalised file block format and plan format
    +    +
    +    +**Exit criteria:**
    +    +- All integration tests pass with mocked agent responses
    +    +- A real build (manual test) successfully creates a GitHub repo, writes files, passes audits, and pushes
    +    +- No crashes on malformed builder output
    +    +- Phase timeout triggers correctly
    +    +- Git push failures are handled gracefully
    +    +- Working directories are cleaned up
    +    +- `USER_INSTRUCTIONS.md` is comprehensive and accurate
    +    +- All tests pass (backend + frontend)
    +    +- `run_audit.ps1` passes all checks
    +    diff --git a/Forge/Contracts/physics.yaml b/Forge/Contracts/physics.yaml
    +    index b5337ec..f8e7053 100644
    +    --- a/Forge/Contracts/physics.yaml
    +    +++ b/Forge/Contracts/physics.yaml
    +    @@ -161,6 +161,8 @@ paths:
    +           messages_from_server:
    +             type: "audit_update"
    +             payload: AuditRunSummary
    +    +        type: "file_created"
    +    +        payload: BuildFileEvent
    +     
    +       # -- Projects (Phase 8) -------------------------------------------
    +     
    +    @@ -267,11 +269,16 @@ paths:
    +         post:
    +           summary: "Start a build (validates contracts exist, spawns builder)"
    +           auth: bearer
    +    +      request:
    +    +        target_type: string (required, enum: github_new, github_existing, local_path)
    +    +        target_ref: string (required, repo name / full_name / absolute path)
    +           response:
    +             id: uuid
    +             project_id: uuid
    +             phase: string
    +             status: string
    +    +        target_type: string
    +    +        target_ref: string
    +             started_at: datetime
    +             created_at: datetime
    +     
    +    @@ -298,6 +305,23 @@ paths:
    +             error_detail: string | null
    +             created_at: datetime
    +     
    +    +  /projects/{project_id}/build/files:
    +    +    get:
    +    +      summary: "List all files written during the build"
    +    +      auth: bearer
    +    +      response:
    +    +        items: BuildFile[]
    +    +
    +    +  /projects/{project_id}/build/files/{path}:
    +    +    get:
    +    +      summary: "Retrieve content of a specific file written during the build"
    +    +      auth: bearer
    +    +      response:
    +    +        path: string
    +    +        content: string
    +    +        size_bytes: integer
    +    +        language: string
    +    +
    +       /projects/{project_id}/build/logs:
    +         get:
    +           summary: "Paginated build logs"
    +    @@ -422,12 +446,20 @@ schemas:
    +         message: string
    +         created_at: datetime
    +     
    +    +  BuildFile:
    +    +    path: string
    +    +    size_bytes: integer
    +    +    language: string
    +    +    created_at: datetime
    +    +
    +       BuildStatus:
    +         id: uuid
    +         project_id: uuid
    +         phase: string
    +         status: string
    +         loop_count: integer
    +    +    target_type: string | null
    +    +    target_ref: string | null
    +         started_at: datetime | null
    +         completed_at: datetime | null
    +         error_detail: string | null
    +    diff --git a/Forge/Contracts/schema.md b/Forge/Contracts/schema.md
    +    index e68e84e..6871701 100644
    +    --- a/Forge/Contracts/schema.md
    +    +++ b/Forge/Contracts/schema.md
    +    @@ -183,6 +183,9 @@ CREATE TABLE builds (
    +         project_id      UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
    +         phase           VARCHAR(100) NOT NULL DEFAULT 'Phase 0',
    +         status          VARCHAR(20) NOT NULL DEFAULT 'pending',
    +    +    target_type     VARCHAR(20),
    +    +    target_ref      TEXT,
    +    +    working_dir     TEXT,
    +         started_at      TIMESTAMPTZ,
    +         completed_at    TIMESTAMPTZ,
    +         loop_count      INTEGER NOT NULL DEFAULT 0,
    +    @@ -192,6 +195,7 @@ CREATE TABLE builds (
    +     ```
    +     
    +     `status` values: `pending`, `running`, `completed`, `failed`, `cancelled`
    +    +`target_type` values: `github_new`, `github_existing`, `local_path`, `null` (legacy builds)
    +     
    +     ```sql
    +     CREATE INDEX idx_builds_project_id ON builds(project_id);
    +    @@ -275,4 +279,8 @@ db/migrations/
    +       002_projects.sql
    +       003_builds.sql
    +       004_build_costs.sql
    +    +  005_questionnaire_state.sql
    +    +  006_user_api_key.sql
    +    +  007_audit_llm_toggle.sql
    +    +  008_build_targets.sql
    +     ```
         diff --git a/Forge/evidence/audit_ledger.md b/Forge/evidence/audit_ledger.md
    -    index 5a3369d..7ec1b27 100644
    +    index 8732f2e..da18693 100644
         --- a/Forge/evidence/audit_ledger.md
         +++ b/Forge/evidence/audit_ledger.md
    -    @@ -3399,3 +3399,34 @@ Outcome: FAIL
    -     W1: PASS -- No secret patterns detected.
    +    @@ -3779,3 +3779,60 @@ Outcome: SIGNED-OFF (awaiting AUTHORIZED)
    +     W1: WARN -- Potential secrets found: sk-
          W2: PASS -- audit_ledger.md exists and is non-empty.
          W3: PASS -- All physics paths have corresponding handler files.
         +
         +---
    -    +## Audit Entry: unknown -- Iteration 74
    -    +Timestamp: 2026-02-15T16:18:59Z
    -    +AEM Cycle: unknown
    +    +## Audit Entry: Phase 12 -- - Build Target & File Writing: builder writes real files to a chosen target -- Iteration 81
    +    +Timestamp: 2026-02-15T19:26:20Z
    +    +AEM Cycle: Phase 12 -- - Build Target & File Writing: builder writes real files to a chosen target
         +Outcome: FAIL
         +
         +### Checklist
    -    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/builds.py, app/repos/build_repo.py, app/services/build_service.py, Forge/Contracts/builder_contract.md, Forge/Contracts/phases.md, Forge/Contracts/physics.yaml, Forge/Contracts/schema.md, Forge/evidence/updatedifflog.md, tests/test_build_repo.py, tests/test_build_service.py, tests/test_builds_router.py, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx. Claimed but not in diff: _write_file_block, app/api/routers/builds.py (StartBuildRequest, app/clients/git_client.py (NEW), app/repos/build_repo.py (target params, app/services/build_service.py (file parsing, BuildFile schema), db/migrations/008_build_targets.sql (NEW), detection), file endpoints, file endpoints), file_created WS handler), Forge/Contracts/builder_contract.md (Ôö¼┬║0.1 file block output format), Forge/Contracts/phases.md (Phases 12-15 appended), Forge/Contracts/physics.yaml (build target params, Forge/Contracts/schema.md (builds table target columns, get_build_file_logs), git ops), migration 008), target create), target handling, tests/test_build_repo.py (new tests for file logs, tests/test_build_service.py (new tests for file parsing, tests/test_builds_router.py (new tests for target params, tests/test_git_client.py (NEW), web/src/__tests__/BuildTargetModal.test.tsx (NEW), web/src/components/BuildTargetModal.tsx (NEW), web/src/pages/BuildProgress.tsx (file tree panel, web/src/pages/ProjectDetail.tsx (target picker integration), writing.
         +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
         +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
         +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    -    +- A5 Diff Log Gate:         FAIL -- updatedifflog.md contains TODO: placeholders.
    +    +- A5 Diff Log Gate:         PASS -- No TODO: placeholders in updatedifflog.md.
         +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    -    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    +    +- A7 Verification order:    FAIL -- Missing verification keywords: Static, Runtime, Behavior, Contract.
         +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
         +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
         +
         +### Fix Plan (FAIL items)
    -    +- A1: FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    -    +- A5: FAIL -- updatedifflog.md contains TODO: placeholders.
    +    +- A1: FAIL -- Unclaimed in diff: app/api/routers/builds.py, app/repos/build_repo.py, app/services/build_service.py, Forge/Contracts/builder_contract.md, Forge/Contracts/phases.md, Forge/Contracts/physics.yaml, Forge/Contracts/schema.md, Forge/evidence/updatedifflog.md, tests/test_build_repo.py, tests/test_build_service.py, tests/test_builds_router.py, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx. Claimed but not in diff: _write_file_block, app/api/routers/builds.py (StartBuildRequest, app/clients/git_client.py (NEW), app/repos/build_repo.py (target params, app/services/build_service.py (file parsing, BuildFile schema), db/migrations/008_build_targets.sql (NEW), detection), file endpoints, file endpoints), file_created WS handler), Forge/Contracts/builder_contract.md (Ôö¼┬║0.1 file block output format), Forge/Contracts/phases.md (Phases 12-15 appended), Forge/Contracts/physics.yaml (build target params, Forge/Contracts/schema.md (builds table target columns, get_build_file_logs), git ops), migration 008), target create), target handling, tests/test_build_repo.py (new tests for file logs, tests/test_build_service.py (new tests for file parsing, tests/test_builds_router.py (new tests for target params, tests/test_git_client.py (NEW), web/src/__tests__/BuildTargetModal.test.tsx (NEW), web/src/components/BuildTargetModal.tsx (NEW), web/src/pages/BuildProgress.tsx (file tree panel, web/src/pages/ProjectDetail.tsx (target picker integration), writing.
    +    +- A7: FAIL -- Missing verification keywords: Static, Runtime, Behavior, Contract.
         +
         +### Files Changed
    -    +- Forge/evidence/test_runs_latest.md
    -    +- Forge/scripts/run_audit.ps1
    -    +- web/src/components/QuestionnaireModal.tsx
    +    +- _write_file_block
    +    +- app/api/routers/builds.py (StartBuildRequest
    +    +- app/clients/git_client.py (NEW)
    +    +- app/repos/build_repo.py (target params
    +    +- app/services/build_service.py (file parsing
    +    +- BuildFile schema)
    +    +- db/migrations/008_build_targets.sql (NEW)
    +    +- detection)
    +    +- file endpoints
    +    +- file endpoints)
    +    +- file_created WS handler)
    +    +- Forge/Contracts/builder_contract.md (Ôö¼┬║0.1 file block output format)
    +    +- Forge/Contracts/phases.md (Phases 12-15 appended)
    +    +- Forge/Contracts/physics.yaml (build target params
    +    +- Forge/Contracts/schema.md (builds table target columns
    +    +- get_build_file_logs)
    +    +- git ops)
    +    +- migration 008)
    +    +- target create)
    +    +- target handling
    +    +- tests/test_build_repo.py (new tests for file logs
    +    +- tests/test_build_service.py (new tests for file parsing
    +    +- tests/test_builds_router.py (new tests for target params
    +    +- tests/test_git_client.py (NEW)
    +    +- web/src/__tests__/BuildTargetModal.test.tsx (NEW)
    +    +- web/src/components/BuildTargetModal.tsx (NEW)
    +    +- web/src/pages/BuildProgress.tsx (file tree panel
    +    +- web/src/pages/ProjectDetail.tsx (target picker integration)
    +    +- writing
         +
         +### Notes
    -    +W1: WARN -- Potential secrets found: sk-
    +    +W1: WARN -- Potential secrets found: sk-, token=
         +W2: PASS -- audit_ledger.md exists and is non-empty.
         +W3: PASS -- All physics paths have corresponding handler files.
    -    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    -    index 84a13ac..ad6bd57 100644
    -    --- a/Forge/evidence/test_runs_latest.md
    -    +++ b/Forge/evidence/test_runs_latest.md
    -    @@ -1,19 +1,17 @@
    -     ┬┤ÔòùÔöÉStatus: PASS
    -    -Start: 2026-02-15T04:40:00Z
    -    -End: 2026-02-15T04:41:00Z
    -    +Start: 2026-02-15T16:20:00Z
    -    +End: 2026-02-15T16:21:00Z
    -     Branch: master
    -    -HEAD: post-phase-enhancement
    -    +HEAD: 3a575f8
    -     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    -     compileall exit: 0
    -     import_sanity exit: 0
    -     
    -     ## Backend (pytest)
    -    -- 219 passed, 0 failed, 1 warning
    -    -- Duration: 12.58s
    -    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    -    +- 240 passed, 0 failed, 1 warning
    -    +- Duration: 13.60s
    -     
    -     ## Frontend (vitest)
    -    -- 39 passed, 0 failed
    -    -- Duration: 2.17s
    -    -- New tests: CreateProjectModal (4)
    -    +- 49 passed, 0 failed
    -    +- Duration: 2.59s
    -     
         diff --git a/Forge/evidence/updatedifflog.md b/Forge/evidence/updatedifflog.md
    -    index 5d019da..fd8648e 100644
    +    index a9722d8..53c0f18 100644
         --- a/Forge/evidence/updatedifflog.md
         +++ b/Forge/evidence/updatedifflog.md
    -    @@ -1,46 +1,3253 @@
    -    -┬┤ÔòùÔöÉ# Diff Log (overwrite each cycle)
    -    +# Diff Log (overwrite each cycle)
    +    @@ -1,3723 +1,8460 @@
    +    -# Diff Log (overwrite each cycle)
    +    +┬┤ÔòùÔöÉ# Diff Log (overwrite each cycle)
          
          ## Cycle Metadata
    -    -- Timestamp: 2026-02-15T04:42:00+00:00
    -    +- Timestamp: 2026-02-15T16:19:58+00:00
    +    -- Timestamp: 2026-02-15T18:16:39+00:00
    +    +- Timestamp: 2026-02-15T19:26:28+00:00
          - Branch: master
    -    -- HEAD: pending
    -    -- BASE_HEAD: 63d92ee
    -    -- Diff basis: post-phase enhancement (commit backfill + create project)
    -    +- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    -    +- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    -    +- Diff basis: staged
    +    -- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    +    -- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    +    +- HEAD: ceb988f83e66f094035eb31168aed612e537a451
    +    +- BASE_HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    +     - Diff basis: staged
          
          ## Cycle Status
          - Status: COMPLETE
          
          ## Summary
    -    -- Added offline commit backfill: `list_commits()` GitHub client, `get_existing_commit_shas()` repo layer, `backfill_repo_commits()` service, `POST /repos/{id}/sync` endpoint
    -    -- Added "Create Project" button + modal on Dashboard with name/description form
    -    -- Added "Sync Commits" button on CommitTimeline page to trigger backfill
    -    -- 15 new tests: 5 audit service, 3 GitHub client, 3 repos router sync, 4 frontend CreateProjectModal
    -    -
    -    -## Files Changed
    -    -- app/clients/github_client.py (added list_commits)
    -    -- app/repos/audit_repo.py (added get_existing_commit_shas)
    -    -- app/services/audit_service.py (added backfill_repo_commits)
    -    -- app/api/routers/repos.py (added POST sync endpoint)
    -    -- web/src/components/CreateProjectModal.tsx (new)
    -    -- web/src/pages/Dashboard.tsx (added Create Project button + modal)
    -    -- web/src/pages/CommitTimeline.tsx (added Sync Commits button)
    -    -- tests/test_audit_service.py (new, 5 tests)
    -    -- tests/test_github_client.py (new, 3 tests)
    -    -- tests/test_repos_router.py (added 3 sync tests)
    -    -- web/src/__tests__/App.test.tsx (added 4 CreateProjectModal tests)
    -    +- Fixed mic reconnection bug in QuestionnaireModal: reuse single SpeechRecognition instance across toggle cycles instead of creating new ones (browsers throttle new instances outside original gesture context)
    -    +- Fixed run_audit.ps1 .Count error: wrapped pipeline result in @() to ensure array type when single file is claimed
    -    +- Updated test_runs_latest.md with current pass counts (240 backend, 49 frontend)
    -    +- Multi-feature batch: questionnaire modal, LLM multi-provider, project remove, build system, settings page, contract progress
    -    +
    -    +## Files Changed (staged)
    -    +- Forge/evidence/audit_ledger.md
    -     - Forge/evidence/test_runs_latest.md
    +    -- Removed phase_breakdown from questionnaire (7 sections),Added build/phases endpoint parsing phases contract,Enhanced build WS events with token data in phase_complete and build_complete,Rewrote BuildProgress.tsx with two-column layout: phase checklist + metrics + activity feed
    +    +- Phase 12 -- Build Target & File Writing: builder writes real files to a chosen target
    +    +- Add build target selection (github_new, github_existing, local_path) to POST /build
    +    +- Create git_client.py for clone/add/commit/push operations
    +    +- Parse file blocks from builder output and write to disk in real time
    +    +- Create BuildTargetModal component and file tree panel for BuildProgress UI
    +     
    +     ## Files Changed (staged)
    +    +- Forge/Contracts/builder_contract.md
    +    +- Forge/Contracts/phases.md
    +    +- Forge/Contracts/physics.yaml
    +    +- Forge/Contracts/schema.md
    +     - Forge/evidence/audit_ledger.md
    +    -- Forge/evidence/test_runs_latest.md
          - Forge/evidence/updatedifflog.md
    -    +- Forge/scripts/run_audit.ps1
    -    +- USER_INSTRUCTIONS.md
    -    +- app/api/routers/auth.py
    -    +- app/api/routers/projects.py
    -    +- app/clients/llm_client.py
    -    +- app/config.py
    -    +- app/repos/audit_repo.py
    -    +- app/repos/user_repo.py
    -    +- app/services/audit_service.py
    -    +- app/services/build_service.py
    -    +- app/services/project_service.py
    -    +- db/migrations/006_user_api_key.sql
    -    +- tests/test_audit_service.py
    -    +- tests/test_auth_router.py
    -    +- tests/test_build_service.py
    -    +- tests/test_llm_client.py
    -    +- tests/test_project_service.py
    -    +- tests/test_projects_router.py
    -    +- web/src/App.tsx
    -    +- web/src/__tests__/App.test.tsx
    -    +- web/src/components/AppShell.tsx
    -    +- web/src/components/ContractProgress.tsx
    -    +- web/src/components/QuestionnaireModal.tsx
    -    +- web/src/context/AuthContext.tsx
    -    +- web/src/pages/BuildComplete.tsx
    -    +- web/src/pages/BuildProgress.tsx
    -    +- web/src/pages/ProjectDetail.tsx
    -    +- web/src/pages/Settings.tsx
    -    +- web/vite.config.ts
    -    +
    -    +## git status -sb
    -    +    ## master...origin/master [ahead 2]
    +    -- Forge/scripts/run_audit.ps1
    +    -- USER_INSTRUCTIONS.md
    +    -- app/api/routers/auth.py
    +     - app/api/routers/builds.py
    +    -- app/api/routers/projects.py
    +    -- app/clients/llm_client.py
    +    -- app/config.py
    +    -- app/repos/audit_repo.py
    +    -- app/repos/user_repo.py
    +    -- app/services/audit_service.py
    +    +- app/clients/git_client.py
    +    +- app/repos/build_repo.py
    +     - app/services/build_service.py
    +    -- app/services/project_service.py
    +    -- db/migrations/006_user_api_key.sql
    +    -- tests/test_audit_service.py
    +    -- tests/test_auth_router.py
    +    +- db/migrations/008_build_targets.sql
    +    +- tests/test_build_repo.py
    +     - tests/test_build_service.py
    +    -- tests/test_llm_client.py
    +    -- tests/test_project_service.py
    +    -- tests/test_projects_router.py
    +    -- web/src/App.tsx
    +    -- web/src/__tests__/App.test.tsx
    +    -- web/src/__tests__/Build.test.tsx
    +    -- web/src/components/AppShell.tsx
    +    -- web/src/components/ContractProgress.tsx
    +    -- web/src/components/QuestionnaireModal.tsx
    +    -- web/src/context/AuthContext.tsx
    +    -- web/src/pages/BuildComplete.tsx
    +    +- tests/test_builds_router.py
    +    +- tests/test_git_client.py
    +    +- web/src/__tests__/BuildTargetModal.test.tsx
    +    +- web/src/components/BuildTargetModal.tsx
    +     - web/src/pages/BuildProgress.tsx
    +     - web/src/pages/ProjectDetail.tsx
    +    -- web/src/pages/Settings.tsx
    +    -- web/vite.config.ts
    +     
    +     ## git status -sb
    +    -    ## master...origin/master [ahead 2]
    +    -    MM Forge/evidence/audit_ledger.md
    +    -    M  Forge/evidence/test_runs_latest.md
    +    -    MM Forge/evidence/updatedifflog.md
    +    -    M  Forge/scripts/run_audit.ps1
    +    -    M  USER_INSTRUCTIONS.md
    +    -    M  app/api/routers/auth.py
    +    +    ## master...origin/master [ahead 3]
    +    +    M  Forge/Contracts/builder_contract.md
    +    +    M  Forge/Contracts/phases.md
    +    +    M  Forge/Contracts/physics.yaml
    +    +    M  Forge/Contracts/schema.md
         +    M  Forge/evidence/audit_ledger.md
    -    +    M  Forge/evidence/test_runs_latest.md
         +    M  Forge/evidence/updatedifflog.md
    -    +    M  Forge/scripts/run_audit.ps1
    -    +    M  USER_INSTRUCTIONS.md
    -    +    M  app/api/routers/auth.py
    -    +    M  app/api/routers/projects.py
    -    +    M  app/clients/llm_client.py
    -    +    M  app/config.py
    -    +    M  app/repos/audit_repo.py
    -    +    M  app/repos/user_repo.py
    -    +    M  app/services/audit_service.py
    -    +    M  app/services/build_service.py
    -    +    M  app/services/project_service.py
    -    +    A  db/migrations/006_user_api_key.sql
    -    +    M  tests/test_audit_service.py
    -    +    M  tests/test_auth_router.py
    -    +    M  tests/test_build_service.py
    -    +    M  tests/test_llm_client.py
    -    +    M  tests/test_project_service.py
    -    +    M  tests/test_projects_router.py
    -    +    M  web/src/App.tsx
    -    +    M  web/src/__tests__/App.test.tsx
    -    +    M  web/src/components/AppShell.tsx
    -    +    A  web/src/components/ContractProgress.tsx
    -    +    M  web/src/components/QuestionnaireModal.tsx
    -    +    M  web/src/context/AuthContext.tsx
    -    +    M  web/src/pages/BuildComplete.tsx
    -    +    M  web/src/pages/BuildProgress.tsx
    +         M  app/api/routers/builds.py
    +    -    M  app/api/routers/projects.py
    +    -    M  app/clients/llm_client.py
    +    -    M  app/config.py
    +    -    M  app/repos/audit_repo.py
    +    -    M  app/repos/user_repo.py
    +    -    M  app/services/audit_service.py
    +    +    A  app/clients/git_client.py
    +    +    M  app/repos/build_repo.py
    +         M  app/services/build_service.py
    +    -    M  app/services/project_service.py
    +    -    A  db/migrations/006_user_api_key.sql
    +    -    M  tests/test_audit_service.py
    +    -    M  tests/test_auth_router.py
    +    +    A  db/migrations/008_build_targets.sql
    +    +    M  tests/test_build_repo.py
    +         M  tests/test_build_service.py
    +    -    M  tests/test_llm_client.py
    +    -    MM tests/test_project_service.py
    +    -    MM tests/test_projects_router.py
    +    -    MM web/src/App.tsx
    +    -    MM web/src/__tests__/App.test.tsx
    +    -    M  web/src/__tests__/Build.test.tsx
    +    -    M  web/src/components/AppShell.tsx
    +    -    AM web/src/components/ContractProgress.tsx
    +    -    M  web/src/components/QuestionnaireModal.tsx
    +    -    MM web/src/context/AuthContext.tsx
    +    -    M  web/src/pages/BuildComplete.tsx
    +    +    M  tests/test_builds_router.py
    +    +    A  tests/test_git_client.py
    +    +    A  web/src/__tests__/BuildTargetModal.test.tsx
    +    +    A  web/src/components/BuildTargetModal.tsx
    +         M  web/src/pages/BuildProgress.tsx
    +    -    MM web/src/pages/ProjectDetail.tsx
    +    -    A  web/src/pages/Settings.tsx
    +    -    M  web/vite.config.ts
         +    M  web/src/pages/ProjectDetail.tsx
    -    +    A  web/src/pages/Settings.tsx
    -    +    M  web/vite.config.ts
          
          ## Verification
    -     - Static: all files compile (compileall + tsc pass)
    -    -- Runtime: 219 pytest + 39 vitest = 258 tests pass (was 243)
    -    -- Behavior: backfill syncs missing commits, Create Project modal submits to backend
    -    -- Contract: no phase contract changes needed (post-phase enhancement)
    -    +- Runtime: 240 pytest + 49 vitest = 289 tests pass
    -    +- Behavior: mic stays active across toggle cycles, audit script handles single-file claims
    -    +- Contract: no boundary violations (A4 PASS)
    +    -- Static: pylance 0 errors on all changed files,Runtime: boot.ps1 runs without errors,Behavior: vitest 49/49 pass,Contract: phases contract parsing matches schema.md phase structure
    +    +- Static: All Python files pass pylance/mypy; TypeScript compiles without errors
    +    +- Runtime: 281 backend tests pass (pytest tests/ --tb=short -q); 0 failures
    +    +- Behavior: 61 frontend tests pass (npx vitest run); 3 test files; 0 failures
    +    +- Contract: physics.yaml updated before implementation; schema.md includes migration 008
          
          ## Notes (optional)
    -    -- Backfill fetches up to 300 recent commits (3 pages Ôö£├╣ 100) per sync
    -    -- Backfill continues processing if individual commits error (graceful degradation)
    -    +- No blockers or risks identified
    +    -- PhaseProgressBar/BuildLogViewer still exist but no longer used by BuildProgress
    +    +- W1 secret warnings are false positives (test fixtures with sk- prefixes, token= in git URL handling)
          
          ## Next Steps
    -    -- Features ready for manual QA with live GitHub repos
    -    +- Test full questionnaire flow end-to-end with live Anthropic API
    -    +
    -    +## Minimal Diff Hunks
    -    +    diff --git a/Forge/evidence/audit_ledger.md b/Forge/evidence/audit_ledger.md
    -    +    index 5a3369d..7ec1b27 100644
    -    +    --- a/Forge/evidence/audit_ledger.md
    -    +    +++ b/Forge/evidence/audit_ledger.md
    -    +    @@ -3399,3 +3399,34 @@ Outcome: FAIL
    -    +     W1: PASS -- No secret patterns detected.
    -    +     W2: PASS -- audit_ledger.md exists and is non-empty.
    -    +     W3: PASS -- All physics paths have corresponding handler files.
    +    -- Watcher sign-off
    +    +- Phase 13: Multi-Turn Builder & Structured Build Plan
    +    +- Phase 14: Build Pause, Resume & User Interjection
    +     
    +     ## Minimal Diff Hunks
    +    +    diff --git a/Forge/Contracts/builder_contract.md b/Forge/Contracts/builder_contract.md
    +    +    index 2b43966..85cd9c1 100644
    +    +    --- a/Forge/Contracts/builder_contract.md
    +    +    +++ b/Forge/Contracts/builder_contract.md
    +    +    @@ -35,6 +35,26 @@ ProjectRoot/              Ôö£├ÂÔö£├æÔö£├½ git root, builder's working directory
    +    +     - `forge.json` lives at the project root.
    +    +     - The `Forge/` folder may be deleted after the project build is complete. No project code may import from or depend on files inside `Forge/`.
    +    +     
    +    +    +### 0.1) File block output format (mandatory for autonomous builds)
    +    +    +
    +    +    +When the builder is operating as a ForgeGuard autonomous build agent (not a human-interactive session), all file creation MUST use the following canonical format so the orchestrator can parse and write files to disk:
    +    +    +
    +    +    +```
    +    +    +=== FILE: path/to/file.py ===
    +    +    +```python
    +    +    +<file contents>
    +    +    +```
    +    +    +=== END FILE ===
    +    +    +```
    +    +    +
    +    +    +**Rules:**
    +    +    +- The path after `FILE:` is relative to the project root (e.g., `app/main.py`, `tests/test_health.py`).
    +    +    +- One file per block. Multiple files = multiple blocks.
    +    +    +- The code fence inside the block (` ```lang `) is optional but recommended for readability.
    +    +    +- If updating an existing file, emit the full file content (the orchestrator overwrites).
    +    +    +- Do NOT emit partial files or diffs -- always emit the complete file.
    +    +    +- The `=== END FILE ===` delimiter MUST appear on its own line after the file content.
    +    +    +
    +    +     ---
    +    +     
    +    +     ## 1) Contract read gate (mandatory)
    +    +    diff --git a/Forge/Contracts/phases.md b/Forge/Contracts/phases.md
    +    +    index f5bfde5..e9c0542 100644
    +    +    --- a/Forge/Contracts/phases.md
    +    +    +++ b/Forge/Contracts/phases.md
    +    +    @@ -385,3 +385,279 @@ Canonical phase plan. Each phase is self-contained, shippable, and auditable. Th
    +    +     - `USER_INSTRUCTIONS.md` covers the full project creation and build workflow
    +    +     - All tests pass
    +    +     - `run_audit.ps1` passes all checks
    +    +    +
    +    +    +---
    +    +    +
    +    +    +## Phase 12 -- Build Target & File Writing
    +    +    +
    +    +    +**Objective:** The builder actually writes files. Users choose a build target -- a new GitHub repo, an existing GitHub repo, or a local file path -- and the builder's output is parsed into discrete files and written to that target in real time. This replaces the current "stream text only" behaviour.
    +    +    +
    +    +    +**Background:** Currently the builder streams its entire output as raw text chunks. No files are created anywhere. The user's intention was always that builds produce real, usable code in a real repository or directory.
    +    +    +
    +    +    +**Deliverables:**
    +    +    +
    +    +    +- **Build target selection** (backend + frontend):
    +    +    +  - `build_target_type` enum: `github_new`, `github_existing`, `local_path`
    +    +    +  - `POST /projects/{id}/build` extended: accepts `target_type` and `target_ref` (repo name for new, repo full_name for existing, absolute path for local)
    +    +    +  - For `github_new`: call GitHub API to create an empty repo under the user's account, clone it locally to a temp working directory
    +    +    +  - For `github_existing`: clone the repo to a temp working directory (shallow clone, default branch)
    +    +    +  - For `local_path`: validate the path exists (or create it), use directly as the working directory
    +    +    +  - Store target info on the `builds` table: `target_type`, `target_ref`, `working_dir`
    +    +    +
    +    +    +- **DB migration 008** -- `build_targets`:
    +    +    +  - Add columns to `builds`: `target_type VARCHAR(20)`, `target_ref TEXT`, `working_dir TEXT`
    +    +    +
    +    +    +- **File parser in build_service.py**:
    +    +    +  - Builder directive updated to instruct the LLM to emit file blocks in a canonical format:
    +    +    +    ```
    +    +    +    === FILE: path/to/file.py ===
    +    +    +    ```python
    +    +    +    <file contents>
    +    +    +    ```
    +    +    +    === END FILE ===
    +    +    +    ```
    +    +    +  - `_parse_file_blocks(accumulated_text)` -- extracts file path + content from builder output
    +    +    +  - When a file block is detected:
    +    +    +    1. Write the file to the working directory on disk
    +    +    +    2. Emit `file_created` WS event with `{ path, size_bytes, language }`
    +    +    +    3. Log the file write to build_logs
    +    +    +  - Handle file updates (same path written twice = overwrite with latest)
    +    +    +
    +    +    +- **Git operations** (for GitHub targets):
    +    +    +  - After each phase completes audit, stage + commit all new/modified files with message `"forge: Phase N complete"`
    +    +    +  - After build completes, push all commits to the remote
    +    +    +  - `app/clients/git_client.py` -- thin wrapper around `asyncio.subprocess` for git clone, add, commit, push (no heavy git library dependency)
    +    +    +
    +    +    +- **Frontend: Build target picker** (shown before build starts):
    +    +    +  - Three-option card selector: "New GitHub Repo" / "Existing GitHub Repo" / "Local Directory"
    +    +    +  - For new repo: text input for repo name (validated against GitHub naming rules)
    +    +    +  - For existing repo: repo picker modal (reuse existing component)
    +    +    +  - For local: text input for absolute path with validation
    +    +    +  - Selected target stored in build state and sent with `POST /projects/{id}/build`
    +    +    +
    +    +    +- **Frontend: File tree panel** on BuildProgress page:
    +    +    +  - New collapsible panel (left column, below phase checklist) showing files created so far
    +    +    +  - Tree structure mirroring directory hierarchy
    +    +    +  - Each file shows: path, size, language icon
    +    +    +  - Updates in real-time via `file_created` WS events
    +    +    +  - Click a file to expand and see a syntax-highlighted preview of its content (read from build logs or a dedicated endpoint)
    +    +    +
    +    +    +- **API for file retrieval**:
    +    +    +  - `GET /projects/{id}/build/files` -- list all files written during the build
    +    +    +  - `GET /projects/{id}/build/files/{path}` -- retrieve content of a specific file
    +    +    +
    +    +    +**Schema coverage:**
    +    +    +- [x] builds (extended with target columns)
    +    +    +- [x] build_logs (Phase 9)
    +    +    +- [ ] No new tables -- file metadata derived from build_logs + filesystem
    +    +    +
    +    +    +**Exit criteria:**
    +    +    +- User can select "New GitHub Repo" and the build creates the repo + writes files into it
    +    +    +- User can select "Existing GitHub Repo" and the build writes files into the cloned repo
    +    +    +- User can select "Local Directory" and files are written to that path
    +    +    +- Files appear in the file tree panel in real-time as the builder creates them
    +    +    +- After each phase audit pass, files are committed with a phase-specific message
    +    +    +- After build completion (GitHub targets), all commits are pushed to the remote
    +    +    +- File content is retrievable via API
    +    +    +- All existing tests still pass + new tests for file parsing, git operations, and target selection
    +    +    +- `run_audit.ps1` passes all checks
    +    +    +
    +    +    +---
    +    +    +
    +    +    +## Phase 13 -- Multi-Turn Builder & Structured Build Plan
    +    +    +
    +    +    +**Objective:** Convert the builder from a single streaming call to a multi-turn conversation. The builder emits a structured plan at the start, and after audit failures the audit feedback is injected back into the conversation so the builder can self-correct. This gives the builder full context of what it's already done, what failed, and why.
    +    +    +
    +    +    +**Background:** Currently `_run_build()` creates `messages = [{"role":"user","content": directive}]` and makes one `stream_agent()` call. The audit runs but its feedback is never sent back to the builder. The builder has no ability to self-correct -- it just gets a loop count incremented and the build eventually fails. Real builds took ~7 iterations because the diff log retained TODO placeholders that the auditor kept flagging.
    +    +    +
    +    +    +**Deliverables:**
    +    +    +
    +    +    +- **Structured build plan emission**:
    +    +    +  - Update builder directive (system prompt / builder_contract.md) to instruct the LLM:
    +    +    +    > Before writing any code, emit a `=== BUILD PLAN ===` block listing all tasks you will perform, grouped by phase. Each task should be a single line: `- [ ] Task description`. End the plan with `=== END BUILD PLAN ===`.
    +    +    +  - `_parse_build_plan(text)` in build_service.py -- extracts task list from the plan block
    +    +    +  - Emit `build_plan` WS event: `{ tasks: [{ id, description, phase, status }] }`
    +    +    +  - As the builder works, detect task completion signals (`=== TASK DONE: <id> ===`) and emit `task_complete` WS events
    +    +    +  - Frontend: Build Plan checklist panel in BuildProgress (right column, above activity feed), showing all tasks with check/pending/fail icons, updating in real-time
    +    +    +
    +    +    +- **Multi-turn conversation loop**:
    +    +    +  - Replace single `stream_agent()` call with a conversation loop:
    +    +    +    ```
    +    +    +    messages = [{"role": "user", "content": directive}]
    +    +    +    while not build_complete:
    +    +    +        async for chunk in stream_agent(..., messages=messages):
    +    +    +            # accumulate, parse files, detect signals
    +    +    +        messages.append({"role": "assistant", "content": accumulated_text})
    +    +    +        
    +    +    +        if phase_complete_detected:
    +    +    +            audit_result = await _run_inline_audit(...)
    +    +    +            if audit_result == "PASS":
    +    +    +                # continue to next phase
    +    +    +                messages.append({"role": "user", "content": f"Audit PASSED for {phase}. Proceed to the next phase."})
    +    +    +            else:
    +    +    +                # loopback with audit feedback
    +    +    +                messages.append({"role": "user", "content": f"Audit FAILED for {phase}.\n\nAudit feedback:\n{audit_detail}\n\nFix the issues identified above and re-submit {phase}."})
    +    +    +    ```
    +    +    +  - The conversation grows with each turn -- the builder sees everything it's already produced + audit results
    +    +    +  - No separate database table for "state" -- the conversation history IS the state
    +    +    +
    +    +    +- **Audit feedback forwarding**:
    +    +    +  - `_run_inline_audit()` updated to return audit detail (not just PASS/FAIL) -- the full auditor response including specific findings
    +    +    +  - Return type changes from `str` to `AuditResult` dataclass: `{ verdict: str, detail: str, findings: list[str] }`
    +    +    +  - On FAIL: the audit detail is appended to messages so the builder knows exactly what to fix
    +    +    +  - Emit `audit_fail` WS event extended with `{ findings: [...] }` so the frontend can show what failed
    +    +    +
    +    +    +- **Context window management**:
    +    +    +  - Track total conversation tokens (input + output across turns)
    +    +    +  - If conversation approaches model context limit (200K for Opus), truncate earlier turns while preserving: (1) original directive, (2) last 2 turns, (3) all audit feedback messages
    +    +    +  - `_compact_messages(messages, max_tokens)` helper for intelligent truncation
    +    +    +  - Log a warning when compaction occurs
    +    +    +
    +    +    +- **Builder directive updates**:
    +    +    +  - Update `Forge/Contracts/builder_contract.md` with file block format instructions
    +    +    +  - Add task signal format to builder_directive template
    +    +    +  - Instruct builder to emit `=== PHASE SIGN-OFF: PASS ===` only after ALL tasks for a phase are complete and the code is ready for audit
    +    +    +
    +    +    +**Schema coverage:**
    +    +    +- No new tables -- conversation state is in-memory during build execution
    +    +    +
    +    +    +**Exit criteria:**
    +    +    +- Builder emits a structured plan at the start of the build
    +    +    +- Plan tasks are shown in the UI and checked off as they're completed
    +    +    +- After an audit failure, the audit feedback is sent back to the builder as a new conversation turn
    +    +    +- The builder successfully self-corrects based on audit feedback (verifiable in test with mocked responses)
    +    +    +- Conversation history grows across turns with full context preservation
    +    +    +- Context compaction triggers when approaching model limits (tested with mocked large conversations)
    +    +    +- All existing tests still pass + new tests for plan parsing, multi-turn loop, audit feedback injection, context compaction
    +    +    +- `run_audit.ps1` passes all checks
         +    +
         +    +---
    -    +    +## Audit Entry: unknown -- Iteration 74
    -    +    +Timestamp: 2026-02-15T16:18:59Z
    -    +    +AEM Cycle: unknown
    -    +    +Outcome: FAIL
    -    +    +
    -    +    +### Checklist
    -    +    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    -    +    +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    -    +    +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    -    +    +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    -    +    +- A5 Diff Log Gate:         FAIL -- updatedifflog.md contains TODO: placeholders.
    -    +    +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    -    +    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    -    +    +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    -    +    +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    -    +    +
    -    +    +### Fix Plan (FAIL items)
    -    +    +- A1: FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    -    +    +- A5: FAIL -- updatedifflog.md contains TODO: placeholders.
    -    +    +
    -    +    +### Files Changed
    -    +    +- Forge/evidence/test_runs_latest.md
    -    +    +- Forge/scripts/run_audit.ps1
    -    +    +- web/src/components/QuestionnaireModal.tsx
    -    +    +
    -    +    +### Notes
    -    +    +W1: WARN -- Potential secrets found: sk-
    -    +    +W2: PASS -- audit_ledger.md exists and is non-empty.
    -    +    +W3: PASS -- All physics paths have corresponding handler files.
    -    +    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    -    +    index 84a13ac..ad6bd57 100644
    -    +    --- a/Forge/evidence/test_runs_latest.md
    -    +    +++ b/Forge/evidence/test_runs_latest.md
    -    +    @@ -1,19 +1,17 @@
    -    +     Ôö¼Ôöñ├ö├▓├╣├ö├Â├ëStatus: PASS
    -    +    -Start: 2026-02-15T04:40:00Z
    -    +    -End: 2026-02-15T04:41:00Z
    -    +    +Start: 2026-02-15T16:20:00Z
    -    +    +End: 2026-02-15T16:21:00Z
    -    +     Branch: master
    -    +    -HEAD: post-phase-enhancement
    -    +    +HEAD: 3a575f8
    -    +     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    -    +     compileall exit: 0
    -    +     import_sanity exit: 0
    +    +    +
    +    +    +## Phase 14 -- Build Pause, Resume & User Interjection
    +    +    +
    +    +    +**Objective:** When the builder hits a configurable failure threshold on a single phase, the build pauses instead of dying. The user sees what went wrong and can choose to: retry (with or without a message to the builder), skip the phase, or abort. The user can also proactively interject at any time during the build to send guidance to the builder.
    +    +    +
    +    +    +**Background:** Currently at `MAX_LOOP_COUNT = 3`, `_fail_build()` fires with "RISK_EXCEEDS_SCOPE" and the build is dead. The user can only start over. With Option D (multi-turn loopback + pause at threshold), the builder auto-corrects for the first N failures (Phase 13). When it still can't pass, it pauses and asks the human for help. The user can also press a button to interject mid-build at any time.
    +    +    +
    +    +    +**Deliverables:**
    +    +    +
    +    +    +- **Build pause mechanism** (backend):
    +    +    +  - New build status: `paused` (joins existing: `pending`, `running`, `completed`, `failed`, `cancelled`)
    +    +    +  - DB migration 009: add `paused_at TIMESTAMPTZ`, `pause_reason TEXT`, `pause_phase TEXT` to `builds` table
    +    +    +  - When `loop_count >= PAUSE_THRESHOLD` (configurable, default 3) on a single phase:
    +    +    +    1. Set build status to `paused` with reason and phase
    +    +    +    2. Emit `build_paused` WS event: `{ phase, loop_count, audit_findings, options: ["retry", "retry_with_message", "skip_phase", "abort"] }`
    +    +    +    3. The background task enters an `asyncio.Event` wait state (does not exit, preserving conversation context in memory)
    +    +    +  - `PAUSE_THRESHOLD` configurable via env var (default 3), replaces the hard `MAX_LOOP_COUNT` constant
    +    +    +
    +    +    +- **Resume endpoints** (backend):
    +    +    +  - `POST /projects/{id}/build/resume` -- resume a paused build
    +    +    +    - Body: `{ "action": "retry" | "skip" | "abort", "message": "optional user message" }`
    +    +    +    - `retry`: append user message (if any) + "Please retry this phase, fixing the issues above." to conversation, set event, builder continues
    +    +    +    - `retry_with_message`: same as retry but user's message is mandatory and is prepended to the retry instruction
    +    +    +    - `skip`: append "Phase skipped by user. Proceed to the next phase." to conversation, advance phase, set event
    +    +    +    - `abort`: call `_fail_build()` with "Build aborted by user at {phase}"
    +    +    +  - The `asyncio.Event` is signalled, the background task wakes up and reads the action
    +    +    +
    +    +    +- **Proactive interjection** (backend):
    +    +    +  - `POST /projects/{id}/build/interject` -- send a message to the builder mid-build (while status is `running`)
    +    +    +    - Body: `{ "message": "user guidance text" }`
    +    +    +    - Sets an interjection flag; at the next natural break point (after current chunk batch), the builder pauses streaming, appends the user message to conversation, and resumes with a new `stream_agent()` call that includes the user's guidance
    +    +    +    - Emit `build_interjection` WS event: `{ message, injected_at }`
    +    +    +  - Interjection queue: if multiple messages sent before the builder reaches a break point, they're concatenated into a single injection
    +    +    +
    +    +    +- **Frontend: Pause UI** on BuildProgress page:
    +    +    +  - When `build_paused` event received, show a modal/overlay:
    +    +    +    - Header: "Build paused Ôö£├ÂÔö£├ºÔö£├é audit failed {loop_count} times on {phase}"
    +    +    +    - Audit findings list (from the last audit failure)
    +    +    +    - Four action buttons:
    +    +    +      - **Retry** -- "Let the builder try again"
    +    +    +      - **Retry with guidance** -- expands a text input where user types a message, then sends `retry_with_message`
    +    +    +      - **Skip phase** -- "Skip this phase and continue" (with warning that skipped phases may cause issues)
    +    +    +      - **Abort build** -- "Stop the build entirely" (with confirmation dialog)
    +    +    +    - The user's typed message is sent as part of the resume request and injected into the builder's conversation
    +    +    +
    +    +    +- **Frontend: Interjection button** on BuildProgress page:
    +    +    +  - Small "Send message to builder" button (or chat input) visible while build is `running`
    +    +    +  - Opens a text input; on submit, calls `POST /projects/{id}/build/interject`
    +    +    +  - Activity feed shows "You: {message}" entry when interjection is sent
    +    +    +  - Activity feed shows "Builder acknowledged interjection" when it's processed
    +    +    +
    +    +    +- **Frontend: Paused state styling**:
    +    +    +  - Build status badge shows "Paused" in amber/yellow
    +    +    +  - Phase checklist shows the paused phase with a pause icon
    +    +    +  - Activity feed shows "Build paused Ôö£├ÂÔö£├ºÔö£├é awaiting user input" entry
    +    +    +
    +    +    +- **Timeout safeguard**:
    +    +    +  - If a build is paused for longer than 30 minutes (configurable via `BUILD_PAUSE_TIMEOUT_MINUTES`), automatically abort with "Build timed out while paused"
    +    +    +  - Background task uses `asyncio.wait_for(event.wait(), timeout=1800)`
    +    +    +
    +    +    +**Schema coverage:**
    +    +    +- [x] builds (extended with pause columns)
    +    +    +
    +    +    +**Exit criteria:**
    +    +    +- Build pauses after 3 audit failures on a single phase instead of dying
    +    +    +- Pause UI shows audit findings and four action options
    +    +    +- "Retry" resumes the build and the builder attempts the phase again
    +    +    +- "Retry with guidance" injects the user's message into the builder's conversation before retrying
    +    +    +- "Skip phase" advances to the next phase
    +    +    +- "Abort" stops the build with a clear status message
    +    +    +- Proactive interjection works mid-build -- user can send guidance at any time
    +    +    +- Interjection message appears in the builder's next conversation turn
    +    +    +- Paused build times out after 30 minutes if no action taken
    +    +    +- Activity feed shows all pause/resume/interjection events
    +    +    +- All existing tests still pass + new tests for pause/resume, interjection, timeout, and all action types
    +    +    +- `run_audit.ps1` passes all checks
    +    +    +
    +    +    +---
    +    +    +
    +    +    +## Phase 15 -- Builder Intelligence Hardening
    +    +    +
    +    +    +**Objective:** End-to-end integration testing and refinement of the multi-turn builder pipeline. Validate that the full flow -- target selection Ôö£├ÂÔö£├æÔö£├Ñ build plan Ôö£├ÂÔö£├æÔö£├Ñ file writing Ôö£├ÂÔö£├æÔö£├Ñ audit Ôö£├ÂÔö£├æÔö£├Ñ self-correction Ôö£├ÂÔö£├æÔö£├Ñ pause/resume Ôö£├ÂÔö£├æÔö£├Ñ push -- works reliably. Harden edge cases, tune prompts, and ensure the builder produces genuinely usable code.
    +    +    +
    +    +    +**Deliverables:**
    +    +    +
    +    +    +- **Integration test suite** (`tests/test_build_integration.py`):
    +    +    +  - Full build lifecycle with mocked agent: target selection Ôö£├ÂÔö£├æÔö£├Ñ plan emission Ôö£├ÂÔö£├æÔö£├Ñ file blocks Ôö£├ÂÔö£├æÔö£├Ñ phase sign-off Ôö£├ÂÔö£├æÔö£├Ñ audit pass Ôö£├ÂÔö£├æÔö£├Ñ next phase Ôö£├ÂÔö£├æÔö£├Ñ completion Ôö£├ÂÔö£├æÔö£├Ñ git push
    +    +    +  - Audit failure Ôö£├ÂÔö£├æÔö£├Ñ self-correction loop (mock agent returns fixed output on second turn)
    +    +    +  - Audit failure Ôö£├ÂÔö£├æÔö£├Ñ pause threshold Ôö£├ÂÔö£├æÔö£├Ñ user retry with message Ôö£├ÂÔö£├æÔö£├Ñ builder succeeds
    +    +    +  - Audit failure Ôö£├ÂÔö£├æÔö£├Ñ pause Ôö£├ÂÔö£├æÔö£├Ñ user skip Ôö£├ÂÔö£├æÔö£├Ñ next phase
    +    +    +  - Audit failure Ôö£├ÂÔö£├æÔö£├Ñ pause Ôö£├ÂÔö£├æÔö£├Ñ user abort
    +    +    +  - Proactive interjection mid-build Ôö£├ÂÔö£├æÔö£├Ñ message appears in conversation Ôö£├ÂÔö£├æÔö£├Ñ builder adjusts
    +    +    +  - Context compaction trigger with large conversation
    +    +    +  - File overwrite (same path written twice)
    +    +    +  - Build target: local path (file writing verified on disk)
    +    +    +  - Build target: GitHub new repo (mocked GitHub API + git operations)
    +    +    +
    +    +    +- **Prompt tuning**:
    +    +    +  - Refine builder_contract.md file block format instructions based on real LLM output patterns
    +    +    +  - Refine auditor_prompt.md to reduce false positives (especially the diff log TODO issue)
    +    +    +  - Add examples of correct file block format to the builder directive
    +    +    +  - Tune PAUSE_THRESHOLD default based on testing (may adjust from 3)
    +    +    +
    +    +    +- **Edge case hardening**:
    +    +    +  - Builder emits malformed file blocks Ôö£├ÂÔö£├æÔö£├Ñ graceful fallback (log warning, don't crash)
    +    +    +  - Builder never emits PHASE_COMPLETE_SIGNAL Ôö£├ÂÔö£├æÔö£├Ñ timeout per phase (configurable, default 10 minutes)
    +    +    +  - Network error during git push Ôö£├ÂÔö£├æÔö£├Ñ retry with backoff, then pause build with error details
    +    +    +  - Working directory cleanup on build completion/failure/cancellation
    +    +    +  - Concurrent builds per user prevention (existing rate limit enforcement)
    +    +    +  - Large file handling (>1MB file blocks) Ôö£├ÂÔö£├æÔö£├Ñ warn but still write
    +    +    +
    +    +    +- **Observability**:
    +    +    +  - Build summary endpoint enhanced with: total turns, total audit attempts, files written count, git commits made, interjections received
    +    +    +  - Build logs searchable/filterable in the frontend (search bar on activity feed)
    +    +    +
    +    +    +- **Documentation**:
    +    +    +  - Update `USER_INSTRUCTIONS.md` with: build target options, how to use interjection, what happens on audit failure, pause/resume flow
    +    +    +  - Update `Forge/Contracts/builder_contract.md` with finalised file block format and plan format
    +    +    +
    +    +    +**Exit criteria:**
    +    +    +- All integration tests pass with mocked agent responses
    +    +    +- A real build (manual test) successfully creates a GitHub repo, writes files, passes audits, and pushes
    +    +    +- No crashes on malformed builder output
    +    +    +- Phase timeout triggers correctly
    +    +    +- Git push failures are handled gracefully
    +    +    +- Working directories are cleaned up
    +    +    +- `USER_INSTRUCTIONS.md` is comprehensive and accurate
    +    +    +- All tests pass (backend + frontend)
    +    +    +- `run_audit.ps1` passes all checks
    +    +    diff --git a/Forge/Contracts/physics.yaml b/Forge/Contracts/physics.yaml
    +    +    index b5337ec..f8e7053 100644
    +    +    --- a/Forge/Contracts/physics.yaml
    +    +    +++ b/Forge/Contracts/physics.yaml
    +    +    @@ -161,6 +161,8 @@ paths:
    +    +           messages_from_server:
    +    +             type: "audit_update"
    +    +             payload: AuditRunSummary
    +    +    +        type: "file_created"
    +    +    +        payload: BuildFileEvent
         +     
    -    +     ## Backend (pytest)
    -    +    -- 219 passed, 0 failed, 1 warning
    -    +    -- Duration: 12.58s
    -    +    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    -    +    +- 240 passed, 0 failed, 1 warning
    -    +    +- Duration: 13.60s
    +    +       # -- Projects (Phase 8) -------------------------------------------
         +     
    -    +     ## Frontend (vitest)
    -    +    -- 39 passed, 0 failed
    -    +    -- Duration: 2.17s
    -    +    -- New tests: CreateProjectModal (4)
    -    +    +- 49 passed, 0 failed
    -    +    +- Duration: 2.59s
    +    +    @@ -267,11 +269,16 @@ paths:
    +    +         post:
    +    +           summary: "Start a build (validates contracts exist, spawns builder)"
    +    +           auth: bearer
    +    +    +      request:
    +    +    +        target_type: string (required, enum: github_new, github_existing, local_path)
    +    +    +        target_ref: string (required, repo name / full_name / absolute path)
    +    +           response:
    +    +             id: uuid
    +    +             project_id: uuid
    +    +             phase: string
    +    +             status: string
    +    +    +        target_type: string
    +    +    +        target_ref: string
    +    +             started_at: datetime
    +    +             created_at: datetime
         +     
    -    +    diff --git a/Forge/evidence/updatedifflog.md b/Forge/evidence/updatedifflog.md
    -    +    index 5d019da..2433eaf 100644
    -    +    --- a/Forge/evidence/updatedifflog.md
    -    +    +++ b/Forge/evidence/updatedifflog.md
    -    +    @@ -1,46 +1,684 @@
    -    +    -Ôö¼Ôöñ├ö├▓├╣├ö├Â├ë# Diff Log (overwrite each cycle)
    -    +    +# Diff Log (overwrite each cycle)
    +    +    @@ -298,6 +305,23 @@ paths:
    +    +             error_detail: string | null
    +    +             created_at: datetime
         +     
    -    +     ## Cycle Metadata
    -    +    -- Timestamp: 2026-02-15T04:42:00+00:00
    -    +    +- Timestamp: 2026-02-15T16:18:17+00:00
    -    +     - Branch: master
    -    +    -- HEAD: pending
    -    +    -- BASE_HEAD: 63d92ee
    -    +    -- Diff basis: post-phase enhancement (commit backfill + create project)
    -    +    +- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    -    +    +- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    -    +    +- Diff basis: staged
    +    +    +  /projects/{project_id}/build/files:
    +    +    +    get:
    +    +    +      summary: "List all files written during the build"
    +    +    +      auth: bearer
    +    +    +      response:
    +    +    +        items: BuildFile[]
    +    +    +
    +    +    +  /projects/{project_id}/build/files/{path}:
    +    +    +    get:
    +    +    +      summary: "Retrieve content of a specific file written during the build"
    +    +    +      auth: bearer
    +    +    +      response:
    +    +    +        path: string
    +    +    +        content: string
    +    +    +        size_bytes: integer
    +    +    +        language: string
    +    +    +
    +    +       /projects/{project_id}/build/logs:
    +    +         get:
    +    +           summary: "Paginated build logs"
    +    +    @@ -422,12 +446,20 @@ schemas:
    +    +         message: string
    +    +         created_at: datetime
         +     
    -    +     ## Cycle Status
    -    +     - Status: COMPLETE
    +    +    +  BuildFile:
    +    +    +    path: string
    +    +    +    size_bytes: integer
    +    +    +    language: string
    +    +    +    created_at: datetime
    +    +    +
    +    +       BuildStatus:
    +    +         id: uuid
    +    +         project_id: uuid
    +    +         phase: string
    +    +         status: string
    +    +         loop_count: integer
    +    +    +    target_type: string | null
    +    +    +    target_ref: string | null
    +    +         started_at: datetime | null
    +    +         completed_at: datetime | null
    +    +         error_detail: string | null
    +    +    diff --git a/Forge/Contracts/schema.md b/Forge/Contracts/schema.md
    +    +    index e68e84e..6871701 100644
    +    +    --- a/Forge/Contracts/schema.md
    +    +    +++ b/Forge/Contracts/schema.md
    +    +    @@ -183,6 +183,9 @@ CREATE TABLE builds (
    +    +         project_id      UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
    +    +         phase           VARCHAR(100) NOT NULL DEFAULT 'Phase 0',
    +    +         status          VARCHAR(20) NOT NULL DEFAULT 'pending',
    +    +    +    target_type     VARCHAR(20),
    +    +    +    target_ref      TEXT,
    +    +    +    working_dir     TEXT,
    +    +         started_at      TIMESTAMPTZ,
    +    +         completed_at    TIMESTAMPTZ,
    +    +         loop_count      INTEGER NOT NULL DEFAULT 0,
    +    +    @@ -192,6 +195,7 @@ CREATE TABLE builds (
    +    +     ```
         +     
    -    +     ## Summary
    -    +    -- Added offline commit backfill: `list_commits()` GitHub client, `get_existing_commit_shas()` repo layer, `backfill_repo_commits()` service, `POST /repos/{id}/sync` endpoint
    -    +    -- Added "Create Project" button + modal on Dashboard with name/description form
    -    +    -- Added "Sync Commits" button on CommitTimeline page to trigger backfill
    -    +    -- 15 new tests: 5 audit service, 3 GitHub client, 3 repos router sync, 4 frontend CreateProjectModal
    -    +    -
    -    +    -## Files Changed
    -    +    -- app/clients/github_client.py (added list_commits)
    -    +    -- app/repos/audit_repo.py (added get_existing_commit_shas)
    -    +    -- app/services/audit_service.py (added backfill_repo_commits)
    -    +    -- app/api/routers/repos.py (added POST sync endpoint)
    -    +    -- web/src/components/CreateProjectModal.tsx (new)
    -    +    -- web/src/pages/Dashboard.tsx (added Create Project button + modal)
    -    +    -- web/src/pages/CommitTimeline.tsx (added Sync Commits button)
    -    +    -- tests/test_audit_service.py (new, 5 tests)
    -    +    -- tests/test_github_client.py (new, 3 tests)
    -    +    -- tests/test_repos_router.py (added 3 sync tests)
    -    +    -- web/src/__tests__/App.test.tsx (added 4 CreateProjectModal tests)
    -    +    +- Fixed mic reconnection bug: reuse single SpeechRecognition instance instead of creating new ones per toggle (browsers throttle/block new instances outside original gesture context)
    -    +    +- Fixed run_audit.ps1 .Count error: wrapped pipeline result in @() to ensure array type when single file is claimed
    -    +    +- Updated test_runs_latest.md with current pass counts (240 backend, 49 frontend)
    -    +    +
    -    +    +## Files Changed (staged)
    -    +     - Forge/evidence/test_runs_latest.md
    -    +    -- Forge/evidence/updatedifflog.md
    -    +    +- Forge/scripts/run_audit.ps1
    -    +    +- web/src/components/QuestionnaireModal.tsx
    +    +     `status` values: `pending`, `running`, `completed`, `failed`, `cancelled`
    +    +    +`target_type` values: `github_new`, `github_existing`, `local_path`, `null` (legacy builds)
    +    +     
    +    +     ```sql
    +    +     CREATE INDEX idx_builds_project_id ON builds(project_id);
    +    +    @@ -275,4 +279,8 @@ db/migrations/
    +    +       002_projects.sql
    +    +       003_builds.sql
    +    +       004_build_costs.sql
    +    +    +  005_questionnaire_state.sql
    +    +    +  006_user_api_key.sql
    +    +    +  007_audit_llm_toggle.sql
    +    +    +  008_build_targets.sql
    +    +     ```
    +         diff --git a/Forge/evidence/audit_ledger.md b/Forge/evidence/audit_ledger.md
    +    -    index 5a3369d..7ec1b27 100644
    +    +    index 8732f2e..da18693 100644
    +         --- a/Forge/evidence/audit_ledger.md
    +         +++ b/Forge/evidence/audit_ledger.md
    +    -    @@ -3399,3 +3399,34 @@ Outcome: FAIL
    +    -     W1: PASS -- No secret patterns detected.
    +    +    @@ -3779,3 +3779,60 @@ Outcome: SIGNED-OFF (awaiting AUTHORIZED)
    +    +     W1: WARN -- Potential secrets found: sk-
    +          W2: PASS -- audit_ledger.md exists and is non-empty.
    +          W3: PASS -- All physics paths have corresponding handler files.
    +         +
    +         +---
    +    -    +## Audit Entry: unknown -- Iteration 74
    +    -    +Timestamp: 2026-02-15T16:18:59Z
    +    -    +AEM Cycle: unknown
    +    +    +## Audit Entry: Phase 12 -- - Build Target & File Writing: builder writes real files to a chosen target -- Iteration 81
    +    +    +Timestamp: 2026-02-15T19:26:20Z
    +    +    +AEM Cycle: Phase 12 -- - Build Target & File Writing: builder writes real files to a chosen target
    +         +Outcome: FAIL
    +         +
    +         +### Checklist
    +    -    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    +    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/builds.py, app/repos/build_repo.py, app/services/build_service.py, Forge/Contracts/builder_contract.md, Forge/Contracts/phases.md, Forge/Contracts/physics.yaml, Forge/Contracts/schema.md, Forge/evidence/updatedifflog.md, tests/test_build_repo.py, tests/test_build_service.py, tests/test_builds_router.py, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx. Claimed but not in diff: _write_file_block, app/api/routers/builds.py (StartBuildRequest, app/clients/git_client.py (NEW), app/repos/build_repo.py (target params, app/services/build_service.py (file parsing, BuildFile schema), db/migrations/008_build_targets.sql (NEW), detection), file endpoints, file endpoints), file_created WS handler), Forge/Contracts/builder_contract.md (├ö├Â┬╝Ôö¼Ôòæ0.1 file block output format), Forge/Contracts/phases.md (Phases 12-15 appended), Forge/Contracts/physics.yaml (build target params, Forge/Contracts/schema.md (builds table target columns, get_build_file_logs), git ops), migration 008), target create), target handling, tests/test_build_repo.py (new tests for file logs, tests/test_build_service.py (new tests for file parsing, tests/test_builds_router.py (new tests for target params, tests/test_git_client.py (NEW), web/src/__tests__/BuildTargetModal.test.tsx (NEW), web/src/components/BuildTargetModal.tsx (NEW), web/src/pages/BuildProgress.tsx (file tree panel, web/src/pages/ProjectDetail.tsx (target picker integration), writing.
    +         +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    +         +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    +         +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    +    -    +- A5 Diff Log Gate:         FAIL -- updatedifflog.md contains TODO: placeholders.
    +    +    +- A5 Diff Log Gate:         PASS -- No TODO: placeholders in updatedifflog.md.
    +         +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    +    -    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    +    +    +- A7 Verification order:    FAIL -- Missing verification keywords: Static, Runtime, Behavior, Contract.
    +         +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    +         +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    +         +
    +         +### Fix Plan (FAIL items)
    +    -    +- A1: FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    -    +- A5: FAIL -- updatedifflog.md contains TODO: placeholders.
    +    +    +- A1: FAIL -- Unclaimed in diff: app/api/routers/builds.py, app/repos/build_repo.py, app/services/build_service.py, Forge/Contracts/builder_contract.md, Forge/Contracts/phases.md, Forge/Contracts/physics.yaml, Forge/Contracts/schema.md, Forge/evidence/updatedifflog.md, tests/test_build_repo.py, tests/test_build_service.py, tests/test_builds_router.py, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx. Claimed but not in diff: _write_file_block, app/api/routers/builds.py (StartBuildRequest, app/clients/git_client.py (NEW), app/repos/build_repo.py (target params, app/services/build_service.py (file parsing, BuildFile schema), db/migrations/008_build_targets.sql (NEW), detection), file endpoints, file endpoints), file_created WS handler), Forge/Contracts/builder_contract.md (├ö├Â┬╝Ôö¼Ôòæ0.1 file block output format), Forge/Contracts/phases.md (Phases 12-15 appended), Forge/Contracts/physics.yaml (build target params, Forge/Contracts/schema.md (builds table target columns, get_build_file_logs), git ops), migration 008), target create), target handling, tests/test_build_repo.py (new tests for file logs, tests/test_build_service.py (new tests for file parsing, tests/test_builds_router.py (new tests for target params, tests/test_git_client.py (NEW), web/src/__tests__/BuildTargetModal.test.tsx (NEW), web/src/components/BuildTargetModal.tsx (NEW), web/src/pages/BuildProgress.tsx (file tree panel, web/src/pages/ProjectDetail.tsx (target picker integration), writing.
    +    +    +- A7: FAIL -- Missing verification keywords: Static, Runtime, Behavior, Contract.
    +         +
    +         +### Files Changed
    +    -    +- Forge/evidence/test_runs_latest.md
    +    -    +- Forge/scripts/run_audit.ps1
    +    -    +- web/src/components/QuestionnaireModal.tsx
    +    +    +- _write_file_block
    +    +    +- app/api/routers/builds.py (StartBuildRequest
    +    +    +- app/clients/git_client.py (NEW)
    +    +    +- app/repos/build_repo.py (target params
    +    +    +- app/services/build_service.py (file parsing
    +    +    +- BuildFile schema)
    +    +    +- db/migrations/008_build_targets.sql (NEW)
    +    +    +- detection)
    +    +    +- file endpoints
    +    +    +- file endpoints)
    +    +    +- file_created WS handler)
    +    +    +- Forge/Contracts/builder_contract.md (├ö├Â┬╝Ôö¼Ôòæ0.1 file block output format)
    +    +    +- Forge/Contracts/phases.md (Phases 12-15 appended)
    +    +    +- Forge/Contracts/physics.yaml (build target params
    +    +    +- Forge/Contracts/schema.md (builds table target columns
    +    +    +- get_build_file_logs)
    +    +    +- git ops)
    +    +    +- migration 008)
    +    +    +- target create)
    +    +    +- target handling
    +    +    +- tests/test_build_repo.py (new tests for file logs
    +    +    +- tests/test_build_service.py (new tests for file parsing
    +    +    +- tests/test_builds_router.py (new tests for target params
    +    +    +- tests/test_git_client.py (NEW)
    +    +    +- web/src/__tests__/BuildTargetModal.test.tsx (NEW)
    +    +    +- web/src/components/BuildTargetModal.tsx (NEW)
    +    +    +- web/src/pages/BuildProgress.tsx (file tree panel
    +    +    +- web/src/pages/ProjectDetail.tsx (target picker integration)
    +    +    +- writing
    +         +
    +         +### Notes
    +    -    +W1: WARN -- Potential secrets found: sk-
    +    +    +W1: WARN -- Potential secrets found: sk-, token=
    +         +W2: PASS -- audit_ledger.md exists and is non-empty.
    +         +W3: PASS -- All physics paths have corresponding handler files.
    +    -    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    +    -    index 84a13ac..ad6bd57 100644
    +    -    --- a/Forge/evidence/test_runs_latest.md
    +    -    +++ b/Forge/evidence/test_runs_latest.md
    +    -    @@ -1,19 +1,17 @@
    +    -     Ôö¼Ôöñ├ö├▓├╣├ö├Â├ëStatus: PASS
    +    -    -Start: 2026-02-15T04:40:00Z
    +    -    -End: 2026-02-15T04:41:00Z
    +    -    +Start: 2026-02-15T16:20:00Z
    +    -    +End: 2026-02-15T16:21:00Z
    +    -     Branch: master
    +    -    -HEAD: post-phase-enhancement
    +    -    +HEAD: 3a575f8
    +    -     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    +    -     compileall exit: 0
    +    -     import_sanity exit: 0
    +    -     
    +    -     ## Backend (pytest)
    +    -    -- 219 passed, 0 failed, 1 warning
    +    -    -- Duration: 12.58s
    +    -    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    +    -    +- 240 passed, 0 failed, 1 warning
    +    -    +- Duration: 13.60s
    +    -     
    +    -     ## Frontend (vitest)
    +    -    -- 39 passed, 0 failed
    +    -    -- Duration: 2.17s
    +    -    -- New tests: CreateProjectModal (4)
    +    -    +- 49 passed, 0 failed
    +    -    +- Duration: 2.59s
    +    -     
    +         diff --git a/Forge/evidence/updatedifflog.md b/Forge/evidence/updatedifflog.md
    +    -    index 5d019da..fd8648e 100644
    +    +    index a9722d8..ca21ec2 100644
    +         --- a/Forge/evidence/updatedifflog.md
    +         +++ b/Forge/evidence/updatedifflog.md
    +    -    @@ -1,46 +1,3253 @@
    +    -    -Ôö¼Ôöñ├ö├▓├╣├ö├Â├ë# Diff Log (overwrite each cycle)
    +    -    +# Diff Log (overwrite each cycle)
    +    +    @@ -1,7369 +1,470 @@
    +    +     # Diff Log (overwrite each cycle)
    +          
    +          ## Cycle Metadata
    +    -    -- Timestamp: 2026-02-15T04:42:00+00:00
    +    -    +- Timestamp: 2026-02-15T16:19:58+00:00
    +    +    -- Timestamp: 2026-02-15T18:16:39+00:00
    +    +    +- Timestamp: 2026-02-15T19:08:06+00:00
    +          - Branch: master
    +    -    -- HEAD: pending
    +    -    -- BASE_HEAD: 63d92ee
    +    -    -- Diff basis: post-phase enhancement (commit backfill + create project)
    +    -    +- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    +    -    +- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    +    -    +- Diff basis: staged
    +    +    -- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    +    +    -- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    +    +    +- HEAD: ceb988f83e66f094035eb31168aed612e537a451
    +    +    +- BASE_HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    +    +     - Diff basis: staged
    +          
    +          ## Cycle Status
    +          - Status: COMPLETE
    +          
    +    +    +## Verification Evidence
    +    +    +- Backend tests: 281 passed (pytest tests/ --tb=short -q)
    +    +    +- Frontend tests: 61 passed, 3 test files (npx vitest run)
    +    +    +- New test files: tests/test_git_client.py (10 tests)
    +    +    +- New test file: web/src/__tests__/BuildTargetModal.test.tsx (11 tests)
    +    +    +- New tests added to: test_build_service.py, test_build_repo.py, test_builds_router.py
         +    +
    -    +    +## git status -sb
    -    +    +    ## master...origin/master [ahead 2]
    -    +    +    M  Forge/evidence/test_runs_latest.md
    -    +    +     M Forge/evidence/updatedifflog.md
    -    +    +    M  Forge/scripts/run_audit.ps1
    -    +    +     M USER_INSTRUCTIONS.md
    -    +    +     M app/api/routers/auth.py
    -    +    +     M app/api/routers/projects.py
    -    +    +     M app/clients/llm_client.py
    -    +    +     M app/config.py
    -    +    +     M app/repos/audit_repo.py
    -    +    +     M app/repos/user_repo.py
    -    +    +     M app/services/audit_service.py
    -    +    +     M app/services/build_service.py
    -    +    +     M app/services/project_service.py
    -    +    +     M tests/test_audit_service.py
    -    +    +     M tests/test_auth_router.py
    -    +    +     M tests/test_build_service.py
    -    +    +     M tests/test_llm_client.py
    -    +    +     M tests/test_project_service.py
    -    +    +     M tests/test_projects_router.py
    -    +    +     M web/src/App.tsx
    -    +    +     M web/src/__tests__/App.test.tsx
    -    +    +     M web/src/components/AppShell.tsx
    -    +    +    M  web/src/components/QuestionnaireModal.tsx
    -    +    +     M web/src/context/AuthContext.tsx
    -    +    +     M web/src/pages/BuildComplete.tsx
    -    +    +     M web/src/pages/BuildProgress.tsx
    -    +    +     M web/src/pages/ProjectDetail.tsx
    -    +    +     M web/vite.config.ts
    -    +    +    ?? db/migrations/006_user_api_key.sql
    -    +    +    ?? web/src/components/ContractProgress.tsx
    -    +    +    ?? web/src/pages/Settings.tsx
    +          ## Summary
    +    -    -- Added offline commit backfill: `list_commits()` GitHub client, `get_existing_commit_shas()` repo layer, `backfill_repo_commits()` service, `POST /repos/{id}/sync` endpoint
    +    -    -- Added "Create Project" button + modal on Dashboard with name/description form
    +    -    -- Added "Sync Commits" button on CommitTimeline page to trigger backfill
    +    -    -- 15 new tests: 5 audit service, 3 GitHub client, 3 repos router sync, 4 frontend CreateProjectModal
    +    -    -
    +    -    -## Files Changed
    +    -    -- app/clients/github_client.py (added list_commits)
    +    -    -- app/repos/audit_repo.py (added get_existing_commit_shas)
    +    -    -- app/services/audit_service.py (added backfill_repo_commits)
    +    -    -- app/api/routers/repos.py (added POST sync endpoint)
    +    -    -- web/src/components/CreateProjectModal.tsx (new)
    +    -    -- web/src/pages/Dashboard.tsx (added Create Project button + modal)
    +    -    -- web/src/pages/CommitTimeline.tsx (added Sync Commits button)
    +    -    -- tests/test_audit_service.py (new, 5 tests)
    +    -    -- tests/test_github_client.py (new, 3 tests)
    +    -    -- tests/test_repos_router.py (added 3 sync tests)
    +    -    -- web/src/__tests__/App.test.tsx (added 4 CreateProjectModal tests)
    +    -    +- Fixed mic reconnection bug in QuestionnaireModal: reuse single SpeechRecognition instance across toggle cycles instead of creating new ones (browsers throttle new instances outside original gesture context)
    +    -    +- Fixed run_audit.ps1 .Count error: wrapped pipeline result in @() to ensure array type when single file is claimed
    +    -    +- Updated test_runs_latest.md with current pass counts (240 backend, 49 frontend)
    +    -    +- Multi-feature batch: questionnaire modal, LLM multi-provider, project remove, build system, settings page, contract progress
    +    -    +
    +    -    +## Files Changed (staged)
    +    -    +- Forge/evidence/audit_ledger.md
    +    -     - Forge/evidence/test_runs_latest.md
    +    -     - Forge/evidence/updatedifflog.md
    +    -    +- Forge/scripts/run_audit.ps1
    +    -    +- USER_INSTRUCTIONS.md
    +    -    +- app/api/routers/auth.py
    +    -    +- app/api/routers/projects.py
    +    -    +- app/clients/llm_client.py
    +    -    +- app/config.py
    +    -    +- app/repos/audit_repo.py
    +    -    +- app/repos/user_repo.py
    +    -    +- app/services/audit_service.py
    +    -    +- app/services/build_service.py
    +    -    +- app/services/project_service.py
    +    -    +- db/migrations/006_user_api_key.sql
    +    -    +- tests/test_audit_service.py
    +    -    +- tests/test_auth_router.py
    +    -    +- tests/test_build_service.py
    +    -    +- tests/test_llm_client.py
    +    -    +- tests/test_project_service.py
    +    -    +- tests/test_projects_router.py
    +    -    +- web/src/App.tsx
    +    -    +- web/src/__tests__/App.test.tsx
    +    -    +- web/src/components/AppShell.tsx
    +    -    +- web/src/components/ContractProgress.tsx
    +    -    +- web/src/components/QuestionnaireModal.tsx
    +    -    +- web/src/context/AuthContext.tsx
    +    -    +- web/src/pages/BuildComplete.tsx
    +    -    +- web/src/pages/BuildProgress.tsx
    +    -    +- web/src/pages/ProjectDetail.tsx
    +    -    +- web/src/pages/Settings.tsx
    +    -    +- web/vite.config.ts
    +    -    +
    +    -    +## git status -sb
    +    -    +    ## master...origin/master [ahead 2]
    +    -    +    M  Forge/evidence/audit_ledger.md
    +    -    +    M  Forge/evidence/test_runs_latest.md
    +    -    +    M  Forge/evidence/updatedifflog.md
    +    -    +    M  Forge/scripts/run_audit.ps1
    +    -    +    M  USER_INSTRUCTIONS.md
    +    -    +    M  app/api/routers/auth.py
    +    -    +    M  app/api/routers/projects.py
    +    -    +    M  app/clients/llm_client.py
    +    -    +    M  app/config.py
    +    -    +    M  app/repos/audit_repo.py
    +    -    +    M  app/repos/user_repo.py
    +    -    +    M  app/services/audit_service.py
    +    -    +    M  app/services/build_service.py
    +    -    +    M  app/services/project_service.py
    +    -    +    A  db/migrations/006_user_api_key.sql
    +    -    +    M  tests/test_audit_service.py
    +    -    +    M  tests/test_auth_router.py
    +    -    +    M  tests/test_build_service.py
    +    -    +    M  tests/test_llm_client.py
    +    -    +    M  tests/test_project_service.py
    +    -    +    M  tests/test_projects_router.py
    +    -    +    M  web/src/App.tsx
    +    -    +    M  web/src/__tests__/App.test.tsx
    +    -    +    M  web/src/components/AppShell.tsx
    +    -    +    A  web/src/components/ContractProgress.tsx
    +    -    +    M  web/src/components/QuestionnaireModal.tsx
    +    -    +    M  web/src/context/AuthContext.tsx
    +    -    +    M  web/src/pages/BuildComplete.tsx
    +    -    +    M  web/src/pages/BuildProgress.tsx
    +    -    +    M  web/src/pages/ProjectDetail.tsx
    +    -    +    A  web/src/pages/Settings.tsx
    +    -    +    M  web/vite.config.ts
    +    +    -- Removed phase_breakdown from questionnaire (7 sections),Added build/phases endpoint parsing phases contract,Enhanced build WS events with token data in phase_complete and build_complete,Rewrote BuildProgress.tsx with two-column layout: phase checklist + metrics + activity feed
    +    +    +- Phase 12 -- Build Target & File Writing: builder writes real files to a chosen target
    +    +    +- Add build target selection (github_new, github_existing, local_path) to POST /build
    +    +    +- Create git_client.py for clone/add/commit/push operations
    +    +    +- Parse file blocks from builder output and write to disk in real time
    +    +    +- Add file tree panel to BuildProgress UI with file_created WS events
    +    +    +- Add GET /build/files and GET /build/files/{path} for file retrieval
    +    +    +- DB migration 008: target_type, target_ref, working_dir columns on builds table
    +    +    +- Create BuildTargetModal component for target type selection
    +    +    +- Update physics.yaml and schema.md contracts first (physics-first gate)
         +     
    -    +     ## Verification
    -    +    -- Static: all files compile (compileall + tsc pass)
    -    +    -- Runtime: 219 pytest + 39 vitest = 258 tests pass (was 243)
    -    +    -- Behavior: backfill syncs missing commits, Create Project modal submits to backend
    -    +    -- Contract: no phase contract changes needed (post-phase enhancement)
    -    +    +- TODO: verification evidence (static -> runtime -> behavior -> contract).
    +    +    -## Files Changed (staged)
    +    +    -- Forge/evidence/audit_ledger.md
    +    +    -- Forge/evidence/test_runs_latest.md
    +    +    -- Forge/evidence/updatedifflog.md
    +    +    -- Forge/scripts/run_audit.ps1
    +    +    -- USER_INSTRUCTIONS.md
    +    +    -- app/api/routers/auth.py
    +    +    -- app/api/routers/builds.py
    +    +    -- app/api/routers/projects.py
    +    +    -- app/clients/llm_client.py
    +    +    -- app/config.py
    +    +    -- app/repos/audit_repo.py
    +    +    -- app/repos/user_repo.py
    +    +    -- app/services/audit_service.py
    +    +    -- app/services/build_service.py
    +    +    -- app/services/project_service.py
    +    +    -- db/migrations/006_user_api_key.sql
    +    +    -- tests/test_audit_service.py
    +    +    -- tests/test_auth_router.py
    +    +    -- tests/test_build_service.py
    +    +    -- tests/test_llm_client.py
    +    +    -- tests/test_project_service.py
    +    +    -- tests/test_projects_router.py
    +    +    -- web/src/App.tsx
    +    +    -- web/src/__tests__/App.test.tsx
    +    +    -- web/src/__tests__/Build.test.tsx
    +    +    -- web/src/components/AppShell.tsx
    +    +    -- web/src/components/ContractProgress.tsx
    +    +    -- web/src/components/QuestionnaireModal.tsx
    +    +    -- web/src/context/AuthContext.tsx
    +    +    -- web/src/pages/BuildComplete.tsx
    +    +    -- web/src/pages/BuildProgress.tsx
    +    +    -- web/src/pages/ProjectDetail.tsx
    +    +    -- web/src/pages/Settings.tsx
    +    +    -- web/vite.config.ts
    +    +    +## Files Changed
    +    +    +- Forge/Contracts/phases.md (Phases 12-15 appended)
    +    +    +- Forge/Contracts/physics.yaml (build target params, file endpoints, BuildFile schema)
    +    +    +- Forge/Contracts/schema.md (builds table target columns, migration 008)
    +    +    +- Forge/Contracts/builder_contract.md (├ö├Â┬╝Ôö¼Ôòæ0.1 file block output format)
    +    +    +- db/migrations/008_build_targets.sql (NEW)
    +    +    +- app/clients/git_client.py (NEW)
    +    +    +- app/repos/build_repo.py (target params, get_build_file_logs)
    +    +    +- app/services/build_service.py (file parsing, target handling, _write_file_block, git ops)
    +    +    +- app/api/routers/builds.py (StartBuildRequest, file endpoints)
    +    +    +- web/src/components/BuildTargetModal.tsx (NEW)
    +    +    +- web/src/pages/ProjectDetail.tsx (target picker integration)
    +    +    +- web/src/pages/BuildProgress.tsx (file tree panel, file_created WS handler)
    +    +    +- tests/test_git_client.py (NEW)
    +    +    +- tests/test_build_service.py (new tests for file parsing, writing, detection)
    +    +    +- tests/test_build_repo.py (new tests for file logs, target create)
    +    +    +- tests/test_builds_router.py (new tests for target params, file endpoints)
    +    +    +- web/src/__tests__/BuildTargetModal.test.tsx (NEW)
         +     
    -    +     ## Notes (optional)
    -    +    -- Backfill fetches up to 300 recent commits (3 pages ├ö├Â┬úÔö£Ôòú 100) per sync
    -    +    -- Backfill continues processing if individual commits error (graceful degradation)
    -    +    +- TODO: blockers, risks, constraints.
    +    +     ## git status -sb
    +    +    -    ## master...origin/master [ahead 2]
    +    +    -    MM Forge/evidence/audit_ledger.md
    +    +    -    M  Forge/evidence/test_runs_latest.md
    +    +    -    MM Forge/evidence/updatedifflog.md
    +    +    -    M  Forge/scripts/run_audit.ps1
    +    +    -    M  USER_INSTRUCTIONS.md
    +    +    -    M  app/api/routers/auth.py
    +    +    -    M  app/api/routers/builds.py
    +    +    -    M  app/api/routers/projects.py
    +    +    -    M  app/clients/llm_client.py
    +    +    -    M  app/config.py
    +    +    -    M  app/repos/audit_repo.py
    +    +    -    M  app/repos/user_repo.py
    +    +    -    M  app/services/audit_service.py
    +    +    -    M  app/services/build_service.py
    +    +    -    M  app/services/project_service.py
    +    +    -    A  db/migrations/006_user_api_key.sql
    +    +    -    M  tests/test_audit_service.py
    +    +    -    M  tests/test_auth_router.py
    +    +    -    M  tests/test_build_service.py
    +    +    -    M  tests/test_llm_client.py
    +    +    -    MM tests/test_project_service.py
    +    +    -    MM tests/test_projects_router.py
    +    +    -    MM web/src/App.tsx
    +    +    -    MM web/src/__tests__/App.test.tsx
    +    +    -    M  web/src/__tests__/Build.test.tsx
    +    +    -    M  web/src/components/AppShell.tsx
    +    +    -    AM web/src/components/ContractProgress.tsx
    +    +    -    M  web/src/components/QuestionnaireModal.tsx
    +    +    -    MM web/src/context/AuthContext.tsx
    +    +    -    M  web/src/pages/BuildComplete.tsx
    +    +    -    M  web/src/pages/BuildProgress.tsx
    +    +    -    MM web/src/pages/ProjectDetail.tsx
    +    +    -    A  web/src/pages/Settings.tsx
    +    +    -    M  web/vite.config.ts
    +    +    +    ## master...origin/master [ahead 3]
    +    +    +    M  Forge/Contracts/phases.md
    +    +    +    M  Forge/Contracts/physics.yaml
    +    +    +    M  Forge/Contracts/schema.md
    +    +    +     M Forge/evidence/updatedifflog.md
    +          
    +          ## Verification
    +    -     - Static: all files compile (compileall + tsc pass)
    +    -    -- Runtime: 219 pytest + 39 vitest = 258 tests pass (was 243)
    +    -    -- Behavior: backfill syncs missing commits, Create Project modal submits to backend
    +    -    -- Contract: no phase contract changes needed (post-phase enhancement)
    +    -    +- Runtime: 240 pytest + 49 vitest = 289 tests pass
    +    -    +- Behavior: mic stays active across toggle cycles, audit script handles single-file claims
    +    -    +- Contract: no boundary violations (A4 PASS)
    +    +    -- Static: pylance 0 errors on all changed files,Runtime: boot.ps1 runs without errors,Behavior: vitest 49/49 pass,Contract: phases contract parsing matches schema.md phase structure
    +    +    +- Static: PENDING (will run pytest + vitest after implementation)
    +    +    +- Runtime: PENDING (will verify boot + endpoints)
    +    +    +- Behavior: PENDING (will verify file writing + target selection)
    +    +    +- Contract: PENDING (will verify physics/schema/boundary compliance)
    +          
    +          ## Notes (optional)
    +    -    -- Backfill fetches up to 300 recent commits (3 pages ├ö├Â┬úÔö£Ôòú 100) per sync
    +    -    -- Backfill continues processing if individual commits error (graceful degradation)
    +    -    +- No blockers or risks identified
    +    +    -- PhaseProgressBar/BuildLogViewer still exist but no longer used by BuildProgress
    +    +    +- Builds table extended with nullable target columns for backward compatibility
    +    +    +- git_client.py uses asyncio.subprocess (no heavy git library) per phase spec
    +    +    +- File blocks use === FILE: path === / === END FILE === delimiters
    +    +    +- Builder directive updated to instruct LLM to emit file blocks
    +          
    +          ## Next Steps
    +    -    -- Features ready for manual QA with live GitHub repos
    +    -    +- Test full questionnaire flow end-to-end with live Anthropic API
    +    -    +
    +    -    +## Minimal Diff Hunks
    +    -    +    diff --git a/Forge/evidence/audit_ledger.md b/Forge/evidence/audit_ledger.md
    +    -    +    index 5a3369d..7ec1b27 100644
    +    -    +    --- a/Forge/evidence/audit_ledger.md
    +    -    +    +++ b/Forge/evidence/audit_ledger.md
    +    -    +    @@ -3399,3 +3399,34 @@ Outcome: FAIL
    +    -    +     W1: PASS -- No secret patterns detected.
    +    -    +     W2: PASS -- audit_ledger.md exists and is non-empty.
    +    -    +     W3: PASS -- All physics paths have corresponding handler files.
    +    -    +    +
    +    -    +    +---
    +    -    +    +## Audit Entry: unknown -- Iteration 74
    +    -    +    +Timestamp: 2026-02-15T16:18:59Z
    +    -    +    +AEM Cycle: unknown
    +    -    +    +Outcome: FAIL
    +    -    +    +
    +    -    +    +### Checklist
    +    -    +    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    -    +    +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    +    -    +    +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    +    -    +    +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    +    -    +    +- A5 Diff Log Gate:         FAIL -- updatedifflog.md contains TODO: placeholders.
    +    -    +    +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    +    -    +    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    +    -    +    +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    +    -    +    +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    +    -    +    +
    +    -    +    +### Fix Plan (FAIL items)
    +    -    +    +- A1: FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    -    +    +- A5: FAIL -- updatedifflog.md contains TODO: placeholders.
    +    -    +    +
    +    -    +    +### Files Changed
    +    -    +    +- Forge/evidence/test_runs_latest.md
    +    -    +    +- Forge/scripts/run_audit.ps1
    +    -    +    +- web/src/components/QuestionnaireModal.tsx
    +    -    +    +
    +    -    +    +### Notes
    +    -    +    +W1: WARN -- Potential secrets found: sk-
    +    -    +    +W2: PASS -- audit_ledger.md exists and is non-empty.
    +    -    +    +W3: PASS -- All physics paths have corresponding handler files.
    +    -    +    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    +    -    +    index 84a13ac..ad6bd57 100644
    +    -    +    --- a/Forge/evidence/test_runs_latest.md
    +    -    +    +++ b/Forge/evidence/test_runs_latest.md
    +    -    +    @@ -1,19 +1,17 @@
    +    -    +     ├ö├Â┬╝├ö├Â├▒Ôö£├ÂÔö£ÔûôÔö£ÔòúÔö£├ÂÔö£├éÔö£├½Status: PASS
    +    -    +    -Start: 2026-02-15T04:40:00Z
    +    -    +    -End: 2026-02-15T04:41:00Z
    +    -    +    +Start: 2026-02-15T16:20:00Z
    +    -    +    +End: 2026-02-15T16:21:00Z
    +    -    +     Branch: master
    +    -    +    -HEAD: post-phase-enhancement
    +    -    +    +HEAD: 3a575f8
    +    -    +     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    +    -    +     compileall exit: 0
    +    -    +     import_sanity exit: 0
    +    -    +     
    +    -    +     ## Backend (pytest)
    +    -    +    -- 219 passed, 0 failed, 1 warning
    +    -    +    -- Duration: 12.58s
    +    -    +    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    +    -    +    +- 240 passed, 0 failed, 1 warning
    +    -    +    +- Duration: 13.60s
    +    -    +     
    +    -    +     ## Frontend (vitest)
    +    -    +    -- 39 passed, 0 failed
    +    -    +    -- Duration: 2.17s
    +    -    +    -- New tests: CreateProjectModal (4)
    +    -    +    +- 49 passed, 0 failed
    +    -    +    +- Duration: 2.59s
    +    -    +     
    +    -    +    diff --git a/Forge/evidence/updatedifflog.md b/Forge/evidence/updatedifflog.md
    +    -    +    index 5d019da..2433eaf 100644
    +    -    +    --- a/Forge/evidence/updatedifflog.md
    +    -    +    +++ b/Forge/evidence/updatedifflog.md
    +    -    +    @@ -1,46 +1,684 @@
    +    -    +    -├ö├Â┬╝├ö├Â├▒Ôö£├ÂÔö£ÔûôÔö£ÔòúÔö£├ÂÔö£├éÔö£├½# Diff Log (overwrite each cycle)
    +    -    +    +# Diff Log (overwrite each cycle)
    +    -    +     
    +    -    +     ## Cycle Metadata
    +    -    +    -- Timestamp: 2026-02-15T04:42:00+00:00
    +    -    +    +- Timestamp: 2026-02-15T16:18:17+00:00
    +    -    +     - Branch: master
    +    -    +    -- HEAD: pending
    +    -    +    -- BASE_HEAD: 63d92ee
    +    -    +    -- Diff basis: post-phase enhancement (commit backfill + create project)
    +    -    +    +- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    +    -    +    +- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    +    -    +    +- Diff basis: staged
    +    -    +     
    +    -    +     ## Cycle Status
    +    -    +     - Status: COMPLETE
    +    -    +     
    +    -    +     ## Summary
    +    -    +    -- Added offline commit backfill: `list_commits()` GitHub client, `get_existing_commit_shas()` repo layer, `backfill_repo_commits()` service, `POST /repos/{id}/sync` endpoint
    +    -    +    -- Added "Create Project" button + modal on Dashboard with name/description form
    +    -    +    -- Added "Sync Commits" button on CommitTimeline page to trigger backfill
    +    -    +    -- 15 new tests: 5 audit service, 3 GitHub client, 3 repos router sync, 4 frontend CreateProjectModal
    +    -    +    -
    +    -    +    -## Files Changed
    +    -    +    -- app/clients/github_client.py (added list_commits)
    +    -    +    -- app/repos/audit_repo.py (added get_existing_commit_shas)
    +    -    +    -- app/services/audit_service.py (added backfill_repo_commits)
    +    -    +    -- app/api/routers/repos.py (added POST sync endpoint)
    +    -    +    -- web/src/components/CreateProjectModal.tsx (new)
    +    -    +    -- web/src/pages/Dashboard.tsx (added Create Project button + modal)
    +    -    +    -- web/src/pages/CommitTimeline.tsx (added Sync Commits button)
    +    -    +    -- tests/test_audit_service.py (new, 5 tests)
    +    -    +    -- tests/test_github_client.py (new, 3 tests)
    +    -    +    -- tests/test_repos_router.py (added 3 sync tests)
    +    -    +    -- web/src/__tests__/App.test.tsx (added 4 CreateProjectModal tests)
    +    -    +    +- Fixed mic reconnection bug: reuse single SpeechRecognition instance instead of creating new ones per toggle (browsers throttle/block new instances outside original gesture context)
    +    -    +    +- Fixed run_audit.ps1 .Count error: wrapped pipeline result in @() to ensure array type when single file is claimed
    +    -    +    +- Updated test_runs_latest.md with current pass counts (240 backend, 49 frontend)
    +    -    +    +
    +    -    +    +## Files Changed (staged)
    +    -    +     - Forge/evidence/test_runs_latest.md
    +    -    +    -- Forge/evidence/updatedifflog.md
    +    -    +    +- Forge/scripts/run_audit.ps1
    +    -    +    +- web/src/components/QuestionnaireModal.tsx
    +    -    +    +
    +    -    +    +## git status -sb
    +    -    +    +    ## master...origin/master [ahead 2]
    +    -    +    +    M  Forge/evidence/test_runs_latest.md
    +    -    +    +     M Forge/evidence/updatedifflog.md
    +    -    +    +    M  Forge/scripts/run_audit.ps1
    +    -    +    +     M USER_INSTRUCTIONS.md
    +    -    +    +     M app/api/routers/auth.py
    +    -    +    +     M app/api/routers/projects.py
    +    -    +    +     M app/clients/llm_client.py
    +    -    +    +     M app/config.py
    +    -    +    +     M app/repos/audit_repo.py
    +    -    +    +     M app/repos/user_repo.py
    +    -    +    +     M app/services/audit_service.py
    +    -    +    +     M app/services/build_service.py
    +    -    +    +     M app/services/project_service.py
    +    -    +    +     M tests/test_audit_service.py
    +    -    +    +     M tests/test_auth_router.py
    +    -    +    +     M tests/test_build_service.py
    +    -    +    +     M tests/test_llm_client.py
    +    -    +    +     M tests/test_project_service.py
    +    -    +    +     M tests/test_projects_router.py
    +    -    +    +     M web/src/App.tsx
    +    -    +    +     M web/src/__tests__/App.test.tsx
    +    -    +    +     M web/src/components/AppShell.tsx
    +    -    +    +    M  web/src/components/QuestionnaireModal.tsx
    +    -    +    +     M web/src/context/AuthContext.tsx
    +    -    +    +     M web/src/pages/BuildComplete.tsx
    +    -    +    +     M web/src/pages/BuildProgress.tsx
    +    -    +    +     M web/src/pages/ProjectDetail.tsx
    +    -    +    +     M web/vite.config.ts
    +    -    +    +    ?? db/migrations/006_user_api_key.sql
    +    -    +    +    ?? web/src/components/ContractProgress.tsx
    +    -    +    +    ?? web/src/pages/Settings.tsx
    +    -    +     
    +    -    +     ## Verification
    +    -    +    -- Static: all files compile (compileall + tsc pass)
    +    -    +    -- Runtime: 219 pytest + 39 vitest = 258 tests pass (was 243)
    +    -    +    -- Behavior: backfill syncs missing commits, Create Project modal submits to backend
    +    -    +    -- Contract: no phase contract changes needed (post-phase enhancement)
    +    -    +    +- TODO: verification evidence (static -> runtime -> behavior -> contract).
    +    -    +     
    +    -    +     ## Notes (optional)
    +    -    +    -- Backfill fetches up to 300 recent commits (3 pages Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬ú├ö├▓├║ 100) per sync
    +    -    +    -- Backfill continues processing if individual commits error (graceful degradation)
    +    -    +    +- TODO: blockers, risks, constraints.
    +    -    +     
    +    -    +     ## Next Steps
    +    -    +    -- Features ready for manual QA with live GitHub repos
    +    -    +    +- TODO: next actions (small, specific).
    +    -    +    +
    +    -    +    +## Minimal Diff Hunks
    +    -    +    +    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    +    -    +    +    index 84a13ac..ad6bd57 100644
    +    -    +    +    --- a/Forge/evidence/test_runs_latest.md
    +    -    +    +    +++ b/Forge/evidence/test_runs_latest.md
    +    -    +    +    @@ -1,19 +1,17 @@
    +    -    +    +     Ôö£├ÂÔö£├éÔö¼ÔòØÔö£├ÂÔö£├éÔö£ÔûÆ├ö├Â┬úÔö£├é├ö├Â┬ú├ö├╗├┤├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬¢Status: PASS
    +    -    +    +    -Start: 2026-02-15T04:40:00Z
    +    -    +    +    -End: 2026-02-15T04:41:00Z
    +    -    +    +    +Start: 2026-02-15T16:20:00Z
    +    -    +    +    +End: 2026-02-15T16:21:00Z
    +    -    +    +     Branch: master
    +    -    +    +    -HEAD: post-phase-enhancement
    +    -    +    +    +HEAD: 3a575f8
    +    -    +    +     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    +    -    +    +     compileall exit: 0
    +    -    +    +     import_sanity exit: 0
    +    -    +    +     
    +    -    +    +     ## Backend (pytest)
    +    -    +    +    -- 219 passed, 0 failed, 1 warning
    +    -    +    +    -- Duration: 12.58s
    +    -    +    +    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    +    -    +    +    +- 240 passed, 0 failed, 1 warning
    +    -    +    +    +- Duration: 13.60s
    +    -    +    +     
    +    -    +    +     ## Frontend (vitest)
    +    -    +    +    -- 39 passed, 0 failed
    +    -    +    +    -- Duration: 2.17s
    +    -    +    +    -- New tests: CreateProjectModal (4)
    +    -    +    +    +- 49 passed, 0 failed
    +    -    +    +    +- Duration: 2.59s
    +    -    +    +     
    +    -    +    +    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    +    -    +    +    index 369350b..d8df0cf 100644
    +    -    +    +    --- a/Forge/scripts/run_audit.ps1
    +    -    +    +    +++ b/Forge/scripts/run_audit.ps1
    +    -    +    +    @@ -1,4 +1,4 @@
    +    -    +    +    -Ôö£├ÂÔö£├éÔö¼ÔòØÔö£├ÂÔö£├éÔö£ÔûÆ├ö├Â┬úÔö£├é├ö├Â┬ú├ö├╗├┤├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬¢# scripts/run_audit.ps1
    +    -    +    +    +# scripts/run_audit.ps1
    +    -    +    +     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    +    -    +    +     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    +    -    +    +     # Reads layer boundaries from Contracts/boundaries.json.
    +    -    +    +    @@ -24,7 +24,7 @@ param(
    +    -    +    +     Set-StrictMode -Version Latest
    +    -    +    +     $ErrorActionPreference = "Stop"
    +    -    +    +     
    +    -    +    +    -# Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Helpers Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +# -- Helpers ------------------------------------------------------------------
    +    -    +    +     
    +    -    +    +     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    +    -    +    +     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    +    -    +    +    @@ -41,7 +41,7 @@ function RepoRoot {
    +    -    +    +       return (& git rev-parse --show-toplevel).Trim()
    +    -    +    +     }
    +    -    +    +     
    +    -    +    +    -# Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Main Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +# -- Main ---------------------------------------------------------------------
    +    -    +    +     
    +    -    +    +     try {
    +    -    +    +       RequireGit
    +    -    +    +    @@ -54,10 +54,10 @@ try {
    +    -    +    +       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    +    -    +    +     
    +    -    +    +       # Parse claimed files into a sorted, normalized set
    +    -    +    +    -  $claimed = $ClaimedFiles.Split(",") |
    +    -    +    +    +  $claimed = @($ClaimedFiles.Split(",") |
    +    -    +    +         ForEach-Object { $_.Trim().Replace("\", "/") } |
    +    -    +    +         Where-Object { $_ -ne "" } |
    +    -    +    +    -    Sort-Object -Unique
    +    -    +    +    +    Sort-Object -Unique)
    +    -    +    +     
    +    -    +    +       if ($claimed.Count -eq 0) {
    +    -    +    +         throw "ClaimedFiles is empty."
    +    -    +    +    @@ -79,7 +79,7 @@ try {
    +    -    +    +       $warnings  = [ordered]@{}
    +    -    +    +       $anyFail   = $false
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A1: Scope compliance Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A1: Scope compliance -----------------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    +    -    +    +    @@ -111,7 +111,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A2: Minimal-diff discipline Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A2: Minimal-diff discipline ----------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         $summaryRaw = & git diff --cached --summary 2>&1
    +    -    +    +    @@ -133,7 +133,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A3: Evidence completeness Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A3: Evidence completeness ------------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         $a3Failures = @()
    +    -    +    +    @@ -164,7 +164,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A4: Boundary compliance (reads Contracts/boundaries.json) Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         $a4Violations = @()
    +    -    +    +    @@ -213,7 +213,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A5: Diff Log Gate Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A5: Diff Log Gate --------------------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         if (-not (Test-Path $diffLog)) {
    +    -    +    +    @@ -237,7 +237,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A6: Authorization Gate Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A6: Authorization Gate ---------------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         $lastAuthHash = $null
    +    -    +    +    @@ -268,7 +268,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A7: Verification hierarchy order Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A7: Verification hierarchy order -----------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         if (-not (Test-Path $diffLog)) {
    +    -    +    +    @@ -324,7 +324,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A8: Test gate Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A8: Test gate ------------------------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         if (-not (Test-Path $testRunsLatest)) {
    +    -    +    +    @@ -344,7 +344,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A9: Dependency gate Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- A9: Dependency gate ------------------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         $a9Failures = @()
    +    -    +    +    @@ -508,7 +508,7 @@ try {
    +    -    +    +         $anyFail = $true
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ W1: No secrets in diff Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- W1: No secrets in diff --------------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         $diffContent = & git diff --cached 2>&1
    +    -    +    +    @@ -534,7 +534,7 @@ try {
    +    -    +    +         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ W2: Audit ledger integrity Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- W2: Audit ledger integrity ----------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         if (-not (Test-Path $auditLedger)) {
    +    -    +    +    @@ -548,7 +548,7 @@ try {
    +    -    +    +         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ W3: Physics route coverage Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- W3: Physics route coverage ----------------------------------------
    +    -    +    +     
    +    -    +    +       try {
    +    -    +    +         if (-not (Test-Path $physicsYaml)) {
    +    -    +    +    @@ -613,7 +613,7 @@ try {
    +    -    +    +         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    +    -    +    +       }
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Build output Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- Build output ------------------------------------------------------
    +    -    +    +     
    +    -    +    +       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    +    -    +    +     
    +    -    +    +    @@ -643,7 +643,7 @@ Overall: $overall
    +    -    +    +     
    +    -    +    +       Write-Output $output
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Append to audit ledger Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- Append to audit ledger ---------------------------------------------
    +    -    +    +     
    +    -    +    +       $iteration = 1
    +    -    +    +       if (Test-Path $auditLedger) {
    +    -    +    +    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    +    -    +    +       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    +    -    +    +       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    +    -    +    +     
    +    -    +    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Exit Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    -    +    +    +  # -- Exit ---------------------------------------------------------------
    +    -    +    +     
    +    -    +    +       if ($anyFail) {
    +    -    +    +         exit 1
    +    -    +    +    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    +    -    +    +    index 2b28280..bd8693a 100644
    +    -    +    +    --- a/web/src/components/QuestionnaireModal.tsx
    +    -    +    +    +++ b/web/src/components/QuestionnaireModal.tsx
    +    -    +    +    @@ -7,6 +7,7 @@
    +    -    +    +      */
    +    -    +    +     import { useState, useEffect, useRef, useCallback } from 'react';
    +    -    +    +     import { useAuth } from '../context/AuthContext';
    +    -    +    +    +import ContractProgress from './ContractProgress';
    +    -    +    +     
    +    -    +    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    -    +    +     
    +    -    +    +    @@ -34,6 +35,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    +    -    +    +     interface ChatMessage {
    +    -    +    +       role: 'user' | 'assistant';
    +    -    +    +       content: string;
    +    -    +    +    +  section?: string;
    +    -    +    +     }
    +    -    +    +     
    +    -    +    +     interface QuestionnaireState {
    +    -    +    +    @@ -150,12 +152,21 @@ const SpeechRecognition =
    +    -    +    +         : null;
    +    -    +    +     
    +    -    +    +     function useSpeechRecognition(onResult: (text: string) => void) {
    +    -    +    +    -  const recognitionRef = useRef<any>(null);
    +    -    +    +       const [listening, setListening] = useState(false);
    +    -    +    +       const listeningRef = useRef(false);
    +    -    +    +    +  const recRef = useRef<any>(null);
    +    -    +    +    +  const onResultRef = useRef(onResult);
    +    -    +    +    +  onResultRef.current = onResult;
    +    -    +    +    +
    +    -    +    +    +  /* Lazily create a single SpeechRecognition instance and keep it for the
    +    -    +    +    +     lifetime of the component.  Browsers throttle or block new instances
    +    -    +    +    +     created outside a user-gesture context, which is why creating a fresh
    +    -    +    +    +     instance on every start() caused the second activation to silently die
    +    -    +    +    +     after a few seconds. */
    +    -    +    +    +  const getRec = useCallback(() => {
    +    -    +    +    +    if (recRef.current) return recRef.current;
    +    -    +    +    +    if (!SpeechRecognition) return null;
    +    -    +    +     
    +    -    +    +    -  useEffect(() => {
    +    -    +    +    -    if (!SpeechRecognition) return;
    +    -    +    +         const rec = new SpeechRecognition();
    +    -    +    +         rec.continuous = true;
    +    -    +    +         rec.interimResults = true;
    +    -    +    +    @@ -169,64 +180,93 @@ function useSpeechRecognition(onResult: (text: string) => void) {
    +    -    +    +             }
    +    -    +    +           }
    +    -    +    +           if (finalTranscript) {
    +    -    +    +    -        onResult(finalTranscript);
    +    -    +    +    +        onResultRef.current(finalTranscript);
    +    -    +    +           }
    +    -    +    +         };
    +    -    +    +     
    +    -    +    +         rec.onerror = (e: any) => {
    +    -    +    +    -      /* 'no-speech' and 'aborted' are normal during pauses Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« auto-restart */
    +    -    +    +           if (e.error === 'no-speech' || e.error === 'aborted') {
    +    -    +    +    +        /* Browser fires these during normal pauses Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« restart if still active */
    +    -    +    +             if (listeningRef.current) {
    +    -    +    +    -          try { rec.start(); } catch { /* already running */ }
    +    -    +    +    +          setTimeout(() => {
    +    -    +    +    +            if (listeningRef.current) {
    +    -    +    +    +              try { rec.start(); } catch { /* already running */ }
    +    -    +    +    +            }
    +    -    +    +    +          }, 300);
    +    -    +    +             }
    +    -    +    +             return;
    +    -    +    +           }
    +    -    +    +    +      /* Real error Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« stop */
    +    -    +    +           listeningRef.current = false;
    +    -    +    +           setListening(false);
    +    -    +    +         };
    +    -    +    +     
    +    -    +    +    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    +    -    +    +         rec.onend = () => {
    +    -    +    +    +      /* Browser ends recognition after silence; auto-restart if user hasn't toggled off */
    +    -    +    +           if (listeningRef.current) {
    +    -    +    +    -        try { rec.start(); } catch { /* already running */ }
    +    -    +    +    -      } else {
    +    -    +    +    -        setListening(false);
    +    -    +    +    +        setTimeout(() => {
    +    -    +    +    +          if (listeningRef.current) {
    +    -    +    +    +            try { rec.start(); } catch { /* already running */ }
    +    -    +    +    +          }
    +    -    +    +    +        }, 300);
    +    -    +    +           }
    +    -    +    +         };
    +    -    +    +     
    +    -    +    +    -    recognitionRef.current = rec;
    +    -    +    +    -    return () => {
    +    -    +    +    -      listeningRef.current = false;
    +    -    +    +    -      rec.abort();
    +    -    +    +    -    };
    +    -    +    +    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    +    -    +    +    +    recRef.current = rec;
    +    -    +    +    +    return rec;
    +    -    +    +       }, []);
    +    -    +    +     
    +    -    +    +    -  const toggle = useCallback(() => {
    +    -    +    +    -    const rec = recognitionRef.current;
    +    -    +    +    +  const stop = useCallback(() => {
    +    -    +    +    +    listeningRef.current = false;
    +    -    +    +    +    setListening(false);
    +    -    +    +    +    const rec = recRef.current;
    +    -    +    +    +    if (rec) {
    +    -    +    +    +      try { rec.stop(); } catch { /* ignore */ }
    +    -    +    +    +    }
    +    -    +    +    +  }, []);
    +    -    +    +    +
    +    -    +    +    +  const start = useCallback(() => {
    +    -    +    +    +    const rec = getRec();
    +    -    +    +         if (!rec) return;
    +    -    +    +    +    /* Stop any active session first, then restart */
    +    -    +    +    +    try { rec.stop(); } catch { /* not running */ }
    +    -    +    +    +    listeningRef.current = true;
    +    -    +    +    +    setListening(true);
    +    -    +    +    +    /* Small delay to let the previous stop() settle */
    +    -    +    +    +    setTimeout(() => {
    +    -    +    +    +      if (listeningRef.current) {
    +    -    +    +    +        try { rec.start(); } catch { /* already running */ }
    +    -    +    +    +      }
    +    -    +    +    +    }, 100);
    +    -    +    +    +  }, [getRec]);
    +    -    +    +    +
    +    -    +    +    +  const toggle = useCallback(() => {
    +    -    +    +         if (listening) {
    +    -    +    +    -      listeningRef.current = false;
    +    -    +    +    -      rec.abort();
    +    -    +    +    -      setListening(false);
    +    -    +    +    +      stop();
    +    -    +    +         } else {
    +    -    +    +    -      listeningRef.current = true;
    +    -    +    +    -      rec.start();
    +    -    +    +    -      setListening(true);
    +    -    +    +    +      start();
    +    -    +    +         }
    +    -    +    +    -  }, [listening]);
    +    -    +    +    +  }, [listening, start, stop]);
    +    -    +    +    +
    +    -    +    +    +  /* Cleanup on unmount */
    +    -    +    +    +  useEffect(() => {
    +    -    +    +    +    return () => {
    +    -    +    +    +      listeningRef.current = false;
    +    -    +    +    +      const rec = recRef.current;
    +    -    +    +    +      recRef.current = null;
    +    -    +    +    +      if (rec) {
    +    -    +    +    +        rec.onresult = null;
    +    -    +    +    +        rec.onerror = null;
    +    -    +    +    +        rec.onend = null;
    +    -    +    +    +        try { rec.abort(); } catch { /* ignore */ }
    +    -    +    +    +      }
    +    -    +    +    +    };
    +    -    +    +    +  }, []);
    +    -    +    +     
    +    -    +    +       return { listening, toggle, supported: !!SpeechRecognition };
    +    -    +    +     }
    +    -    +    +     
    +    -    +    +    -function speak(text: string) {
    +    -    +    +    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    +    -    +    +    -  window.speechSynthesis.cancel();
    +    -    +    +    -  const utter = new SpeechSynthesisUtterance(text);
    +    -    +    +    -  utter.rate = 1.05;
    +    -    +    +    -  utter.pitch = 1;
    +    -    +    +    -  window.speechSynthesis.speak(utter);
    +    -    +    +    -}
    +    -    +    +    +
    +    -    +    +     
    +    -    +    +     /* ------------------------------------------------------------------ */
    +    -    +    +     /*  Progress bar                                                      */
    +    -    +    +    @@ -265,7 +305,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +    +       const [messages, setMessages] = useState<ChatMessage[]>([]);
    +    -    +    +       const [input, setInput] = useState('');
    +    -    +    +       const [sending, setSending] = useState(false);
    +    -    +    +    -  const [generating, setGenerating] = useState(false);
    +    -    +    +       const [qState, setQState] = useState<QuestionnaireState>({
    +    -    +    +         current_section: 'product_intent',
    +    -    +    +         completed_sections: [],
    +    -    +    +    @@ -273,7 +312,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +    +         is_complete: false,
    +    -    +    +       });
    +    -    +    +       const [error, setError] = useState('');
    +    -    +    +    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    +    -    +    +    +  const [resetting, setResetting] = useState(false);
    +    -    +    +    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    +    -    +    +    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    +    -    +    +       const messagesEndRef = useRef<HTMLDivElement>(null);
    +    -    +    +       const textareaRef = useRef<HTMLTextAreaElement>(null);
    +    -    +    +     
    +    -    +    +    @@ -307,13 +348,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +    +                 remaining_sections: state.remaining_sections,
    +    -    +    +                 is_complete: state.is_complete,
    +    -    +    +               });
    +    -    +    +    -          /* Restore prior conversation */
    +    -    +    +    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    +    -    +    +    -            (m: { role: string; content: string }) => ({
    +    -    +    +    -              role: m.role as 'user' | 'assistant',
    +    -    +    +    -              content: m.content,
    +    -    +    +    -            }),
    +    -    +    +    -          );
    +    -    +    +    +          /* Restore prior conversation Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« only messages from the current section */
    +    -    +    +    +          const currentSec = state.current_section;
    +    -    +    +    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    +    -    +    +    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    +    -    +    +    +            .map(
    +    -    +    +    +              (m: { role: string; content: string; section?: string }) => ({
    +    -    +    +    +                role: m.role as 'user' | 'assistant',
    +    -    +    +    +                content: m.content,
    +    -    +    +    +                section: m.section,
    +    -    +    +    +              }),
    +    -    +    +    +            );
    +    -    +    +    +          /* Restore token usage */
    +    -    +    +    +          if (state.token_usage) {
    +    -    +    +    +            setTokenUsage(state.token_usage);
    +    -    +    +    +          }
    +    -    +    +               if (history.length > 0) {
    +    -    +    +                 setMessages(history);
    +    -    +    +               } else if (!state.is_complete) {
    +    -    +    +    @@ -367,18 +416,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +    +           }
    +    -    +    +     
    +    -    +    +           const data = await res.json();
    +    -    +    +    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    +    -    +    +    +
    +    -    +    +    +      /* Detect section transition Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« clear visible messages for a fresh screen */
    +    -    +    +    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    +    -    +    +    +      const prevSection = qState.current_section;
    +    -    +    +    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    +    -    +    +    +
    +    -    +    +    +      if (sectionChanged) {
    +    -    +    +    +        /* Section just completed Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« start fresh with only the transition reply */
    +    -    +    +    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    +    -    +    +    +      } else {
    +    -    +    +    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    +    -    +    +    +      }
    +    -    +    +    +
    +    -    +    +           setQState({
    +    -    +    +    -        current_section: data.remaining_sections[0] ?? null,
    +    -    +    +    +        current_section: newCurrentSection,
    +    -    +    +             completed_sections: data.completed_sections,
    +    -    +    +             remaining_sections: data.remaining_sections,
    +    -    +    +             is_complete: data.is_complete,
    +    -    +    +           });
    +    -    +    +     
    +    -    +    +    -      /* auto-read assistant reply with TTS */
    +    -    +    +    -      if (voiceEnabled) {
    +    -    +    +    -        speak(data.reply);
    +    -    +    +    +      /* Update token usage */
    +    -    +    +    +      if (data.token_usage) {
    +    -    +    +    +        setTokenUsage(data.token_usage);
    +    -    +    +           }
    +    -    +    +    +
    +    -    +    +         } catch {
    +    -    +    +           setError('Network error');
    +    -    +    +         } finally {
    +    -    +    +    @@ -387,25 +449,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +    +       };
    +    -    +    +     
    +    -    +    +       /* ---- Generate contracts ---- */
    +    -    +    +    -  const handleGenerate = async () => {
    +    -    +    +    -    setGenerating(true);
    +    -    +    +    -    setError('');
    +    -    +    +    -    try {
    +    -    +    +    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    -    +    +    -        method: 'POST',
    +    -    +    +    -        headers: { Authorization: `Bearer ${token}` },
    +    -    +    +    -      });
    +    -    +    +    -      if (res.ok) {
    +    -    +    +    -        onContractsGenerated();
    +    -    +    +    -      } else {
    +    -    +    +    -        const d = await res.json().catch(() => ({}));
    +    -    +    +    -        setError(d.detail || 'Failed to generate contracts');
    +    -    +    +    -      }
    +    -    +    +    -    } catch {
    +    -    +    +    -      setError('Network error');
    +    -    +    +    -    } finally {
    +    -    +    +    -      setGenerating(false);
    +    -    +    +    -    }
    +    -    +    +    +  const handleStartGenerate = () => {
    +    -    +    +    +    setGeneratingContracts(true);
    +    -    +    +       };
    +    -    +    +     
    +    -    +    +       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    +    -    +    +    @@ -442,21 +487,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +    +                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    +    -    +    +                       : 'Starting...'}
    +    -    +    +                 </p>
    +    -    +    +    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    +    -    +    +    +              Model: claude-haiku-4-5
    +    -    +    +    +            </p>
    +    -    +    +    +            {/* Context window meter */}
    +    -    +    +    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    +    -    +    +    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    -    +    +    +              const contextWindow = 200_000;
    +    -    +    +    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    +    -    +    +    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    +    -    +    +    +              return (
    +    -    +    +    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    +    -    +    +    +                  <div style={{
    +    -    +    +    +                    flex: 1,
    +    -    +    +    +                    height: '4px',
    +    -    +    +    +                    background: '#1E293B',
    +    -    +    +    +                    borderRadius: '2px',
    +    -    +    +    +                    overflow: 'hidden',
    +    -    +    +    +                    maxWidth: '120px',
    +    -    +    +    +                  }}>
    +    -    +    +    +                    <div style={{
    +    -    +    +    +                      width: `${pct}%`,
    +    -    +    +    +                      height: '100%',
    +    -    +    +    +                      background: barColor,
    +    -    +    +    +                      borderRadius: '2px',
    +    -    +    +    +                      transition: 'width 0.3s',
    +    -    +    +    +                    }} />
    +    -    +    +    +                  </div>
    +    -    +    +    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    +    -    +    +    +                    {totalTokens.toLocaleString()} / 200K
    +    -    +    +    +                  </span>
    +    -    +    +    +                </div>
    +    -    +    +    +              );
    +    -    +    +    +            })()}
    +    -    +    +               </div>
    +    -    +    +               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    +    -    +    +    -            {/* Voice toggle */}
    +    -    +    +    +            {/* Restart questionnaire */}
    +    -    +    +                 <button
    +    -    +    +    -              onClick={() => setVoiceEnabled((v) => !v)}
    +    -    +    +    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    +    -    +    +    -              data-testid="voice-toggle"
    +    -    +    +    +              onClick={async () => {
    +    -    +    +    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    +    -    +    +    +                setResetting(true);
    +    -    +    +    +                try {
    +    -    +    +    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    +    -    +    +    +                    method: 'DELETE',
    +    -    +    +    +                    headers: { Authorization: `Bearer ${token}` },
    +    -    +    +    +                  });
    +    -    +    +    +                  if (res.ok) {
    +    -    +    +    +                    setMessages([]);
    +    -    +    +    +                    setQState({
    +    -    +    +    +                      current_section: 'product_intent',
    +    -    +    +    +                      completed_sections: [],
    +    -    +    +    +                      remaining_sections: [...ALL_SECTIONS],
    +    -    +    +    +                      is_complete: false,
    +    -    +    +    +                    });
    +    -    +    +    +                    setInput('');
    +    -    +    +    +                    setError('');
    +    -    +    +    +                  }
    +    -    +    +    +                } catch { /* ignore */ }
    +    -    +    +    +                setResetting(false);
    +    -    +    +    +              }}
    +    -    +    +    +              disabled={resetting}
    +    -    +    +    +              title="Restart questionnaire"
    +    -    +    +    +              data-testid="restart-btn"
    +    -    +    +                   style={{
    +    -    +    +                     ...btnGhost,
    +    -    +    +                     padding: '6px 10px',
    +    -    +    +    -                fontSize: '1rem',
    +    -    +    +    -                opacity: voiceEnabled ? 1 : 0.5,
    +    -    +    +    +                fontSize: '0.7rem',
    +    -    +    +    +                fontWeight: 600,
    +    -    +    +    +                color: '#F59E0B',
    +    -    +    +    +                borderColor: '#F59E0B33',
    +    -    +    +    +                opacity: resetting ? 0.5 : 1,
    +    -    +    +                   }}
    +    -    +    +                 >
    +    -    +    +    -              {voiceEnabled ? 'Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬╝Ôö£┬í├ö├Â┬úÔö£Ôòæ├ö├Â┬úÔö£├æÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├Â├ë' : 'Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬╝Ôö£┬í├ö├Â┬úÔö£Ôòæ├ö├Â┬úÔö£├æÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª'}
    +    -    +    +    +              Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬¬├ö├Â┬úÔö£├é├ö├Â┬ú├ö├╗├┤├ö├Â┬ú├ö├▓├║ Restart
    +    -    +    +                 </button>
    +    -    +    +                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    +    -    +    +                   Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔòùÔö£Ôöñ
    +    -    +    +    @@ -514,8 +617,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +    +               </div>
    +    -    +    +             )}
    +    -    +    +     
    +    -    +    +    +        {/* Contract generation progress */}
    +    -    +    +    +        {generatingContracts && (
    +    -    +    +    +          <ContractProgress
    +    -    +    +    +            projectId={projectId}
    +    -    +    +    +            tokenUsage={tokenUsage}
    +    -    +    +    +            model="claude-haiku-4-5"
    +    -    +    +    +            onComplete={onContractsGenerated}
    +    -    +    +    +          />
    +    -    +    +    +        )}
    +    -    +    +    +
    +    -    +    +             {/* Generate contracts banner */}
    +    -    +    +    -        {qState.is_complete && (
    +    -    +    +    +        {qState.is_complete && !generatingContracts && (
    +    -    +    +               <div
    +    -    +    +                 style={{
    +    -    +    +                   padding: '12px 20px',
    +    -    +    +    @@ -533,17 +646,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +    +                   Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£ÔûÆ All sections complete Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« ready to generate contracts
    +    -    +    +                 </span>
    +    -    +    +                 <button
    +    -    +    +    -              onClick={handleGenerate}
    +    -    +    +    -              disabled={generating}
    +    -    +    +    +              onClick={handleStartGenerate}
    +    -    +    +                   data-testid="generate-contracts-btn"
    +    -    +    +                   style={{
    +    -    +    +                     ...btnPrimary,
    +    -    +    +                     background: '#16A34A',
    +    -    +    +    -                opacity: generating ? 0.6 : 1,
    +    -    +    +    -                cursor: generating ? 'wait' : 'pointer',
    +    -    +    +    +                cursor: 'pointer',
    +    -    +    +                   }}
    +    -    +    +                 >
    +    -    +    +    -              {generating ? 'Generating...' : 'Generate Contracts'}
    +    -    +    +    +              Generate Contracts
    +    -    +    +                 </button>
    +    -    +    +               </div>
    +    -    +    +             )}
    +    -    +     
    +    -    +    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    +    -    +    index 369350b..d8df0cf 100644
    +    -    +    --- a/Forge/scripts/run_audit.ps1
    +    -    +    +++ b/Forge/scripts/run_audit.ps1
    +    -    +    @@ -1,4 +1,4 @@
    +    -    +    -├ö├Â┬╝├ö├Â├▒Ôö£├ÂÔö£ÔûôÔö£ÔòúÔö£├ÂÔö£├éÔö£├½# scripts/run_audit.ps1
    +    -    +    +# scripts/run_audit.ps1
    +    -    +     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    +    -    +     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    +    -    +     # Reads layer boundaries from Contracts/boundaries.json.
    +    -    +    @@ -24,7 +24,7 @@ param(
    +    -    +     Set-StrictMode -Version Latest
    +    -    +     $ErrorActionPreference = "Stop"
    +    -    +     
    +    -    +    -# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Helpers ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +# -- Helpers ------------------------------------------------------------------
    +    -    +     
    +    -    +     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    +    -    +     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    +    -    +    @@ -41,7 +41,7 @@ function RepoRoot {
    +    -    +       return (& git rev-parse --show-toplevel).Trim()
    +    -    +     }
    +    -    +     
    +    -    +    -# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Main ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +# -- Main ---------------------------------------------------------------------
    +    -    +     
    +    -    +     try {
    +    -    +       RequireGit
    +    -    +    @@ -54,10 +54,10 @@ try {
    +    -    +       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    +    -    +     
    +    -    +       # Parse claimed files into a sorted, normalized set
    +    -    +    -  $claimed = $ClaimedFiles.Split(",") |
    +    -    +    +  $claimed = @($ClaimedFiles.Split(",") |
    +    -    +         ForEach-Object { $_.Trim().Replace("\", "/") } |
    +    -    +         Where-Object { $_ -ne "" } |
    +    -    +    -    Sort-Object -Unique
    +    -    +    +    Sort-Object -Unique)
    +    -    +     
    +    -    +       if ($claimed.Count -eq 0) {
    +    -    +         throw "ClaimedFiles is empty."
    +    -    +    @@ -79,7 +79,7 @@ try {
    +    -    +       $warnings  = [ordered]@{}
    +    -    +       $anyFail   = $false
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A1: Scope compliance ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A1: Scope compliance -----------------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    +    -    +    @@ -111,7 +111,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A2: Minimal-diff discipline ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A2: Minimal-diff discipline ----------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         $summaryRaw = & git diff --cached --summary 2>&1
    +    -    +    @@ -133,7 +133,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A3: Evidence completeness ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A3: Evidence completeness ------------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         $a3Failures = @()
    +    -    +    @@ -164,7 +164,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A4: Boundary compliance (reads Contracts/boundaries.json) ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
    +    -    +     
    +    -    +       try {
    +    -    +         $a4Violations = @()
    +    -    +    @@ -213,7 +213,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A5: Diff Log Gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A5: Diff Log Gate --------------------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         if (-not (Test-Path $diffLog)) {
    +    -    +    @@ -237,7 +237,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A6: Authorization Gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A6: Authorization Gate ---------------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         $lastAuthHash = $null
    +    -    +    @@ -268,7 +268,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A7: Verification hierarchy order ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A7: Verification hierarchy order -----------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         if (-not (Test-Path $diffLog)) {
    +    -    +    @@ -324,7 +324,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A8: Test gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A8: Test gate ------------------------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         if (-not (Test-Path $testRunsLatest)) {
    +    -    +    @@ -344,7 +344,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A9: Dependency gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- A9: Dependency gate ------------------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         $a9Failures = @()
    +    -    +    @@ -508,7 +508,7 @@ try {
    +    -    +         $anyFail = $true
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W1: No secrets in diff ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- W1: No secrets in diff --------------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         $diffContent = & git diff --cached 2>&1
    +    -    +    @@ -534,7 +534,7 @@ try {
    +    -    +         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W2: Audit ledger integrity ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- W2: Audit ledger integrity ----------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         if (-not (Test-Path $auditLedger)) {
    +    -    +    @@ -548,7 +548,7 @@ try {
    +    -    +         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W3: Physics route coverage ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- W3: Physics route coverage ----------------------------------------
    +    -    +     
    +    -    +       try {
    +    -    +         if (-not (Test-Path $physicsYaml)) {
    +    -    +    @@ -613,7 +613,7 @@ try {
    +    -    +         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    +    -    +       }
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Build output ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- Build output ------------------------------------------------------
    +    -    +     
    +    -    +       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    +    -    +     
    +    -    +    @@ -643,7 +643,7 @@ Overall: $overall
    +    -    +     
    +    -    +       Write-Output $output
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Append to audit ledger ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- Append to audit ledger ---------------------------------------------
    +    -    +     
    +    -    +       $iteration = 1
    +    -    +       if (Test-Path $auditLedger) {
    +    -    +    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    +    -    +       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    +    -    +       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    +    -    +     
    +    -    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Exit ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    -    +    +  # -- Exit ---------------------------------------------------------------
    +    -    +     
    +    -    +       if ($anyFail) {
    +    -    +         exit 1
    +    -    +    diff --git a/USER_INSTRUCTIONS.md b/USER_INSTRUCTIONS.md
    +    -    +    index c76b33a..ad50c71 100644
    +    -    +    --- a/USER_INSTRUCTIONS.md
    +    -    +    +++ b/USER_INSTRUCTIONS.md
    +    -    +    @@ -87,7 +87,7 @@ APP_URL=http://localhost:8000
    +    -    +     - `APP_URL` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® `http://localhost:8000`
    +    -    +     - `ANTHROPIC_API_KEY` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® required for AI-powered builds (get one at [console.anthropic.com](https://console.anthropic.com))
    +    -    +     - `LLM_BUILDER_MODEL` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® model for builds (default: `claude-opus-4-6`)
    +    -    +    -- `LLM_QUESTIONNAIRE_MODEL` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® model for questionnaire (default: `claude-3-5-haiku-20241022`)
    +    -    +    +- `LLM_QUESTIONNAIRE_MODEL` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® model for questionnaire (default: `claude-haiku-4-5`)
    +    -    +     
    +    -    +     ---
    +    -    +     
    +    -    +    diff --git a/app/api/routers/auth.py b/app/api/routers/auth.py
    +    -    +    index dffd10d..cf3df44 100644
    +    -    +    --- a/app/api/routers/auth.py
    +    -    +    +++ b/app/api/routers/auth.py
    +    -    +    @@ -1,13 +1,15 @@
    +    -    +    -"""Authentication router -- GitHub OAuth flow and user info."""
    +    -    +    +"""Authentication router -- GitHub OAuth flow, user info, and BYOK API key management."""
    +    -    +     
    +    -    +     import secrets
    +    -    +     from urllib.parse import urlencode
    +    -    +     
    +    -    +     from fastapi import APIRouter, Depends, HTTPException, Query, status
    +    -    +    +from pydantic import BaseModel
    +    -    +     
    +    -    +     from app.api.deps import get_current_user
    +    -    +     from app.clients.github_client import GITHUB_OAUTH_URL
    +    -    +     from app.config import settings
    +    -    +    +from app.repos.user_repo import set_anthropic_api_key
    +    -    +     from app.services.auth_service import handle_github_callback
    +    -    +     
    +    -    +     router = APIRouter(prefix="/auth", tags=["auth"])
    +    -    +    @@ -66,8 +68,36 @@ async def get_current_user_info(
    +    -    +         current_user: dict = Depends(get_current_user),
    +    -    +     ) -> dict:
    +    -    +         """Return the current authenticated user info."""
    +    -    +    +    has_api_key = bool(current_user.get("anthropic_api_key"))
    +    -    +         return {
    +    -    +             "id": str(current_user["id"]),
    +    -    +             "github_login": current_user["github_login"],
    +    -    +             "avatar_url": current_user.get("avatar_url"),
    +    -    +    +        "has_anthropic_key": has_api_key,
    +    -    +         }
    +    -    +    +
    +    -    +    +
    +    -    +    +class ApiKeyBody(BaseModel):
    +    -    +    +    api_key: str
    +    -    +    +
    +    -    +    +
    +    -    +    +@router.put("/api-key")
    +    -    +    +async def save_api_key(
    +    -    +    +    body: ApiKeyBody,
    +    -    +    +    current_user: dict = Depends(get_current_user),
    +    -    +    +) -> dict:
    +    -    +    +    """Save the user's Anthropic API key for BYOK builds."""
    +    -    +    +    key = body.api_key.strip()
    +    -    +    +    if not key:
    +    -    +    +        raise HTTPException(status_code=400, detail="API key cannot be empty")
    +    -    +    +    await set_anthropic_api_key(current_user["id"], key)
    +    -    +    +    return {"saved": True}
    +    -    +    +
    +    -    +    +
    +    -    +    +@router.delete("/api-key")
    +    -    +    +async def remove_api_key(
    +    -    +    +    current_user: dict = Depends(get_current_user),
    +    -    +    +) -> dict:
    +    -    +    +    """Remove the user's stored Anthropic API key."""
    +    -    +    +    await set_anthropic_api_key(current_user["id"], None)
    +    -    +    +    return {"removed": True}
    +    -    +    diff --git a/app/api/routers/projects.py b/app/api/routers/projects.py
    +    -    +    index 0e72551..cc00763 100644
    +    -    +    --- a/app/api/routers/projects.py
    +    -    +    +++ b/app/api/routers/projects.py
    +    -    +    @@ -17,6 +17,7 @@ from app.services.project_service import (
    +    -    +         list_contracts,
    +    -    +         list_user_projects,
    +    -    +         process_questionnaire_message,
    +    -    +    +    reset_questionnaire,
    +    -    +         update_contract,
    +    -    +     )
    +    -    +     
    +    -    +    @@ -177,6 +178,20 @@ async def questionnaire_progress(
    +    -    +             )
    +    -    +     
    +    -    +     
    +    -    +    +@router.delete("/{project_id}/questionnaire")
    +    -    +    +async def questionnaire_reset(
    +    -    +    +    project_id: UUID,
    +    -    +    +    current_user: dict = Depends(get_current_user),
    +    -    +    +) -> dict:
    +    -    +    +    """Reset questionnaire to start over."""
    +    -    +    +    try:
    +    -    +    +        return await reset_questionnaire(current_user["id"], project_id)
    +    -    +    +    except ValueError as exc:
    +    -    +    +        raise HTTPException(
    +    -    +    +            status_code=status.HTTP_404_NOT_FOUND, detail=str(exc)
    +    -    +    +        )
    +    -    +    +
    +    -    +    +
    +    -    +     # ---------------------------------------------------------------------------
    +    -    +     # Contracts
    +    -    +     # ---------------------------------------------------------------------------
    +    -    +    diff --git a/app/clients/llm_client.py b/app/clients/llm_client.py
    +    -    +    index 60b0218..19622bd 100644
    +    -    +    --- a/app/clients/llm_client.py
    +    -    +    +++ b/app/clients/llm_client.py
    +    -    +    @@ -47,13 +47,20 @@ async def chat_anthropic(
    +    -    +                 raise ValueError(f"Anthropic API {response.status_code}: {err_msg}")
    +    -    +     
    +    -    +         data = response.json()
    +    -    +    +    usage = data.get("usage", {})
    +    -    +         content_blocks = data.get("content", [])
    +    -    +         if not content_blocks:
    +    -    +             raise ValueError("Empty response from Anthropic API")
    +    -    +     
    +    -    +         for block in content_blocks:
    +    -    +             if block.get("type") == "text":
    +    -    +    -            return block["text"]
    +    -    +    +            return {
    +    -    +    +                "text": block["text"],
    +    -    +    +                "usage": {
    +    -    +    +                    "input_tokens": usage.get("input_tokens", 0),
    +    -    +    +                    "output_tokens": usage.get("output_tokens", 0),
    +    -    +    +                },
    +    -    +    +            }
    +    -    +     
    +    -    +         raise ValueError("No text block in Anthropic API response")
    +    -    +     
    +    -    +    @@ -112,7 +119,14 @@ async def chat_openai(
    +    -    +         if not content:
    +    -    +             raise ValueError("No content in OpenAI API response")
    +    -    +     
    +    -    +    -    return content
    +    -    +    +    usage = data.get("usage", {})
    +    -    +    +    return {
    +    -    +    +        "text": content,
    +    -    +    +        "usage": {
    +    -    +    +            "input_tokens": usage.get("prompt_tokens", 0),
    +    -    +    +            "output_tokens": usage.get("completion_tokens", 0),
    +    -    +    +        },
    +    -    +    +    }
    +    -    +     
    +    -    +     
    +    -    +     # ---------------------------------------------------------------------------
    +    -    +    @@ -147,8 +161,8 @@ async def chat(
    +    -    +     
    +    -    +         Returns
    +    -    +         -------
    +    -    +    -    str
    +    -    +    -        The assistant's text reply.
    +    -    +    +    dict
    +    -    +    +        ``{"text": str, "usage": {"input_tokens": int, "output_tokens": int}}``
    +    -    +         """
    +    -    +         if provider == "openai":
    +    -    +             return await chat_openai(api_key, model, system_prompt, messages, max_tokens)
    +    -    +    diff --git a/app/config.py b/app/config.py
    +    -    +    index dcff943..0845923 100644
    +    -    +    --- a/app/config.py
    +    -    +    +++ b/app/config.py
    +    -    +    @@ -44,7 +44,7 @@ class Settings:
    +    -    +         FRONTEND_URL: str = os.getenv("FRONTEND_URL", "http://localhost:5173")
    +    -    +         APP_URL: str = os.getenv("APP_URL", "http://localhost:8000")
    +    -    +         LLM_QUESTIONNAIRE_MODEL: str = os.getenv(
    +    -    +    -        "LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022"
    +    -    +    +        "LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5"
    +    -    +         )
    +    -    +         ANTHROPIC_API_KEY: str = os.getenv("ANTHROPIC_API_KEY", "")
    +    -    +         OPENAI_API_KEY: str = os.getenv("OPENAI_API_KEY", "")
    +    -    +    diff --git a/app/repos/audit_repo.py b/app/repos/audit_repo.py
    +    -    +    index 2bc2568..f30784b 100644
    +    -    +    --- a/app/repos/audit_repo.py
    +    -    +    +++ b/app/repos/audit_repo.py
    +    -    +    @@ -63,6 +63,26 @@ async def update_audit_run(
    +    -    +         )
    +    -    +     
    +    -    +     
    +    -    +    +async def mark_stale_audit_runs(repo_id: UUID, stale_minutes: int = 5) -> int:
    +    -    +    +    """Mark audit runs stuck in 'pending' or 'running' for longer than
    +    -    +    +    *stale_minutes* as 'error'. Returns the number of rows updated."""
    +    -    +    +    pool = await get_pool()
    +    -    +    +    result = await pool.execute(
    +    -    +    +        """
    +    -    +    +        UPDATE audit_runs
    +    -    +    +        SET status = 'error', overall_result = 'ERROR',
    +    -    +    +            completed_at = now()
    +    -    +    +        WHERE repo_id = $1
    +    -    +    +          AND status IN ('pending', 'running')
    +    -    +    +          AND created_at < now() - ($2 || ' minutes')::interval
    +    -    +    +        """,
    +    -    +    +        repo_id,
    +    -    +    +        str(stale_minutes),
    +    -    +    +    )
    +    -    +    +    # asyncpg returns 'UPDATE N'
    +    -    +    +    return int(result.split()[-1])
    +    -    +    +
    +    -    +    +
    +    -    +     async def insert_audit_checks(
    +    -    +         audit_run_id: UUID,
    +    -    +         checks: list[dict],
    +    -    +    diff --git a/app/repos/user_repo.py b/app/repos/user_repo.py
    +    -    +    index f8a2386..689f7a9 100644
    +    -    +    --- a/app/repos/user_repo.py
    +    -    +    +++ b/app/repos/user_repo.py
    +    -    +    @@ -38,7 +38,17 @@ async def get_user_by_id(user_id: UUID) -> dict | None:
    +    -    +         """Fetch a user by primary key. Returns None if not found."""
    +    -    +         pool = await get_pool()
    +    -    +         row = await pool.fetchrow(
    +    -    +    -        "SELECT id, github_id, github_login, avatar_url, access_token, created_at, updated_at FROM users WHERE id = $1",
    +    -    +    +        "SELECT id, github_id, github_login, avatar_url, access_token, anthropic_api_key, created_at, updated_at FROM users WHERE id = $1",
    +    -    +             user_id,
    +    -    +         )
    +    -    +         return dict(row) if row else None
    +    -    +    +
    +    -    +    +
    +    -    +    +async def set_anthropic_api_key(user_id: UUID, api_key: str | None) -> None:
    +    -    +    +    """Store (or clear) the user's Anthropic API key."""
    +    -    +    +    pool = await get_pool()
    +    -    +    +    await pool.execute(
    +    -    +    +        "UPDATE users SET anthropic_api_key = $2, updated_at = now() WHERE id = $1",
    +    -    +    +        user_id,
    +    -    +    +        api_key,
    +    -    +    +    )
    +    -    +    diff --git a/app/services/audit_service.py b/app/services/audit_service.py
    +    -    +    index ab835fe..1bf0d18 100644
    +    -    +    --- a/app/services/audit_service.py
    +    -    +    +++ b/app/services/audit_service.py
    +    -    +    @@ -1,5 +1,6 @@
    +    -    +     """Audit service -- orchestrates audit execution triggered by webhooks."""
    +    -    +     
    +    -    +    +import asyncio
    +    -    +     import json
    +    -    +     import logging
    +    -    +     import os
    +    -    +    @@ -12,6 +13,7 @@ from app.repos.audit_repo import (
    +    -    +         create_audit_run,
    +    -    +         get_existing_commit_shas,
    +    -    +         insert_audit_checks,
    +    -    +    +    mark_stale_audit_runs,
    +    -    +         update_audit_run,
    +    -    +     )
    +    -    +     from app.repos.repo_repo import get_repo_by_github_id, get_repo_by_id
    +    -    +    @@ -288,6 +290,11 @@ async def backfill_repo_commits(
    +    -    +         full_name = repo["full_name"]
    +    -    +         branch = repo.get("default_branch", "main")
    +    -    +     
    +    -    +    +    # Clean up any audit runs left stuck from a prior interrupted sync
    +    -    +    +    cleaned = await mark_stale_audit_runs(repo_id)
    +    -    +    +    if cleaned:
    +    -    +    +        logger.info("Cleaned %d stale audit runs for repo %s", cleaned, repo_id)
    +    -    +    +
    +    -    +         # Find the latest audit we already have so we only pull newer commits
    +    -    +         existing_shas = await get_existing_commit_shas(repo_id)
    +    -    +     
    +    -    +    @@ -365,6 +372,16 @@ async def backfill_repo_commits(
    +    -    +                 )
    +    -    +                 synced += 1
    +    -    +     
    +    -    +    +        except asyncio.CancelledError:
    +    -    +    +            logger.warning("Backfill cancelled for commit %s", sha)
    +    -    +    +            await update_audit_run(
    +    -    +    +                audit_run_id=audit_run["id"],
    +    -    +    +                status="error",
    +    -    +    +                overall_result="ERROR",
    +    -    +    +                files_checked=0,
    +    -    +    +            )
    +    -    +    +            raise  # re-raise so the request terminates properly
    +    -    +    +
    +    -    +             except Exception:
    +    -    +                 logger.exception("Backfill failed for commit %s", sha)
    +    -    +                 await update_audit_run(
    +    -    +    diff --git a/app/services/build_service.py b/app/services/build_service.py
    +    -    +    index e98f439..2dcc4bb 100644
    +    -    +    --- a/app/services/build_service.py
    +    -    +    +++ b/app/services/build_service.py
    +    -    +    @@ -17,6 +17,7 @@ from app.clients.agent_client import StreamUsage, stream_agent
    +    -    +     from app.config import settings
    +    -    +     from app.repos import build_repo
    +    -    +     from app.repos import project_repo
    +    -    +    +from app.repos.user_repo import get_user_by_id
    +    -    +     from app.ws_manager import manager
    +    -    +     
    +    -    +     # Maximum consecutive loopback failures before stopping
    +    -    +    @@ -31,9 +32,25 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
    +    -    +     # Active build tasks keyed by build_id
    +    -    +     _active_tasks: dict[str, asyncio.Task] = {}
    +    -    +     
    +    -    +    -# Cost-per-token estimates (USD) -- updated as pricing changes
    +    -    +    -_COST_PER_INPUT_TOKEN: Decimal = Decimal("0.000015")   # $15 / 1M input tokens
    +    -    +    -_COST_PER_OUTPUT_TOKEN: Decimal = Decimal("0.000075")  # $75 / 1M output tokens
    +    -    +    +# Cost-per-token estimates (USD) keyed by model prefix -- updated as pricing changes
    +    -    +    +_MODEL_PRICING: dict[str, tuple[Decimal, Decimal]] = {
    +    -    +    +    # (input $/token, output $/token)
    +    -    +    +    "claude-opus-4":       (Decimal("0.000015"),  Decimal("0.000075")),   # $15 / $75 per 1M
    +    -    +    +    "claude-sonnet-4":     (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    +    -    +    +    "claude-haiku-4":      (Decimal("0.000001"),  Decimal("0.000005")),   # $1 / $5 per 1M
    +    -    +    +    "claude-3-5-sonnet":   (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    +    -    +    +}
    +    -    +    +# Fallback: Opus pricing (most expensive = safest default)
    +    -    +    +_DEFAULT_INPUT_RATE = Decimal("0.000015")
    +    -    +    +_DEFAULT_OUTPUT_RATE = Decimal("0.000075")
    +    -    +    +
    +    -    +    +
    +    -    +    +def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
    +    -    +    +    """Return (input_rate, output_rate) per token for the given model."""
    +    -    +    +    for prefix, rates in _MODEL_PRICING.items():
    +    -    +    +        if model.startswith(prefix):
    +    -    +    +            return rates
    +    -    +    +    return (_DEFAULT_INPUT_RATE, _DEFAULT_OUTPUT_RATE)
    +    -    +     
    +    -    +     
    +    -    +     # ---------------------------------------------------------------------------
    +    -    +    @@ -72,6 +89,14 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    -    +         if latest and latest["status"] in ("pending", "running"):
    +    -    +             raise ValueError("A build is already in progress for this project")
    +    -    +     
    +    -    +    +    # BYOK: user must supply their own Anthropic API key for builds
    +    -    +    +    user = await get_user_by_id(user_id)
    +    -    +    +    user_api_key = (user or {}).get("anthropic_api_key") or ""
    +    -    +    +    if not user_api_key.strip():
    +    -    +    +        raise ValueError(
    +    -    +    +            "Anthropic API key required. Add your key in Settings to start a build."
    +    -    +    +        )
    +    -    +    +
    +    -    +         # Create build record
    +    -    +         build = await build_repo.create_build(project_id)
    +    -    +     
    +    -    +    @@ -80,7 +105,7 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    -    +     
    +    -    +         # Spawn background task
    +    -    +         task = asyncio.create_task(
    +    -    +    -        _run_build(build["id"], project_id, user_id, contracts)
    +    -    +    +        _run_build(build["id"], project_id, user_id, contracts, user_api_key)
    +    -    +         )
    +    -    +         _active_tasks[str(build["id"])] = task
    +    -    +     
    +    -    +    @@ -196,6 +221,7 @@ async def _run_build(
    +    -    +         project_id: UUID,
    +    -    +         user_id: UUID,
    +    -    +         contracts: list[dict],
    +    -    +    +    api_key: str,
    +    -    +     ) -> None:
    +    -    +         """Background task that orchestrates the full build lifecycle.
    +    -    +     
    +    -    +    @@ -232,7 +258,7 @@ async def _run_build(
    +    -    +     
    +    -    +             # Stream agent output
    +    -    +             async for chunk in stream_agent(
    +    -    +    -            api_key=settings.ANTHROPIC_API_KEY,
    +    -    +    +            api_key=api_key,
    +    -    +                 model=settings.LLM_BUILDER_MODEL,
    +    -    +                 system_prompt="You are an autonomous software builder operating under the Forge governance framework.",
    +    -    +                 messages=messages,
    +    -    +    @@ -446,8 +472,9 @@ async def _record_phase_cost(
    +    -    +         input_t = usage.input_tokens
    +    -    +         output_t = usage.output_tokens
    +    -    +         model = usage.model or settings.LLM_BUILDER_MODEL
    +    -    +    -    cost = (Decimal(input_t) * _COST_PER_INPUT_TOKEN
    +    -    +    -            + Decimal(output_t) * _COST_PER_OUTPUT_TOKEN)
    +    -    +    +    input_rate, output_rate = _get_token_rates(model)
    +    -    +    +    cost = (Decimal(input_t) * input_rate
    +    -    +    +            + Decimal(output_t) * output_rate)
    +    -    +         await build_repo.record_build_cost(
    +    -    +             build_id, phase, input_t, output_t, model, cost
    +    -    +         )
    +    -    +    diff --git a/app/services/project_service.py b/app/services/project_service.py
    +    -    +    index 46ab7de..491922c 100644
    +    -    +    --- a/app/services/project_service.py
    +    -    +    +++ b/app/services/project_service.py
    +    -    +    @@ -7,6 +7,7 @@ from uuid import UUID
    +    -    +     
    +    -    +     from app.clients.llm_client import chat as llm_chat
    +    -    +     from app.config import settings
    +    -    +    +from app.ws_manager import manager
    +    -    +     from app.repos.project_repo import (
    +    -    +         create_project as repo_create_project,
    +    -    +         delete_project as repo_delete_project,
    +    -    +    @@ -244,7 +245,7 @@ async def process_questionnaire_message(
    +    -    +         )
    +    -    +     
    +    -    +         try:
    +    -    +    -        raw_reply = await llm_chat(
    +    -    +    +        llm_result = await llm_chat(
    +    -    +                 api_key=llm_api_key,
    +    -    +                 model=llm_model,
    +    -    +                 system_prompt=dynamic_system,
    +    -    +    @@ -255,6 +256,8 @@ async def process_questionnaire_message(
    +    -    +             logger.exception("LLM chat failed for project %s", project_id)
    +    -    +             raise ValueError(f"LLM service error: {exc}") from exc
    +    -    +     
    +    -    +    +    raw_reply = llm_result["text"]
    +    -    +    +    usage = llm_result.get("usage", {})
    +    -    +         logger.info("LLM raw response (first 500 chars): %s", raw_reply[:500])
    +    -    +     
    +    -    +         # Parse the structured JSON response from the LLM
    +    -    +    @@ -263,19 +266,42 @@ async def process_questionnaire_message(
    +    -    +                     parsed.get("section_complete"), parsed.get("section"))
    +    -    +     
    +    -    +         # Update state based on LLM response
    +    -    +    -    history.append({"role": "user", "content": message})
    +    -    +    -    history.append({"role": "assistant", "content": parsed["reply"]})
    +    -    +    +    history.append({"role": "user", "content": message, "section": current_section})
    +    -    +     
    +    -    +    -    if parsed.get("section_complete") and parsed.get("extracted_data"):
    +    -    +    +    # If section just completed, tag the assistant reply with the NEXT section
    +    -    +    +    # so it appears in the new section's chat (it contains the transition question).
    +    -    +    +    section_just_completed = (
    +    -    +    +        parsed.get("section_complete") and parsed.get("extracted_data")
    +    -    +    +    )
    +    -    +    +    if section_just_completed:
    +    -    +             section_name = parsed.get("section", current_section)
    +    -    +             answers[section_name] = parsed["extracted_data"]
    +    -    +             if section_name not in completed:
    +    -    +                 completed.append(section_name)
    +    -    +    +        # Determine the next section (if any) for tagging the reply
    +    -    +    +        next_section = None
    +    -    +    +        for s in QUESTIONNAIRE_SECTIONS:
    +    -    +    +            if s not in completed:
    +    -    +    +                next_section = s
    +    -    +    +                break
    +    -    +    +        reply_section = next_section or current_section
    +    -    +    +    else:
    +    -    +    +        reply_section = current_section
    +    -    +    +
    +    -    +    +    history.append({"role": "assistant", "content": parsed["reply"], "section": reply_section})
    +    -    +    +
    +    -    +    +    # Accumulate token usage
    +    -    +    +    prev_usage = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    +    -    +    +    total_usage = {
    +    -    +    +        "input_tokens": prev_usage.get("input_tokens", 0) + usage.get("input_tokens", 0),
    +    -    +    +        "output_tokens": prev_usage.get("output_tokens", 0) + usage.get("output_tokens", 0),
    +    -    +    +    }
    +    -    +     
    +    -    +         new_state = {
    +    -    +             "completed_sections": completed,
    +    -    +             "answers": answers,
    +    -    +             "conversation_history": history,
    +    -    +    +        "token_usage": total_usage,
    +    -    +         }
    +    -    +         await update_questionnaire_state(project_id, new_state)
    +    -    +     
    +    -    +    @@ -292,6 +318,7 @@ async def process_questionnaire_message(
    +    -    +             "completed_sections": completed,
    +    -    +             "remaining_sections": remaining,
    +    -    +             "is_complete": is_complete,
    +    -    +    +        "token_usage": total_usage,
    +    -    +         }
    +    -    +     
    +    -    +     
    +    -    +    @@ -309,9 +336,26 @@ async def get_questionnaire_state(
    +    -    +         qs = project.get("questionnaire_state") or {}
    +    -    +         progress = _questionnaire_progress(qs)
    +    -    +         progress["conversation_history"] = qs.get("conversation_history", [])
    +    -    +    +    progress["token_usage"] = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    +    -    +         return progress
    +    -    +     
    +    -    +     
    +    -    +    +async def reset_questionnaire(
    +    -    +    +    user_id: UUID,
    +    -    +    +    project_id: UUID,
    +    -    +    +) -> dict:
    +    -    +    +    """Clear all questionnaire state and reset the project to draft."""
    +    -    +    +    project = await get_project_by_id(project_id)
    +    -    +    +    if not project:
    +    -    +    +        raise ValueError("Project not found")
    +    -    +    +    if str(project["user_id"]) != str(user_id):
    +    -    +    +        raise ValueError("Project not found")
    +    -    +    +
    +    -    +    +    await update_questionnaire_state(project_id, {})
    +    -    +    +    await update_project_status(project_id, "draft")
    +    -    +    +    return {"status": "reset"}
    +    -    +    +
    +    -    +    +
    +    -    +     # ---------------------------------------------------------------------------
    +    -    +     # Contract generation
    +    -    +     # ---------------------------------------------------------------------------
    +    -    +    @@ -344,7 +388,20 @@ async def generate_contracts(
    +    -    +         template_vars = _build_template_vars(project, answers)
    +    -    +     
    +    -    +         generated = []
    +    -    +    -    for contract_type in CONTRACT_TYPES:
    +    -    +    +    total = len(CONTRACT_TYPES)
    +    -    +    +    for idx, contract_type in enumerate(CONTRACT_TYPES):
    +    -    +    +        # Notify client that generation of this contract has started
    +    -    +    +        await manager.send_to_user(str(user_id), {
    +    -    +    +            "type": "contract_progress",
    +    -    +    +            "payload": {
    +    -    +    +                "project_id": str(project_id),
    +    -    +    +                "contract_type": contract_type,
    +    -    +    +                "status": "generating",
    +    -    +    +                "index": idx,
    +    -    +    +                "total": total,
    +    -    +    +            },
    +    -    +    +        })
    +    -    +    +
    +    -    +             content = _render_template(contract_type, template_vars)
    +    -    +             row = await upsert_contract(project_id, contract_type, content)
    +    -    +             generated.append({
    +    -    +    @@ -356,6 +413,18 @@ async def generate_contracts(
    +    -    +                 "updated_at": row["updated_at"],
    +    -    +             })
    +    -    +     
    +    -    +    +        # Notify client that this contract is done
    +    -    +    +        await manager.send_to_user(str(user_id), {
    +    -    +    +            "type": "contract_progress",
    +    -    +    +            "payload": {
    +    -    +    +                "project_id": str(project_id),
    +    -    +    +                "contract_type": contract_type,
    +    -    +    +                "status": "done",
    +    -    +    +                "index": idx,
    +    -    +    +                "total": total,
    +    -    +    +            },
    +    -    +    +        })
    +    -    +    +
    +    -    +         await update_project_status(project_id, "contracts_ready")
    +    -    +         return generated
    +    -    +     
    +    -    +    diff --git a/db/migrations/006_user_api_key.sql b/db/migrations/006_user_api_key.sql
    +    -    +    new file mode 100644
    +    -    +    index 0000000..13156c9
    +    -    +    --- /dev/null
    +    -    +    +++ b/db/migrations/006_user_api_key.sql
    +    -    +    @@ -0,0 +1,4 @@
    +    -    +    +-- Phase 12: BYOK ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├▒ user-supplied Anthropic API key for builds
    +    -    +    +-- Adds an encrypted API key column to the users table.
    +    -    +    +
    +    -    +    +ALTER TABLE users ADD COLUMN IF NOT EXISTS anthropic_api_key TEXT;
    +    -    +    diff --git a/tests/test_audit_service.py b/tests/test_audit_service.py
    +    -    +    index 0f0451e..94d6f01 100644
    +    -    +    --- a/tests/test_audit_service.py
    +    -    +    +++ b/tests/test_audit_service.py
    +    -    +    @@ -32,6 +32,7 @@ def _make_patches():
    +    -    +             "get_user_by_id": AsyncMock(return_value=MOCK_USER),
    +    -    +             "list_commits": AsyncMock(return_value=[]),
    +    -    +             "get_existing_commit_shas": AsyncMock(return_value=set()),
    +    -    +    +        "mark_stale_audit_runs": AsyncMock(return_value=0),
    +    -    +             "create_audit_run": AsyncMock(return_value={"id": UUID("aaaa1111-1111-1111-1111-111111111111")}),
    +    -    +             "update_audit_run": AsyncMock(),
    +    -    +             "get_commit_files": AsyncMock(return_value=["README.md"]),
    +    -    +    @@ -156,3 +157,54 @@ async def test_backfill_handles_commit_error_gracefully():
    +    -    +         # Both count as "synced" (processed) even if one errored
    +    -    +         assert result["synced"] == 2
    +    -    +         assert result["skipped"] == 0
    +    -    +    +
    +    -    +    +
    +    -    +    +@pytest.mark.asyncio
    +    -    +    +async def test_backfill_cleans_stale_runs():
    +    -    +    +    """backfill_repo_commits calls mark_stale_audit_runs before processing."""
    +    -    +    +    mocks = _make_patches()
    +    -    +    +    mocks["list_commits"].return_value = []
    +    -    +    +    mocks["mark_stale_audit_runs"].return_value = 3
    +    -    +    +
    +    -    +    +    patches = _apply_patches(mocks)
    +    -    +    +    for p in patches:
    +    -    +    +        p.start()
    +    -    +    +    try:
    +    -    +    +        result = await backfill_repo_commits(REPO_ID, USER_ID)
    +    -    +    +    finally:
    +    -    +    +        for p in patches:
    +    -    +    +            p.stop()
    +    -    +    +
    +    -    +    +    mocks["mark_stale_audit_runs"].assert_called_once_with(REPO_ID)
    +    -    +    +    assert result["synced"] == 0
    +    -    +    +    assert result["skipped"] == 0
    +    -    +    +
    +    -    +    +
    +    -    +    +@pytest.mark.asyncio
    +    -    +    +async def test_backfill_marks_error_on_cancel():
    +    -    +    +    """If backfill is cancelled mid-commit, the in-progress row is marked error."""
    +    -    +    +    import asyncio
    +    -    +    +
    +    -    +    +    mocks = _make_patches()
    +    -    +    +    mocks["list_commits"].return_value = [
    +    -    +    +        {"sha": "aaa111", "message": "first", "author": "Alice"},
    +    -    +    +    ]
    +    -    +    +    mocks["get_existing_commit_shas"].return_value = set()
    +    -    +    +    mocks["get_commit_files"].side_effect = asyncio.CancelledError()
    +    -    +    +
    +    -    +    +    patches = _apply_patches(mocks)
    +    -    +    +    for p in patches:
    +    -    +    +        p.start()
    +    -    +    +    try:
    +    -    +    +        with pytest.raises(asyncio.CancelledError):
    +    -    +    +            await backfill_repo_commits(REPO_ID, USER_ID)
    +    -    +    +    finally:
    +    -    +    +        for p in patches:
    +    -    +    +            p.stop()
    +    -    +    +
    +    -    +    +    # The audit run should have been marked as error before re-raising
    +    -    +    +    error_calls = [
    +    -    +    +        c for c in mocks["update_audit_run"].call_args_list
    +    -    +    +        if c.kwargs.get("status") == "error" or (c.args and len(c.args) > 1 and c.args[1] == "error")
    +    -    +    +    ]
    +    -    +    +    assert len(error_calls) >= 1
    +    -    +    diff --git a/tests/test_auth_router.py b/tests/test_auth_router.py
    +    -    +    index 4cd5836..9dc3526 100644
    +    -    +    --- a/tests/test_auth_router.py
    +    -    +    +++ b/tests/test_auth_router.py
    +    -    +    @@ -57,6 +57,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    +    -    +             "github_id": 12345,
    +    -    +             "github_login": "octocat",
    +    -    +             "avatar_url": "https://example.com/avatar.png",
    +    -    +    +        "anthropic_api_key": "sk-ant-test",
    +    -    +         }
    +    -    +     
    +    -    +         token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    -    +    @@ -68,6 +69,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    +    -    +         data = response.json()
    +    -    +         assert data["github_login"] == "octocat"
    +    -    +         assert data["id"] == "11111111-1111-1111-1111-111111111111"
    +    -    +    +    assert data["has_anthropic_key"] is True
    +    -    +     
    +    -    +     
    +    -    +     @patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    -    +    @@ -80,3 +82,57 @@ def test_auth_me_returns_401_when_user_not_found(mock_get_user):
    +    -    +             headers={"Authorization": f"Bearer {token}"},
    +    -    +         )
    +    -    +         assert response.status_code == 401
    +    -    +    +
    +    -    +    +
    +    -    +    +# ---------------------------------------------------------------------------
    +    -    +    +# Tests: API key management (BYOK)
    +    -    +    +# ---------------------------------------------------------------------------
    +    -    +    +
    +    -    +    +_USER_DICT = {
    +    -    +    +    "id": "11111111-1111-1111-1111-111111111111",
    +    -    +    +    "github_id": 12345,
    +    -    +    +    "github_login": "octocat",
    +    -    +    +    "avatar_url": "https://example.com/avatar.png",
    +    -    +    +    "anthropic_api_key": None,
    +    -    +    +}
    +    -    +    +
    +    -    +    +
    +    -    +    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    +    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    -    +    +def test_save_api_key(mock_get_user, mock_set_key):
    +    -    +    +    mock_get_user.return_value = _USER_DICT
    +    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    -    +    +    response = client.put(
    +    -    +    +        "/auth/api-key",
    +    -    +    +        json={"api_key": "sk-ant-api03-test"},
    +    -    +    +        headers={"Authorization": f"Bearer {token}"},
    +    -    +    +    )
    +    -    +    +    assert response.status_code == 200
    +    -    +    +    assert response.json()["saved"] is True
    +    -    +    +    mock_set_key.assert_called_once()
    +    -    +    +
    +    -    +    +
    +    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    -    +    +def test_save_api_key_empty_rejected(mock_get_user):
    +    -    +    +    mock_get_user.return_value = _USER_DICT
    +    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    -    +    +    response = client.put(
    +    -    +    +        "/auth/api-key",
    +    -    +    +        json={"api_key": "   "},
    +    -    +    +        headers={"Authorization": f"Bearer {token}"},
    +    -    +    +    )
    +    -    +    +    assert response.status_code == 400
    +    -    +    +
    +    -    +    +
    +    -    +    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    +    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    -    +    +def test_remove_api_key(mock_get_user, mock_set_key):
    +    -    +    +    mock_get_user.return_value = _USER_DICT
    +    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    -    +    +    response = client.delete(
    +    -    +    +        "/auth/api-key",
    +    -    +    +        headers={"Authorization": f"Bearer {token}"},
    +    -    +    +    )
    +    -    +    +    assert response.status_code == 200
    +    -    +    +    assert response.json()["removed"] is True
    +    -    +    +    mock_set_key.assert_called_once()
    +    -    +    diff --git a/tests/test_build_service.py b/tests/test_build_service.py
    +    -    +    index 1c7792e..9861a64 100644
    +    -    +    --- a/tests/test_build_service.py
    +    -    +    +++ b/tests/test_build_service.py
    +    -    +    @@ -63,7 +63,8 @@ def _build(**overrides):
    +    -    +     @patch("app.services.build_service.asyncio.create_task")
    +    -    +     @patch("app.services.build_service.project_repo")
    +    -    +     @patch("app.services.build_service.build_repo")
    +    -    +    -async def test_start_build_success(mock_build_repo, mock_project_repo, mock_create_task):
    +    -    +    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    -    +    +async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    -    +         """start_build creates a build record and spawns a background task."""
    +    -    +         mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    -    +         mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    -    +    @@ -71,6 +72,7 @@ async def test_start_build_success(mock_build_repo, mock_project_repo, mock_crea
    +    -    +         mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    -    +         mock_build_repo.create_build = AsyncMock(return_value=_build())
    +    -    +         mock_create_task.return_value = MagicMock()
    +    -    +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    +    -    +     
    +    -    +         result = await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    -    +     
    +    -    +    @@ -133,6 +135,21 @@ async def test_start_build_already_running(mock_build_repo, mock_project_repo):
    +    -    +             await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    -    +     
    +    -    +     
    +    -    +    +@pytest.mark.asyncio
    +    -    +    +@patch("app.services.build_service.project_repo")
    +    -    +    +@patch("app.services.build_service.build_repo")
    +    -    +    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    -    +    +async def test_start_build_no_api_key(mock_get_user, mock_build_repo, mock_project_repo):
    +    -    +    +    """start_build raises ValueError when user has no Anthropic API key."""
    +    -    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    -    +    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    -    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    -    +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": None}
    +    -    +    +
    +    -    +    +    with pytest.raises(ValueError, match="API key required"):
    +    -    +    +        await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    -    +    +
    +    -    +    +
    +    -    +     # ---------------------------------------------------------------------------
    +    -    +     # Tests: cancel_build
    +    -    +     # ---------------------------------------------------------------------------
    +    -    +    @@ -431,3 +448,21 @@ async def test_record_phase_cost(mock_build_repo):
    +    -    +         mock_build_repo.record_build_cost.assert_called_once()
    +    -    +         assert usage.input_tokens == 0
    +    -    +         assert usage.output_tokens == 0
    +    -    +    +
    +    -    +    +
    +    -    +    +def test_get_token_rates_model_aware():
    +    -    +    +    """_get_token_rates returns correct pricing per model family."""
    +    -    +    +    from decimal import Decimal
    +    -    +    +
    +    -    +    +    opus_in, opus_out = build_service._get_token_rates("claude-opus-4-6")
    +    -    +    +    assert opus_in == Decimal("0.000015")
    +    -    +    +    assert opus_out == Decimal("0.000075")
    +    -    +    +
    +    -    +    +    haiku_in, haiku_out = build_service._get_token_rates("claude-haiku-4-5-20251001")
    +    -    +    +    assert haiku_in == Decimal("0.000001")
    +    -    +    +    assert haiku_out == Decimal("0.000005")
    +    -    +    +
    +    -    +    +    # Unknown model falls back to Opus (safest = most expensive)
    +    -    +    +    unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
    +    -    +    +    assert unk_in == Decimal("0.000015")
    +    -    +    +    assert unk_out == Decimal("0.000075")
    +    -    +    diff --git a/tests/test_llm_client.py b/tests/test_llm_client.py
    +    -    +    index c7c4f8e..4f323a2 100644
    +    -    +    --- a/tests/test_llm_client.py
    +    -    +    +++ b/tests/test_llm_client.py
    +    -    +    @@ -34,6 +34,7 @@ async def test_chat_success(mock_client_cls):
    +    -    +             "content": [{"type": "text", "text": "Hello from Haiku!"}],
    +    -    +             "model": "claude-3-5-haiku-20241022",
    +    -    +             "role": "assistant",
    +    -    +    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    -    +         })
    +    -    +         mock_client_cls.return_value = mock_client
    +    -    +     
    +    -    +    @@ -44,7 +45,9 @@ async def test_chat_success(mock_client_cls):
    +    -    +             messages=[{"role": "user", "content": "Hi"}],
    +    -    +         )
    +    -    +     
    +    -    +    -    assert result == "Hello from Haiku!"
    +    -    +    +    assert result["text"] == "Hello from Haiku!"
    +    -    +    +    assert result["usage"]["input_tokens"] == 10
    +    -    +    +    assert result["usage"]["output_tokens"] == 20
    +    -    +         mock_client.post.assert_called_once()
    +    -    +         call_kwargs = mock_client.post.call_args
    +    -    +         body = call_kwargs.kwargs["json"] if "json" in call_kwargs.kwargs else call_kwargs[1]["json"]
    +    -    +    @@ -141,6 +144,7 @@ async def test_chat_openai_success(mock_client_cls):
    +    -    +         """Successful OpenAI chat returns message content."""
    +    -    +         mock_client = _make_mock_client({
    +    -    +             "choices": [{"message": {"role": "assistant", "content": "Hello from GPT!"}}],
    +    -    +    +        "usage": {"prompt_tokens": 5, "completion_tokens": 15},
    +    -    +         })
    +    -    +         mock_client_cls.return_value = mock_client
    +    -    +     
    +    -    +    @@ -151,7 +155,9 @@ async def test_chat_openai_success(mock_client_cls):
    +    -    +             messages=[{"role": "user", "content": "Hi"}],
    +    -    +         )
    +    -    +     
    +    -    +    -    assert result == "Hello from GPT!"
    +    -    +    +    assert result["text"] == "Hello from GPT!"
    +    -    +    +    assert result["usage"]["input_tokens"] == 5
    +    -    +    +    assert result["usage"]["output_tokens"] == 15
    +    -    +         call_kwargs = mock_client.post.call_args
    +    -    +         body = call_kwargs.kwargs.get("json", call_kwargs[1].get("json", {}))
    +    -    +         assert body["model"] == "gpt-4o"
    +    -    +    @@ -226,6 +232,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    +    -    +         """chat(provider='openai') routes to OpenAI endpoint."""
    +    -    +         mock_client = _make_mock_client({
    +    -    +             "choices": [{"message": {"role": "assistant", "content": "dispatched"}}],
    +    -    +    +        "usage": {"prompt_tokens": 0, "completion_tokens": 0},
    +    -    +         })
    +    -    +         mock_client_cls.return_value = mock_client
    +    -    +     
    +    -    +    @@ -237,7 +244,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    +    -    +             provider="openai",
    +    -    +         )
    +    -    +     
    +    -    +    -    assert result == "dispatched"
    +    -    +    +    assert result["text"] == "dispatched"
    +    -    +         call_kwargs = mock_client.post.call_args
    +    -    +         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    +    -    +         assert "openai.com" in url
    +    -    +    @@ -249,6 +256,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    +    -    +         """chat() defaults to Anthropic."""
    +    -    +         mock_client = _make_mock_client({
    +    -    +             "content": [{"type": "text", "text": "default"}],
    +    -    +    +        "usage": {"input_tokens": 0, "output_tokens": 0},
    +    -    +         })
    +    -    +         mock_client_cls.return_value = mock_client
    +    -    +     
    +    -    +    @@ -259,7 +267,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    +    -    +             messages=[{"role": "user", "content": "Hi"}],
    +    -    +         )
    +    -    +     
    +    -    +    -    assert result == "default"
    +    -    +    +    assert result["text"] == "default"
    +    -    +         call_kwargs = mock_client.post.call_args
    +    -    +         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    +    -    +         assert "anthropic.com" in url
    +    -    +    diff --git a/tests/test_project_service.py b/tests/test_project_service.py
    +    -    +    index 1957ba3..1b410b3 100644
    +    -    +    --- a/tests/test_project_service.py
    +    -    +    +++ b/tests/test_project_service.py
    +    -    +    @@ -191,17 +191,22 @@ async def test_process_questionnaire_first_message(
    +    -    +             "status": "draft",
    +    -    +             "questionnaire_state": {},
    +    -    +         }
    +    -    +    -    mock_llm.return_value = json.dumps({
    +    -    +    -        "reply": "Tell me about your product.",
    +    -    +    -        "section": "product_intent",
    +    -    +    -        "section_complete": False,
    +    -    +    -        "extracted_data": None,
    +    -    +    -    })
    +    -    +    +    mock_llm.return_value = {
    +    -    +    +        "text": json.dumps({
    +    -    +    +            "reply": "Tell me about your product.",
    +    -    +    +            "section": "product_intent",
    +    -    +    +            "section_complete": False,
    +    -    +    +            "extracted_data": None,
    +    -    +    +        }),
    +    -    +    +        "usage": {"input_tokens": 50, "output_tokens": 30},
    +    -    +    +    }
    +    -    +     
    +    -    +         result = await process_questionnaire_message(USER_ID, PROJECT_ID, "Hi")
    +    -    +     
    +    -    +         assert result["reply"] == "Tell me about your product."
    +    -    +         assert result["is_complete"] is False
    +    -    +    +    assert result["token_usage"]["input_tokens"] == 50
    +    -    +    +    assert result["token_usage"]["output_tokens"] == 30
    +    -    +         mock_status.assert_called_once()  # draft -> questionnaire
    +    -    +     
    +    -    +     
    +    -    +    @@ -255,10 +260,11 @@ async def test_process_questionnaire_already_complete(mock_project):
    +    -    +     
    +    -    +     
    +    -    +     @pytest.mark.asyncio
    +    -    +    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    +    -    +     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    +    -    +     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    +    -    +     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    +    -    +    -async def test_generate_contracts_success(mock_project, mock_upsert, mock_status):
    +    -    +    +async def test_generate_contracts_success(mock_project, mock_upsert, mock_status, mock_ws):
    +    -    +         mock_project.return_value = {
    +    -    +             "id": PROJECT_ID,
    +    -    +             "user_id": USER_ID,
    +    -    +    diff --git a/tests/test_projects_router.py b/tests/test_projects_router.py
    +    -    +    index 862c16d..dc7c5ff 100644
    +    -    +    --- a/tests/test_projects_router.py
    +    -    +    +++ b/tests/test_projects_router.py
    +    -    +    @@ -21,7 +21,7 @@ def _set_test_config(monkeypatch):
    +    -    +         monkeypatch.setattr("app.config.settings.APP_URL", "http://localhost:8000")
    +    -    +         monkeypatch.setattr("app.config.settings.GITHUB_WEBHOOK_SECRET", "whsec_test")
    +    -    +         monkeypatch.setattr("app.config.settings.ANTHROPIC_API_KEY", "test-api-key")
    +    -    +    -    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022")
    +    -    +    +    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5")
    +    -    +     
    +    -    +     
    +    -    +     USER_ID = "22222222-2222-2222-2222-222222222222"
    +    -    +    @@ -248,7 +248,10 @@ def test_questionnaire_message(
    +    -    +             "status": "draft",
    +    -    +             "questionnaire_state": {},
    +    -    +         }
    +    -    +    -    mock_llm.return_value = '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}'
    +    -    +    +    mock_llm.return_value = {
    +    -    +    +        "text": '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}',
    +    -    +    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    -    +    +    }
    +    -    +     
    +    -    +         resp = client.post(
    +    -    +             f"/projects/{PROJECT_ID}/questionnaire",
    +    -    +    @@ -332,8 +335,9 @@ def test_generate_contracts_incomplete(mock_project, mock_get_user):
    +    -    +     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    +    -    +     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    +    -    +     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    +    -    +    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    +    -    +     def test_generate_contracts_success(
    +    -    +    -    mock_status, mock_upsert, mock_project, mock_get_user
    +    -    +    +    mock_ws, mock_status, mock_upsert, mock_project, mock_get_user
    +    -    +     ):
    +    -    +         mock_get_user.return_value = MOCK_USER
    +    -    +         all_sections = [
    +    -    +    diff --git a/web/src/App.tsx b/web/src/App.tsx
    +    -    +    index 7a6f811..8eadcd4 100644
    +    -    +    --- a/web/src/App.tsx
    +    -    +    +++ b/web/src/App.tsx
    +    -    +    @@ -7,6 +7,7 @@ import AuditDetailPage from './pages/AuditDetail';
    +    -    +     import ProjectDetail from './pages/ProjectDetail';
    +    -    +     import BuildProgress from './pages/BuildProgress';
    +    -    +     import BuildComplete from './pages/BuildComplete';
    +    -    +    +import Settings from './pages/Settings';
    +    -    +     import { AuthProvider, useAuth } from './context/AuthContext';
    +    -    +     import { ToastProvider } from './context/ToastContext';
    +    -    +     
    +    -    +    @@ -72,6 +73,14 @@ function App() {
    +    -    +                     </ProtectedRoute>
    +    -    +                   }
    +    -    +                 />
    +    -    +    +            <Route
    +    -    +    +              path="/settings"
    +    -    +    +              element={
    +    -    +    +                <ProtectedRoute>
    +    -    +    +                  <Settings />
    +    -    +    +                </ProtectedRoute>
    +    -    +    +              }
    +    -    +    +            />
    +    -    +                 <Route path="*" element={<Navigate to="/" replace />} />
    +    -    +               </Routes>
    +    -    +             </BrowserRouter>
    +    -    +    diff --git a/web/src/__tests__/App.test.tsx b/web/src/__tests__/App.test.tsx
    +    -    +    index 7678f4e..0d8a335 100644
    +    -    +    --- a/web/src/__tests__/App.test.tsx
    +    -    +    +++ b/web/src/__tests__/App.test.tsx
    +    -    +    @@ -298,7 +298,7 @@ describe('QuestionnaireModal', () => {
    +    -    +         expect(onClose).toHaveBeenCalled();
    +    -    +       });
    +    -    +     
    +    -    +    -  it('has a voice toggle button', () => {
    +    -    +    +  it('has a restart button', () => {
    +    -    +         render(
    +    -    +           <QuestionnaireModal
    +    -    +             projectId="test-id"
    +    -    +    @@ -307,7 +307,7 @@ describe('QuestionnaireModal', () => {
    +    -    +             onContractsGenerated={() => {}}
    +    -    +           />,
    +    -    +         );
    +    -    +    -    expect(screen.getByTestId('voice-toggle')).toBeInTheDocument();
    +    -    +    +    expect(screen.getByTestId('restart-btn')).toBeInTheDocument();
    +    -    +       });
    +    -    +     
    +    -    +       it('shows generate banner when questionnaire is complete', async () => {
    +    -    +    diff --git a/web/src/components/AppShell.tsx b/web/src/components/AppShell.tsx
    +    -    +    index 47a1098..b8f1f3c 100644
    +    -    +    --- a/web/src/components/AppShell.tsx
    +    -    +    +++ b/web/src/components/AppShell.tsx
    +    -    +    @@ -103,7 +103,6 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    +    -    +                   style={{ width: 28, height: 28, borderRadius: '50%' }}
    +    -    +                 />
    +    -    +               )}
    +    -    +    -          <span style={{ color: '#94A3B8', fontSize: '0.85rem' }}>{user?.github_login}</span>
    +    -    +               <button
    +    -    +                 onClick={logout}
    +    -    +                 style={{
    +    -    +    @@ -192,11 +191,50 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    +    -    +                     marginTop: 'auto',
    +    -    +                     padding: '12px 16px',
    +    -    +                     borderTop: '1px solid #1E293B',
    +    -    +    -                color: '#64748B',
    +    -    +    -                fontSize: '0.7rem',
    +    -    +    +                display: 'flex',
    +    -    +    +                alignItems: 'center',
    +    -    +    +                justifyContent: 'space-between',
    +    -    +                   }}
    +    -    +                 >
    +    -    +    -              v0.1.0
    +    -    +    +              <div
    +    -    +    +                onClick={() => navigate('/settings')}
    +    -    +    +                style={{
    +    -    +    +                  display: 'flex',
    +    -    +    +                  alignItems: 'center',
    +    -    +    +                  gap: '8px',
    +    -    +    +                  cursor: 'pointer',
    +    -    +    +                  flex: 1,
    +    -    +    +                  minWidth: 0,
    +    -    +    +                }}
    +    -    +    +                title={user?.github_login ?? 'Settings'}
    +    -    +    +              >
    +    -    +    +                {user?.avatar_url && (
    +    -    +    +                  <img
    +    -    +    +                    src={user.avatar_url}
    +    -    +    +                    alt={user.github_login}
    +    -    +    +                    style={{ width: 22, height: 22, borderRadius: '50%', flexShrink: 0 }}
    +    -    +    +                  />
    +    -    +    +                )}
    +    -    +    +                <span style={{ color: '#CBD5E1', fontSize: '0.75rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    +    -    +    +                  {user?.github_login}
    +    -    +    +                </span>
    +    -    +    +              </div>
    +    -    +    +              <button
    +    -    +    +                onClick={() => navigate('/settings')}
    +    -    +    +                title="Settings"
    +    -    +    +                style={{
    +    -    +    +                  background: 'transparent',
    +    -    +    +                  border: 'none',
    +    -    +    +                  color: '#64748B',
    +    -    +    +                  cursor: 'pointer',
    +    -    +    +                  fontSize: '0.95rem',
    +    -    +    +                  padding: '4px',
    +    -    +    +                  flexShrink: 0,
    +    -    +    +                  lineHeight: 1,
    +    -    +    +                }}
    +    -    +    +              >
    +    -    +    +                ├ö├Â┬úÔö£├é├ö├Â┬úÔö¼├║├ö├Â┬úÔö£Ôòù
    +    -    +    +              </button>
    +    -    +                 </div>
    +    -    +               </aside>
    +    -    +             )}
    +    -    +    diff --git a/web/src/components/ContractProgress.tsx b/web/src/components/ContractProgress.tsx
    +    -    +    new file mode 100644
    +    -    +    index 0000000..821fec7
    +    -    +    --- /dev/null
    +    -    +    +++ b/web/src/components/ContractProgress.tsx
    +    -    +    @@ -0,0 +1,294 @@
    +    -    +    +/**
    +    -    +    + * ContractProgress -- live step-by-step contract generation progress panel.
    +    -    +    + *
    +    -    +    + * Shows each contract being generated with status indicators, a running log,
    +    -    +    + * context window meter, and cumulative token usage from the questionnaire.
    +    -    +    + */
    +    -    +    +import { useState, useEffect, useRef, useCallback } from 'react';
    +    -    +    +import { useAuth } from '../context/AuthContext';
    +    -    +    +import { useWebSocket } from '../hooks/useWebSocket';
    +    -    +    +
    +    -    +    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    -    +    +
    +    -    +    +/* ------------------------------------------------------------------ */
    +    -    +    +/*  Contract type labels                                              */
    +    -    +    +/* ------------------------------------------------------------------ */
    +    -    +    +
    +    -    +    +const CONTRACT_LABELS: Record<string, string> = {
    +    -    +    +  blueprint: 'Blueprint',
    +    -    +    +  manifesto: 'Manifesto',
    +    -    +    +  stack: 'Stack',
    +    -    +    +  schema: 'Schema',
    +    -    +    +  physics: 'Physics',
    +    -    +    +  boundaries: 'Boundaries',
    +    -    +    +  phases: 'Phases',
    +    -    +    +  ui: 'UI',
    +    -    +    +  builder_contract: 'Builder Contract',
    +    -    +    +  builder_directive: 'Builder Directive',
    +    -    +    +};
    +    -    +    +
    +    -    +    +const ALL_CONTRACTS = Object.keys(CONTRACT_LABELS);
    +    -    +    +
    +    -    +    +/* ------------------------------------------------------------------ */
    +    -    +    +/*  Context window constants                                          */
    +    -    +    +/* ------------------------------------------------------------------ */
    +    -    +    +
    +    -    +    +const MODEL_CONTEXT_WINDOWS: Record<string, number> = {
    +    -    +    +  'claude-haiku-4-5': 200_000,
    +    -    +    +  'claude-sonnet-4-5': 200_000,
    +    -    +    +  'claude-opus-4-6': 200_000,
    +    -    +    +  'gpt-4o': 128_000,
    +    -    +    +};
    +    -    +    +const DEFAULT_CONTEXT_WINDOW = 200_000;
    +    +    -- Watcher sign-off
    +    +    +- Implement DB migration 008
    +    +    +- Create git_client.py
    +    +    +- Update build_service.py with file parser and target handling
    +    +    +- Update builds router with target params and file endpoints
    +    +    +- Create BuildTargetPicker and FileTree frontend components
    +    +    +- Add file_created WS event handling in BuildProgress
    +    +    +- Write backend + frontend tests
    +    +    +- Run full test suite and audit
         +     
    -    +     ## Next Steps
    -    +    -- Features ready for manual QA with live GitHub repos
    -    +    +- TODO: next actions (small, specific).
    -    +    +
    -    +    +## Minimal Diff Hunks
    -    +    +    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    -    +    +    index 84a13ac..ad6bd57 100644
    -    +    +    --- a/Forge/evidence/test_runs_latest.md
    -    +    +    +++ b/Forge/evidence/test_runs_latest.md
    -    +    +    @@ -1,19 +1,17 @@
    -    +    +     ├ö├Â┬╝├ö├Â├▒Ôö£├ÂÔö£ÔûôÔö£ÔòúÔö£├ÂÔö£├éÔö£├½Status: PASS
    -    +    +    -Start: 2026-02-15T04:40:00Z
    -    +    +    -End: 2026-02-15T04:41:00Z
    -    +    +    +Start: 2026-02-15T16:20:00Z
    -    +    +    +End: 2026-02-15T16:21:00Z
    -    +    +     Branch: master
    -    +    +    -HEAD: post-phase-enhancement
    -    +    +    +HEAD: 3a575f8
    -    +    +     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    -    +    +     compileall exit: 0
    -    +    +     import_sanity exit: 0
    -    +    +     
    -    +    +     ## Backend (pytest)
    -    +    +    -- 219 passed, 0 failed, 1 warning
    -    +    +    -- Duration: 12.58s
    -    +    +    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    -    +    +    +- 240 passed, 0 failed, 1 warning
    -    +    +    +- Duration: 13.60s
    -    +    +     
    -    +    +     ## Frontend (vitest)
    -    +    +    -- 39 passed, 0 failed
    -    +    +    -- Duration: 2.17s
    -    +    +    -- New tests: CreateProjectModal (4)
    -    +    +    +- 49 passed, 0 failed
    -    +    +    +- Duration: 2.59s
    -    +    +     
    -    +    +    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    -    +    +    index 369350b..d8df0cf 100644
    -    +    +    --- a/Forge/scripts/run_audit.ps1
    -    +    +    +++ b/Forge/scripts/run_audit.ps1
    -    +    +    @@ -1,4 +1,4 @@
    -    +    +    -├ö├Â┬╝├ö├Â├▒Ôö£├ÂÔö£ÔûôÔö£ÔòúÔö£├ÂÔö£├éÔö£├½# scripts/run_audit.ps1
    -    +    +    +# scripts/run_audit.ps1
    -    +    +     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    -    +    +     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    -    +    +     # Reads layer boundaries from Contracts/boundaries.json.
    -    +    +    @@ -24,7 +24,7 @@ param(
    -    +    +     Set-StrictMode -Version Latest
    -    +    +     $ErrorActionPreference = "Stop"
    -    +    +     
    -    +    +    -# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Helpers ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +# -- Helpers ------------------------------------------------------------------
    -    +    +     
    -    +    +     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    -    +    +     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    -    +    +    @@ -41,7 +41,7 @@ function RepoRoot {
    -    +    +       return (& git rev-parse --show-toplevel).Trim()
    -    +    +     }
    -    +    +     
    -    +    +    -# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Main ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +# -- Main ---------------------------------------------------------------------
    -    +    +     
    -    +    +     try {
    -    +    +       RequireGit
    -    +    +    @@ -54,10 +54,10 @@ try {
    -    +    +       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    -    +    +     
    -    +    +       # Parse claimed files into a sorted, normalized set
    -    +    +    -  $claimed = $ClaimedFiles.Split(",") |
    -    +    +    +  $claimed = @($ClaimedFiles.Split(",") |
    -    +    +         ForEach-Object { $_.Trim().Replace("\", "/") } |
    -    +    +         Where-Object { $_ -ne "" } |
    -    +    +    -    Sort-Object -Unique
    -    +    +    +    Sort-Object -Unique)
    -    +    +     
    -    +    +       if ($claimed.Count -eq 0) {
    -    +    +         throw "ClaimedFiles is empty."
    -    +    +    @@ -79,7 +79,7 @@ try {
    -    +    +       $warnings  = [ordered]@{}
    -    +    +       $anyFail   = $false
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A1: Scope compliance ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A1: Scope compliance -----------------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    -    +    +    @@ -111,7 +111,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A2: Minimal-diff discipline ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A2: Minimal-diff discipline ----------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         $summaryRaw = & git diff --cached --summary 2>&1
    -    +    +    @@ -133,7 +133,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A3: Evidence completeness ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A3: Evidence completeness ------------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         $a3Failures = @()
    -    +    +    @@ -164,7 +164,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A4: Boundary compliance (reads Contracts/boundaries.json) ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
    -    +    +     
    -    +    +       try {
    -    +    +         $a4Violations = @()
    -    +    +    @@ -213,7 +213,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A5: Diff Log Gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A5: Diff Log Gate --------------------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         if (-not (Test-Path $diffLog)) {
    -    +    +    @@ -237,7 +237,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A6: Authorization Gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A6: Authorization Gate ---------------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         $lastAuthHash = $null
    -    +    +    @@ -268,7 +268,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A7: Verification hierarchy order ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A7: Verification hierarchy order -----------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         if (-not (Test-Path $diffLog)) {
    -    +    +    @@ -324,7 +324,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A8: Test gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A8: Test gate ------------------------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         if (-not (Test-Path $testRunsLatest)) {
    -    +    +    @@ -344,7 +344,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A9: Dependency gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- A9: Dependency gate ------------------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         $a9Failures = @()
    -    +    +    @@ -508,7 +508,7 @@ try {
    -    +    +         $anyFail = $true
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W1: No secrets in diff ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- W1: No secrets in diff --------------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         $diffContent = & git diff --cached 2>&1
    -    +    +    @@ -534,7 +534,7 @@ try {
    -    +    +         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W2: Audit ledger integrity ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- W2: Audit ledger integrity ----------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         if (-not (Test-Path $auditLedger)) {
    -    +    +    @@ -548,7 +548,7 @@ try {
    -    +    +         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W3: Physics route coverage ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- W3: Physics route coverage ----------------------------------------
    -    +    +     
    -    +    +       try {
    -    +    +         if (-not (Test-Path $physicsYaml)) {
    -    +    +    @@ -613,7 +613,7 @@ try {
    -    +    +         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    -    +    +       }
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Build output ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- Build output ------------------------------------------------------
    -    +    +     
    -    +    +       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    -    +    +     
    -    +    +    @@ -643,7 +643,7 @@ Overall: $overall
    -    +    +     
    -    +    +       Write-Output $output
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Append to audit ledger ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- Append to audit ledger ---------------------------------------------
    -    +    +     
    -    +    +       $iteration = 1
    -    +    +       if (Test-Path $auditLedger) {
    -    +    +    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    -    +    +       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    -    +    +       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    -    +    +     
    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Exit ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    -    +    +    +  # -- Exit ---------------------------------------------------------------
    -    +    +     
    -    +    +       if ($anyFail) {
    -    +    +         exit 1
    -    +    +    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    -    +    +    index 2b28280..bd8693a 100644
    -    +    +    --- a/web/src/components/QuestionnaireModal.tsx
    -    +    +    +++ b/web/src/components/QuestionnaireModal.tsx
    -    +    +    @@ -7,6 +7,7 @@
    -    +    +      */
    -    +    +     import { useState, useEffect, useRef, useCallback } from 'react';
    -    +    +     import { useAuth } from '../context/AuthContext';
    -    +    +    +import ContractProgress from './ContractProgress';
    -    +    +     
    -    +    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -    +    +     
    -    +    +    @@ -34,6 +35,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    -    +    +     interface ChatMessage {
    -    +    +       role: 'user' | 'assistant';
    -    +    +       content: string;
    -    +    +    +  section?: string;
    -    +    +     }
    -    +    +     
    -    +    +     interface QuestionnaireState {
    -    +    +    @@ -150,12 +152,21 @@ const SpeechRecognition =
    -    +    +         : null;
    -    +    +     
    -    +    +     function useSpeechRecognition(onResult: (text: string) => void) {
    -    +    +    -  const recognitionRef = useRef<any>(null);
    -    +    +       const [listening, setListening] = useState(false);
    -    +    +       const listeningRef = useRef(false);
    -    +    +    +  const recRef = useRef<any>(null);
    -    +    +    +  const onResultRef = useRef(onResult);
    -    +    +    +  onResultRef.current = onResult;
    -    +    +    +
    -    +    +    +  /* Lazily create a single SpeechRecognition instance and keep it for the
    -    +    +    +     lifetime of the component.  Browsers throttle or block new instances
    -    +    +    +     created outside a user-gesture context, which is why creating a fresh
    -    +    +    +     instance on every start() caused the second activation to silently die
    -    +    +    +     after a few seconds. */
    -    +    +    +  const getRec = useCallback(() => {
    -    +    +    +    if (recRef.current) return recRef.current;
    -    +    +    +    if (!SpeechRecognition) return null;
    -    +    +     
    -    +    +    -  useEffect(() => {
    -    +    +    -    if (!SpeechRecognition) return;
    -    +    +         const rec = new SpeechRecognition();
    -    +    +         rec.continuous = true;
    -    +    +         rec.interimResults = true;
    -    +    +    @@ -169,64 +180,93 @@ function useSpeechRecognition(onResult: (text: string) => void) {
    -    +    +             }
    -    +    +           }
    -    +    +           if (finalTranscript) {
    -    +    +    -        onResult(finalTranscript);
    -    +    +    +        onResultRef.current(finalTranscript);
    -    +    +           }
    -    +    +         };
    -    +    +     
    -    +    +         rec.onerror = (e: any) => {
    -    +    +    -      /* 'no-speech' and 'aborted' are normal during pauses ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® auto-restart */
    -    +    +           if (e.error === 'no-speech' || e.error === 'aborted') {
    -    +    +    +        /* Browser fires these during normal pauses ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® restart if still active */
    -    +    +             if (listeningRef.current) {
    -    +    +    -          try { rec.start(); } catch { /* already running */ }
    -    +    +    +          setTimeout(() => {
    -    +    +    +            if (listeningRef.current) {
    -    +    +    +              try { rec.start(); } catch { /* already running */ }
    -    +    +    +            }
    -    +    +    +          }, 300);
    -    +    +             }
    -    +    +             return;
    -    +    +           }
    -    +    +    +      /* Real error ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® stop */
    -    +    +           listeningRef.current = false;
    -    +    +           setListening(false);
    -    +    +         };
    -    +    +     
    -    +    +    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    -    +    +         rec.onend = () => {
    -    +    +    +      /* Browser ends recognition after silence; auto-restart if user hasn't toggled off */
    -    +    +           if (listeningRef.current) {
    -    +    +    -        try { rec.start(); } catch { /* already running */ }
    -    +    +    -      } else {
    -    +    +    -        setListening(false);
    -    +    +    +        setTimeout(() => {
    -    +    +    +          if (listeningRef.current) {
    -    +    +    +            try { rec.start(); } catch { /* already running */ }
    -    +    +    +          }
    -    +    +    +        }, 300);
    -    +    +           }
    -    +    +         };
    +    +     ## Minimal Diff Hunks
    +    +    -    diff --git a/Forge/evidence/audit_ledger.md b/Forge/evidence/audit_ledger.md
    +    +    -    index 5a3369d..7ec1b27 100644
    +    +    -    --- a/Forge/evidence/audit_ledger.md
    +    +    -    +++ b/Forge/evidence/audit_ledger.md
    +    +    -    @@ -3399,3 +3399,34 @@ Outcome: FAIL
    +    +    -     W1: PASS -- No secret patterns detected.
    +    +    -     W2: PASS -- audit_ledger.md exists and is non-empty.
    +    +    -     W3: PASS -- All physics paths have corresponding handler files.
    +    +    +    diff --git a/Forge/Contracts/phases.md b/Forge/Contracts/phases.md
    +    +    +    index f5bfde5..e9c0542 100644
    +    +    +    --- a/Forge/Contracts/phases.md
    +    +    +    +++ b/Forge/Contracts/phases.md
    +    +    +    @@ -385,3 +385,279 @@ Canonical phase plan. Each phase is self-contained, shippable, and auditable. Th
    +    +    +     - `USER_INSTRUCTIONS.md` covers the full project creation and build workflow
    +    +    +     - All tests pass
    +    +    +     - `run_audit.ps1` passes all checks
    +    +         +
    +    +         +---
    +    +    -    +## Audit Entry: unknown -- Iteration 74
    +    +    -    +Timestamp: 2026-02-15T16:18:59Z
    +    +    -    +AEM Cycle: unknown
    +    +    -    +Outcome: FAIL
    +    +    -    +
    +    +    -    +### Checklist
    +    +    -    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    +    -    +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    +    +    -    +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    +    +    -    +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    +    +    -    +- A5 Diff Log Gate:         FAIL -- updatedifflog.md contains TODO: placeholders.
    +    +    -    +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    +    +    -    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    +    +    -    +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    +    +    -    +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    +    +    -    +
    +    +    -    +### Fix Plan (FAIL items)
    +    +    -    +- A1: FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    +    -    +- A5: FAIL -- updatedifflog.md contains TODO: placeholders.
    +    +    -    +
    +    +    -    +### Files Changed
    +    +    -    +- Forge/evidence/test_runs_latest.md
    +    +    -    +- Forge/scripts/run_audit.ps1
    +    +    -    +- web/src/components/QuestionnaireModal.tsx
    +    +    -    +
    +    +    -    +### Notes
    +    +    -    +W1: WARN -- Potential secrets found: sk-
    +    +    -    +W2: PASS -- audit_ledger.md exists and is non-empty.
    +    +    -    +W3: PASS -- All physics paths have corresponding handler files.
    +    +    -    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    +    +    -    index 84a13ac..ad6bd57 100644
    +    +    -    --- a/Forge/evidence/test_runs_latest.md
    +    +    -    +++ b/Forge/evidence/test_runs_latest.md
    +    +    -    @@ -1,19 +1,17 @@
    +    +    -     ├ö├Â┬╝├ö├Â├▒Ôö£├ÂÔö£ÔûôÔö£ÔòúÔö£├ÂÔö£├éÔö£├½Status: PASS
    +    +    -    -Start: 2026-02-15T04:40:00Z
    +    +    -    -End: 2026-02-15T04:41:00Z
    +    +    -    +Start: 2026-02-15T16:20:00Z
    +    +    -    +End: 2026-02-15T16:21:00Z
    +    +    -     Branch: master
    +    +    -    -HEAD: post-phase-enhancement
    +    +    -    +HEAD: 3a575f8
    +    +    -     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    +    +    -     compileall exit: 0
    +    +    -     import_sanity exit: 0
    +    +    -     
    +    +    -     ## Backend (pytest)
    +    +    -    -- 219 passed, 0 failed, 1 warning
    +    +    -    -- Duration: 12.58s
    +    +    -    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    +    +    -    +- 240 passed, 0 failed, 1 warning
    +    +    -    +- Duration: 13.60s
    +    +    -     
    +    +    -     ## Frontend (vitest)
    +    +    -    -- 39 passed, 0 failed
    +    +    -    -- Duration: 2.17s
    +    +    -    -- New tests: CreateProjectModal (4)
    +    +    -    +- 49 passed, 0 failed
    +    +    -    +- Duration: 2.59s
    +    +    -     
    +    +    -    diff --git a/Forge/evidence/updatedifflog.md b/Forge/evidence/updatedifflog.md
    +    +    -    index 5d019da..fd8648e 100644
    +    +    -    --- a/Forge/evidence/updatedifflog.md
    +    +    -    +++ b/Forge/evidence/updatedifflog.md
    +    +    -    @@ -1,46 +1,3253 @@
    +    +    -    -├ö├Â┬╝├ö├Â├▒Ôö£├ÂÔö£ÔûôÔö£ÔòúÔö£├ÂÔö£├éÔö£├½# Diff Log (overwrite each cycle)
    +    +    -    +# Diff Log (overwrite each cycle)
    +    +    -     
    +    +    -     ## Cycle Metadata
    +    +    -    -- Timestamp: 2026-02-15T04:42:00+00:00
    +    +    -    +- Timestamp: 2026-02-15T16:19:58+00:00
    +    +    -     - Branch: master
    +    +    -    -- HEAD: pending
    +    +    -    -- BASE_HEAD: 63d92ee
    +    +    -    -- Diff basis: post-phase enhancement (commit backfill + create project)
    +    +    -    +- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    +    +    -    +- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    +    +    -    +- Diff basis: staged
    +    +    -     
    +    +    -     ## Cycle Status
    +    +    -     - Status: COMPLETE
    +    +    -     
    +    +    -     ## Summary
    +    +    -    -- Added offline commit backfill: `list_commits()` GitHub client, `get_existing_commit_shas()` repo layer, `backfill_repo_commits()` service, `POST /repos/{id}/sync` endpoint
    +    +    -    -- Added "Create Project" button + modal on Dashboard with name/description form
    +    +    -    -- Added "Sync Commits" button on CommitTimeline page to trigger backfill
    +    +    -    -- 15 new tests: 5 audit service, 3 GitHub client, 3 repos router sync, 4 frontend CreateProjectModal
    +    +    -    -
    +    +    -    -## Files Changed
    +    +    -    -- app/clients/github_client.py (added list_commits)
    +    +    -    -- app/repos/audit_repo.py (added get_existing_commit_shas)
    +    +    -    -- app/services/audit_service.py (added backfill_repo_commits)
    +    +    -    -- app/api/routers/repos.py (added POST sync endpoint)
    +    +    -    -- web/src/components/CreateProjectModal.tsx (new)
    +    +    -    -- web/src/pages/Dashboard.tsx (added Create Project button + modal)
    +    +    -    -- web/src/pages/CommitTimeline.tsx (added Sync Commits button)
    +    +    -    -- tests/test_audit_service.py (new, 5 tests)
    +    +    -    -- tests/test_github_client.py (new, 3 tests)
    +    +    -    -- tests/test_repos_router.py (added 3 sync tests)
    +    +    -    -- web/src/__tests__/App.test.tsx (added 4 CreateProjectModal tests)
    +    +    -    +- Fixed mic reconnection bug in QuestionnaireModal: reuse single SpeechRecognition instance across toggle cycles instead of creating new ones (browsers throttle new instances outside original gesture context)
    +    +    -    +- Fixed run_audit.ps1 .Count error: wrapped pipeline result in @() to ensure array type when single file is claimed
    +    +    -    +- Updated test_runs_latest.md with current pass counts (240 backend, 49 frontend)
    +    +    -    +- Multi-feature batch: questionnaire modal, LLM multi-provider, project remove, build system, settings page, contract progress
    +    +    -    +
    +    +    -    +## Files Changed (staged)
    +    +    -    +- Forge/evidence/audit_ledger.md
    +    +    -     - Forge/evidence/test_runs_latest.md
    +    +    -     - Forge/evidence/updatedifflog.md
    +    +    -    +- Forge/scripts/run_audit.ps1
    +    +    -    +- USER_INSTRUCTIONS.md
    +    +    -    +- app/api/routers/auth.py
    +    +    -    +- app/api/routers/projects.py
    +    +    -    +- app/clients/llm_client.py
    +    +    -    +- app/config.py
    +    +    -    +- app/repos/audit_repo.py
    +    +    -    +- app/repos/user_repo.py
    +    +    -    +- app/services/audit_service.py
    +    +    -    +- app/services/build_service.py
    +    +    -    +- app/services/project_service.py
    +    +    -    +- db/migrations/006_user_api_key.sql
    +    +    -    +- tests/test_audit_service.py
    +    +    -    +- tests/test_auth_router.py
    +    +    -    +- tests/test_build_service.py
    +    +    -    +- tests/test_llm_client.py
    +    +    -    +- tests/test_project_service.py
    +    +    -    +- tests/test_projects_router.py
    +    +    -    +- web/src/App.tsx
    +    +    -    +- web/src/__tests__/App.test.tsx
    +    +    -    +- web/src/components/AppShell.tsx
    +    +    -    +- web/src/components/ContractProgress.tsx
    +    +    -    +- web/src/components/QuestionnaireModal.tsx
    +    +    -    +- web/src/context/AuthContext.tsx
    +    +    -    +- web/src/pages/BuildComplete.tsx
    +    +    -    +- web/src/pages/BuildProgress.tsx
    +    +    -    +- web/src/pages/ProjectDetail.tsx
    +    +    -    +- web/src/pages/Settings.tsx
    +    +    -    +- web/vite.config.ts
    +    +    -    +
    +    +    -    +## git status -sb
    +    +    -    +    ## master...origin/master [ahead 2]
    +    +    -    +    M  Forge/evidence/audit_ledger.md
    +    +    -    +    M  Forge/evidence/test_runs_latest.md
    +    +    -    +    M  Forge/evidence/updatedifflog.md
    +    +    -    +    M  Forge/scripts/run_audit.ps1
    +    +    -    +    M  USER_INSTRUCTIONS.md
    +    +    -    +    M  app/api/routers/auth.py
    +    +    -    +    M  app/api/routers/projects.py
    +    +    -    +    M  app/clients/llm_client.py
    +    +    -    +    M  app/config.py
    +    +    -    +    M  app/repos/audit_repo.py
    +    +    -    +    M  app/repos/user_repo.py
    +    +    -    +    M  app/services/audit_service.py
    +    +    -    +    M  app/services/build_service.py
    +    +    -    +    M  app/services/project_service.py
    +    +    -    +    A  db/migrations/006_user_api_key.sql
    +    +    -    +    M  tests/test_audit_service.py
    +    +    -    +    M  tests/test_auth_router.py
    +    +    -    +    M  tests/test_build_service.py
    +    +    -    +    M  tests/test_llm_client.py
    +    +    -    +    M  tests/test_project_service.py
    +    +    -    +    M  tests/test_projects_router.py
    +    +    -    +    M  web/src/App.tsx
    +    +    -    +    M  web/src/__tests__/App.test.tsx
    +    +    -    +    M  web/src/components/AppShell.tsx
    +    +    -    +    A  web/src/components/ContractProgress.tsx
    +    +    -    +    M  web/src/components/QuestionnaireModal.tsx
    +    +    -    +    M  web/src/context/AuthContext.tsx
    +    +    -    +    M  web/src/pages/BuildComplete.tsx
    +    +    -    +    M  web/src/pages/BuildProgress.tsx
    +    +    -    +    M  web/src/pages/ProjectDetail.tsx
    +    +    -    +    A  web/src/pages/Settings.tsx
    +    +    -    +    M  web/vite.config.ts
    +    +    -     
    +    +    -     ## Verification
    +    +    -     - Static: all files compile (compileall + tsc pass)
    +    +    -    -- Runtime: 219 pytest + 39 vitest = 258 tests pass (was 243)
    +    +    -    -- Behavior: backfill syncs missing commits, Create Project modal submits to backend
    +    +    -    -- Contract: no phase contract changes needed (post-phase enhancement)
    +    +    -    +- Runtime: 240 pytest + 49 vitest = 289 tests pass
    +    +    -    +- Behavior: mic stays active across toggle cycles, audit script handles single-file claims
    +    +    -    +- Contract: no boundary violations (A4 PASS)
    +    +    -     
    +    +    -     ## Notes (optional)
    +    +    -    -- Backfill fetches up to 300 recent commits (3 pages Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬ú├ö├▓├║ 100) per sync
    +    +    -    -- Backfill continues processing if individual commits error (graceful degradation)
    +    +    -    +- No blockers or risks identified
    +    +    -     
    +    +    -     ## Next Steps
    +    +    -    -- Features ready for manual QA with live GitHub repos
    +    +    -    +- Test full questionnaire flow end-to-end with live Anthropic API
    +    +    -    +
    +    +    -    +## Minimal Diff Hunks
    +    +    -    +    diff --git a/Forge/evidence/audit_ledger.md b/Forge/evidence/audit_ledger.md
    +    +    -    +    index 5a3369d..7ec1b27 100644
    +    +    -    +    --- a/Forge/evidence/audit_ledger.md
    +    +    -    +    +++ b/Forge/evidence/audit_ledger.md
    +    +    -    +    @@ -3399,3 +3399,34 @@ Outcome: FAIL
    +    +    -    +     W1: PASS -- No secret patterns detected.
    +    +    -    +     W2: PASS -- audit_ledger.md exists and is non-empty.
    +    +    -    +     W3: PASS -- All physics paths have corresponding handler files.
    +    +    -    +    +
    +    +    -    +    +---
    +    +    -    +    +## Audit Entry: unknown -- Iteration 74
    +    +    -    +    +Timestamp: 2026-02-15T16:18:59Z
    +    +    -    +    +AEM Cycle: unknown
    +    +    -    +    +Outcome: FAIL
    +    +    -    +    +
    +    +    -    +    +### Checklist
    +    +    -    +    +- A1 Scope compliance:      FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    +    -    +    +- A2 Minimal-diff:          PASS -- No renames; diff is minimal.
    +    +    -    +    +- A3 Evidence completeness: PASS -- test_runs_latest.md=PASS, updatedifflog.md present.
    +    +    -    +    +- A4 Boundary compliance:   PASS -- No forbidden patterns found in any boundary layer.
    +    +    -    +    +- A5 Diff Log Gate:         FAIL -- updatedifflog.md contains TODO: placeholders.
    +    +    -    +    +- A6 Authorization Gate:    PASS -- No prior AUTHORIZED entry; first AEM cycle.
    +    +    -    +    +- A7 Verification order:    PASS -- Verification keywords appear in correct order (Static > Runtime > Behavior > Contract).
    +    +    -    +    +- A8 Test gate:             PASS -- test_runs_latest.md reports PASS.
    +    +    -    +    +- A9 Dependency gate:       PASS -- All imports in changed files have declared dependencies.
    +    +    -    +    +
    +    +    -    +    +### Fix Plan (FAIL items)
    +    +    -    +    +- A1: FAIL -- Unclaimed in diff: app/api/routers/auth.py, app/api/routers/projects.py, app/clients/llm_client.py, app/config.py, app/repos/audit_repo.py, app/repos/user_repo.py, app/services/audit_service.py, app/services/build_service.py, app/services/project_service.py, Forge/evidence/updatedifflog.md, tests/test_audit_service.py, tests/test_auth_router.py, tests/test_build_service.py, tests/test_llm_client.py, tests/test_project_service.py, tests/test_projects_router.py, USER_INSTRUCTIONS.md, web/src/__tests__/App.test.tsx, web/src/App.tsx, web/src/components/AppShell.tsx, web/src/context/AuthContext.tsx, web/src/pages/BuildComplete.tsx, web/src/pages/BuildProgress.tsx, web/src/pages/ProjectDetail.tsx, web/vite.config.ts. 
    +    +    -    +    +- A5: FAIL -- updatedifflog.md contains TODO: placeholders.
    +    +    -    +    +
    +    +    -    +    +### Files Changed
    +    +    -    +    +- Forge/evidence/test_runs_latest.md
    +    +    -    +    +- Forge/scripts/run_audit.ps1
    +    +    -    +    +- web/src/components/QuestionnaireModal.tsx
    +    +    -    +    +
    +    +    -    +    +### Notes
    +    +    -    +    +W1: WARN -- Potential secrets found: sk-
    +    +    -    +    +W2: PASS -- audit_ledger.md exists and is non-empty.
    +    +    -    +    +W3: PASS -- All physics paths have corresponding handler files.
    +    +    -    +    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    +    +    -    +    index 84a13ac..ad6bd57 100644
    +    +    -    +    --- a/Forge/evidence/test_runs_latest.md
    +    +    -    +    +++ b/Forge/evidence/test_runs_latest.md
    +    +    -    +    @@ -1,19 +1,17 @@
    +    +    -    +     Ôö£├ÂÔö£├éÔö¼ÔòØÔö£├ÂÔö£├éÔö£ÔûÆ├ö├Â┬úÔö£├é├ö├Â┬ú├ö├╗├┤├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬¢Status: PASS
    +    +    -    +    -Start: 2026-02-15T04:40:00Z
    +    +    -    +    -End: 2026-02-15T04:41:00Z
    +    +    -    +    +Start: 2026-02-15T16:20:00Z
    +    +    -    +    +End: 2026-02-15T16:21:00Z
    +    +    -    +     Branch: master
    +    +    -    +    -HEAD: post-phase-enhancement
    +    +    -    +    +HEAD: 3a575f8
    +    +    -    +     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    +    +    -    +     compileall exit: 0
    +    +    -    +     import_sanity exit: 0
    +    +    -    +     
    +    +    -    +     ## Backend (pytest)
    +    +    -    +    -- 219 passed, 0 failed, 1 warning
    +    +    -    +    -- Duration: 12.58s
    +    +    -    +    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    +    +    -    +    +- 240 passed, 0 failed, 1 warning
    +    +    -    +    +- Duration: 13.60s
    +    +    -    +     
    +    +    -    +     ## Frontend (vitest)
    +    +    -    +    -- 39 passed, 0 failed
    +    +    -    +    -- Duration: 2.17s
    +    +    -    +    -- New tests: CreateProjectModal (4)
    +    +    -    +    +- 49 passed, 0 failed
    +    +    -    +    +- Duration: 2.59s
    +    +    -    +     
    +    +    -    +    diff --git a/Forge/evidence/updatedifflog.md b/Forge/evidence/updatedifflog.md
    +    +    -    +    index 5d019da..2433eaf 100644
    +    +    -    +    --- a/Forge/evidence/updatedifflog.md
    +    +    -    +    +++ b/Forge/evidence/updatedifflog.md
    +    +    -    +    @@ -1,46 +1,684 @@
    +    +    -    +    -Ôö£├ÂÔö£├éÔö¼ÔòØÔö£├ÂÔö£├éÔö£ÔûÆ├ö├Â┬úÔö£├é├ö├Â┬ú├ö├╗├┤├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬¢# Diff Log (overwrite each cycle)
    +    +    -    +    +# Diff Log (overwrite each cycle)
    +    +    -    +     
    +    +    -    +     ## Cycle Metadata
    +    +    -    +    -- Timestamp: 2026-02-15T04:42:00+00:00
    +    +    -    +    +- Timestamp: 2026-02-15T16:18:17+00:00
    +    +    -    +     - Branch: master
    +    +    -    +    -- HEAD: pending
    +    +    -    +    -- BASE_HEAD: 63d92ee
    +    +    -    +    -- Diff basis: post-phase enhancement (commit backfill + create project)
    +    +    -    +    +- HEAD: 3a575f88c1b6d0b34120ab0f67502a2be952dc41
    +    +    -    +    +- BASE_HEAD: 43733d26b13a7765e20988d9aae39518fb3d60a2
    +    +    -    +    +- Diff basis: staged
    +    +    -    +     
    +    +    -    +     ## Cycle Status
    +    +    -    +     - Status: COMPLETE
    +    +    -    +     
    +    +    -    +     ## Summary
    +    +    -    +    -- Added offline commit backfill: `list_commits()` GitHub client, `get_existing_commit_shas()` repo layer, `backfill_repo_commits()` service, `POST /repos/{id}/sync` endpoint
    +    +    -    +    -- Added "Create Project" button + modal on Dashboard with name/description form
    +    +    -    +    -- Added "Sync Commits" button on CommitTimeline page to trigger backfill
    +    +    -    +    -- 15 new tests: 5 audit service, 3 GitHub client, 3 repos router sync, 4 frontend CreateProjectModal
    +    +    -    +    -
    +    +    -    +    -## Files Changed
    +    +    -    +    -- app/clients/github_client.py (added list_commits)
    +    +    -    +    -- app/repos/audit_repo.py (added get_existing_commit_shas)
    +    +    -    +    -- app/services/audit_service.py (added backfill_repo_commits)
    +    +    -    +    -- app/api/routers/repos.py (added POST sync endpoint)
    +    +    -    +    -- web/src/components/CreateProjectModal.tsx (new)
    +    +    -    +    -- web/src/pages/Dashboard.tsx (added Create Project button + modal)
    +    +    -    +    -- web/src/pages/CommitTimeline.tsx (added Sync Commits button)
    +    +    -    +    -- tests/test_audit_service.py (new, 5 tests)
    +    +    -    +    -- tests/test_github_client.py (new, 3 tests)
    +    +    -    +    -- tests/test_repos_router.py (added 3 sync tests)
    +    +    -    +    -- web/src/__tests__/App.test.tsx (added 4 CreateProjectModal tests)
    +    +    -    +    +- Fixed mic reconnection bug: reuse single SpeechRecognition instance instead of creating new ones per toggle (browsers throttle/block new instances outside original gesture context)
    +    +    -    +    +- Fixed run_audit.ps1 .Count error: wrapped pipeline result in @() to ensure array type when single file is claimed
    +    +    -    +    +- Updated test_runs_latest.md with current pass counts (240 backend, 49 frontend)
    +    +    -    +    +
    +    +    -    +    +## Files Changed (staged)
    +    +    -    +     - Forge/evidence/test_runs_latest.md
    +    +    -    +    -- Forge/evidence/updatedifflog.md
    +    +    -    +    +- Forge/scripts/run_audit.ps1
    +    +    -    +    +- web/src/components/QuestionnaireModal.tsx
    +    +    -    +    +
    +    +    -    +    +## git status -sb
    +    +    -    +    +    ## master...origin/master [ahead 2]
    +    +    -    +    +    M  Forge/evidence/test_runs_latest.md
    +    +    -    +    +     M Forge/evidence/updatedifflog.md
    +    +    -    +    +    M  Forge/scripts/run_audit.ps1
    +    +    -    +    +     M USER_INSTRUCTIONS.md
    +    +    -    +    +     M app/api/routers/auth.py
    +    +    -    +    +     M app/api/routers/projects.py
    +    +    -    +    +     M app/clients/llm_client.py
    +    +    -    +    +     M app/config.py
    +    +    -    +    +     M app/repos/audit_repo.py
    +    +    -    +    +     M app/repos/user_repo.py
    +    +    -    +    +     M app/services/audit_service.py
    +    +    -    +    +     M app/services/build_service.py
    +    +    -    +    +     M app/services/project_service.py
    +    +    -    +    +     M tests/test_audit_service.py
    +    +    -    +    +     M tests/test_auth_router.py
    +    +    -    +    +     M tests/test_build_service.py
    +    +    -    +    +     M tests/test_llm_client.py
    +    +    -    +    +     M tests/test_project_service.py
    +    +    -    +    +     M tests/test_projects_router.py
    +    +    -    +    +     M web/src/App.tsx
    +    +    -    +    +     M web/src/__tests__/App.test.tsx
    +    +    -    +    +     M web/src/components/AppShell.tsx
    +    +    -    +    +    M  web/src/components/QuestionnaireModal.tsx
    +    +    -    +    +     M web/src/context/AuthContext.tsx
    +    +    -    +    +     M web/src/pages/BuildComplete.tsx
    +    +    -    +    +     M web/src/pages/BuildProgress.tsx
    +    +    -    +    +     M web/src/pages/ProjectDetail.tsx
    +    +    -    +    +     M web/vite.config.ts
    +    +    -    +    +    ?? db/migrations/006_user_api_key.sql
    +    +    -    +    +    ?? web/src/components/ContractProgress.tsx
    +    +    -    +    +    ?? web/src/pages/Settings.tsx
    +    +    -    +     
    +    +    -    +     ## Verification
    +    +    -    +    -- Static: all files compile (compileall + tsc pass)
    +    +    -    +    -- Runtime: 219 pytest + 39 vitest = 258 tests pass (was 243)
    +    +    -    +    -- Behavior: backfill syncs missing commits, Create Project modal submits to backend
    +    +    -    +    -- Contract: no phase contract changes needed (post-phase enhancement)
    +    +    -    +    +- TODO: verification evidence (static -> runtime -> behavior -> contract).
    +    +    -    +     
    +    +    -    +     ## Notes (optional)
    +    +    -    +    -- Backfill fetches up to 300 recent commits (3 pages ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£Ôòæ 100) per sync
    +    +    -    +    -- Backfill continues processing if individual commits error (graceful degradation)
    +    +    -    +    +- TODO: blockers, risks, constraints.
    +    +    -    +     
    +    +    -    +     ## Next Steps
    +    +    -    +    -- Features ready for manual QA with live GitHub repos
    +    +    -    +    +- TODO: next actions (small, specific).
    +    +    -    +    +
    +    +    -    +    +## Minimal Diff Hunks
    +    +    -    +    +    diff --git a/Forge/evidence/test_runs_latest.md b/Forge/evidence/test_runs_latest.md
    +    +    -    +    +    index 84a13ac..ad6bd57 100644
    +    +    -    +    +    --- a/Forge/evidence/test_runs_latest.md
    +    +    -    +    +    +++ b/Forge/evidence/test_runs_latest.md
    +    +    -    +    +    @@ -1,19 +1,17 @@
    +    +    -    +    +     ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝├ö├▓├ÿ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬ú├ö├╗├åÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔòùÔö£ÔöñÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬óStatus: PASS
    +    +    -    +    +    -Start: 2026-02-15T04:40:00Z
    +    +    -    +    +    -End: 2026-02-15T04:41:00Z
    +    +    -    +    +    +Start: 2026-02-15T16:20:00Z
    +    +    -    +    +    +End: 2026-02-15T16:21:00Z
    +    +    -    +    +     Branch: master
    +    +    -    +    +    -HEAD: post-phase-enhancement
    +    +    -    +    +    +HEAD: 3a575f8
    +    +    -    +    +     Runtime: Z:\ForgeCollection\ForgeGuard\.venv\Scripts\python.exe
    +    +    -    +    +     compileall exit: 0
    +    +    -    +    +     import_sanity exit: 0
    +    +    -    +    +     
    +    +    -    +    +     ## Backend (pytest)
    +    +    -    +    +    -- 219 passed, 0 failed, 1 warning
    +    +    -    +    +    -- Duration: 12.58s
    +    +    -    +    +    -- New tests: test_audit_service (5), test_github_client (3), test_repos_router sync (3)
    +    +    -    +    +    +- 240 passed, 0 failed, 1 warning
    +    +    -    +    +    +- Duration: 13.60s
    +    +    -    +    +     
    +    +    -    +    +     ## Frontend (vitest)
    +    +    -    +    +    -- 39 passed, 0 failed
    +    +    -    +    +    -- Duration: 2.17s
    +    +    -    +    +    -- New tests: CreateProjectModal (4)
    +    +    -    +    +    +- 49 passed, 0 failed
    +    +    -    +    +    +- Duration: 2.59s
    +    +    -    +    +     
    +    +    -    +    +    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    +    +    -    +    +    index 369350b..d8df0cf 100644
    +    +    -    +    +    --- a/Forge/scripts/run_audit.ps1
    +    +    -    +    +    +++ b/Forge/scripts/run_audit.ps1
    +    +    -    +    +    @@ -1,4 +1,4 @@
    +    +    -    +    +    -├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝├ö├▓├ÿ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬ú├ö├╗├åÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔòùÔö£ÔöñÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬ó# scripts/run_audit.ps1
    +    +    -    +    +    +# scripts/run_audit.ps1
    +    +    -    +    +     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    +    +    -    +    +     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    +    +    -    +    +     # Reads layer boundaries from Contracts/boundaries.json.
    +    +    -    +    +    @@ -24,7 +24,7 @@ param(
    +    +    -    +    +     Set-StrictMode -Version Latest
    +    +    -    +    +     $ErrorActionPreference = "Stop"
    +    +    -    +    +     
    +    +    -    +    +    -# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª Helpers ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +# -- Helpers ------------------------------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    +    +    -    +    +     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    +    +    -    +    +    @@ -41,7 +41,7 @@ function RepoRoot {
    +    +    -    +    +       return (& git rev-parse --show-toplevel).Trim()
    +    +    -    +    +     }
    +    +    -    +    +     
    +    +    -    +    +    -# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª Main ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +# -- Main ---------------------------------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +     try {
    +    +    -    +    +       RequireGit
    +    +    -    +    +    @@ -54,10 +54,10 @@ try {
    +    +    -    +    +       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    +    +    -    +    +     
    +    +    -    +    +       # Parse claimed files into a sorted, normalized set
    +    +    -    +    +    -  $claimed = $ClaimedFiles.Split(",") |
    +    +    -    +    +    +  $claimed = @($ClaimedFiles.Split(",") |
    +    +    -    +    +         ForEach-Object { $_.Trim().Replace("\", "/") } |
    +    +    -    +    +         Where-Object { $_ -ne "" } |
    +    +    -    +    +    -    Sort-Object -Unique
    +    +    -    +    +    +    Sort-Object -Unique)
    +    +    -    +    +     
    +    +    -    +    +       if ($claimed.Count -eq 0) {
    +    +    -    +    +         throw "ClaimedFiles is empty."
    +    +    -    +    +    @@ -79,7 +79,7 @@ try {
    +    +    -    +    +       $warnings  = [ordered]@{}
    +    +    -    +    +       $anyFail   = $false
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A1: Scope compliance ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A1: Scope compliance -----------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    +    +    -    +    +    @@ -111,7 +111,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A2: Minimal-diff discipline ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A2: Minimal-diff discipline ----------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         $summaryRaw = & git diff --cached --summary 2>&1
    +    +    -    +    +    @@ -133,7 +133,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A3: Evidence completeness ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A3: Evidence completeness ------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         $a3Failures = @()
    +    +    -    +    +    @@ -164,7 +164,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A4: Boundary compliance (reads Contracts/boundaries.json) ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         $a4Violations = @()
    +    +    -    +    +    @@ -213,7 +213,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A5: Diff Log Gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A5: Diff Log Gate --------------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         if (-not (Test-Path $diffLog)) {
    +    +    -    +    +    @@ -237,7 +237,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A6: Authorization Gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A6: Authorization Gate ---------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         $lastAuthHash = $null
    +    +    -    +    +    @@ -268,7 +268,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A7: Verification hierarchy order ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A7: Verification hierarchy order -----------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         if (-not (Test-Path $diffLog)) {
    +    +    -    +    +    @@ -324,7 +324,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A8: Test gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A8: Test gate ------------------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         if (-not (Test-Path $testRunsLatest)) {
    +    +    -    +    +    @@ -344,7 +344,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª A9: Dependency gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- A9: Dependency gate ------------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         $a9Failures = @()
    +    +    -    +    +    @@ -508,7 +508,7 @@ try {
    +    +    -    +    +         $anyFail = $true
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª W1: No secrets in diff ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- W1: No secrets in diff --------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         $diffContent = & git diff --cached 2>&1
    +    +    -    +    +    @@ -534,7 +534,7 @@ try {
    +    +    -    +    +         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª W2: Audit ledger integrity ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- W2: Audit ledger integrity ----------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         if (-not (Test-Path $auditLedger)) {
    +    +    -    +    +    @@ -548,7 +548,7 @@ try {
    +    +    -    +    +         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª W3: Physics route coverage ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- W3: Physics route coverage ----------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       try {
    +    +    -    +    +         if (-not (Test-Path $physicsYaml)) {
    +    +    -    +    +    @@ -613,7 +613,7 @@ try {
    +    +    -    +    +         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    +    +    -    +    +       }
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª Build output ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- Build output ------------------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    +    +    -    +    +     
    +    +    -    +    +    @@ -643,7 +643,7 @@ Overall: $overall
    +    +    -    +    +     
    +    +    -    +    +       Write-Output $output
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª Append to audit ledger ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- Append to audit ledger ---------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       $iteration = 1
    +    +    -    +    +       if (Test-Path $auditLedger) {
    +    +    -    +    +    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    +    +    -    +    +       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    +    +    -    +    +       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    +    +    -    +    +     
    +    +    -    +    +    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª Exit ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª
    +    +    -    +    +    +  # -- Exit ---------------------------------------------------------------
    +    +    -    +    +     
    +    +    -    +    +       if ($anyFail) {
    +    +    -    +    +         exit 1
    +    +    -    +    +    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    +    +    -    +    +    index 2b28280..bd8693a 100644
    +    +    -    +    +    --- a/web/src/components/QuestionnaireModal.tsx
    +    +    -    +    +    +++ b/web/src/components/QuestionnaireModal.tsx
    +    +    -    +    +    @@ -7,6 +7,7 @@
    +    +    -    +    +      */
    +    +    -    +    +     import { useState, useEffect, useRef, useCallback } from 'react';
    +    +    -    +    +     import { useAuth } from '../context/AuthContext';
    +    +    -    +    +    +import ContractProgress from './ContractProgress';
    +    +    -    +    +     
    +    +    -    +    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -    +    +     
    +    +    -    +    +    @@ -34,6 +35,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    +    +    -    +    +     interface ChatMessage {
    +    +    -    +    +       role: 'user' | 'assistant';
    +    +    -    +    +       content: string;
    +    +    -    +    +    +  section?: string;
    +    +    -    +    +     }
    +    +    -    +    +     
    +    +    -    +    +     interface QuestionnaireState {
    +    +    -    +    +    @@ -150,12 +152,21 @@ const SpeechRecognition =
    +    +    -    +    +         : null;
    +    +    -    +    +     
    +    +    -    +    +     function useSpeechRecognition(onResult: (text: string) => void) {
    +    +    -    +    +    -  const recognitionRef = useRef<any>(null);
    +    +    -    +    +       const [listening, setListening] = useState(false);
    +    +    -    +    +       const listeningRef = useRef(false);
    +    +    -    +    +    +  const recRef = useRef<any>(null);
    +    +    -    +    +    +  const onResultRef = useRef(onResult);
    +    +    -    +    +    +  onResultRef.current = onResult;
    +    +    -    +    +    +
    +    +    -    +    +    +  /* Lazily create a single SpeechRecognition instance and keep it for the
    +    +    -    +    +    +     lifetime of the component.  Browsers throttle or block new instances
    +    +    -    +    +    +     created outside a user-gesture context, which is why creating a fresh
    +    +    -    +    +    +     instance on every start() caused the second activation to silently die
    +    +    -    +    +    +     after a few seconds. */
    +    +    -    +    +    +  const getRec = useCallback(() => {
    +    +    -    +    +    +    if (recRef.current) return recRef.current;
    +    +    -    +    +    +    if (!SpeechRecognition) return null;
    +    +    -    +    +     
    +    +    -    +    +    -  useEffect(() => {
    +    +    -    +    +    -    if (!SpeechRecognition) return;
    +    +    -    +    +         const rec = new SpeechRecognition();
    +    +    -    +    +         rec.continuous = true;
    +    +    -    +    +         rec.interimResults = true;
    +    +    -    +    +    @@ -169,64 +180,93 @@ function useSpeechRecognition(onResult: (text: string) => void) {
    +    +    -    +    +             }
    +    +    -    +    +           }
    +    +    -    +    +           if (finalTranscript) {
    +    +    -    +    +    -        onResult(finalTranscript);
    +    +    -    +    +    +        onResultRef.current(finalTranscript);
    +    +    -    +    +           }
    +    +    -    +    +         };
    +    +    -    +    +     
    +    +    -    +    +         rec.onerror = (e: any) => {
    +    +    -    +    +    -      /* 'no-speech' and 'aborted' are normal during pauses ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½ auto-restart */
    +    +    -    +    +           if (e.error === 'no-speech' || e.error === 'aborted') {
    +    +    -    +    +    +        /* Browser fires these during normal pauses ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½ restart if still active */
    +    +    -    +    +             if (listeningRef.current) {
    +    +    -    +    +    -          try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +    +          setTimeout(() => {
    +    +    -    +    +    +            if (listeningRef.current) {
    +    +    -    +    +    +              try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +    +            }
    +    +    -    +    +    +          }, 300);
    +    +    -    +    +             }
    +    +    -    +    +             return;
    +    +    -    +    +           }
    +    +    -    +    +    +      /* Real error ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½ stop */
    +    +    -    +    +           listeningRef.current = false;
    +    +    -    +    +           setListening(false);
    +    +    -    +    +         };
    +    +    -    +    +     
    +    +    -    +    +    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    +    +    -    +    +         rec.onend = () => {
    +    +    -    +    +    +      /* Browser ends recognition after silence; auto-restart if user hasn't toggled off */
    +    +    -    +    +           if (listeningRef.current) {
    +    +    -    +    +    -        try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +    -      } else {
    +    +    -    +    +    -        setListening(false);
    +    +    -    +    +    +        setTimeout(() => {
    +    +    -    +    +    +          if (listeningRef.current) {
    +    +    -    +    +    +            try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +    +          }
    +    +    -    +    +    +        }, 300);
    +    +    -    +    +           }
    +    +    -    +    +         };
    +    +    -    +    +     
    +    +    -    +    +    -    recognitionRef.current = rec;
    +    +    -    +    +    -    return () => {
    +    +    -    +    +    -      listeningRef.current = false;
    +    +    -    +    +    -      rec.abort();
    +    +    -    +    +    -    };
    +    +    -    +    +    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    +    +    -    +    +    +    recRef.current = rec;
    +    +    -    +    +    +    return rec;
    +    +    -    +    +       }, []);
    +    +    -    +    +     
    +    +    -    +    +    -  const toggle = useCallback(() => {
    +    +    -    +    +    -    const rec = recognitionRef.current;
    +    +    -    +    +    +  const stop = useCallback(() => {
    +    +    -    +    +    +    listeningRef.current = false;
    +    +    -    +    +    +    setListening(false);
    +    +    -    +    +    +    const rec = recRef.current;
    +    +    -    +    +    +    if (rec) {
    +    +    -    +    +    +      try { rec.stop(); } catch { /* ignore */ }
    +    +    -    +    +    +    }
    +    +    -    +    +    +  }, []);
    +    +    -    +    +    +
    +    +    -    +    +    +  const start = useCallback(() => {
    +    +    -    +    +    +    const rec = getRec();
    +    +    -    +    +         if (!rec) return;
    +    +    -    +    +    +    /* Stop any active session first, then restart */
    +    +    -    +    +    +    try { rec.stop(); } catch { /* not running */ }
    +    +    -    +    +    +    listeningRef.current = true;
    +    +    -    +    +    +    setListening(true);
    +    +    -    +    +    +    /* Small delay to let the previous stop() settle */
    +    +    -    +    +    +    setTimeout(() => {
    +    +    -    +    +    +      if (listeningRef.current) {
    +    +    -    +    +    +        try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +    +      }
    +    +    -    +    +    +    }, 100);
    +    +    -    +    +    +  }, [getRec]);
    +    +    -    +    +    +
    +    +    -    +    +    +  const toggle = useCallback(() => {
    +    +    -    +    +         if (listening) {
    +    +    -    +    +    -      listeningRef.current = false;
    +    +    -    +    +    -      rec.abort();
    +    +    -    +    +    -      setListening(false);
    +    +    -    +    +    +      stop();
    +    +    -    +    +         } else {
    +    +    -    +    +    -      listeningRef.current = true;
    +    +    -    +    +    -      rec.start();
    +    +    -    +    +    -      setListening(true);
    +    +    -    +    +    +      start();
    +    +    -    +    +         }
    +    +    -    +    +    -  }, [listening]);
    +    +    -    +    +    +  }, [listening, start, stop]);
    +    +    -    +    +    +
    +    +    -    +    +    +  /* Cleanup on unmount */
    +    +    -    +    +    +  useEffect(() => {
    +    +    -    +    +    +    return () => {
    +    +    -    +    +    +      listeningRef.current = false;
    +    +    -    +    +    +      const rec = recRef.current;
    +    +    -    +    +    +      recRef.current = null;
    +    +    -    +    +    +      if (rec) {
    +    +    -    +    +    +        rec.onresult = null;
    +    +    -    +    +    +        rec.onerror = null;
    +    +    -    +    +    +        rec.onend = null;
    +    +    -    +    +    +        try { rec.abort(); } catch { /* ignore */ }
    +    +    -    +    +    +      }
    +    +    -    +    +    +    };
    +    +    -    +    +    +  }, []);
    +    +    -    +    +     
    +    +    -    +    +       return { listening, toggle, supported: !!SpeechRecognition };
    +    +    -    +    +     }
    +    +    -    +    +     
    +    +    -    +    +    -function speak(text: string) {
    +    +    -    +    +    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    +    +    -    +    +    -  window.speechSynthesis.cancel();
    +    +    -    +    +    -  const utter = new SpeechSynthesisUtterance(text);
    +    +    -    +    +    -  utter.rate = 1.05;
    +    +    -    +    +    -  utter.pitch = 1;
    +    +    -    +    +    -  window.speechSynthesis.speak(utter);
    +    +    -    +    +    -}
    +    +    -    +    +    +
    +    +    -    +    +     
    +    +    -    +    +     /* ------------------------------------------------------------------ */
    +    +    -    +    +     /*  Progress bar                                                      */
    +    +    -    +    +    @@ -265,7 +305,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +    +       const [messages, setMessages] = useState<ChatMessage[]>([]);
    +    +    -    +    +       const [input, setInput] = useState('');
    +    +    -    +    +       const [sending, setSending] = useState(false);
    +    +    -    +    +    -  const [generating, setGenerating] = useState(false);
    +    +    -    +    +       const [qState, setQState] = useState<QuestionnaireState>({
    +    +    -    +    +         current_section: 'product_intent',
    +    +    -    +    +         completed_sections: [],
    +    +    -    +    +    @@ -273,7 +312,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +    +         is_complete: false,
    +    +    -    +    +       });
    +    +    -    +    +       const [error, setError] = useState('');
    +    +    -    +    +    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    +    +    -    +    +    +  const [resetting, setResetting] = useState(false);
    +    +    -    +    +    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    +    +    -    +    +    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    +    +    -    +    +       const messagesEndRef = useRef<HTMLDivElement>(null);
    +    +    -    +    +       const textareaRef = useRef<HTMLTextAreaElement>(null);
    +    +    -    +    +     
    +    +    -    +    +    @@ -307,13 +348,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +    +                 remaining_sections: state.remaining_sections,
    +    +    -    +    +                 is_complete: state.is_complete,
    +    +    -    +    +               });
    +    +    -    +    +    -          /* Restore prior conversation */
    +    +    -    +    +    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    +    +    -    +    +    -            (m: { role: string; content: string }) => ({
    +    +    -    +    +    -              role: m.role as 'user' | 'assistant',
    +    +    -    +    +    -              content: m.content,
    +    +    -    +    +    -            }),
    +    +    -    +    +    -          );
    +    +    -    +    +    +          /* Restore prior conversation ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½ only messages from the current section */
    +    +    -    +    +    +          const currentSec = state.current_section;
    +    +    -    +    +    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    +    +    -    +    +    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    +    +    -    +    +    +            .map(
    +    +    -    +    +    +              (m: { role: string; content: string; section?: string }) => ({
    +    +    -    +    +    +                role: m.role as 'user' | 'assistant',
    +    +    -    +    +    +                content: m.content,
    +    +    -    +    +    +                section: m.section,
    +    +    -    +    +    +              }),
    +    +    -    +    +    +            );
    +    +    -    +    +    +          /* Restore token usage */
    +    +    -    +    +    +          if (state.token_usage) {
    +    +    -    +    +    +            setTokenUsage(state.token_usage);
    +    +    -    +    +    +          }
    +    +    -    +    +               if (history.length > 0) {
    +    +    -    +    +                 setMessages(history);
    +    +    -    +    +               } else if (!state.is_complete) {
    +    +    -    +    +    @@ -367,18 +416,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +    +           }
    +    +    -    +    +     
    +    +    -    +    +           const data = await res.json();
    +    +    -    +    +    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    +    +    -    +    +    +
    +    +    -    +    +    +      /* Detect section transition ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½ clear visible messages for a fresh screen */
    +    +    -    +    +    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    +    +    -    +    +    +      const prevSection = qState.current_section;
    +    +    -    +    +    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    +    +    -    +    +    +
    +    +    -    +    +    +      if (sectionChanged) {
    +    +    -    +    +    +        /* Section just completed ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½ start fresh with only the transition reply */
    +    +    -    +    +    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    +    +    -    +    +    +      } else {
    +    +    -    +    +    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    +    +    -    +    +    +      }
    +    +    -    +    +    +
    +    +    -    +    +           setQState({
    +    +    -    +    +    -        current_section: data.remaining_sections[0] ?? null,
    +    +    -    +    +    +        current_section: newCurrentSection,
    +    +    -    +    +             completed_sections: data.completed_sections,
    +    +    -    +    +             remaining_sections: data.remaining_sections,
    +    +    -    +    +             is_complete: data.is_complete,
    +    +    -    +    +           });
    +    +    -    +    +     
    +    +    -    +    +    -      /* auto-read assistant reply with TTS */
    +    +    -    +    +    -      if (voiceEnabled) {
    +    +    -    +    +    -        speak(data.reply);
    +    +    -    +    +    +      /* Update token usage */
    +    +    -    +    +    +      if (data.token_usage) {
    +    +    -    +    +    +        setTokenUsage(data.token_usage);
    +    +    -    +    +           }
    +    +    -    +    +    +
    +    +    -    +    +         } catch {
    +    +    -    +    +           setError('Network error');
    +    +    -    +    +         } finally {
    +    +    -    +    +    @@ -387,25 +449,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +    +       };
    +    +    -    +    +     
    +    +    -    +    +       /* ---- Generate contracts ---- */
    +    +    -    +    +    -  const handleGenerate = async () => {
    +    +    -    +    +    -    setGenerating(true);
    +    +    -    +    +    -    setError('');
    +    +    -    +    +    -    try {
    +    +    -    +    +    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    +    -    +    +    -        method: 'POST',
    +    +    -    +    +    -        headers: { Authorization: `Bearer ${token}` },
    +    +    -    +    +    -      });
    +    +    -    +    +    -      if (res.ok) {
    +    +    -    +    +    -        onContractsGenerated();
    +    +    -    +    +    -      } else {
    +    +    -    +    +    -        const d = await res.json().catch(() => ({}));
    +    +    -    +    +    -        setError(d.detail || 'Failed to generate contracts');
    +    +    -    +    +    -      }
    +    +    -    +    +    -    } catch {
    +    +    -    +    +    -      setError('Network error');
    +    +    -    +    +    -    } finally {
    +    +    -    +    +    -      setGenerating(false);
    +    +    -    +    +    -    }
    +    +    -    +    +    +  const handleStartGenerate = () => {
    +    +    -    +    +    +    setGeneratingContracts(true);
    +    +    -    +    +       };
    +    +    -    +    +     
    +    +    -    +    +       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    +    +    -    +    +    @@ -442,21 +487,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +    +                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    +    +    -    +    +                       : 'Starting...'}
    +    +    -    +    +                 </p>
    +    +    -    +    +    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    +    +    -    +    +    +              Model: claude-haiku-4-5
    +    +    -    +    +    +            </p>
    +    +    -    +    +    +            {/* Context window meter */}
    +    +    -    +    +    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    +    +    -    +    +    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    +    -    +    +    +              const contextWindow = 200_000;
    +    +    -    +    +    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    +    +    -    +    +    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    +    +    -    +    +    +              return (
    +    +    -    +    +    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    +    +    -    +    +    +                  <div style={{
    +    +    -    +    +    +                    flex: 1,
    +    +    -    +    +    +                    height: '4px',
    +    +    -    +    +    +                    background: '#1E293B',
    +    +    -    +    +    +                    borderRadius: '2px',
    +    +    -    +    +    +                    overflow: 'hidden',
    +    +    -    +    +    +                    maxWidth: '120px',
    +    +    -    +    +    +                  }}>
    +    +    -    +    +    +                    <div style={{
    +    +    -    +    +    +                      width: `${pct}%`,
    +    +    -    +    +    +                      height: '100%',
    +    +    -    +    +    +                      background: barColor,
    +    +    -    +    +    +                      borderRadius: '2px',
    +    +    -    +    +    +                      transition: 'width 0.3s',
    +    +    -    +    +    +                    }} />
    +    +    -    +    +    +                  </div>
    +    +    -    +    +    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    +    +    -    +    +    +                    {totalTokens.toLocaleString()} / 200K
    +    +    -    +    +    +                  </span>
    +    +    -    +    +    +                </div>
    +    +    -    +    +    +              );
    +    +    -    +    +    +            })()}
    +    +    -    +    +               </div>
    +    +    -    +    +               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    +    +    -    +    +    -            {/* Voice toggle */}
    +    +    -    +    +    +            {/* Restart questionnaire */}
    +    +    -    +    +                 <button
    +    +    -    +    +    -              onClick={() => setVoiceEnabled((v) => !v)}
    +    +    -    +    +    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    +    +    -    +    +    -              data-testid="voice-toggle"
    +    +    -    +    +    +              onClick={async () => {
    +    +    -    +    +    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    +    +    -    +    +    +                setResetting(true);
    +    +    -    +    +    +                try {
    +    +    -    +    +    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    +    +    -    +    +    +                    method: 'DELETE',
    +    +    -    +    +    +                    headers: { Authorization: `Bearer ${token}` },
    +    +    -    +    +    +                  });
    +    +    -    +    +    +                  if (res.ok) {
    +    +    -    +    +    +                    setMessages([]);
    +    +    -    +    +    +                    setQState({
    +    +    -    +    +    +                      current_section: 'product_intent',
    +    +    -    +    +    +                      completed_sections: [],
    +    +    -    +    +    +                      remaining_sections: [...ALL_SECTIONS],
    +    +    -    +    +    +                      is_complete: false,
    +    +    -    +    +    +                    });
    +    +    -    +    +    +                    setInput('');
    +    +    -    +    +    +                    setError('');
    +    +    -    +    +    +                  }
    +    +    -    +    +    +                } catch { /* ignore */ }
    +    +    -    +    +    +                setResetting(false);
    +    +    -    +    +    +              }}
    +    +    -    +    +    +              disabled={resetting}
    +    +    -    +    +    +              title="Restart questionnaire"
    +    +    -    +    +    +              data-testid="restart-btn"
    +    +    -    +    +                   style={{
    +    +    -    +    +                     ...btnGhost,
    +    +    -    +    +                     padding: '6px 10px',
    +    +    -    +    +    -                fontSize: '1rem',
    +    +    -    +    +    -                opacity: voiceEnabled ? 1 : 0.5,
    +    +    -    +    +    +                fontSize: '0.7rem',
    +    +    -    +    +    +                fontWeight: 600,
    +    +    -    +    +    +                color: '#F59E0B',
    +    +    -    +    +    +                borderColor: '#F59E0B33',
    +    +    -    +    +    +                opacity: resetting ? 0.5 : 1,
    +    +    -    +    +                   }}
    +    +    -    +    +                 >
    +    +    -    +    +    -              {voiceEnabled ? '├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝├ö├▓├ÿÔö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬úÔö¼├¡Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼ÔòØÔö£├ÂÔö£├éÔö£├½' : '├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝├ö├▓├ÿÔö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬úÔö¼├¡Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼ÔòØÔö£├ÂÔö£ÔûôÔö£┬¬'}
    +    +    -    +    +    +              ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬¼Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔòùÔö£ÔöñÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£Ôòæ Restart
    +    +    -    +    +                 </button>
    +    +    -    +    +                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    +    +    -    +    +                   ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝├ö├▓├ÿÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£┬¬├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£Ôòæ├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├╣├ö├Â┬ú├ö├Â├▒
    +    +    -    +    +    @@ -514,8 +617,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +    +               </div>
    +    +    -    +    +             )}
    +    +    -    +    +     
    +    +    -    +    +    +        {/* Contract generation progress */}
    +    +    -    +    +    +        {generatingContracts && (
    +    +    -    +    +    +          <ContractProgress
    +    +    -    +    +    +            projectId={projectId}
    +    +    -    +    +    +            tokenUsage={tokenUsage}
    +    +    -    +    +    +            model="claude-haiku-4-5"
    +    +    -    +    +    +            onComplete={onContractsGenerated}
    +    +    -    +    +    +          />
    +    +    -    +    +    +        )}
    +    +    -    +    +    +
    +    +    -    +    +             {/* Generate contracts banner */}
    +    +    -    +    +    -        {qState.is_complete && (
    +    +    -    +    +    +        {qState.is_complete && !generatingContracts && (
    +    +    -    +    +               <div
    +    +    -    +    +                 style={{
    +    +    -    +    +                   padding: '12px 20px',
    +    +    -    +    +    @@ -533,17 +646,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +    +                   ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝├ö├▓├ÿÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£┬¬├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£Ôòæ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬ú├ö├╗├å All sections complete ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼┬½ ready to generate contracts
    +    +    -    +    +                 </span>
    +    +    -    +    +                 <button
    +    +    -    +    +    -              onClick={handleGenerate}
    +    +    -    +    +    -              disabled={generating}
    +    +    -    +    +    +              onClick={handleStartGenerate}
    +    +    -    +    +                   data-testid="generate-contracts-btn"
    +    +    -    +    +                   style={{
    +    +    -    +    +                     ...btnPrimary,
    +    +    -    +    +                     background: '#16A34A',
    +    +    -    +    +    -                opacity: generating ? 0.6 : 1,
    +    +    -    +    +    -                cursor: generating ? 'wait' : 'pointer',
    +    +    -    +    +    +                cursor: 'pointer',
    +    +    -    +    +                   }}
    +    +    -    +    +                 >
    +    +    -    +    +    -              {generating ? 'Generating...' : 'Generate Contracts'}
    +    +    -    +    +    +              Generate Contracts
    +    +    -    +    +                 </button>
    +    +    -    +    +               </div>
    +    +    -    +    +             )}
    +    +    -    +     
    +    +    -    +    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    +    +    -    +    index 369350b..d8df0cf 100644
    +    +    -    +    --- a/Forge/scripts/run_audit.ps1
    +    +    -    +    +++ b/Forge/scripts/run_audit.ps1
    +    +    -    +    @@ -1,4 +1,4 @@
    +    +    -    +    -Ôö£├ÂÔö£├éÔö¼ÔòØÔö£├ÂÔö£├éÔö£ÔûÆ├ö├Â┬úÔö£├é├ö├Â┬ú├ö├╗├┤├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬¢# scripts/run_audit.ps1
    +    +    -    +    +# scripts/run_audit.ps1
    +    +    -    +     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    +    +    -    +     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    +    +    -    +     # Reads layer boundaries from Contracts/boundaries.json.
    +    +    -    +    @@ -24,7 +24,7 @@ param(
    +    +    -    +     Set-StrictMode -Version Latest
    +    +    -    +     $ErrorActionPreference = "Stop"
    +    +    -    +     
    +    +    -    +    -# Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Helpers Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +# -- Helpers ------------------------------------------------------------------
    +    +    -    +     
    +    +    -    +     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    +    +    -    +     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    +    +    -    +    @@ -41,7 +41,7 @@ function RepoRoot {
    +    +    -    +       return (& git rev-parse --show-toplevel).Trim()
    +    +    -    +     }
    +    +    -    +     
    +    +    -    +    -# Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Main Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +# -- Main ---------------------------------------------------------------------
    +    +    -    +     
    +    +    -    +     try {
    +    +    -    +       RequireGit
    +    +    -    +    @@ -54,10 +54,10 @@ try {
    +    +    -    +       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    +    +    -    +     
    +    +    -    +       # Parse claimed files into a sorted, normalized set
    +    +    -    +    -  $claimed = $ClaimedFiles.Split(",") |
    +    +    -    +    +  $claimed = @($ClaimedFiles.Split(",") |
    +    +    -    +         ForEach-Object { $_.Trim().Replace("\", "/") } |
    +    +    -    +         Where-Object { $_ -ne "" } |
    +    +    -    +    -    Sort-Object -Unique
    +    +    -    +    +    Sort-Object -Unique)
    +    +    -    +     
    +    +    -    +       if ($claimed.Count -eq 0) {
    +    +    -    +         throw "ClaimedFiles is empty."
    +    +    -    +    @@ -79,7 +79,7 @@ try {
    +    +    -    +       $warnings  = [ordered]@{}
    +    +    -    +       $anyFail   = $false
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A1: Scope compliance Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A1: Scope compliance -----------------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    +    +    -    +    @@ -111,7 +111,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A2: Minimal-diff discipline Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A2: Minimal-diff discipline ----------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         $summaryRaw = & git diff --cached --summary 2>&1
    +    +    -    +    @@ -133,7 +133,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A3: Evidence completeness Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A3: Evidence completeness ------------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         $a3Failures = @()
    +    +    -    +    @@ -164,7 +164,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A4: Boundary compliance (reads Contracts/boundaries.json) Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         $a4Violations = @()
    +    +    -    +    @@ -213,7 +213,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A5: Diff Log Gate Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A5: Diff Log Gate --------------------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         if (-not (Test-Path $diffLog)) {
    +    +    -    +    @@ -237,7 +237,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A6: Authorization Gate Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A6: Authorization Gate ---------------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         $lastAuthHash = $null
    +    +    -    +    @@ -268,7 +268,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A7: Verification hierarchy order Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A7: Verification hierarchy order -----------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         if (-not (Test-Path $diffLog)) {
    +    +    -    +    @@ -324,7 +324,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A8: Test gate Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A8: Test gate ------------------------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         if (-not (Test-Path $testRunsLatest)) {
    +    +    -    +    @@ -344,7 +344,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ A9: Dependency gate Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- A9: Dependency gate ------------------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         $a9Failures = @()
    +    +    -    +    @@ -508,7 +508,7 @@ try {
    +    +    -    +         $anyFail = $true
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ W1: No secrets in diff Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- W1: No secrets in diff --------------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         $diffContent = & git diff --cached 2>&1
    +    +    -    +    @@ -534,7 +534,7 @@ try {
    +    +    -    +         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ W2: Audit ledger integrity Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- W2: Audit ledger integrity ----------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         if (-not (Test-Path $auditLedger)) {
    +    +    -    +    @@ -548,7 +548,7 @@ try {
    +    +    -    +         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ W3: Physics route coverage Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- W3: Physics route coverage ----------------------------------------
    +    +    -    +     
    +    +    -    +       try {
    +    +    -    +         if (-not (Test-Path $physicsYaml)) {
    +    +    -    +    @@ -613,7 +613,7 @@ try {
    +    +    -    +         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    +    +    -    +       }
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Build output Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- Build output ------------------------------------------------------
    +    +    -    +     
    +    +    -    +       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    +    +    -    +     
    +    +    -    +    @@ -643,7 +643,7 @@ Overall: $overall
    +    +    -    +     
    +    +    -    +       Write-Output $output
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Append to audit ledger Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- Append to audit ledger ---------------------------------------------
    +    +    -    +     
    +    +    -    +       $iteration = 1
    +    +    -    +       if (Test-Path $auditLedger) {
    +    +    -    +    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    +    +    -    +       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    +    +    -    +       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    +    +    -    +     
    +    +    -    +    -  # Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ Exit Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼Ôòæ
    +    +    -    +    +  # -- Exit ---------------------------------------------------------------
    +    +    -    +     
    +    +    -    +       if ($anyFail) {
    +    +    -    +         exit 1
    +    +    -    +    diff --git a/USER_INSTRUCTIONS.md b/USER_INSTRUCTIONS.md
    +    +    -    +    index c76b33a..ad50c71 100644
    +    +    -    +    --- a/USER_INSTRUCTIONS.md
    +    +    -    +    +++ b/USER_INSTRUCTIONS.md
    +    +    -    +    @@ -87,7 +87,7 @@ APP_URL=http://localhost:8000
    +    +    -    +     - `APP_URL` Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« `http://localhost:8000`
    +    +    -    +     - `ANTHROPIC_API_KEY` Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« required for AI-powered builds (get one at [console.anthropic.com](https://console.anthropic.com))
    +    +    -    +     - `LLM_BUILDER_MODEL` Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« model for builds (default: `claude-opus-4-6`)
    +    +    -    +    -- `LLM_QUESTIONNAIRE_MODEL` Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« model for questionnaire (default: `claude-3-5-haiku-20241022`)
    +    +    -    +    +- `LLM_QUESTIONNAIRE_MODEL` Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« model for questionnaire (default: `claude-haiku-4-5`)
    +    +    -    +     
    +    +    -    +     ---
    +    +    -    +     
    +    +    -    +    diff --git a/app/api/routers/auth.py b/app/api/routers/auth.py
    +    +    -    +    index dffd10d..cf3df44 100644
    +    +    -    +    --- a/app/api/routers/auth.py
    +    +    -    +    +++ b/app/api/routers/auth.py
    +    +    -    +    @@ -1,13 +1,15 @@
    +    +    -    +    -"""Authentication router -- GitHub OAuth flow and user info."""
    +    +    -    +    +"""Authentication router -- GitHub OAuth flow, user info, and BYOK API key management."""
    +    +    -    +     
    +    +    -    +     import secrets
    +    +    -    +     from urllib.parse import urlencode
    +    +    -    +     
    +    +    -    +     from fastapi import APIRouter, Depends, HTTPException, Query, status
    +    +    -    +    +from pydantic import BaseModel
    +    +    -    +     
    +    +    -    +     from app.api.deps import get_current_user
    +    +    -    +     from app.clients.github_client import GITHUB_OAUTH_URL
    +    +    -    +     from app.config import settings
    +    +    -    +    +from app.repos.user_repo import set_anthropic_api_key
    +    +    -    +     from app.services.auth_service import handle_github_callback
    +    +    -    +     
    +    +    -    +     router = APIRouter(prefix="/auth", tags=["auth"])
    +    +    -    +    @@ -66,8 +68,36 @@ async def get_current_user_info(
    +    +    -    +         current_user: dict = Depends(get_current_user),
    +    +    -    +     ) -> dict:
    +    +    -    +         """Return the current authenticated user info."""
    +    +    -    +    +    has_api_key = bool(current_user.get("anthropic_api_key"))
    +    +    -    +         return {
    +    +    -    +             "id": str(current_user["id"]),
    +    +    -    +             "github_login": current_user["github_login"],
    +    +    -    +             "avatar_url": current_user.get("avatar_url"),
    +    +    -    +    +        "has_anthropic_key": has_api_key,
    +    +    -    +         }
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +class ApiKeyBody(BaseModel):
    +    +    -    +    +    api_key: str
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +@router.put("/api-key")
    +    +    -    +    +async def save_api_key(
    +    +    -    +    +    body: ApiKeyBody,
    +    +    -    +    +    current_user: dict = Depends(get_current_user),
    +    +    -    +    +) -> dict:
    +    +    -    +    +    """Save the user's Anthropic API key for BYOK builds."""
    +    +    -    +    +    key = body.api_key.strip()
    +    +    -    +    +    if not key:
    +    +    -    +    +        raise HTTPException(status_code=400, detail="API key cannot be empty")
    +    +    -    +    +    await set_anthropic_api_key(current_user["id"], key)
    +    +    -    +    +    return {"saved": True}
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +@router.delete("/api-key")
    +    +    -    +    +async def remove_api_key(
    +    +    -    +    +    current_user: dict = Depends(get_current_user),
    +    +    -    +    +) -> dict:
    +    +    -    +    +    """Remove the user's stored Anthropic API key."""
    +    +    -    +    +    await set_anthropic_api_key(current_user["id"], None)
    +    +    -    +    +    return {"removed": True}
    +    +    -    +    diff --git a/app/api/routers/projects.py b/app/api/routers/projects.py
    +    +    -    +    index 0e72551..cc00763 100644
    +    +    -    +    --- a/app/api/routers/projects.py
    +    +    -    +    +++ b/app/api/routers/projects.py
    +    +    -    +    @@ -17,6 +17,7 @@ from app.services.project_service import (
    +    +    -    +         list_contracts,
    +    +    -    +         list_user_projects,
    +    +    -    +         process_questionnaire_message,
    +    +    -    +    +    reset_questionnaire,
    +    +    -    +         update_contract,
    +    +    -    +     )
    +    +    -    +     
    +    +    -    +    @@ -177,6 +178,20 @@ async def questionnaire_progress(
    +    +    -    +             )
    +    +    -    +     
    +    +    -    +     
    +    +    -    +    +@router.delete("/{project_id}/questionnaire")
    +    +    -    +    +async def questionnaire_reset(
    +    +    -    +    +    project_id: UUID,
    +    +    -    +    +    current_user: dict = Depends(get_current_user),
    +    +    -    +    +) -> dict:
    +    +    -    +    +    """Reset questionnaire to start over."""
    +    +    -    +    +    try:
    +    +    -    +    +        return await reset_questionnaire(current_user["id"], project_id)
    +    +    -    +    +    except ValueError as exc:
    +    +    -    +    +        raise HTTPException(
    +    +    -    +    +            status_code=status.HTTP_404_NOT_FOUND, detail=str(exc)
    +    +    -    +    +        )
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +     # ---------------------------------------------------------------------------
    +    +    -    +     # Contracts
    +    +    -    +     # ---------------------------------------------------------------------------
    +    +    -    +    diff --git a/app/clients/llm_client.py b/app/clients/llm_client.py
    +    +    -    +    index 60b0218..19622bd 100644
    +    +    -    +    --- a/app/clients/llm_client.py
    +    +    -    +    +++ b/app/clients/llm_client.py
    +    +    -    +    @@ -47,13 +47,20 @@ async def chat_anthropic(
    +    +    -    +                 raise ValueError(f"Anthropic API {response.status_code}: {err_msg}")
    +    +    -    +     
    +    +    -    +         data = response.json()
    +    +    -    +    +    usage = data.get("usage", {})
    +    +    -    +         content_blocks = data.get("content", [])
    +    +    -    +         if not content_blocks:
    +    +    -    +             raise ValueError("Empty response from Anthropic API")
    +    +    -    +     
    +    +    -    +         for block in content_blocks:
    +    +    -    +             if block.get("type") == "text":
    +    +    -    +    -            return block["text"]
    +    +    -    +    +            return {
    +    +    -    +    +                "text": block["text"],
    +    +    -    +    +                "usage": {
    +    +    -    +    +                    "input_tokens": usage.get("input_tokens", 0),
    +    +    -    +    +                    "output_tokens": usage.get("output_tokens", 0),
    +    +    -    +    +                },
    +    +    -    +    +            }
    +    +    -    +     
    +    +    -    +         raise ValueError("No text block in Anthropic API response")
    +    +    -    +     
    +    +    -    +    @@ -112,7 +119,14 @@ async def chat_openai(
    +    +    -    +         if not content:
    +    +    -    +             raise ValueError("No content in OpenAI API response")
    +    +    -    +     
    +    +    -    +    -    return content
    +    +    -    +    +    usage = data.get("usage", {})
    +    +    -    +    +    return {
    +    +    -    +    +        "text": content,
    +    +    -    +    +        "usage": {
    +    +    -    +    +            "input_tokens": usage.get("prompt_tokens", 0),
    +    +    -    +    +            "output_tokens": usage.get("completion_tokens", 0),
    +    +    -    +    +        },
    +    +    -    +    +    }
    +    +    -    +     
    +    +    -    +     
    +    +    -    +     # ---------------------------------------------------------------------------
    +    +    -    +    @@ -147,8 +161,8 @@ async def chat(
    +    +    -    +     
    +    +    -    +         Returns
    +    +    -    +         -------
    +    +    -    +    -    str
    +    +    -    +    -        The assistant's text reply.
    +    +    -    +    +    dict
    +    +    -    +    +        ``{"text": str, "usage": {"input_tokens": int, "output_tokens": int}}``
    +    +    -    +         """
    +    +    -    +         if provider == "openai":
    +    +    -    +             return await chat_openai(api_key, model, system_prompt, messages, max_tokens)
    +    +    -    +    diff --git a/app/config.py b/app/config.py
    +    +    -    +    index dcff943..0845923 100644
    +    +    -    +    --- a/app/config.py
    +    +    -    +    +++ b/app/config.py
    +    +    -    +    @@ -44,7 +44,7 @@ class Settings:
    +    +    -    +         FRONTEND_URL: str = os.getenv("FRONTEND_URL", "http://localhost:5173")
    +    +    -    +         APP_URL: str = os.getenv("APP_URL", "http://localhost:8000")
    +    +    -    +         LLM_QUESTIONNAIRE_MODEL: str = os.getenv(
    +    +    -    +    -        "LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022"
    +    +    -    +    +        "LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5"
    +    +    -    +         )
    +    +    -    +         ANTHROPIC_API_KEY: str = os.getenv("ANTHROPIC_API_KEY", "")
    +    +    -    +         OPENAI_API_KEY: str = os.getenv("OPENAI_API_KEY", "")
    +    +    -    +    diff --git a/app/repos/audit_repo.py b/app/repos/audit_repo.py
    +    +    -    +    index 2bc2568..f30784b 100644
    +    +    -    +    --- a/app/repos/audit_repo.py
    +    +    -    +    +++ b/app/repos/audit_repo.py
    +    +    -    +    @@ -63,6 +63,26 @@ async def update_audit_run(
    +    +    -    +         )
    +    +    -    +     
    +    +    -    +     
    +    +    -    +    +async def mark_stale_audit_runs(repo_id: UUID, stale_minutes: int = 5) -> int:
    +    +    -    +    +    """Mark audit runs stuck in 'pending' or 'running' for longer than
    +    +    -    +    +    *stale_minutes* as 'error'. Returns the number of rows updated."""
    +    +    -    +    +    pool = await get_pool()
    +    +    -    +    +    result = await pool.execute(
    +    +    -    +    +        """
    +    +    -    +    +        UPDATE audit_runs
    +    +    -    +    +        SET status = 'error', overall_result = 'ERROR',
    +    +    -    +    +            completed_at = now()
    +    +    -    +    +        WHERE repo_id = $1
    +    +    -    +    +          AND status IN ('pending', 'running')
    +    +    -    +    +          AND created_at < now() - ($2 || ' minutes')::interval
    +    +    -    +    +        """,
    +    +    -    +    +        repo_id,
    +    +    -    +    +        str(stale_minutes),
    +    +    -    +    +    )
    +    +    -    +    +    # asyncpg returns 'UPDATE N'
    +    +    -    +    +    return int(result.split()[-1])
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +     async def insert_audit_checks(
    +    +    -    +         audit_run_id: UUID,
    +    +    -    +         checks: list[dict],
    +    +    -    +    diff --git a/app/repos/user_repo.py b/app/repos/user_repo.py
    +    +    -    +    index f8a2386..689f7a9 100644
    +    +    -    +    --- a/app/repos/user_repo.py
    +    +    -    +    +++ b/app/repos/user_repo.py
    +    +    -    +    @@ -38,7 +38,17 @@ async def get_user_by_id(user_id: UUID) -> dict | None:
    +    +    -    +         """Fetch a user by primary key. Returns None if not found."""
    +    +    -    +         pool = await get_pool()
    +    +    -    +         row = await pool.fetchrow(
    +    +    -    +    -        "SELECT id, github_id, github_login, avatar_url, access_token, created_at, updated_at FROM users WHERE id = $1",
    +    +    -    +    +        "SELECT id, github_id, github_login, avatar_url, access_token, anthropic_api_key, created_at, updated_at FROM users WHERE id = $1",
    +    +    -    +             user_id,
    +    +    -    +         )
    +    +    -    +         return dict(row) if row else None
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +async def set_anthropic_api_key(user_id: UUID, api_key: str | None) -> None:
    +    +    -    +    +    """Store (or clear) the user's Anthropic API key."""
    +    +    -    +    +    pool = await get_pool()
    +    +    -    +    +    await pool.execute(
    +    +    -    +    +        "UPDATE users SET anthropic_api_key = $2, updated_at = now() WHERE id = $1",
    +    +    -    +    +        user_id,
    +    +    -    +    +        api_key,
    +    +    -    +    +    )
    +    +    -    +    diff --git a/app/services/audit_service.py b/app/services/audit_service.py
    +    +    -    +    index ab835fe..1bf0d18 100644
    +    +    -    +    --- a/app/services/audit_service.py
    +    +    -    +    +++ b/app/services/audit_service.py
    +    +    -    +    @@ -1,5 +1,6 @@
    +    +    -    +     """Audit service -- orchestrates audit execution triggered by webhooks."""
    +    +    -    +     
    +    +    -    +    +import asyncio
    +    +    -    +     import json
    +    +    -    +     import logging
    +    +    -    +     import os
    +    +    -    +    @@ -12,6 +13,7 @@ from app.repos.audit_repo import (
    +    +    -    +         create_audit_run,
    +    +    -    +         get_existing_commit_shas,
    +    +    -    +         insert_audit_checks,
    +    +    -    +    +    mark_stale_audit_runs,
    +    +    -    +         update_audit_run,
    +    +    -    +     )
    +    +    -    +     from app.repos.repo_repo import get_repo_by_github_id, get_repo_by_id
    +    +    -    +    @@ -288,6 +290,11 @@ async def backfill_repo_commits(
    +    +    -    +         full_name = repo["full_name"]
    +    +    -    +         branch = repo.get("default_branch", "main")
    +    +    -    +     
    +    +    -    +    +    # Clean up any audit runs left stuck from a prior interrupted sync
    +    +    -    +    +    cleaned = await mark_stale_audit_runs(repo_id)
    +    +    -    +    +    if cleaned:
    +    +    -    +    +        logger.info("Cleaned %d stale audit runs for repo %s", cleaned, repo_id)
    +    +    -    +    +
    +    +    -    +         # Find the latest audit we already have so we only pull newer commits
    +    +    -    +         existing_shas = await get_existing_commit_shas(repo_id)
    +    +    -    +     
    +    +    -    +    @@ -365,6 +372,16 @@ async def backfill_repo_commits(
    +    +    -    +                 )
    +    +    -    +                 synced += 1
    +    +    -    +     
    +    +    -    +    +        except asyncio.CancelledError:
    +    +    -    +    +            logger.warning("Backfill cancelled for commit %s", sha)
    +    +    -    +    +            await update_audit_run(
    +    +    -    +    +                audit_run_id=audit_run["id"],
    +    +    -    +    +                status="error",
    +    +    -    +    +                overall_result="ERROR",
    +    +    -    +    +                files_checked=0,
    +    +    -    +    +            )
    +    +    -    +    +            raise  # re-raise so the request terminates properly
    +    +    -    +    +
    +    +    -    +             except Exception:
    +    +    -    +                 logger.exception("Backfill failed for commit %s", sha)
    +    +    -    +                 await update_audit_run(
    +    +    -    +    diff --git a/app/services/build_service.py b/app/services/build_service.py
    +    +    -    +    index e98f439..2dcc4bb 100644
    +    +    -    +    --- a/app/services/build_service.py
    +    +    -    +    +++ b/app/services/build_service.py
    +    +    -    +    @@ -17,6 +17,7 @@ from app.clients.agent_client import StreamUsage, stream_agent
    +    +    -    +     from app.config import settings
    +    +    -    +     from app.repos import build_repo
    +    +    -    +     from app.repos import project_repo
    +    +    -    +    +from app.repos.user_repo import get_user_by_id
    +    +    -    +     from app.ws_manager import manager
    +    +    -    +     
    +    +    -    +     # Maximum consecutive loopback failures before stopping
    +    +    -    +    @@ -31,9 +32,25 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
    +    +    -    +     # Active build tasks keyed by build_id
    +    +    -    +     _active_tasks: dict[str, asyncio.Task] = {}
    +    +    -    +     
    +    +    -    +    -# Cost-per-token estimates (USD) -- updated as pricing changes
    +    +    -    +    -_COST_PER_INPUT_TOKEN: Decimal = Decimal("0.000015")   # $15 / 1M input tokens
    +    +    -    +    -_COST_PER_OUTPUT_TOKEN: Decimal = Decimal("0.000075")  # $75 / 1M output tokens
    +    +    -    +    +# Cost-per-token estimates (USD) keyed by model prefix -- updated as pricing changes
    +    +    -    +    +_MODEL_PRICING: dict[str, tuple[Decimal, Decimal]] = {
    +    +    -    +    +    # (input $/token, output $/token)
    +    +    -    +    +    "claude-opus-4":       (Decimal("0.000015"),  Decimal("0.000075")),   # $15 / $75 per 1M
    +    +    -    +    +    "claude-sonnet-4":     (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    +    +    -    +    +    "claude-haiku-4":      (Decimal("0.000001"),  Decimal("0.000005")),   # $1 / $5 per 1M
    +    +    -    +    +    "claude-3-5-sonnet":   (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    +    +    -    +    +}
    +    +    -    +    +# Fallback: Opus pricing (most expensive = safest default)
    +    +    -    +    +_DEFAULT_INPUT_RATE = Decimal("0.000015")
    +    +    -    +    +_DEFAULT_OUTPUT_RATE = Decimal("0.000075")
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
    +    +    -    +    +    """Return (input_rate, output_rate) per token for the given model."""
    +    +    -    +    +    for prefix, rates in _MODEL_PRICING.items():
    +    +    -    +    +        if model.startswith(prefix):
    +    +    -    +    +            return rates
    +    +    -    +    +    return (_DEFAULT_INPUT_RATE, _DEFAULT_OUTPUT_RATE)
    +    +    -    +     
    +    +    -    +     
    +    +    -    +     # ---------------------------------------------------------------------------
    +    +    -    +    @@ -72,6 +89,14 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    +    -    +         if latest and latest["status"] in ("pending", "running"):
    +    +    -    +             raise ValueError("A build is already in progress for this project")
    +    +    -    +     
    +    +    -    +    +    # BYOK: user must supply their own Anthropic API key for builds
    +    +    -    +    +    user = await get_user_by_id(user_id)
    +    +    -    +    +    user_api_key = (user or {}).get("anthropic_api_key") or ""
    +    +    -    +    +    if not user_api_key.strip():
    +    +    -    +    +        raise ValueError(
    +    +    -    +    +            "Anthropic API key required. Add your key in Settings to start a build."
    +    +    -    +    +        )
    +    +    -    +    +
    +    +    -    +         # Create build record
    +    +    -    +         build = await build_repo.create_build(project_id)
    +    +    -    +     
    +    +    -    +    @@ -80,7 +105,7 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    +    -    +     
    +    +    -    +         # Spawn background task
    +    +    -    +         task = asyncio.create_task(
    +    +    -    +    -        _run_build(build["id"], project_id, user_id, contracts)
    +    +    -    +    +        _run_build(build["id"], project_id, user_id, contracts, user_api_key)
    +    +    -    +         )
    +    +    -    +         _active_tasks[str(build["id"])] = task
    +    +    -    +     
    +    +    -    +    @@ -196,6 +221,7 @@ async def _run_build(
    +    +    -    +         project_id: UUID,
    +    +    -    +         user_id: UUID,
    +    +    -    +         contracts: list[dict],
    +    +    -    +    +    api_key: str,
    +    +    -    +     ) -> None:
    +    +    -    +         """Background task that orchestrates the full build lifecycle.
    +    +    -    +     
    +    +    -    +    @@ -232,7 +258,7 @@ async def _run_build(
    +    +    -    +     
    +    +    -    +             # Stream agent output
    +    +    -    +             async for chunk in stream_agent(
    +    +    -    +    -            api_key=settings.ANTHROPIC_API_KEY,
    +    +    -    +    +            api_key=api_key,
    +    +    -    +                 model=settings.LLM_BUILDER_MODEL,
    +    +    -    +                 system_prompt="You are an autonomous software builder operating under the Forge governance framework.",
    +    +    -    +                 messages=messages,
    +    +    -    +    @@ -446,8 +472,9 @@ async def _record_phase_cost(
    +    +    -    +         input_t = usage.input_tokens
    +    +    -    +         output_t = usage.output_tokens
    +    +    -    +         model = usage.model or settings.LLM_BUILDER_MODEL
    +    +    -    +    -    cost = (Decimal(input_t) * _COST_PER_INPUT_TOKEN
    +    +    -    +    -            + Decimal(output_t) * _COST_PER_OUTPUT_TOKEN)
    +    +    -    +    +    input_rate, output_rate = _get_token_rates(model)
    +    +    -    +    +    cost = (Decimal(input_t) * input_rate
    +    +    -    +    +            + Decimal(output_t) * output_rate)
    +    +    -    +         await build_repo.record_build_cost(
    +    +    -    +             build_id, phase, input_t, output_t, model, cost
    +    +    -    +         )
    +    +    -    +    diff --git a/app/services/project_service.py b/app/services/project_service.py
    +    +    -    +    index 46ab7de..491922c 100644
    +    +    -    +    --- a/app/services/project_service.py
    +    +    -    +    +++ b/app/services/project_service.py
    +    +    -    +    @@ -7,6 +7,7 @@ from uuid import UUID
    +    +    -    +     
    +    +    -    +     from app.clients.llm_client import chat as llm_chat
    +    +    -    +     from app.config import settings
    +    +    -    +    +from app.ws_manager import manager
    +    +    -    +     from app.repos.project_repo import (
    +    +    -    +         create_project as repo_create_project,
    +    +    -    +         delete_project as repo_delete_project,
    +    +    -    +    @@ -244,7 +245,7 @@ async def process_questionnaire_message(
    +    +    -    +         )
    +    +    -    +     
    +    +    -    +         try:
    +    +    -    +    -        raw_reply = await llm_chat(
    +    +    -    +    +        llm_result = await llm_chat(
    +    +    -    +                 api_key=llm_api_key,
    +    +    -    +                 model=llm_model,
    +    +    -    +                 system_prompt=dynamic_system,
    +    +    -    +    @@ -255,6 +256,8 @@ async def process_questionnaire_message(
    +    +    -    +             logger.exception("LLM chat failed for project %s", project_id)
    +    +    -    +             raise ValueError(f"LLM service error: {exc}") from exc
    +    +    -    +     
    +    +    -    +    +    raw_reply = llm_result["text"]
    +    +    -    +    +    usage = llm_result.get("usage", {})
    +    +    -    +         logger.info("LLM raw response (first 500 chars): %s", raw_reply[:500])
    +    +    -    +     
    +    +    -    +         # Parse the structured JSON response from the LLM
    +    +    -    +    @@ -263,19 +266,42 @@ async def process_questionnaire_message(
    +    +    -    +                     parsed.get("section_complete"), parsed.get("section"))
    +    +    -    +     
    +    +    -    +         # Update state based on LLM response
    +    +    -    +    -    history.append({"role": "user", "content": message})
    +    +    -    +    -    history.append({"role": "assistant", "content": parsed["reply"]})
    +    +    -    +    +    history.append({"role": "user", "content": message, "section": current_section})
    +    +    -    +     
    +    +    -    +    -    if parsed.get("section_complete") and parsed.get("extracted_data"):
    +    +    -    +    +    # If section just completed, tag the assistant reply with the NEXT section
    +    +    -    +    +    # so it appears in the new section's chat (it contains the transition question).
    +    +    -    +    +    section_just_completed = (
    +    +    -    +    +        parsed.get("section_complete") and parsed.get("extracted_data")
    +    +    -    +    +    )
    +    +    -    +    +    if section_just_completed:
    +    +    -    +             section_name = parsed.get("section", current_section)
    +    +    -    +             answers[section_name] = parsed["extracted_data"]
    +    +    -    +             if section_name not in completed:
    +    +    -    +                 completed.append(section_name)
    +    +    -    +    +        # Determine the next section (if any) for tagging the reply
    +    +    -    +    +        next_section = None
    +    +    -    +    +        for s in QUESTIONNAIRE_SECTIONS:
    +    +    -    +    +            if s not in completed:
    +    +    -    +    +                next_section = s
    +    +    -    +    +                break
    +    +    -    +    +        reply_section = next_section or current_section
    +    +    -    +    +    else:
    +    +    -    +    +        reply_section = current_section
    +    +    -    +    +
    +    +    -    +    +    history.append({"role": "assistant", "content": parsed["reply"], "section": reply_section})
    +    +    -    +    +
    +    +    -    +    +    # Accumulate token usage
    +    +    -    +    +    prev_usage = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    +    +    -    +    +    total_usage = {
    +    +    -    +    +        "input_tokens": prev_usage.get("input_tokens", 0) + usage.get("input_tokens", 0),
    +    +    -    +    +        "output_tokens": prev_usage.get("output_tokens", 0) + usage.get("output_tokens", 0),
    +    +    -    +    +    }
    +    +    -    +     
    +    +    -    +         new_state = {
    +    +    -    +             "completed_sections": completed,
    +    +    -    +             "answers": answers,
    +    +    -    +             "conversation_history": history,
    +    +    -    +    +        "token_usage": total_usage,
    +    +    -    +         }
    +    +    -    +         await update_questionnaire_state(project_id, new_state)
    +    +    -    +     
    +    +    -    +    @@ -292,6 +318,7 @@ async def process_questionnaire_message(
    +    +    -    +             "completed_sections": completed,
    +    +    -    +             "remaining_sections": remaining,
    +    +    -    +             "is_complete": is_complete,
    +    +    -    +    +        "token_usage": total_usage,
    +    +    -    +         }
    +    +    -    +     
    +    +    -    +     
    +    +    -    +    @@ -309,9 +336,26 @@ async def get_questionnaire_state(
    +    +    -    +         qs = project.get("questionnaire_state") or {}
    +    +    -    +         progress = _questionnaire_progress(qs)
    +    +    -    +         progress["conversation_history"] = qs.get("conversation_history", [])
    +    +    -    +    +    progress["token_usage"] = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    +    +    -    +         return progress
    +    +    -    +     
    +    +    -    +     
    +    +    -    +    +async def reset_questionnaire(
    +    +    -    +    +    user_id: UUID,
    +    +    -    +    +    project_id: UUID,
    +    +    -    +    +) -> dict:
    +    +    -    +    +    """Clear all questionnaire state and reset the project to draft."""
    +    +    -    +    +    project = await get_project_by_id(project_id)
    +    +    -    +    +    if not project:
    +    +    -    +    +        raise ValueError("Project not found")
    +    +    -    +    +    if str(project["user_id"]) != str(user_id):
    +    +    -    +    +        raise ValueError("Project not found")
    +    +    -    +    +
    +    +    -    +    +    await update_questionnaire_state(project_id, {})
    +    +    -    +    +    await update_project_status(project_id, "draft")
    +    +    -    +    +    return {"status": "reset"}
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +     # ---------------------------------------------------------------------------
    +    +    -    +     # Contract generation
    +    +    -    +     # ---------------------------------------------------------------------------
    +    +    -    +    @@ -344,7 +388,20 @@ async def generate_contracts(
    +    +    -    +         template_vars = _build_template_vars(project, answers)
    +    +    -    +     
    +    +    -    +         generated = []
    +    +    -    +    -    for contract_type in CONTRACT_TYPES:
    +    +    -    +    +    total = len(CONTRACT_TYPES)
    +    +    -    +    +    for idx, contract_type in enumerate(CONTRACT_TYPES):
    +    +    -    +    +        # Notify client that generation of this contract has started
    +    +    -    +    +        await manager.send_to_user(str(user_id), {
    +    +    -    +    +            "type": "contract_progress",
    +    +    -    +    +            "payload": {
    +    +    -    +    +                "project_id": str(project_id),
    +    +    -    +    +                "contract_type": contract_type,
    +    +    -    +    +                "status": "generating",
    +    +    -    +    +                "index": idx,
    +    +    -    +    +                "total": total,
    +    +    -    +    +            },
    +    +    -    +    +        })
    +    +    -    +    +
    +    +    -    +             content = _render_template(contract_type, template_vars)
    +    +    -    +             row = await upsert_contract(project_id, contract_type, content)
    +    +    -    +             generated.append({
    +    +    -    +    @@ -356,6 +413,18 @@ async def generate_contracts(
    +    +    -    +                 "updated_at": row["updated_at"],
    +    +    -    +             })
    +    +    -    +     
    +    +    -    +    +        # Notify client that this contract is done
    +    +    -    +    +        await manager.send_to_user(str(user_id), {
    +    +    -    +    +            "type": "contract_progress",
    +    +    -    +    +            "payload": {
    +    +    -    +    +                "project_id": str(project_id),
    +    +    -    +    +                "contract_type": contract_type,
    +    +    -    +    +                "status": "done",
    +    +    -    +    +                "index": idx,
    +    +    -    +    +                "total": total,
    +    +    -    +    +            },
    +    +    -    +    +        })
    +    +    -    +    +
    +    +    -    +         await update_project_status(project_id, "contracts_ready")
    +    +    -    +         return generated
    +    +    -    +     
    +    +    -    +    diff --git a/db/migrations/006_user_api_key.sql b/db/migrations/006_user_api_key.sql
    +    +    -    +    new file mode 100644
    +    +    -    +    index 0000000..13156c9
    +    +    -    +    --- /dev/null
    +    +    -    +    +++ b/db/migrations/006_user_api_key.sql
    +    +    -    +    @@ -0,0 +1,4 @@
    +    +    -    +    +-- Phase 12: BYOK Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£ÔûÆ user-supplied Anthropic API key for builds
    +    +    -    +    +-- Adds an encrypted API key column to the users table.
    +    +    -    +    +
    +    +    -    +    +ALTER TABLE users ADD COLUMN IF NOT EXISTS anthropic_api_key TEXT;
    +    +    -    +    diff --git a/tests/test_audit_service.py b/tests/test_audit_service.py
    +    +    -    +    index 0f0451e..94d6f01 100644
    +    +    -    +    --- a/tests/test_audit_service.py
    +    +    -    +    +++ b/tests/test_audit_service.py
    +    +    -    +    @@ -32,6 +32,7 @@ def _make_patches():
    +    +    -    +             "get_user_by_id": AsyncMock(return_value=MOCK_USER),
    +    +    -    +             "list_commits": AsyncMock(return_value=[]),
    +    +    -    +             "get_existing_commit_shas": AsyncMock(return_value=set()),
    +    +    -    +    +        "mark_stale_audit_runs": AsyncMock(return_value=0),
    +    +    -    +             "create_audit_run": AsyncMock(return_value={"id": UUID("aaaa1111-1111-1111-1111-111111111111")}),
    +    +    -    +             "update_audit_run": AsyncMock(),
    +    +    -    +             "get_commit_files": AsyncMock(return_value=["README.md"]),
    +    +    -    +    @@ -156,3 +157,54 @@ async def test_backfill_handles_commit_error_gracefully():
    +    +    -    +         # Both count as "synced" (processed) even if one errored
    +    +    -    +         assert result["synced"] == 2
    +    +    -    +         assert result["skipped"] == 0
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +@pytest.mark.asyncio
    +    +    -    +    +async def test_backfill_cleans_stale_runs():
    +    +    -    +    +    """backfill_repo_commits calls mark_stale_audit_runs before processing."""
    +    +    -    +    +    mocks = _make_patches()
    +    +    -    +    +    mocks["list_commits"].return_value = []
    +    +    -    +    +    mocks["mark_stale_audit_runs"].return_value = 3
    +    +    -    +    +
    +    +    -    +    +    patches = _apply_patches(mocks)
    +    +    -    +    +    for p in patches:
    +    +    -    +    +        p.start()
    +    +    -    +    +    try:
    +    +    -    +    +        result = await backfill_repo_commits(REPO_ID, USER_ID)
    +    +    -    +    +    finally:
    +    +    -    +    +        for p in patches:
    +    +    -    +    +            p.stop()
    +    +    -    +    +
    +    +    -    +    +    mocks["mark_stale_audit_runs"].assert_called_once_with(REPO_ID)
    +    +    -    +    +    assert result["synced"] == 0
    +    +    -    +    +    assert result["skipped"] == 0
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +@pytest.mark.asyncio
    +    +    -    +    +async def test_backfill_marks_error_on_cancel():
    +    +    -    +    +    """If backfill is cancelled mid-commit, the in-progress row is marked error."""
    +    +    -    +    +    import asyncio
    +    +    -    +    +
    +    +    -    +    +    mocks = _make_patches()
    +    +    -    +    +    mocks["list_commits"].return_value = [
    +    +    -    +    +        {"sha": "aaa111", "message": "first", "author": "Alice"},
    +    +    -    +    +    ]
    +    +    -    +    +    mocks["get_existing_commit_shas"].return_value = set()
    +    +    -    +    +    mocks["get_commit_files"].side_effect = asyncio.CancelledError()
    +    +    -    +    +
    +    +    -    +    +    patches = _apply_patches(mocks)
    +    +    -    +    +    for p in patches:
    +    +    -    +    +        p.start()
    +    +    -    +    +    try:
    +    +    -    +    +        with pytest.raises(asyncio.CancelledError):
    +    +    -    +    +            await backfill_repo_commits(REPO_ID, USER_ID)
    +    +    -    +    +    finally:
    +    +    -    +    +        for p in patches:
    +    +    -    +    +            p.stop()
    +    +    -    +    +
    +    +    -    +    +    # The audit run should have been marked as error before re-raising
    +    +    -    +    +    error_calls = [
    +    +    -    +    +        c for c in mocks["update_audit_run"].call_args_list
    +    +    -    +    +        if c.kwargs.get("status") == "error" or (c.args and len(c.args) > 1 and c.args[1] == "error")
    +    +    -    +    +    ]
    +    +    -    +    +    assert len(error_calls) >= 1
    +    +    -    +    diff --git a/tests/test_auth_router.py b/tests/test_auth_router.py
    +    +    -    +    index 4cd5836..9dc3526 100644
    +    +    -    +    --- a/tests/test_auth_router.py
    +    +    -    +    +++ b/tests/test_auth_router.py
    +    +    -    +    @@ -57,6 +57,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    +    +    -    +             "github_id": 12345,
    +    +    -    +             "github_login": "octocat",
    +    +    -    +             "avatar_url": "https://example.com/avatar.png",
    +    +    -    +    +        "anthropic_api_key": "sk-ant-test",
    +    +    -    +         }
    +    +    -    +     
    +    +    -    +         token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    +    -    +    @@ -68,6 +69,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    +    +    -    +         data = response.json()
    +    +    -    +         assert data["github_login"] == "octocat"
    +    +    -    +         assert data["id"] == "11111111-1111-1111-1111-111111111111"
    +    +    -    +    +    assert data["has_anthropic_key"] is True
    +    +    -    +     
    +    +    -    +     
    +    +    -    +     @patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +    @@ -80,3 +82,57 @@ def test_auth_me_returns_401_when_user_not_found(mock_get_user):
    +    +    -    +             headers={"Authorization": f"Bearer {token}"},
    +    +    -    +         )
    +    +    -    +         assert response.status_code == 401
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +# ---------------------------------------------------------------------------
    +    +    -    +    +# Tests: API key management (BYOK)
    +    +    -    +    +# ---------------------------------------------------------------------------
    +    +    -    +    +
    +    +    -    +    +_USER_DICT = {
    +    +    -    +    +    "id": "11111111-1111-1111-1111-111111111111",
    +    +    -    +    +    "github_id": 12345,
    +    +    -    +    +    "github_login": "octocat",
    +    +    -    +    +    "avatar_url": "https://example.com/avatar.png",
    +    +    -    +    +    "anthropic_api_key": None,
    +    +    -    +    +}
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    +    +    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +    +def test_save_api_key(mock_get_user, mock_set_key):
    +    +    -    +    +    mock_get_user.return_value = _USER_DICT
    +    +    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    +    -    +    +    response = client.put(
    +    +    -    +    +        "/auth/api-key",
    +    +    -    +    +        json={"api_key": "sk-ant-api03-test"},
    +    +    -    +    +        headers={"Authorization": f"Bearer {token}"},
    +    +    -    +    +    )
    +    +    -    +    +    assert response.status_code == 200
    +    +    -    +    +    assert response.json()["saved"] is True
    +    +    -    +    +    mock_set_key.assert_called_once()
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +    +def test_save_api_key_empty_rejected(mock_get_user):
    +    +    -    +    +    mock_get_user.return_value = _USER_DICT
    +    +    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    +    -    +    +    response = client.put(
    +    +    -    +    +        "/auth/api-key",
    +    +    -    +    +        json={"api_key": "   "},
    +    +    -    +    +        headers={"Authorization": f"Bearer {token}"},
    +    +    -    +    +    )
    +    +    -    +    +    assert response.status_code == 400
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    +    +    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +    +def test_remove_api_key(mock_get_user, mock_set_key):
    +    +    -    +    +    mock_get_user.return_value = _USER_DICT
    +    +    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    +    -    +    +    response = client.delete(
    +    +    -    +    +        "/auth/api-key",
    +    +    -    +    +        headers={"Authorization": f"Bearer {token}"},
    +    +    -    +    +    )
    +    +    -    +    +    assert response.status_code == 200
    +    +    -    +    +    assert response.json()["removed"] is True
    +    +    -    +    +    mock_set_key.assert_called_once()
    +    +    -    +    diff --git a/tests/test_build_service.py b/tests/test_build_service.py
    +    +    -    +    index 1c7792e..9861a64 100644
    +    +    -    +    --- a/tests/test_build_service.py
    +    +    -    +    +++ b/tests/test_build_service.py
    +    +    -    +    @@ -63,7 +63,8 @@ def _build(**overrides):
    +    +    -    +     @patch("app.services.build_service.asyncio.create_task")
    +    +    -    +     @patch("app.services.build_service.project_repo")
    +    +    -    +     @patch("app.services.build_service.build_repo")
    +    +    -    +    -async def test_start_build_success(mock_build_repo, mock_project_repo, mock_create_task):
    +    +    -    +    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +    +async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    +    -    +         """start_build creates a build record and spawns a background task."""
    +    +    -    +         mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    -    +         mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    +    -    +    @@ -71,6 +72,7 @@ async def test_start_build_success(mock_build_repo, mock_project_repo, mock_crea
    +    +    -    +         mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    +    -    +         mock_build_repo.create_build = AsyncMock(return_value=_build())
    +    +    -    +         mock_create_task.return_value = MagicMock()
    +    +    -    +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    +    +    -    +     
    +    +    -    +         result = await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    +    -    +     
    +    +    -    +    @@ -133,6 +135,21 @@ async def test_start_build_already_running(mock_build_repo, mock_project_repo):
    +    +    -    +             await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    +    -    +     
    +    +    -    +     
    +    +    -    +    +@pytest.mark.asyncio
    +    +    -    +    +@patch("app.services.build_service.project_repo")
    +    +    -    +    +@patch("app.services.build_service.build_repo")
    +    +    -    +    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +    +async def test_start_build_no_api_key(mock_get_user, mock_build_repo, mock_project_repo):
    +    +    -    +    +    """start_build raises ValueError when user has no Anthropic API key."""
    +    +    -    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    -    +    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    +    -    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    +    -    +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": None}
    +    +    -    +    +
    +    +    -    +    +    with pytest.raises(ValueError, match="API key required"):
    +    +    -    +    +        await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +     # ---------------------------------------------------------------------------
    +    +    -    +     # Tests: cancel_build
    +    +    -    +     # ---------------------------------------------------------------------------
    +    +    -    +    @@ -431,3 +448,21 @@ async def test_record_phase_cost(mock_build_repo):
    +    +    -    +         mock_build_repo.record_build_cost.assert_called_once()
    +    +    -    +         assert usage.input_tokens == 0
    +    +    -    +         assert usage.output_tokens == 0
    +    +    -    +    +
    +    +    -    +    +
    +    +    -    +    +def test_get_token_rates_model_aware():
    +    +    -    +    +    """_get_token_rates returns correct pricing per model family."""
    +    +    -    +    +    from decimal import Decimal
    +    +    -    +    +
    +    +    -    +    +    opus_in, opus_out = build_service._get_token_rates("claude-opus-4-6")
    +    +    -    +    +    assert opus_in == Decimal("0.000015")
    +    +    -    +    +    assert opus_out == Decimal("0.000075")
    +    +    -    +    +
    +    +    -    +    +    haiku_in, haiku_out = build_service._get_token_rates("claude-haiku-4-5-20251001")
    +    +    -    +    +    assert haiku_in == Decimal("0.000001")
    +    +    -    +    +    assert haiku_out == Decimal("0.000005")
    +    +    -    +    +
    +    +    -    +    +    # Unknown model falls back to Opus (safest = most expensive)
    +    +    -    +    +    unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
    +    +    -    +    +    assert unk_in == Decimal("0.000015")
    +    +    -    +    +    assert unk_out == Decimal("0.000075")
    +    +    -    +    diff --git a/tests/test_llm_client.py b/tests/test_llm_client.py
    +    +    -    +    index c7c4f8e..4f323a2 100644
    +    +    -    +    --- a/tests/test_llm_client.py
    +    +    -    +    +++ b/tests/test_llm_client.py
    +    +    -    +    @@ -34,6 +34,7 @@ async def test_chat_success(mock_client_cls):
    +    +    -    +             "content": [{"type": "text", "text": "Hello from Haiku!"}],
    +    +    -    +             "model": "claude-3-5-haiku-20241022",
    +    +    -    +             "role": "assistant",
    +    +    -    +    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    +    -    +         })
    +    +    -    +         mock_client_cls.return_value = mock_client
    +    +    -    +     
    +    +    -    +    @@ -44,7 +45,9 @@ async def test_chat_success(mock_client_cls):
    +    +    -    +             messages=[{"role": "user", "content": "Hi"}],
    +    +    -    +         )
    +    +    -    +     
    +    +    -    +    -    assert result == "Hello from Haiku!"
    +    +    -    +    +    assert result["text"] == "Hello from Haiku!"
    +    +    -    +    +    assert result["usage"]["input_tokens"] == 10
    +    +    -    +    +    assert result["usage"]["output_tokens"] == 20
    +    +    -    +         mock_client.post.assert_called_once()
    +    +    -    +         call_kwargs = mock_client.post.call_args
    +    +    -    +         body = call_kwargs.kwargs["json"] if "json" in call_kwargs.kwargs else call_kwargs[1]["json"]
    +    +    -    +    @@ -141,6 +144,7 @@ async def test_chat_openai_success(mock_client_cls):
    +    +    -    +         """Successful OpenAI chat returns message content."""
    +    +    -    +         mock_client = _make_mock_client({
    +    +    -    +             "choices": [{"message": {"role": "assistant", "content": "Hello from GPT!"}}],
    +    +    -    +    +        "usage": {"prompt_tokens": 5, "completion_tokens": 15},
    +    +    -    +         })
    +    +    -    +         mock_client_cls.return_value = mock_client
    +    +    -    +     
    +    +    -    +    @@ -151,7 +155,9 @@ async def test_chat_openai_success(mock_client_cls):
    +    +    -    +             messages=[{"role": "user", "content": "Hi"}],
    +    +    -    +         )
    +    +    -    +     
    +    +    -    +    -    assert result == "Hello from GPT!"
    +    +    -    +    +    assert result["text"] == "Hello from GPT!"
    +    +    -    +    +    assert result["usage"]["input_tokens"] == 5
    +    +    -    +    +    assert result["usage"]["output_tokens"] == 15
    +    +    -    +         call_kwargs = mock_client.post.call_args
    +    +    -    +         body = call_kwargs.kwargs.get("json", call_kwargs[1].get("json", {}))
    +    +    -    +         assert body["model"] == "gpt-4o"
    +    +    -    +    @@ -226,6 +232,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    +    +    -    +         """chat(provider='openai') routes to OpenAI endpoint."""
    +    +    -    +         mock_client = _make_mock_client({
    +    +    -    +             "choices": [{"message": {"role": "assistant", "content": "dispatched"}}],
    +    +    -    +    +        "usage": {"prompt_tokens": 0, "completion_tokens": 0},
    +    +    -    +         })
    +    +    -    +         mock_client_cls.return_value = mock_client
    +    +    -    +     
    +    +    -    +    @@ -237,7 +244,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    +    +    -    +             provider="openai",
    +    +    -    +         )
    +    +    -    +     
    +    +    -    +    -    assert result == "dispatched"
    +    +    -    +    +    assert result["text"] == "dispatched"
    +    +    -    +         call_kwargs = mock_client.post.call_args
    +    +    -    +         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    +    +    -    +         assert "openai.com" in url
    +    +    -    +    @@ -249,6 +256,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    +    +    -    +         """chat() defaults to Anthropic."""
    +    +    -    +         mock_client = _make_mock_client({
    +    +    -    +             "content": [{"type": "text", "text": "default"}],
    +    +    -    +    +        "usage": {"input_tokens": 0, "output_tokens": 0},
    +    +    -    +         })
    +    +    -    +         mock_client_cls.return_value = mock_client
    +    +    -    +     
    +    +    -    +    @@ -259,7 +267,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    +    +    -    +             messages=[{"role": "user", "content": "Hi"}],
    +    +    -    +         )
    +    +    -    +     
    +    +    -    +    -    assert result == "default"
    +    +    -    +    +    assert result["text"] == "default"
    +    +    -    +         call_kwargs = mock_client.post.call_args
    +    +    -    +         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    +    +    -    +         assert "anthropic.com" in url
    +    +    -    +    diff --git a/tests/test_project_service.py b/tests/test_project_service.py
    +    +    -    +    index 1957ba3..1b410b3 100644
    +    +    -    +    --- a/tests/test_project_service.py
    +    +    -    +    +++ b/tests/test_project_service.py
    +    +    -    +    @@ -191,17 +191,22 @@ async def test_process_questionnaire_first_message(
    +    +    -    +             "status": "draft",
    +    +    -    +             "questionnaire_state": {},
    +    +    -    +         }
    +    +    -    +    -    mock_llm.return_value = json.dumps({
    +    +    -    +    -        "reply": "Tell me about your product.",
    +    +    -    +    -        "section": "product_intent",
    +    +    -    +    -        "section_complete": False,
    +    +    -    +    -        "extracted_data": None,
    +    +    -    +    -    })
    +    +    -    +    +    mock_llm.return_value = {
    +    +    -    +    +        "text": json.dumps({
    +    +    -    +    +            "reply": "Tell me about your product.",
    +    +    -    +    +            "section": "product_intent",
    +    +    -    +    +            "section_complete": False,
    +    +    -    +    +            "extracted_data": None,
    +    +    -    +    +        }),
    +    +    -    +    +        "usage": {"input_tokens": 50, "output_tokens": 30},
    +    +    -    +    +    }
    +    +    -    +     
    +    +    -    +         result = await process_questionnaire_message(USER_ID, PROJECT_ID, "Hi")
    +    +    -    +     
    +    +    -    +         assert result["reply"] == "Tell me about your product."
    +    +    -    +         assert result["is_complete"] is False
    +    +    -    +    +    assert result["token_usage"]["input_tokens"] == 50
    +    +    -    +    +    assert result["token_usage"]["output_tokens"] == 30
    +    +    -    +         mock_status.assert_called_once()  # draft -> questionnaire
    +    +    -    +     
    +    +    -    +     
    +    +    -    +    @@ -255,10 +260,11 @@ async def test_process_questionnaire_already_complete(mock_project):
    +    +    -    +     
    +    +    -    +     
    +    +    -    +     @pytest.mark.asyncio
    +    +    -    +    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    +    +    -    +     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    +    +    -    +     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    +    +    -    +     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    +    +    -    +    -async def test_generate_contracts_success(mock_project, mock_upsert, mock_status):
    +    +    -    +    +async def test_generate_contracts_success(mock_project, mock_upsert, mock_status, mock_ws):
    +    +    -    +         mock_project.return_value = {
    +    +    -    +             "id": PROJECT_ID,
    +    +    -    +             "user_id": USER_ID,
    +    +    -    +    diff --git a/tests/test_projects_router.py b/tests/test_projects_router.py
    +    +    -    +    index 862c16d..dc7c5ff 100644
    +    +    -    +    --- a/tests/test_projects_router.py
    +    +    -    +    +++ b/tests/test_projects_router.py
    +    +    -    +    @@ -21,7 +21,7 @@ def _set_test_config(monkeypatch):
    +    +    -    +         monkeypatch.setattr("app.config.settings.APP_URL", "http://localhost:8000")
    +    +    -    +         monkeypatch.setattr("app.config.settings.GITHUB_WEBHOOK_SECRET", "whsec_test")
    +    +    -    +         monkeypatch.setattr("app.config.settings.ANTHROPIC_API_KEY", "test-api-key")
    +    +    -    +    -    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022")
    +    +    -    +    +    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5")
    +    +    -    +     
    +    +    -    +     
    +    +    -    +     USER_ID = "22222222-2222-2222-2222-222222222222"
    +    +    -    +    @@ -248,7 +248,10 @@ def test_questionnaire_message(
    +    +    -    +             "status": "draft",
    +    +    -    +             "questionnaire_state": {},
    +    +    -    +         }
    +    +    -    +    -    mock_llm.return_value = '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}'
    +    +    -    +    +    mock_llm.return_value = {
    +    +    -    +    +        "text": '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}',
    +    +    -    +    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    +    -    +    +    }
    +    +    -    +     
    +    +    -    +         resp = client.post(
    +    +    -    +             f"/projects/{PROJECT_ID}/questionnaire",
    +    +    -    +    @@ -332,8 +335,9 @@ def test_generate_contracts_incomplete(mock_project, mock_get_user):
    +    +    -    +     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    +    +    -    +     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    +    +    -    +     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    +    +    -    +    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    +    +    -    +     def test_generate_contracts_success(
    +    +    -    +    -    mock_status, mock_upsert, mock_project, mock_get_user
    +    +    -    +    +    mock_ws, mock_status, mock_upsert, mock_project, mock_get_user
    +    +    -    +     ):
    +    +    -    +         mock_get_user.return_value = MOCK_USER
    +    +    -    +         all_sections = [
    +    +    -    +    diff --git a/web/src/App.tsx b/web/src/App.tsx
    +    +    -    +    index 7a6f811..8eadcd4 100644
    +    +    -    +    --- a/web/src/App.tsx
    +    +    -    +    +++ b/web/src/App.tsx
    +    +    -    +    @@ -7,6 +7,7 @@ import AuditDetailPage from './pages/AuditDetail';
    +    +    -    +     import ProjectDetail from './pages/ProjectDetail';
    +    +    -    +     import BuildProgress from './pages/BuildProgress';
    +    +    -    +     import BuildComplete from './pages/BuildComplete';
    +    +    -    +    +import Settings from './pages/Settings';
    +    +    -    +     import { AuthProvider, useAuth } from './context/AuthContext';
    +    +    -    +     import { ToastProvider } from './context/ToastContext';
    +    +    -    +     
    +    +    -    +    @@ -72,6 +73,14 @@ function App() {
    +    +    -    +                     </ProtectedRoute>
    +    +    -    +                   }
    +    +    -    +                 />
    +    +    -    +    +            <Route
    +    +    -    +    +              path="/settings"
    +    +    -    +    +              element={
    +    +    -    +    +                <ProtectedRoute>
    +    +    -    +    +                  <Settings />
    +    +    -    +    +                </ProtectedRoute>
    +    +    -    +    +              }
    +    +    -    +    +            />
    +    +    -    +                 <Route path="*" element={<Navigate to="/" replace />} />
    +    +    -    +               </Routes>
    +    +    -    +             </BrowserRouter>
    +    +    -    +    diff --git a/web/src/__tests__/App.test.tsx b/web/src/__tests__/App.test.tsx
    +    +    -    +    index 7678f4e..0d8a335 100644
    +    +    -    +    --- a/web/src/__tests__/App.test.tsx
    +    +    -    +    +++ b/web/src/__tests__/App.test.tsx
    +    +    -    +    @@ -298,7 +298,7 @@ describe('QuestionnaireModal', () => {
    +    +    -    +         expect(onClose).toHaveBeenCalled();
    +    +    -    +       });
    +    +    -    +     
    +    +    -    +    -  it('has a voice toggle button', () => {
    +    +    -    +    +  it('has a restart button', () => {
    +    +    -    +         render(
    +    +    -    +           <QuestionnaireModal
    +    +    -    +             projectId="test-id"
    +    +    -    +    @@ -307,7 +307,7 @@ describe('QuestionnaireModal', () => {
    +    +    -    +             onContractsGenerated={() => {}}
    +    +    -    +           />,
    +    +    -    +         );
    +    +    -    +    -    expect(screen.getByTestId('voice-toggle')).toBeInTheDocument();
    +    +    -    +    +    expect(screen.getByTestId('restart-btn')).toBeInTheDocument();
    +    +    -    +       });
    +    +    -    +     
    +    +    -    +       it('shows generate banner when questionnaire is complete', async () => {
    +    +    -    +    diff --git a/web/src/components/AppShell.tsx b/web/src/components/AppShell.tsx
    +    +    -    +    index 47a1098..b8f1f3c 100644
    +    +    -    +    --- a/web/src/components/AppShell.tsx
    +    +    -    +    +++ b/web/src/components/AppShell.tsx
    +    +    -    +    @@ -103,7 +103,6 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    +    +    -    +                   style={{ width: 28, height: 28, borderRadius: '50%' }}
    +    +    -    +                 />
    +    +    -    +               )}
    +    +    -    +    -          <span style={{ color: '#94A3B8', fontSize: '0.85rem' }}>{user?.github_login}</span>
    +    +    -    +               <button
    +    +    -    +                 onClick={logout}
    +    +    -    +                 style={{
    +    +    -    +    @@ -192,11 +191,50 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    +    +    -    +                     marginTop: 'auto',
    +    +    -    +                     padding: '12px 16px',
    +    +    -    +                     borderTop: '1px solid #1E293B',
    +    +    -    +    -                color: '#64748B',
    +    +    -    +    -                fontSize: '0.7rem',
    +    +    -    +    +                display: 'flex',
    +    +    -    +    +                alignItems: 'center',
    +    +    -    +    +                justifyContent: 'space-between',
    +    +    -    +                   }}
    +    +    -    +                 >
    +    +    -    +    -              v0.1.0
    +    +    -    +    +              <div
    +    +    -    +    +                onClick={() => navigate('/settings')}
    +    +    -    +    +                style={{
    +    +    -    +    +                  display: 'flex',
    +    +    -    +    +                  alignItems: 'center',
    +    +    -    +    +                  gap: '8px',
    +    +    -    +    +                  cursor: 'pointer',
    +    +    -    +    +                  flex: 1,
    +    +    -    +    +                  minWidth: 0,
    +    +    -    +    +                }}
    +    +    -    +    +                title={user?.github_login ?? 'Settings'}
    +    +    -    +    +              >
    +    +    -    +    +                {user?.avatar_url && (
    +    +    -    +    +                  <img
    +    +    -    +    +                    src={user.avatar_url}
    +    +    -    +    +                    alt={user.github_login}
    +    +    -    +    +                    style={{ width: 22, height: 22, borderRadius: '50%', flexShrink: 0 }}
    +    +    -    +    +                  />
    +    +    -    +    +                )}
    +    +    -    +    +                <span style={{ color: '#CBD5E1', fontSize: '0.75rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    +    +    -    +    +                  {user?.github_login}
    +    +    -    +    +                </span>
    +    +    -    +    +              </div>
    +    +    -    +    +              <button
    +    +    -    +    +                onClick={() => navigate('/settings')}
    +    +    -    +    +                title="Settings"
    +    +    -    +    +                style={{
    +    +    -    +    +                  background: 'transparent',
    +    +    -    +    +                  border: 'none',
    +    +    -    +    +                  color: '#64748B',
    +    +    -    +    +                  cursor: 'pointer',
    +    +    -    +    +                  fontSize: '0.95rem',
    +    +    -    +    +                  padding: '4px',
    +    +    -    +    +                  flexShrink: 0,
    +    +    -    +    +                  lineHeight: 1,
    +    +    -    +    +                }}
    +    +    -    +    +              >
    +    +    -    +    +                Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬╝Ôö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬ú├ö├▓├╣
    +    +    -    +    +              </button>
    +    +    -    +                 </div>
    +    +    -    +               </aside>
    +    +    -    +             )}
    +    +    -    +    diff --git a/web/src/components/ContractProgress.tsx b/web/src/components/ContractProgress.tsx
    +    +    -    +    new file mode 100644
    +    +    -    +    index 0000000..821fec7
    +    +    -    +    --- /dev/null
    +    +    -    +    +++ b/web/src/components/ContractProgress.tsx
    +    +    -    +    @@ -0,0 +1,294 @@
    +    +    -    +    +/**
    +    +    -    +    + * ContractProgress -- live step-by-step contract generation progress panel.
    +    +    -    +    + *
    +    +    -    +    + * Shows each contract being generated with status indicators, a running log,
    +    +    -    +    + * context window meter, and cumulative token usage from the questionnaire.
    +    +    -    +    + */
    +    +    -    +    +import { useState, useEffect, useRef, useCallback } from 'react';
    +    +    -    +    +import { useAuth } from '../context/AuthContext';
    +    +    -    +    +import { useWebSocket } from '../hooks/useWebSocket';
    +    +    -    +    +
    +    +    -    +    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -    +    +
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +/*  Contract type labels                                              */
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +
    +    +    -    +    +const CONTRACT_LABELS: Record<string, string> = {
    +    +    -    +    +  blueprint: 'Blueprint',
    +    +    -    +    +  manifesto: 'Manifesto',
    +    +    -    +    +  stack: 'Stack',
    +    +    -    +    +  schema: 'Schema',
    +    +    -    +    +  physics: 'Physics',
    +    +    -    +    +  boundaries: 'Boundaries',
    +    +    -    +    +  phases: 'Phases',
    +    +    -    +    +  ui: 'UI',
    +    +    -    +    +  builder_contract: 'Builder Contract',
    +    +    -    +    +  builder_directive: 'Builder Directive',
    +    +    -    +    +};
    +    +    -    +    +
    +    +    -    +    +const ALL_CONTRACTS = Object.keys(CONTRACT_LABELS);
    +    +    -    +    +
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +/*  Context window constants                                          */
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +
    +    +    -    +    +const MODEL_CONTEXT_WINDOWS: Record<string, number> = {
    +    +    -    +    +  'claude-haiku-4-5': 200_000,
    +    +    -    +    +  'claude-sonnet-4-5': 200_000,
    +    +    -    +    +  'claude-opus-4-6': 200_000,
    +    +    -    +    +  'gpt-4o': 128_000,
    +    +    -    +    +};
    +    +    -    +    +const DEFAULT_CONTEXT_WINDOW = 200_000;
    +    +    -    +    +
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +/*  Types                                                             */
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +
    +    +    -    +    +interface TokenUsage {
    +    +    -    +    +  input_tokens: number;
    +    +    -    +    +  output_tokens: number;
    +    +    -    +    +}
    +    +    -    +    +
    +    +    -    +    +type ContractStatus = 'pending' | 'generating' | 'done';
    +    +    -    +    +
    +    +    -    +    +interface LogEntry {
    +    +    -    +    +  time: string;
    +    +    -    +    +  message: string;
    +    +    -    +    +}
    +    +    -    +    +
    +    +    -    +    +interface Props {
    +    +    -    +    +  projectId: string;
    +    +    -    +    +  tokenUsage: TokenUsage;
    +    +    -    +    +  model: string;
    +    +    -    +    +  onComplete: () => void;
    +    +    -    +    +}
    +    +    -    +    +
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +/*  Styles                                                            */
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +
    +    +    -    +    +const panelStyle: React.CSSProperties = {
    +    +    -    +    +  display: 'flex',
    +    +    -    +    +  flexDirection: 'column',
    +    +    -    +    +  gap: '12px',
    +    +    -    +    +  padding: '16px 20px',
    +    +    -    +    +  flex: 1,
    +    +    -    +    +  overflowY: 'auto',
    +    +    -    +    +};
    +    +    -    +    +
    +    +    -    +    +const stepRowStyle: React.CSSProperties = {
    +    +    -    +    +  display: 'flex',
    +    +    -    +    +  alignItems: 'center',
    +    +    -    +    +  gap: '10px',
    +    +    -    +    +  fontSize: '0.82rem',
    +    +    -    +    +  padding: '6px 0',
    +    +    -    +    +  borderBottom: '1px solid #1E293B',
    +    +    -    +    +};
    +    +    -    +    +
    +    +    -    +    +const logPanelStyle: React.CSSProperties = {
    +    +    -    +    +  background: '#0F172A',
    +    +    -    +    +  borderRadius: '6px',
    +    +    -    +    +  padding: '10px 12px',
    +    +    -    +    +  fontFamily: 'monospace',
    +    +    -    +    +  fontSize: '0.72rem',
    +    +    -    +    +  color: '#94A3B8',
    +    +    -    +    +  maxHeight: '120px',
    +    +    -    +    +  overflowY: 'auto',
    +    +    -    +    +  lineHeight: '1.6',
    +    +    -    +    +};
    +    +    -    +    +
    +    +    -    +    +const meterBarOuter: React.CSSProperties = {
    +    +    -    +    +  flex: 1,
    +    +    -    +    +  height: '8px',
    +    +    -    +    +  background: '#1E293B',
    +    +    -    +    +  borderRadius: '4px',
    +    +    -    +    +  overflow: 'hidden',
    +    +    -    +    +};
    +    +    -    +    +
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +/*  Component                                                         */
    +    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    -    +    +
    +    +    -    +    +export default function ContractProgress({ projectId, tokenUsage, model, onComplete }: Props) {
    +    +    -    +    +  const { token } = useAuth();
    +    +    -    +    +  const [statuses, setStatuses] = useState<Record<string, ContractStatus>>(() =>
    +    +    -    +    +    Object.fromEntries(ALL_CONTRACTS.map((c) => [c, 'pending' as const])),
    +    +    -    +    +  );
    +    +    -    +    +  const [log, setLog] = useState<LogEntry[]>([]);
    +    +    -    +    +  const [generating, setGenerating] = useState(false);
    +    +    -    +    +  const [allDone, setAllDone] = useState(false);
    +    +    -    +    +  const logEndRef = useRef<HTMLDivElement>(null);
    +    +    -    +    +  const startedRef = useRef(false);
    +    +    -    +    +
    +    +    -    +    +  const addLog = useCallback((msg: string) => {
    +    +    -    +    +    const now = new Date();
    +    +    -    +    +    const time = now.toLocaleTimeString('en-GB', { hour12: false });
    +    +    -    +    +    setLog((prev) => [...prev, { time, message: msg }]);
    +    +    -    +    +  }, []);
    +    +    -    +    +
    +    +    -    +    +  /* Auto-scroll log */
    +    +    -    +    +  useEffect(() => {
    +    +    -    +    +    logEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    +    +    -    +    +  }, [log]);
    +    +    -    +    +
    +    +    -    +    +  /* Handle WS progress messages */
    +    +    -    +    +  useWebSocket(
    +    +    -    +    +    useCallback(
    +    +    -    +    +      (data: { type: string; payload: any }) => {
    +    +    -    +    +        if (data.type !== 'contract_progress') return;
    +    +    -    +    +        const p = data.payload;
    +    +    -    +    +        if (p.project_id !== projectId) return;
    +    +    -    +    +
    +    +    -    +    +        const label = CONTRACT_LABELS[p.contract_type] ?? p.contract_type;
    +    +    -    +    +        if (p.status === 'generating') {
    +    +    -    +    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'generating' }));
    +    +    -    +    +          addLog(`Generating ${label}...`);
    +    +    -    +    +        } else if (p.status === 'done') {
    +    +    -    +    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'done' }));
    +    +    -    +    +          addLog(`Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£ÔûÆ ${label} complete`);
    +    +    -    +    +
    +    +    -    +    +          /* Check if all done */
    +    +    -    +    +          setStatuses((prev) => {
    +    +    -    +    +            const values = Object.values(prev);
    +    +    -    +    +            if (values.every((s) => s === 'done')) {
    +    +    -    +    +              setAllDone(true);
    +    +    -    +    +              addLog('All contracts generated successfully.');
    +    +    -    +    +            }
    +    +    -    +    +            return prev;
    +    +    -    +    +          });
    +    +    -    +    +        }
    +    +    -    +    +      },
    +    +    -    +    +      [projectId, addLog],
    +    +    -    +    +    ),
    +    +    -    +    +  );
    +    +    -    +    +
    +    +    -    +    +  /* Kick off generation on mount */
    +    +    -    +    +  useEffect(() => {
    +    +    -    +    +    if (startedRef.current) return;
    +    +    -    +    +    startedRef.current = true;
    +    +    -    +    +    setGenerating(true);
    +    +    -    +    +    addLog('Starting contract generation...');
    +    +    -    +    +
    +    +    -    +    +    fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    +    -    +    +      method: 'POST',
    +    +    -    +    +      headers: { Authorization: `Bearer ${token}` },
    +    +    -    +    +    })
    +    +    -    +    +      .then((res) => {
    +    +    -    +    +        if (!res.ok) throw new Error('Generation failed');
    +    +    -    +    +        /* Mark any remaining as done (safety net) */
    +    +    -    +    +        setStatuses((prev) => {
    +    +    -    +    +          const updated = { ...prev };
    +    +    -    +    +          for (const key of ALL_CONTRACTS) {
    +    +    -    +    +            if (updated[key] !== 'done') updated[key] = 'done';
    +    +    -    +    +          }
    +    +    -    +    +          return updated;
    +    +    -    +    +        });
    +    +    -    +    +        setAllDone(true);
    +    +    -    +    +        setGenerating(false);
    +    +    -    +    +      })
    +    +    -    +    +      .catch(() => {
    +    +    -    +    +        addLog('Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£Ôòæ Contract generation failed');
    +    +    -    +    +        setGenerating(false);
    +    +    -    +    +      });
    +    +    -    +    +  }, [projectId, token, addLog]);
    +    +    -    +    +
    +    +    -    +    +  /* Derived values */
    +    +    -    +    +  const contextWindow = MODEL_CONTEXT_WINDOWS[model] ?? DEFAULT_CONTEXT_WINDOW;
    +    +    -    +    +  const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    +    -    +    +  const ctxPercent = Math.min(100, (totalTokens / contextWindow) * 100);
    +    +    -    +    +  const doneCount = Object.values(statuses).filter((s) => s === 'done').length;
    +    +    -    +    +
    +    +    -    +    +  /* Color for context bar */
    +    +    -    +    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    +    +    -    +    +
    +    +    -    +    +  return (
    +    +    -    +    +    <div style={panelStyle} data-testid="contract-progress">
    +    +    -    +    +      {/* Header */}
    +    +    -    +    +      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
    +    +    -    +    +        <h4 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    +    -    +    +          {allDone ? 'Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£ÔûÆ Contracts Ready' : `Generating ContractsÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬╝Ôö¼ÔòØ (${doneCount}/${ALL_CONTRACTS.length})`}
    +    +    -    +    +        </h4>
    +    +    -    +    +      </div>
    +    +    -    +    +
    +    +    -    +    +      {/* Context window meter */}
    +    +    -    +    +      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    +    +    -    +    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.7rem', color: '#94A3B8' }}>
    +    +    -    +    +          <span>Context Window ({model})</span>
    +    +    -    +    +          <span>
    +    +    -    +    +            {totalTokens.toLocaleString()} / {contextWindow.toLocaleString()} tokens ({ctxPercent.toFixed(1)}%)
    +    +    -    +    +          </span>
    +    +    -    +    +        </div>
    +    +    -    +    +        <div style={meterBarOuter}>
    +    +    -    +    +          <div
    +    +    -    +    +            style={{
    +    +    -    +    +              width: `${ctxPercent}%`,
    +    +    -    +    +              height: '100%',
    +    +    -    +    +              background: ctxColor,
    +    +    -    +    +              borderRadius: '4px',
    +    +    -    +    +              transition: 'width 0.4s ease',
    +    +    -    +    +            }}
    +    +    -    +    +          />
    +    +    -    +    +        </div>
    +    +    -    +    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#64748B' }}>
    +    +    -    +    +          <span>Input: {tokenUsage.input_tokens.toLocaleString()}</span>
    +    +    -    +    +          <span>Output: {tokenUsage.output_tokens.toLocaleString()}</span>
    +    +    -    +    +        </div>
    +    +    -    +    +      </div>
    +    +    -    +    +
    +    +    -    +    +      {/* Step list */}
    +    +    -    +    +      <div>
    +    +    -    +    +        {ALL_CONTRACTS.map((ct) => {
    +    +    -    +    +          const st = statuses[ct];
    +    +    -    +    +          const icon = st === 'done' ? 'Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬í' : st === 'generating' ? 'Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├¡├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö¼┬½' : 'Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├╣';
    +    +    -    +    +          const color = st === 'done' ? '#22C55E' : st === 'generating' ? '#F59E0B' : '#475569';
    +    +    -    +    +          return (
    +    +    -    +    +            <div key={ct} style={stepRowStyle}>
    +    +    -    +    +              <span style={{ width: '20px', textAlign: 'center' }}>{icon}</span>
    +    +    -    +    +              <span style={{ flex: 1, color }}>{CONTRACT_LABELS[ct]}</span>
    +    +    -    +    +              <span style={{ fontSize: '0.7rem', color: '#64748B', textTransform: 'uppercase' }}>{st}</span>
    +    +    -    +    +            </div>
    +    +    -    +    +          );
    +    +    -    +    +        })}
    +    +    -    +    +      </div>
    +    +    -    +    +
    +    +    -    +    +      {/* Log panel */}
    +    +    -    +    +      <div style={logPanelStyle} data-testid="contract-log">
    +    +    -    +    +        {log.map((entry, i) => (
    +    +    -    +    +          <div key={i}>
    +    +    -    +    +            <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    +    +    -    +    +            {entry.message}
    +    +    -    +    +          </div>
    +    +    -    +    +        ))}
    +    +    -    +    +        <div ref={logEndRef} />
    +    +    -    +    +      </div>
    +    +    -    +    +
    +    +    -    +    +      {/* Done button */}
    +    +    -    +    +      {allDone && (
    +    +    -    +    +        <button
    +    +    -    +    +          onClick={onComplete}
    +    +    -    +    +          data-testid="contracts-done-btn"
    +    +    -    +    +          style={{
    +    +    -    +    +            background: '#16A34A',
    +    +    -    +    +            color: '#fff',
    +    +    -    +    +            border: 'none',
    +    +    -    +    +            borderRadius: '8px',
    +    +    -    +    +            padding: '10px 20px',
    +    +    -    +    +            cursor: 'pointer',
    +    +    -    +    +            fontSize: '0.8rem',
    +    +    -    +    +            fontWeight: 600,
    +    +    -    +    +            alignSelf: 'center',
    +    +    -    +    +          }}
    +    +    -    +    +        >
    +    +    -    +    +          Done Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« View Contracts
    +    +    -    +    +        </button>
    +    +    -    +    +      )}
    +    +    -    +    +
    +    +    -    +    +      {generating && !allDone && (
    +    +    -    +    +        <p style={{ textAlign: 'center', color: '#64748B', fontSize: '0.75rem', margin: 0 }}>
    +    +    -    +    +          GeneratingÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬╝Ôö¼ÔòØ
    +    +    -    +    +        </p>
    +    +    -    +    +      )}
    +    +    -    +    +    </div>
    +    +    -    +    +  );
    +    +    -    +    +}
    +    +    -    +    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    +    +    -    +    index 2b28280..bd8693a 100644
    +    +    -    +    --- a/web/src/components/QuestionnaireModal.tsx
    +    +    -    +    +++ b/web/src/components/QuestionnaireModal.tsx
    +    +    -    +    @@ -7,6 +7,7 @@
    +    +    -    +      */
    +    +    -    +     import { useState, useEffect, useRef, useCallback } from 'react';
    +    +    -    +     import { useAuth } from '../context/AuthContext';
    +    +    -    +    +import ContractProgress from './ContractProgress';
    +    +    -    +     
    +    +    -    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -    +     
    +    +    -    +    @@ -34,6 +35,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    +    +    -    +     interface ChatMessage {
    +    +    -    +       role: 'user' | 'assistant';
    +    +    -    +       content: string;
    +    +    -    +    +  section?: string;
    +    +    -    +     }
    +    +    -    +     
    +    +    -    +     interface QuestionnaireState {
    +    +    -    +    @@ -150,12 +152,21 @@ const SpeechRecognition =
    +    +    -    +         : null;
    +    +    -    +     
    +    +    -    +     function useSpeechRecognition(onResult: (text: string) => void) {
    +    +    -    +    -  const recognitionRef = useRef<any>(null);
    +    +    -    +       const [listening, setListening] = useState(false);
    +    +    -    +       const listeningRef = useRef(false);
    +    +    -    +    +  const recRef = useRef<any>(null);
    +    +    -    +    +  const onResultRef = useRef(onResult);
    +    +    -    +    +  onResultRef.current = onResult;
    +    +    -    +    +
    +    +    -    +    +  /* Lazily create a single SpeechRecognition instance and keep it for the
    +    +    -    +    +     lifetime of the component.  Browsers throttle or block new instances
    +    +    -    +    +     created outside a user-gesture context, which is why creating a fresh
    +    +    -    +    +     instance on every start() caused the second activation to silently die
    +    +    -    +    +     after a few seconds. */
    +    +    -    +    +  const getRec = useCallback(() => {
    +    +    -    +    +    if (recRef.current) return recRef.current;
    +    +    -    +    +    if (!SpeechRecognition) return null;
    +    +    -    +     
    +    +    -    +    -  useEffect(() => {
    +    +    -    +    -    if (!SpeechRecognition) return;
    +    +    -    +         const rec = new SpeechRecognition();
    +    +    -    +         rec.continuous = true;
    +    +    -    +         rec.interimResults = true;
    +    +    -    +    @@ -169,64 +180,93 @@ function useSpeechRecognition(onResult: (text: string) => void) {
    +    +    -    +             }
    +    +    -    +           }
    +    +    -    +           if (finalTranscript) {
    +    +    -    +    -        onResult(finalTranscript);
    +    +    -    +    +        onResultRef.current(finalTranscript);
    +    +    -    +           }
    +    +    -    +         };
    +    +    -    +     
    +    +    -    +         rec.onerror = (e: any) => {
    +    +    -    +    -      /* 'no-speech' and 'aborted' are normal during pauses Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« auto-restart */
    +    +    -    +           if (e.error === 'no-speech' || e.error === 'aborted') {
    +    +    -    +    +        /* Browser fires these during normal pauses Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« restart if still active */
    +    +    -    +             if (listeningRef.current) {
    +    +    -    +    -          try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +          setTimeout(() => {
    +    +    -    +    +            if (listeningRef.current) {
    +    +    -    +    +              try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +            }
    +    +    -    +    +          }, 300);
    +    +    -    +             }
    +    +    -    +             return;
    +    +    -    +           }
    +    +    -    +    +      /* Real error Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« stop */
    +    +    -    +           listeningRef.current = false;
    +    +    -    +           setListening(false);
    +    +    -    +         };
    +    +    -    +     
    +    +    -    +    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    +    +    -    +         rec.onend = () => {
    +    +    -    +    +      /* Browser ends recognition after silence; auto-restart if user hasn't toggled off */
    +    +    -    +           if (listeningRef.current) {
    +    +    -    +    -        try { rec.start(); } catch { /* already running */ }
    +    +    -    +    -      } else {
    +    +    -    +    -        setListening(false);
    +    +    -    +    +        setTimeout(() => {
    +    +    -    +    +          if (listeningRef.current) {
    +    +    -    +    +            try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +          }
    +    +    -    +    +        }, 300);
    +    +    -    +           }
    +    +    -    +         };
    +    +    -    +     
    +    +    -    +    -    recognitionRef.current = rec;
    +    +    -    +    -    return () => {
    +    +    -    +    -      listeningRef.current = false;
    +    +    -    +    -      rec.abort();
    +    +    -    +    -    };
    +    +    -    +    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    +    +    -    +    +    recRef.current = rec;
    +    +    -    +    +    return rec;
    +    +    -    +       }, []);
    +    +    -    +     
    +    +    -    +    -  const toggle = useCallback(() => {
    +    +    -    +    -    const rec = recognitionRef.current;
    +    +    -    +    +  const stop = useCallback(() => {
    +    +    -    +    +    listeningRef.current = false;
    +    +    -    +    +    setListening(false);
    +    +    -    +    +    const rec = recRef.current;
    +    +    -    +    +    if (rec) {
    +    +    -    +    +      try { rec.stop(); } catch { /* ignore */ }
    +    +    -    +    +    }
    +    +    -    +    +  }, []);
    +    +    -    +    +
    +    +    -    +    +  const start = useCallback(() => {
    +    +    -    +    +    const rec = getRec();
    +    +    -    +         if (!rec) return;
    +    +    -    +    +    /* Stop any active session first, then restart */
    +    +    -    +    +    try { rec.stop(); } catch { /* not running */ }
    +    +    -    +    +    listeningRef.current = true;
    +    +    -    +    +    setListening(true);
    +    +    -    +    +    /* Small delay to let the previous stop() settle */
    +    +    -    +    +    setTimeout(() => {
    +    +    -    +    +      if (listeningRef.current) {
    +    +    -    +    +        try { rec.start(); } catch { /* already running */ }
    +    +    -    +    +      }
    +    +    -    +    +    }, 100);
    +    +    -    +    +  }, [getRec]);
    +    +    -    +    +
    +    +    -    +    +  const toggle = useCallback(() => {
    +    +    -    +         if (listening) {
    +    +    -    +    -      listeningRef.current = false;
    +    +    -    +    -      rec.abort();
    +    +    -    +    -      setListening(false);
    +    +    -    +    +      stop();
    +    +    -    +         } else {
    +    +    -    +    -      listeningRef.current = true;
    +    +    -    +    -      rec.start();
    +    +    -    +    -      setListening(true);
    +    +    -    +    +      start();
    +    +    -    +         }
    +    +    -    +    -  }, [listening]);
    +    +    -    +    +  }, [listening, start, stop]);
    +    +    -    +    +
    +    +    -    +    +  /* Cleanup on unmount */
    +    +    -    +    +  useEffect(() => {
    +    +    -    +    +    return () => {
    +    +    -    +    +      listeningRef.current = false;
    +    +    -    +    +      const rec = recRef.current;
    +    +    -    +    +      recRef.current = null;
    +    +    -    +    +      if (rec) {
    +    +    -    +    +        rec.onresult = null;
    +    +    -    +    +        rec.onerror = null;
    +    +    -    +    +        rec.onend = null;
    +    +    -    +    +        try { rec.abort(); } catch { /* ignore */ }
    +    +    -    +    +      }
    +    +    -    +    +    };
    +    +    -    +    +  }, []);
    +    +    -    +     
    +    +    -    +       return { listening, toggle, supported: !!SpeechRecognition };
    +    +    -    +     }
    +    +    -    +     
    +    +    -    +    -function speak(text: string) {
    +    +    -    +    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    +    +    -    +    -  window.speechSynthesis.cancel();
    +    +    -    +    -  const utter = new SpeechSynthesisUtterance(text);
    +    +    -    +    -  utter.rate = 1.05;
    +    +    -    +    -  utter.pitch = 1;
    +    +    -    +    -  window.speechSynthesis.speak(utter);
    +    +    -    +    -}
    +    +    -    +    +
    +    +    -    +     
    +    +    -    +     /* ------------------------------------------------------------------ */
    +    +    -    +     /*  Progress bar                                                      */
    +    +    -    +    @@ -265,7 +305,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +       const [messages, setMessages] = useState<ChatMessage[]>([]);
    +    +    -    +       const [input, setInput] = useState('');
    +    +    -    +       const [sending, setSending] = useState(false);
    +    +    -    +    -  const [generating, setGenerating] = useState(false);
    +    +    -    +       const [qState, setQState] = useState<QuestionnaireState>({
    +    +    -    +         current_section: 'product_intent',
    +    +    -    +         completed_sections: [],
    +    +    -    +    @@ -273,7 +312,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +         is_complete: false,
    +    +    -    +       });
    +    +    -    +       const [error, setError] = useState('');
    +    +    -    +    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    +    +    -    +    +  const [resetting, setResetting] = useState(false);
    +    +    -    +    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    +    +    -    +    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    +    +    -    +       const messagesEndRef = useRef<HTMLDivElement>(null);
    +    +    -    +       const textareaRef = useRef<HTMLTextAreaElement>(null);
    +    +    -    +     
    +    +    -    +    @@ -307,13 +348,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +                 remaining_sections: state.remaining_sections,
    +    +    -    +                 is_complete: state.is_complete,
    +    +    -    +               });
    +    +    -    +    -          /* Restore prior conversation */
    +    +    -    +    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    +    +    -    +    -            (m: { role: string; content: string }) => ({
    +    +    -    +    -              role: m.role as 'user' | 'assistant',
    +    +    -    +    -              content: m.content,
    +    +    -    +    -            }),
    +    +    -    +    -          );
    +    +    -    +    +          /* Restore prior conversation Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« only messages from the current section */
    +    +    -    +    +          const currentSec = state.current_section;
    +    +    -    +    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    +    +    -    +    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    +    +    -    +    +            .map(
    +    +    -    +    +              (m: { role: string; content: string; section?: string }) => ({
    +    +    -    +    +                role: m.role as 'user' | 'assistant',
    +    +    -    +    +                content: m.content,
    +    +    -    +    +                section: m.section,
    +    +    -    +    +              }),
    +    +    -    +    +            );
    +    +    -    +    +          /* Restore token usage */
    +    +    -    +    +          if (state.token_usage) {
    +    +    -    +    +            setTokenUsage(state.token_usage);
    +    +    -    +    +          }
    +    +    -    +               if (history.length > 0) {
    +    +    -    +                 setMessages(history);
    +    +    -    +               } else if (!state.is_complete) {
    +    +    -    +    @@ -367,18 +416,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +           }
    +    +    -    +     
    +    +    -    +           const data = await res.json();
    +    +    -    +    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    +    +    -    +    +
    +    +    -    +    +      /* Detect section transition Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« clear visible messages for a fresh screen */
    +    +    -    +    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    +    +    -    +    +      const prevSection = qState.current_section;
    +    +    -    +    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    +    +    -    +    +
    +    +    -    +    +      if (sectionChanged) {
    +    +    -    +    +        /* Section just completed Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« start fresh with only the transition reply */
    +    +    -    +    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    +    +    -    +    +      } else {
    +    +    -    +    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    +    +    -    +    +      }
    +    +    -    +    +
    +    +    -    +           setQState({
    +    +    -    +    -        current_section: data.remaining_sections[0] ?? null,
    +    +    -    +    +        current_section: newCurrentSection,
    +    +    -    +             completed_sections: data.completed_sections,
    +    +    -    +             remaining_sections: data.remaining_sections,
    +    +    -    +             is_complete: data.is_complete,
    +    +    -    +           });
    +    +    -    +     
    +    +    -    +    -      /* auto-read assistant reply with TTS */
    +    +    -    +    -      if (voiceEnabled) {
    +    +    -    +    -        speak(data.reply);
    +    +    -    +    +      /* Update token usage */
    +    +    -    +    +      if (data.token_usage) {
    +    +    -    +    +        setTokenUsage(data.token_usage);
    +    +    -    +           }
    +    +    -    +    +
    +    +    -    +         } catch {
    +    +    -    +           setError('Network error');
    +    +    -    +         } finally {
    +    +    -    +    @@ -387,25 +449,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +       };
    +    +    -    +     
    +    +    -    +       /* ---- Generate contracts ---- */
    +    +    -    +    -  const handleGenerate = async () => {
    +    +    -    +    -    setGenerating(true);
    +    +    -    +    -    setError('');
    +    +    -    +    -    try {
    +    +    -    +    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    +    -    +    -        method: 'POST',
    +    +    -    +    -        headers: { Authorization: `Bearer ${token}` },
    +    +    -    +    -      });
    +    +    -    +    -      if (res.ok) {
    +    +    -    +    -        onContractsGenerated();
    +    +    -    +    -      } else {
    +    +    -    +    -        const d = await res.json().catch(() => ({}));
    +    +    -    +    -        setError(d.detail || 'Failed to generate contracts');
    +    +    -    +    -      }
    +    +    -    +    -    } catch {
    +    +    -    +    -      setError('Network error');
    +    +    -    +    -    } finally {
    +    +    -    +    -      setGenerating(false);
    +    +    -    +    -    }
    +    +    -    +    +  const handleStartGenerate = () => {
    +    +    -    +    +    setGeneratingContracts(true);
    +    +    -    +       };
    +    +    -    +     
    +    +    -    +       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    +    +    -    +    @@ -442,21 +487,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    +    +    -    +                       : 'Starting...'}
    +    +    -    +                 </p>
    +    +    -    +    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    +    +    -    +    +              Model: claude-haiku-4-5
    +    +    -    +    +            </p>
    +    +    -    +    +            {/* Context window meter */}
    +    +    -    +    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    +    +    -    +    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    +    -    +    +              const contextWindow = 200_000;
    +    +    -    +    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    +    +    -    +    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    +    +    -    +    +              return (
    +    +    -    +    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    +    +    -    +    +                  <div style={{
    +    +    -    +    +                    flex: 1,
    +    +    -    +    +                    height: '4px',
    +    +    -    +    +                    background: '#1E293B',
    +    +    -    +    +                    borderRadius: '2px',
    +    +    -    +    +                    overflow: 'hidden',
    +    +    -    +    +                    maxWidth: '120px',
    +    +    -    +    +                  }}>
    +    +    -    +    +                    <div style={{
    +    +    -    +    +                      width: `${pct}%`,
    +    +    -    +    +                      height: '100%',
    +    +    -    +    +                      background: barColor,
    +    +    -    +    +                      borderRadius: '2px',
    +    +    -    +    +                      transition: 'width 0.3s',
    +    +    -    +    +                    }} />
    +    +    -    +    +                  </div>
    +    +    -    +    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    +    +    -    +    +                    {totalTokens.toLocaleString()} / 200K
    +    +    -    +    +                  </span>
    +    +    -    +    +                </div>
    +    +    -    +    +              );
    +    +    -    +    +            })()}
    +    +    -    +               </div>
    +    +    -    +               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    +    +    -    +    -            {/* Voice toggle */}
    +    +    -    +    +            {/* Restart questionnaire */}
    +    +    -    +                 <button
    +    +    -    +    -              onClick={() => setVoiceEnabled((v) => !v)}
    +    +    -    +    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    +    +    -    +    -              data-testid="voice-toggle"
    +    +    -    +    +              onClick={async () => {
    +    +    -    +    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    +    +    -    +    +                setResetting(true);
    +    +    -    +    +                try {
    +    +    -    +    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    +    +    -    +    +                    method: 'DELETE',
    +    +    -    +    +                    headers: { Authorization: `Bearer ${token}` },
    +    +    -    +    +                  });
    +    +    -    +    +                  if (res.ok) {
    +    +    -    +    +                    setMessages([]);
    +    +    -    +    +                    setQState({
    +    +    -    +    +                      current_section: 'product_intent',
    +    +    -    +    +                      completed_sections: [],
    +    +    -    +    +                      remaining_sections: [...ALL_SECTIONS],
    +    +    -    +    +                      is_complete: false,
    +    +    -    +    +                    });
    +    +    -    +    +                    setInput('');
    +    +    -    +    +                    setError('');
    +    +    -    +    +                  }
    +    +    -    +    +                } catch { /* ignore */ }
    +    +    -    +    +                setResetting(false);
    +    +    -    +    +              }}
    +    +    -    +    +              disabled={resetting}
    +    +    -    +    +              title="Restart questionnaire"
    +    +    -    +    +              data-testid="restart-btn"
    +    +    -    +                   style={{
    +    +    -    +                     ...btnGhost,
    +    +    -    +                     padding: '6px 10px',
    +    +    -    +    -                fontSize: '1rem',
    +    +    -    +    -                opacity: voiceEnabled ? 1 : 0.5,
    +    +    -    +    +                fontSize: '0.7rem',
    +    +    -    +    +                fontWeight: 600,
    +    +    -    +    +                color: '#F59E0B',
    +    +    -    +    +                borderColor: '#F59E0B33',
    +    +    -    +    +                opacity: resetting ? 0.5 : 1,
    +    +    -    +                   }}
    +    +    -    +                 >
    +    +    -    +    -              {voiceEnabled ? 'Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬╝Ôö£┬í├ö├Â┬úÔö£Ôòæ├ö├Â┬úÔö£├æÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├Â├ë' : 'Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬╝Ôö£┬í├ö├Â┬úÔö£Ôòæ├ö├Â┬úÔö£├æÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬╝├ö├▓├ª'}
    +    +    -    +    +              Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬¬├ö├Â┬úÔö£├é├ö├Â┬ú├ö├╗├┤├ö├Â┬ú├ö├▓├║ Restart
    +    +    -    +                 </button>
    +    +    -    +                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    +    +    -    +                   Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔòùÔö£Ôöñ
    +    +    -    +    @@ -514,8 +617,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +               </div>
    +    +    -    +             )}
    +    +    -    +     
    +    +    -    +    +        {/* Contract generation progress */}
    +    +    -    +    +        {generatingContracts && (
    +    +    -    +    +          <ContractProgress
    +    +    -    +    +            projectId={projectId}
    +    +    -    +    +            tokenUsage={tokenUsage}
    +    +    -    +    +            model="claude-haiku-4-5"
    +    +    -    +    +            onComplete={onContractsGenerated}
    +    +    -    +    +          />
    +    +    -    +    +        )}
    +    +    -    +    +
    +    +    -    +             {/* Generate contracts banner */}
    +    +    -    +    -        {qState.is_complete && (
    +    +    -    +    +        {qState.is_complete && !generatingContracts && (
    +    +    -    +               <div
    +    +    -    +                 style={{
    +    +    -    +                   padding: '12px 20px',
    +    +    -    +    @@ -533,17 +646,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -    +                   Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬ú├ö├▓├ªÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£ÔûÆ All sections complete Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« ready to generate contracts
    +    +    -    +                 </span>
    +    +    -    +                 <button
    +    +    -    +    -              onClick={handleGenerate}
    +    +    -    +    -              disabled={generating}
    +    +    -    +    +              onClick={handleStartGenerate}
    +    +    -    +                   data-testid="generate-contracts-btn"
    +    +    -    +                   style={{
    +    +    -    +                     ...btnPrimary,
    +    +    -    +                     background: '#16A34A',
    +    +    -    +    -                opacity: generating ? 0.6 : 1,
    +    +    -    +    -                cursor: generating ? 'wait' : 'pointer',
    +    +    -    +    +                cursor: 'pointer',
    +    +    -    +                   }}
    +    +    -    +                 >
    +    +    -    +    -              {generating ? 'Generating...' : 'Generate Contracts'}
    +    +    -    +    +              Generate Contracts
    +    +    -    +                 </button>
    +    +    -    +               </div>
    +    +    -    +             )}
    +    +    -    +    diff --git a/web/src/context/AuthContext.tsx b/web/src/context/AuthContext.tsx
    +    +    -    +    index 3f217e2..0430bc8 100644
    +    +    -    +    --- a/web/src/context/AuthContext.tsx
    +    +    -    +    +++ b/web/src/context/AuthContext.tsx
    +    +    -    +    @@ -4,6 +4,7 @@ interface User {
    +    +    -    +       id: string;
    +    +    -    +       github_login: string;
    +    +    -    +       avatar_url: string | null;
    +    +    -    +    +  has_anthropic_key?: boolean;
    +    +    -    +     }
    +    +    -    +     
    +    +    -    +     interface AuthContextValue {
    +    +    -    +    @@ -11,6 +12,7 @@ interface AuthContextValue {
    +    +    -    +       user: User | null;
    +    +    -    +       login: (token: string, user: User) => void;
    +    +    -    +       logout: () => void;
    +    +    -    +    +  updateUser: (patch: Partial<User>) => void;
    +    +    -    +     }
    +    +    -    +     
    +    +    -    +     const AuthContext = createContext<AuthContextValue | null>(null);
    +    +    -    +    @@ -38,6 +40,15 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    +    +    -    +         localStorage.removeItem('forgeguard_user');
    +    +    -    +       };
    +    +    -    +     
    +    +    -    +    +  const updateUser = (patch: Partial<User>) => {
    +    +    -    +    +    setUser((prev) => {
    +    +    -    +    +      if (!prev) return prev;
    +    +    -    +    +      const updated = { ...prev, ...patch };
    +    +    -    +    +      localStorage.setItem('forgeguard_user', JSON.stringify(updated));
    +    +    -    +    +      return updated;
    +    +    -    +    +    });
    +    +    -    +    +  };
    +    +    -    +    +
    +    +    -    +       useEffect(() => {
    +    +    -    +         if (!token) return;
    +    +    -    +         // Validate token on mount by calling /auth/me
    +    +    -    +    @@ -53,7 +64,7 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    +    +    -    +       }, []); // eslint-disable-line react-hooks/exhaustive-deps
    +    +    -    +     
    +    +    -    +       return (
    +    +    -    +    -    <AuthContext.Provider value={{ token, user, login, logout }}>
    +    +    -    +    +    <AuthContext.Provider value={{ token, user, login, logout, updateUser }}>
    +    +    -    +           {children}
    +    +    -    +         </AuthContext.Provider>
    +    +    -    +       );
    +    +    -    +    diff --git a/web/src/pages/BuildComplete.tsx b/web/src/pages/BuildComplete.tsx
    +    +    -    +    index e419947..19ece0f 100644
    +    +    -    +    --- a/web/src/pages/BuildComplete.tsx
    +    +    -    +    +++ b/web/src/pages/BuildComplete.tsx
    +    +    -    +    @@ -184,6 +184,7 @@ export default function BuildComplete() {
    +    +    -    +               <h3 style={{ color: '#F8FAFC', margin: '0 0 12px' }}>Token Usage by Phase</h3>
    +    +    -    +               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', borderBottom: '1px solid #334155', color: '#94A3B8', fontSize: 13 }}>
    +    +    -    +                 <span style={{ flex: 2 }}>Phase</span>
    +    +    -    +    +            <span style={{ flex: 1 }}>Model</span>
    +    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Input</span>
    +    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Output</span>
    +    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Cost</span>
    +    +    -    +    @@ -191,6 +192,7 @@ export default function BuildComplete() {
    +    +    -    +               {summary.cost.phases.map((entry, i) => (
    +    +    -    +                 <div key={i} style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #1E293B', color: '#F8FAFC', fontSize: 14 }}>
    +    +    -    +                   <span style={{ flex: 2 }}>{entry.phase}</span>
    +    +    -    +    +              <span style={{ flex: 1, color: '#A78BFA', fontSize: 12 }}>{entry.model.replace('claude-', '')}</span>
    +    +    -    +                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.input_tokens)}</span>
    +    +    -    +                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.output_tokens)}</span>
    +    +    -    +                   <span style={{ flex: 1, textAlign: 'right' }}>${entry.estimated_cost_usd.toFixed(4)}</span>
    +    +    -    +    @@ -198,6 +200,7 @@ export default function BuildComplete() {
    +    +    -    +               ))}
    +    +    -    +               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0 0', color: '#F8FAFC', fontWeight: 600, fontSize: 14 }}>
    +    +    -    +                 <span style={{ flex: 2 }}>Total</span>
    +    +    -    +    +            <span style={{ flex: 1 }}></span>
    +    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_input_tokens)}</span>
    +    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_output_tokens)}</span>
    +    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>${summary.cost.total_cost_usd.toFixed(4)}</span>
    +    +    -    +    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    +    +    -    +    index a4f1808..7e97168 100644
    +    +    -    +    --- a/web/src/pages/BuildProgress.tsx
    +    +    -    +    +++ b/web/src/pages/BuildProgress.tsx
    +    +    -    +    @@ -303,6 +303,10 @@ function BuildProgress() {
    +    +    -    +                   <span style={{ color: '#94A3B8' }}>Phase: </span>
    +    +    -    +                   <span style={{ fontWeight: 600 }}>{build.phase}</span>
    +    +    -    +                 </div>
    +    +    -    +    +            <div>
    +    +    -    +    +              <span style={{ color: '#94A3B8' }}>Model: </span>
    +    +    -    +    +              <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    +    +    -    +    +            </div>
    +    +    -    +                 {elapsedStr && (
    +    +    -    +                   <div>
    +    +    -    +                     <span style={{ color: '#94A3B8' }}>Elapsed: </span>
    +    +    -    +    diff --git a/web/src/pages/ProjectDetail.tsx b/web/src/pages/ProjectDetail.tsx
    +    +    -    +    index bbb2777..78a0f36 100644
    +    +    -    +    --- a/web/src/pages/ProjectDetail.tsx
    +    +    -    +    +++ b/web/src/pages/ProjectDetail.tsx
    +    +    -    +    @@ -13,6 +13,28 @@ import QuestionnaireModal from '../components/QuestionnaireModal';
    +    +    -    +     
    +    +    -    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -    +     
    +    +    -    +    +const needsKeyBanner = (
    +    +    -    +    +  <div style={{
    +    +    -    +    +    background: '#1E293B',
    +    +    -    +    +    border: '1px solid #92400E',
    +    +    -    +    +    borderRadius: '6px',
    +    +    -    +    +    padding: '10px 16px',
    +    +    -    +    +    marginBottom: '16px',
    +    +    -    +    +    fontSize: '0.8rem',
    +    +    -    +    +    color: '#FBBF24',
    +    +    -    +    +    display: 'flex',
    +    +    -    +    +    alignItems: 'center',
    +    +    -    +    +    gap: '10px',
    +    +    -    +    +  }}>
    +    +    -    +    +    <span style={{ fontSize: '1rem' }}>Ôö£├ÂÔö£├éÔö¼ÔòØ├ö├Â┬╝Ôö£┬í├ö├Â┬úÔö£Ôòæ├ö├Â┬úÔö£├æÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬╝Ôö¼┬╝</span>
    +    +    -    +    +    <span>
    +    +    -    +    +      Add your Anthropic API key in{' '}
    +    +    -    +    +      <Link to="/settings" style={{ color: '#60A5FA', textDecoration: 'underline' }}>Settings</Link>{' '}
    +    +    -    +    +      to start a build. Questionnaires and audits are free.
    +    +    -    +    +    </span>
    +    +    -    +    +  </div>
    +    +    -    +    +);
    +    +    -    +    +
    +    +    -    +     interface ProjectDetailData {
    +    +    -    +       id: string;
    +    +    -    +       name: string;
    +    +    -    +    @@ -34,7 +56,7 @@ interface ProjectDetailData {
    +    +    -    +     
    +    +    -    +     function ProjectDetail() {
    +    +    -    +       const { projectId } = useParams<{ projectId: string }>();
    +    +    -    +    -  const { token } = useAuth();
    +    +    -    +    +  const { user, token } = useAuth();
    +    +    -    +       const { addToast } = useToast();
    +    +    -    +       const navigate = useNavigate();
    +    +    -    +       const [project, setProject] = useState<ProjectDetailData | null>(null);
    +    +    -    +    @@ -282,6 +304,9 @@ function ProjectDetail() {
    +    +    -    +               </div>
    +    +    -    +             </div>
    +    +    -    +     
    +    +    -    +    +        {/* BYOK warning */}
    +    +    -    +    +        {hasContracts && !buildActive && !(user?.has_anthropic_key) && needsKeyBanner}
    +    +    -    +    +
    +    +    -    +             {/* Build Actions */}
    +    +    -    +             <div style={{ display: 'flex', gap: '12px', marginBottom: '24px' }}>
    +    +    -    +               {!buildActive && (
    +    +    -    +    diff --git a/web/src/pages/Settings.tsx b/web/src/pages/Settings.tsx
    +    +    -    +    new file mode 100644
    +    +    -    +    index 0000000..29c213d
    +    +    -    +    --- /dev/null
    +    +    -    +    +++ b/web/src/pages/Settings.tsx
    +    +    -    +    @@ -0,0 +1,280 @@
    +    +    -    +    +/**
    +    +    -    +    + * Settings -- user settings page with BYOK API key management.
    +    +    -    +    + */
    +    +    -    +    +import { useState } from 'react';
    +    +    -    +    +import { useNavigate } from 'react-router-dom';
    +    +    -    +    +import { useAuth } from '../context/AuthContext';
    +    +    -    +    +import { useToast } from '../context/ToastContext';
    +    +    -    +    +import AppShell from '../components/AppShell';
    +    +    -    +    +
    +    +    -    +    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -    +    +
    +    +    -    +    +function Settings() {
    +    +    -    +    +  const { user, token, updateUser } = useAuth();
    +    +    -    +    +  const { addToast } = useToast();
    +    +    -    +    +  const navigate = useNavigate();
    +    +    -    +    +
    +    +    -    +    +  const [apiKey, setApiKey] = useState('');
    +    +    -    +    +  const [saving, setSaving] = useState(false);
    +    +    -    +    +  const [removing, setRemoving] = useState(false);
    +    +    -    +    +
    +    +    -    +    +  const hasKey = user?.has_anthropic_key ?? false;
    +    +    -    +    +
    +    +    -    +    +  const handleSaveKey = async () => {
    +    +    -    +    +    const trimmed = apiKey.trim();
    +    +    -    +    +    if (!trimmed) return;
    +    +    -    +    +    setSaving(true);
    +    +    -    +    +    try {
    +    +    -    +    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    +    +    -    +    +        method: 'PUT',
    +    +    -    +    +        headers: {
    +    +    -    +    +          Authorization: `Bearer ${token}`,
    +    +    -    +    +          'Content-Type': 'application/json',
    +    +    -    +    +        },
    +    +    -    +    +        body: JSON.stringify({ api_key: trimmed }),
    +    +    -    +    +      });
    +    +    -    +    +      if (res.ok) {
    +    +    -    +    +        addToast('API key saved', 'success');
    +    +    -    +    +        setApiKey('');
    +    +    -    +    +        updateUser({ has_anthropic_key: true });
    +    +    -    +    +      } else {
    +    +    -    +    +        const data = await res.json().catch(() => ({ detail: 'Failed to save key' }));
    +    +    -    +    +        addToast(data.detail || 'Failed to save key');
    +    +    -    +    +      }
    +    +    -    +    +    } catch {
    +    +    -    +    +      addToast('Network error saving key');
    +    +    -    +    +    } finally {
    +    +    -    +    +      setSaving(false);
    +    +    -    +    +    }
    +    +    -    +    +  };
    +    +    -    +    +
    +    +    -    +    +  const handleRemoveKey = async () => {
    +    +    -    +    +    setRemoving(true);
    +    +    -    +    +    try {
    +    +    -    +    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    +    +    -    +    +        method: 'DELETE',
    +    +    -    +    +        headers: { Authorization: `Bearer ${token}` },
    +    +    -    +    +      });
    +    +    -    +    +      if (res.ok) {
    +    +    -    +    +        addToast('API key removed', 'info');
    +    +    -    +    +        updateUser({ has_anthropic_key: false });
    +    +    -    +    +      } else {
    +    +    -    +    +        addToast('Failed to remove key');
    +    +    -    +    +      }
    +    +    -    +    +    } catch {
    +    +    -    +    +      addToast('Network error removing key');
    +    +    -    +    +    } finally {
    +    +    -    +    +      setRemoving(false);
    +    +    -    +    +    }
    +    +    -    +    +  };
    +    +    -    +    +
    +    +    -    +    +  return (
    +    +    -    +    +    <AppShell>
    +    +    -    +    +      <div style={{ padding: '24px', maxWidth: '720px', margin: '0 auto' }}>
    +    +    -    +    +        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    +    +    -    +    +          <button
    +    +    -    +    +            onClick={() => navigate('/')}
    +    +    -    +    +            style={{
    +    +    -    +    +              background: 'transparent',
    +    +    -    +    +              color: '#94A3B8',
    +    +    -    +    +              border: '1px solid #334155',
    +    +    -    +    +              borderRadius: '6px',
    +    +    -    +    +              padding: '6px 12px',
    +    +    -    +    +              cursor: 'pointer',
    +    +    -    +    +              fontSize: '0.8rem',
    +    +    -    +    +            }}
    +    +    -    +    +          >
    +    +    -    +    +            Back
    +    +    -    +    +          </button>
    +    +    -    +    +          <h2 style={{ margin: 0, fontSize: '1.1rem' }}>Settings</h2>
    +    +    -    +    +        </div>
    +    +    -    +    +
    +    +    -    +    +        {/* Profile Section */}
    +    +    -    +    +        <div
    +    +    -    +    +          style={{
    +    +    -    +    +            background: '#1E293B',
    +    +    -    +    +            borderRadius: '8px',
    +    +    -    +    +            padding: '20px',
    +    +    -    +    +            marginBottom: '16px',
    +    +    -    +    +          }}
    +    +    -    +    +        >
    +    +    -    +    +          <h3 style={{ margin: '0 0 16px', fontSize: '0.9rem', color: '#F8FAFC' }}>Profile</h3>
    +    +    -    +    +          <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
    +    +    -    +    +            {user?.avatar_url && (
    +    +    -    +    +              <img
    +    +    -    +    +                src={user.avatar_url}
    +    +    -    +    +                alt={user.github_login}
    +    +    -    +    +                style={{ width: 48, height: 48, borderRadius: '50%' }}
    +    +    -    +    +              />
    +    +    -    +    +            )}
    +    +    -    +    +            <div>
    +    +    -    +    +              <div style={{ fontWeight: 600, fontSize: '0.95rem' }}>{user?.github_login}</div>
    +    +    -    +    +              <div style={{ color: '#64748B', fontSize: '0.8rem', marginTop: '2px' }}>
    +    +    -    +    +                Authenticated via GitHub
    +    +    -    +    +              </div>
    +    +    -    +    +            </div>
    +    +    -    +    +          </div>
    +    +    -    +    +        </div>
    +    +    -    +    +
    +    +    -    +    +        {/* BYOK API Key Section */}
    +    +    -    +    +        <div
    +    +    -    +    +          style={{
    +    +    -    +    +            background: '#1E293B',
    +    +    -    +    +            borderRadius: '8px',
    +    +    -    +    +            padding: '20px',
    +    +    -    +    +            marginBottom: '16px',
    +    +    -    +    +          }}
    +    +    -    +    +          data-testid="byok-section"
    +    +    -    +    +        >
    +    +    -    +    +          <h3 style={{ margin: '0 0 4px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    +    -    +    +            Anthropic API Key
    +    +    -    +    +          </h3>
    +    +    -    +    +          <p style={{ margin: '0 0 14px', fontSize: '0.75rem', color: '#64748B', lineHeight: 1.5 }}>
    +    +    -    +    +            Builds use Claude Opus and run on your own Anthropic API key.
    +    +    -    +    +            Planning, questionnaires, and audits are free Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£┬« powered by Haiku on us.
    +    +    -    +    +          </p>
    +    +    -    +    +
    +    +    -    +    +          {hasKey ? (
    +    +    -    +    +            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    +    +    -    +    +              <div style={{
    +    +    -    +    +                flex: 1,
    +    +    -    +    +                display: 'flex',
    +    +    -    +    +                alignItems: 'center',
    +    +    -    +    +                gap: '8px',
    +    +    -    +    +                padding: '8px 12px',
    +    +    -    +    +                background: '#0F172A',
    +    +    -    +    +                borderRadius: '6px',
    +    +    -    +    +                fontSize: '0.8rem',
    +    +    -    +    +              }}>
    +    +    -    +    +                <span style={{ color: '#22C55E', fontSize: '0.7rem' }}>Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£ÔûôÔö£ÔòæÔö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├¡</span>
    +    +    -    +    +                <span style={{ color: '#94A3B8' }}>Key configured</span>
    +    +    -    +    +                <span style={{ color: '#64748B', fontFamily: 'monospace' }}>sk-ant-Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£┬«Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö£├®Ôö£├ÂÔö£├éÔö¼├║├ö├Â┬úÔö¼ÔòæÔö£├ÂÔö£├éÔö¼├║Ôö£├ÂÔö£├éÔö£┬«</span>
    +    +    -    +    +              </div>
    +    +    -    +    +              <button
    +    +    -    +    +                onClick={handleRemoveKey}
    +    +    -    +    +                disabled={removing}
    +    +    -    +    +                data-testid="remove-api-key-btn"
    +    +    -    +    +                style={{
    +    +    -    +    +                  background: 'transparent',
    +    +    -    +    +                  color: '#EF4444',
    +    +    -    +    +                  border: '1px solid #7F1D1D',
    +    +    -    +    +                  borderRadius: '6px',
    +    +    -    +    +                  padding: '6px 14px',
    +    +    -    +    +                  cursor: removing ? 'not-allowed' : 'pointer',
    +    +    -    +    +                  fontSize: '0.75rem',
    +    +    -    +    +                  opacity: removing ? 0.6 : 1,
    +    +    -    +    +                }}
    +    +    -    +    +              >
    +    +    -    +    +                {removing ? 'Removing...' : 'Remove'}
    +    +    -    +    +              </button>
    +    +    -    +    +            </div>
    +    +    -    +    +          ) : (
    +    +    -    +    +            <div>
    +    +    -    +    +              <div style={{ display: 'flex', gap: '8px' }}>
    +    +    -    +    +                <input
    +    +    -    +    +                  type="password"
    +    +    -    +    +                  value={apiKey}
    +    +    -    +    +                  onChange={(e) => setApiKey(e.target.value)}
    +    +    -    +    +                  placeholder="sk-ant-api03-..."
    +    +    -    +    +                  data-testid="api-key-input"
    +    +    -    +    +                  style={{
    +    +    -    +    +                    flex: 1,
    +    +    -    +    +                    background: '#0F172A',
    +    +    -    +    +                    border: '1px solid #334155',
    +    +    -    +    +                    borderRadius: '6px',
    +    +    -    +    +                    padding: '8px 12px',
    +    +    -    +    +                    color: '#F8FAFC',
    +    +    -    +    +                    fontSize: '0.8rem',
    +    +    -    +    +                    fontFamily: 'monospace',
    +    +    -    +    +                    outline: 'none',
    +    +    -    +    +                  }}
    +    +    -    +    +                  onKeyDown={(e) => { if (e.key === 'Enter') handleSaveKey(); }}
    +    +    -    +    +                />
    +    +    -    +    +                <button
    +    +    -    +    +                  onClick={handleSaveKey}
    +    +    -    +    +                  disabled={saving || !apiKey.trim()}
    +    +    -    +    +                  data-testid="save-api-key-btn"
    +    +    -    +    +                  style={{
    +    +    -    +    +                    background: saving ? '#1E293B' : '#2563EB',
    +    +    -    +    +                    color: '#fff',
    +    +    -    +    +                    border: 'none',
    +    +    -    +    +                    borderRadius: '6px',
    +    +    -    +    +                    padding: '8px 18px',
    +    +    -    +    +                    cursor: saving || !apiKey.trim() ? 'not-allowed' : 'pointer',
    +    +    -    +    +                    fontSize: '0.8rem',
    +    +    -    +    +                    opacity: saving || !apiKey.trim() ? 0.6 : 1,
    +    +    -    +    +                  }}
    +    +    -    +    +                >
    +    +    -    +    +                  {saving ? 'Saving...' : 'Save Key'}
    +    +    -    +    +                </button>
    +    +    -    +    +              </div>
    +    +    -    +    +              <p style={{ margin: '8px 0 0', fontSize: '0.7rem', color: '#64748B' }}>
    +    +    -    +    +                Your key is stored securely and only used for build operations.
    +    +    -    +    +                Get one at{' '}
    +    +    -    +    +                <a
    +    +    -    +    +                  href="https://console.anthropic.com/settings/keys"
    +    +    -    +    +                  target="_blank"
    +    +    -    +    +                  rel="noopener noreferrer"
    +    +    -    +    +                  style={{ color: '#60A5FA' }}
    +    +    -    +    +                >
    +    +    -    +    +                  console.anthropic.com
    +    +    -    +    +                </a>
    +    +    -    +    +              </p>
    +    +    -    +    +            </div>
    +    +    -    +    +          )}
    +    +    -    +    +        </div>
    +    +    -    +    +
    +    +    -    +    +        {/* AI Models info */}
    +    +    -    +    +        <div
    +    +    -    +    +          style={{
    +    +    -    +    +            background: '#1E293B',
    +    +    -    +    +            borderRadius: '8px',
    +    +    -    +    +            padding: '20px',
    +    +    -    +    +            marginBottom: '16px',
    +    +    -    +    +          }}
    +    +    -    +    +        >
    +    +    -    +    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>AI Models</h3>
    +    +    -    +    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', fontSize: '0.8rem' }}>
    +    +    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    +    +    -    +    +              <span style={{ color: '#94A3B8' }}>Questionnaire</span>
    +    +    -    +    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    +    +    -    +    +                <span style={{ color: '#22C55E', fontWeight: 600 }}>claude-haiku-4-5</span>
    +    +    -    +    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>FREE</span>
    +    +    -    +    +              </div>
    +    +    -    +    +            </div>
    +    +    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    +    +    -    +    +              <span style={{ color: '#94A3B8' }}>Builder</span>
    +    +    -    +    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    +    +    -    +    +                <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    +    +    -    +    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>BYOK</span>
    +    +    -    +    +              </div>
    +    +    -    +    +            </div>
    +    +    -    +    +          </div>
    +    +    -    +    +        </div>
    +    +    -    +    +
    +    +    -    +    +        {/* About Section */}
    +    +    -    +    +        <div
    +    +    -    +    +          style={{
    +    +    -    +    +            background: '#1E293B',
    +    +    -    +    +            borderRadius: '8px',
    +    +    -    +    +            padding: '20px',
    +    +    -    +    +          }}
    +    +    -    +    +        >
    +    +    -    +    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>About</h3>
    +    +    -    +    +          <div style={{ fontSize: '0.8rem', color: '#94A3B8', display: 'flex', flexDirection: 'column', gap: '6px' }}>
    +    +    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    +    +    -    +    +              <span>Version</span>
    +    +    -    +    +              <span style={{ color: '#F8FAFC' }}>v0.1.0</span>
    +    +    -    +    +            </div>
    +    +    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    +    +    -    +    +              <span>Framework</span>
    +    +    -    +    +              <span style={{ color: '#F8FAFC' }}>Forge Governance</span>
    +    +    -    +    +            </div>
    +    +    -    +    +          </div>
    +    +    -    +    +        </div>
    +    +    -    +    +      </div>
    +    +    -    +    +    </AppShell>
    +    +    -    +    +  );
    +    +    -    +    +}
    +    +    -    +    +
    +    +    -    +    +export default Settings;
    +    +    -    +    diff --git a/web/vite.config.ts b/web/vite.config.ts
    +    +    -    +    index 136369a..43cba1f 100644
    +    +    -    +    --- a/web/vite.config.ts
    +    +    -    +    +++ b/web/vite.config.ts
    +    +    -    +    @@ -1,6 +1,18 @@
    +    +    -    +     import { defineConfig } from 'vite';
    +    +    -    +     import react from '@vitejs/plugin-react';
    +    +    -    +     
    +    +    -    +    +/* Bypass proxy for browser page navigations (Accept: text/html) so Vite
    +    +    -    +    +   serves index.html and React Router handles the route. API fetch() calls
    +    +    -    +    +   (Accept: application/json) still proxy to the backend. */
    +    +    -    +    +const apiProxy = {
    +    +    -    +    +  target: 'http://localhost:8000',
    +    +    -    +    +  bypass(req: { headers: { accept?: string } }) {
    +    +    -    +    +    if (req.headers.accept?.includes('text/html')) {
    +    +    -    +    +      return '/index.html';
    +    +    -    +    +    }
    +    +    -    +    +  },
    +    +    -    +    +};
    +    +    -    +    +
    +    +    -    +     export default defineConfig({
    +    +    -    +       plugins: [react()],
    +    +    -    +       server: {
    +    +    -    +    @@ -10,11 +22,12 @@ export default defineConfig({
    +    +    -    +           '/auth/login': 'http://localhost:8000',
    +    +    -    +           '/auth/github': 'http://localhost:8000',
    +    +    -    +           '/auth/me': 'http://localhost:8000',
    +    +    -    +    -      '/repos': 'http://localhost:8000',
    +    +    -    +    -      '/projects': 'http://localhost:8000',
    +    +    -    +    +      '/auth/api-key': 'http://localhost:8000',
    +    +    -    +    +      '/repos': apiProxy,
    +    +    -    +    +      '/projects': apiProxy,
    +    +    -    +           '/webhooks': 'http://localhost:8000',
    +    +    -    +           '/ws': {
    +    +    -    +    -        target: 'ws://localhost:8000',
    +    +    -    +    +        target: 'http://localhost:8000',
    +    +    -    +             ws: true,
    +    +    -    +           },
    +    +    -    +         },
    +    +    -     
    +    +    -    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    +    +    -    index 369350b..d8df0cf 100644
    +    +    -    --- a/Forge/scripts/run_audit.ps1
    +    +    -    +++ b/Forge/scripts/run_audit.ps1
    +    +    -    @@ -1,4 +1,4 @@
    +    +    -    -├ö├Â┬╝├ö├Â├▒Ôö£├ÂÔö£ÔûôÔö£ÔòúÔö£├ÂÔö£├éÔö£├½# scripts/run_audit.ps1
    +    +    -    +# scripts/run_audit.ps1
    +    +    -     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    +    +    -     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    +    +    -     # Reads layer boundaries from Contracts/boundaries.json.
    +    +    -    @@ -24,7 +24,7 @@ param(
    +    +    -     Set-StrictMode -Version Latest
    +    +    -     $ErrorActionPreference = "Stop"
    +    +    -     
    +    +    -    -# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Helpers ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +# -- Helpers ------------------------------------------------------------------
    +    +    -     
    +    +    -     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    +    +    -     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    +    +    -    @@ -41,7 +41,7 @@ function RepoRoot {
    +    +    -       return (& git rev-parse --show-toplevel).Trim()
    +    +    -     }
    +    +    -     
    +    +    -    -# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Main ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +# -- Main ---------------------------------------------------------------------
    +    +    -     
    +    +    -     try {
    +    +    -       RequireGit
    +    +    -    @@ -54,10 +54,10 @@ try {
    +    +    -       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    +    +    -     
    +    +    -       # Parse claimed files into a sorted, normalized set
    +    +    -    -  $claimed = $ClaimedFiles.Split(",") |
    +    +    -    +  $claimed = @($ClaimedFiles.Split(",") |
    +    +    -         ForEach-Object { $_.Trim().Replace("\", "/") } |
    +    +    -         Where-Object { $_ -ne "" } |
    +    +    -    -    Sort-Object -Unique
    +    +    -    +    Sort-Object -Unique)
    +    +    -     
    +    +    -       if ($claimed.Count -eq 0) {
    +    +    -         throw "ClaimedFiles is empty."
    +    +    -    @@ -79,7 +79,7 @@ try {
    +    +    -       $warnings  = [ordered]@{}
    +    +    -       $anyFail   = $false
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A1: Scope compliance ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A1: Scope compliance -----------------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    +    +    -    @@ -111,7 +111,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A2: Minimal-diff discipline ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A2: Minimal-diff discipline ----------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         $summaryRaw = & git diff --cached --summary 2>&1
    +    +    -    @@ -133,7 +133,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A3: Evidence completeness ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A3: Evidence completeness ------------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         $a3Failures = @()
    +    +    -    @@ -164,7 +164,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A4: Boundary compliance (reads Contracts/boundaries.json) ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
    +    +    -     
    +    +    -       try {
    +    +    -         $a4Violations = @()
    +    +    -    @@ -213,7 +213,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A5: Diff Log Gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A5: Diff Log Gate --------------------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         if (-not (Test-Path $diffLog)) {
    +    +    -    @@ -237,7 +237,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A6: Authorization Gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A6: Authorization Gate ---------------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         $lastAuthHash = $null
    +    +    -    @@ -268,7 +268,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A7: Verification hierarchy order ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A7: Verification hierarchy order -----------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         if (-not (Test-Path $diffLog)) {
    +    +    -    @@ -324,7 +324,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A8: Test gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A8: Test gate ------------------------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         if (-not (Test-Path $testRunsLatest)) {
    +    +    -    @@ -344,7 +344,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ A9: Dependency gate ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- A9: Dependency gate ------------------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         $a9Failures = @()
    +    +    -    @@ -508,7 +508,7 @@ try {
    +    +    -         $anyFail = $true
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W1: No secrets in diff ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- W1: No secrets in diff --------------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         $diffContent = & git diff --cached 2>&1
    +    +    -    @@ -534,7 +534,7 @@ try {
    +    +    -         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W2: Audit ledger integrity ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- W2: Audit ledger integrity ----------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         if (-not (Test-Path $auditLedger)) {
    +    +    -    @@ -548,7 +548,7 @@ try {
    +    +    -         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ W3: Physics route coverage ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- W3: Physics route coverage ----------------------------------------
    +    +    -     
    +    +    -       try {
    +    +    -         if (-not (Test-Path $physicsYaml)) {
    +    +    -    @@ -613,7 +613,7 @@ try {
    +    +    -         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    +    +    -       }
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Build output ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- Build output ------------------------------------------------------
    +    +    -     
    +    +    -       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    +    +    -     
    +    +    -    @@ -643,7 +643,7 @@ Overall: $overall
    +    +    -     
    +    +    -       Write-Output $output
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Append to audit ledger ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- Append to audit ledger ---------------------------------------------
    +    +    -     
    +    +    -       $iteration = 1
    +    +    -       if (Test-Path $auditLedger) {
    +    +    -    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    +    +    -       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    +    +    -       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    +    +    -     
    +    +    -    -  # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ Exit ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +  # -- Exit ---------------------------------------------------------------
    +    +    -     
    +    +    -       if ($anyFail) {
    +    +    -         exit 1
    +    +    -    diff --git a/USER_INSTRUCTIONS.md b/USER_INSTRUCTIONS.md
    +    +    -    index c76b33a..ad50c71 100644
    +    +    -    --- a/USER_INSTRUCTIONS.md
    +    +    -    +++ b/USER_INSTRUCTIONS.md
    +    +    -    @@ -87,7 +87,7 @@ APP_URL=http://localhost:8000
    +    +    -     - `APP_URL` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® `http://localhost:8000`
    +    +    -     - `ANTHROPIC_API_KEY` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® required for AI-powered builds (get one at [console.anthropic.com](https://console.anthropic.com))
    +    +    -     - `LLM_BUILDER_MODEL` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® model for builds (default: `claude-opus-4-6`)
    +    +    -    -- `LLM_QUESTIONNAIRE_MODEL` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® model for questionnaire (default: `claude-3-5-haiku-20241022`)
    +    +    -    +- `LLM_QUESTIONNAIRE_MODEL` ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® model for questionnaire (default: `claude-haiku-4-5`)
    +    +    -     
    +    +    -     ---
    +    +    -     
    +    +    -    diff --git a/app/api/routers/auth.py b/app/api/routers/auth.py
    +    +    -    index dffd10d..cf3df44 100644
    +    +    -    --- a/app/api/routers/auth.py
    +    +    -    +++ b/app/api/routers/auth.py
    +    +    -    @@ -1,13 +1,15 @@
    +    +    -    -"""Authentication router -- GitHub OAuth flow and user info."""
    +    +    -    +"""Authentication router -- GitHub OAuth flow, user info, and BYOK API key management."""
    +    +    -     
    +    +    -     import secrets
    +    +    -     from urllib.parse import urlencode
    +    +    -     
    +    +    -     from fastapi import APIRouter, Depends, HTTPException, Query, status
    +    +    -    +from pydantic import BaseModel
    +    +    -     
    +    +    -     from app.api.deps import get_current_user
    +    +    -     from app.clients.github_client import GITHUB_OAUTH_URL
    +    +    -     from app.config import settings
    +    +    -    +from app.repos.user_repo import set_anthropic_api_key
    +    +    -     from app.services.auth_service import handle_github_callback
    +    +    -     
    +    +    -     router = APIRouter(prefix="/auth", tags=["auth"])
    +    +    -    @@ -66,8 +68,36 @@ async def get_current_user_info(
    +    +    -         current_user: dict = Depends(get_current_user),
    +    +    -     ) -> dict:
    +    +    -         """Return the current authenticated user info."""
    +    +    -    +    has_api_key = bool(current_user.get("anthropic_api_key"))
    +    +    -         return {
    +    +    -             "id": str(current_user["id"]),
    +    +    -             "github_login": current_user["github_login"],
    +    +    -             "avatar_url": current_user.get("avatar_url"),
    +    +    -    +        "has_anthropic_key": has_api_key,
    +    +    -         }
    +    +    -    +
    +    +    -    +
    +    +    -    +class ApiKeyBody(BaseModel):
    +    +    -    +    api_key: str
    +    +    -    +
    +    +    -    +
    +    +    -    +@router.put("/api-key")
    +    +    -    +async def save_api_key(
    +    +    -    +    body: ApiKeyBody,
    +    +    -    +    current_user: dict = Depends(get_current_user),
    +    +    -    +) -> dict:
    +    +    -    +    """Save the user's Anthropic API key for BYOK builds."""
    +    +    -    +    key = body.api_key.strip()
    +    +    -    +    if not key:
    +    +    -    +        raise HTTPException(status_code=400, detail="API key cannot be empty")
    +    +    -    +    await set_anthropic_api_key(current_user["id"], key)
    +    +    -    +    return {"saved": True}
    +    +    -    +
    +    +    -    +
    +    +    -    +@router.delete("/api-key")
    +    +    -    +async def remove_api_key(
    +    +    -    +    current_user: dict = Depends(get_current_user),
    +    +    -    +) -> dict:
    +    +    -    +    """Remove the user's stored Anthropic API key."""
    +    +    -    +    await set_anthropic_api_key(current_user["id"], None)
    +    +    -    +    return {"removed": True}
    +    +    -    diff --git a/app/api/routers/builds.py b/app/api/routers/builds.py
    +    +    -    index 9f0a5e0..6ef15b8 100644
    +    +    -    --- a/app/api/routers/builds.py
    +    +    -    +++ b/app/api/routers/builds.py
    +    +    -    @@ -92,6 +92,24 @@ async def get_build_logs(
    +    +    -             raise HTTPException(status_code=400, detail=detail)
    +    +    -     
    +    +    -     
    +    +    -    +# ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ GET /projects/{project_id}/build/phases ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -    +
    +    +    -    +
    +    +    -    +@router.get("/{project_id}/build/phases")
    +    +    -    +async def get_build_phases(
    +    +    -    +    project_id: UUID,
    +    +    -    +    user: dict = Depends(get_current_user),
    +    +    -    +):
    +    +    -    +    """Phase definitions parsed from the project's phases contract."""
    +    +    -    +    try:
    +    +    -    +        return await build_service.get_build_phases(project_id, user["id"])
    +    +    -    +    except ValueError as exc:
    +    +    -    +        detail = str(exc)
    +    +    -    +        if "not found" in detail.lower():
    +    +    -    +            raise HTTPException(status_code=404, detail=detail)
    +    +    -    +        raise HTTPException(status_code=400, detail=detail)
    +    +    -    +
    +    +    -    +
    +    +    -     # ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ GET /projects/{project_id}/build/summary ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -     
    +    +    -     
    +    +    -    diff --git a/app/api/routers/projects.py b/app/api/routers/projects.py
    +    +    -    index 0e72551..cc00763 100644
    +    +    -    --- a/app/api/routers/projects.py
    +    +    -    +++ b/app/api/routers/projects.py
    +    +    -    @@ -17,6 +17,7 @@ from app.services.project_service import (
    +    +    -         list_contracts,
    +    +    -         list_user_projects,
    +    +    -         process_questionnaire_message,
    +    +    -    +    reset_questionnaire,
    +    +    -         update_contract,
    +    +    -     )
    +    +    -     
    +    +    -    @@ -177,6 +178,20 @@ async def questionnaire_progress(
    +    +    -             )
    +    +    -     
    +    +    -     
    +    +    -    +@router.delete("/{project_id}/questionnaire")
    +    +    -    +async def questionnaire_reset(
    +    +    -    +    project_id: UUID,
    +    +    -    +    current_user: dict = Depends(get_current_user),
    +    +    -    +) -> dict:
    +    +    -    +    """Reset questionnaire to start over."""
    +    +    -    +    try:
    +    +    -    +        return await reset_questionnaire(current_user["id"], project_id)
    +    +    -    +    except ValueError as exc:
    +    +    -    +        raise HTTPException(
    +    +    -    +            status_code=status.HTTP_404_NOT_FOUND, detail=str(exc)
    +    +    -    +        )
    +    +    -    +
    +    +    -    +
    +    +    -     # ---------------------------------------------------------------------------
    +    +    -     # Contracts
    +    +    -     # ---------------------------------------------------------------------------
    +    +    -    diff --git a/app/clients/llm_client.py b/app/clients/llm_client.py
    +    +    -    index 60b0218..19622bd 100644
    +    +    -    --- a/app/clients/llm_client.py
    +    +    -    +++ b/app/clients/llm_client.py
    +    +    -    @@ -47,13 +47,20 @@ async def chat_anthropic(
    +    +    -                 raise ValueError(f"Anthropic API {response.status_code}: {err_msg}")
    +    +    -     
    +    +    -         data = response.json()
    +    +    -    +    usage = data.get("usage", {})
    +    +    -         content_blocks = data.get("content", [])
    +    +    -         if not content_blocks:
    +    +    -             raise ValueError("Empty response from Anthropic API")
    +    +    -     
    +    +    -         for block in content_blocks:
    +    +    -             if block.get("type") == "text":
    +    +    -    -            return block["text"]
    +    +    -    +            return {
    +    +    -    +                "text": block["text"],
    +    +    -    +                "usage": {
    +    +    -    +                    "input_tokens": usage.get("input_tokens", 0),
    +    +    -    +                    "output_tokens": usage.get("output_tokens", 0),
    +    +    -    +                },
    +    +    -    +            }
    +    +    -     
    +    +    -         raise ValueError("No text block in Anthropic API response")
    +    +    -     
    +    +    -    @@ -112,7 +119,14 @@ async def chat_openai(
    +    +    -         if not content:
    +    +    -             raise ValueError("No content in OpenAI API response")
    +    +    -     
    +    +    -    -    return content
    +    +    -    +    usage = data.get("usage", {})
    +    +    -    +    return {
    +    +    -    +        "text": content,
    +    +    -    +        "usage": {
    +    +    -    +            "input_tokens": usage.get("prompt_tokens", 0),
    +    +    -    +            "output_tokens": usage.get("completion_tokens", 0),
    +    +    -    +        },
    +    +    -    +    }
    +    +    -     
    +    +    -     
    +    +    -     # ---------------------------------------------------------------------------
    +    +    -    @@ -147,8 +161,8 @@ async def chat(
    +    +    -     
    +    +    -         Returns
    +    +    -         -------
    +    +    -    -    str
    +    +    -    -        The assistant's text reply.
    +    +    -    +    dict
    +    +    -    +        ``{"text": str, "usage": {"input_tokens": int, "output_tokens": int}}``
    +    +    -         """
    +    +    -         if provider == "openai":
    +    +    -             return await chat_openai(api_key, model, system_prompt, messages, max_tokens)
    +    +    -    diff --git a/app/config.py b/app/config.py
    +    +    -    index dcff943..0845923 100644
    +    +    -    --- a/app/config.py
    +    +    -    +++ b/app/config.py
    +    +    -    @@ -44,7 +44,7 @@ class Settings:
    +    +    -         FRONTEND_URL: str = os.getenv("FRONTEND_URL", "http://localhost:5173")
    +    +    -         APP_URL: str = os.getenv("APP_URL", "http://localhost:8000")
    +    +    -         LLM_QUESTIONNAIRE_MODEL: str = os.getenv(
    +    +    -    -        "LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022"
    +    +    -    +        "LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5"
    +    +    -         )
    +    +    -         ANTHROPIC_API_KEY: str = os.getenv("ANTHROPIC_API_KEY", "")
    +    +    -         OPENAI_API_KEY: str = os.getenv("OPENAI_API_KEY", "")
    +    +    -    diff --git a/app/repos/audit_repo.py b/app/repos/audit_repo.py
    +    +    -    index 2bc2568..f30784b 100644
    +    +    -    --- a/app/repos/audit_repo.py
    +    +    -    +++ b/app/repos/audit_repo.py
    +    +    -    @@ -63,6 +63,26 @@ async def update_audit_run(
    +    +    -         )
    +    +    -     
    +    +    -     
    +    +    -    +async def mark_stale_audit_runs(repo_id: UUID, stale_minutes: int = 5) -> int:
    +    +    -    +    """Mark audit runs stuck in 'pending' or 'running' for longer than
    +    +    -    +    *stale_minutes* as 'error'. Returns the number of rows updated."""
    +    +    -    +    pool = await get_pool()
    +    +    -    +    result = await pool.execute(
    +    +    -    +        """
    +    +    -    +        UPDATE audit_runs
    +    +    -    +        SET status = 'error', overall_result = 'ERROR',
    +    +    -    +            completed_at = now()
    +    +    -    +        WHERE repo_id = $1
    +    +    -    +          AND status IN ('pending', 'running')
    +    +    -    +          AND created_at < now() - ($2 || ' minutes')::interval
    +    +    -    +        """,
    +    +    -    +        repo_id,
    +    +    -    +        str(stale_minutes),
    +    +    -    +    )
    +    +    -    +    # asyncpg returns 'UPDATE N'
    +    +    -    +    return int(result.split()[-1])
    +    +    -    +
    +    +         +
    +    +    -     async def insert_audit_checks(
    +    +    -         audit_run_id: UUID,
    +    +    -         checks: list[dict],
    +    +    -    diff --git a/app/repos/user_repo.py b/app/repos/user_repo.py
    +    +    -    index f8a2386..689f7a9 100644
    +    +    -    --- a/app/repos/user_repo.py
    +    +    -    +++ b/app/repos/user_repo.py
    +    +    -    @@ -38,7 +38,17 @@ async def get_user_by_id(user_id: UUID) -> dict | None:
    +    +    -         """Fetch a user by primary key. Returns None if not found."""
    +    +    -         pool = await get_pool()
    +    +    -         row = await pool.fetchrow(
    +    +    -    -        "SELECT id, github_id, github_login, avatar_url, access_token, created_at, updated_at FROM users WHERE id = $1",
    +    +    -    +        "SELECT id, github_id, github_login, avatar_url, access_token, anthropic_api_key, created_at, updated_at FROM users WHERE id = $1",
    +    +    -             user_id,
    +    +    -         )
    +    +    -         return dict(row) if row else None
    +    +    +    +## Phase 12 -- Build Target & File Writing
    +         +    +
    +    -    +    +/* ------------------------------------------------------------------ */
    +    -    +    +/*  Types                                                             */
    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    +    +**Objective:** The builder actually writes files. Users choose a build target -- a new GitHub repo, an existing GitHub repo, or a local file path -- and the builder's output is parsed into discrete files and written to that target in real time. This replaces the current "stream text only" behaviour.
    +         +    +
    +    -    +    +interface TokenUsage {
    +    -    +    +  input_tokens: number;
    +    -    +    +  output_tokens: number;
    +    -    +    +}
    +    +    +    +**Background:** Currently the builder streams its entire output as raw text chunks. No files are created anywhere. The user's intention was always that builds produce real, usable code in a real repository or directory.
    +         +    +
    +    -    +    +type ContractStatus = 'pending' | 'generating' | 'done';
    +    +    +    +**Deliverables:**
    +         +    +
    +    -    +    +interface LogEntry {
    +    -    +    +  time: string;
    +    -    +    +  message: string;
    +    -    +    +}
    +    +    +    +- **Build target selection** (backend + frontend):
    +    +    +    +  - `build_target_type` enum: `github_new`, `github_existing`, `local_path`
    +    +    +    +  - `POST /projects/{id}/build` extended: accepts `target_type` and `target_ref` (repo name for new, repo full_name for existing, absolute path for local)
    +    +    +    +  - For `github_new`: call GitHub API to create an empty repo under the user's account, clone it locally to a temp working directory
    +    +    +    +  - For `github_existing`: clone the repo to a temp working directory (shallow clone, default branch)
    +    +    +    +  - For `local_path`: validate the path exists (or create it), use directly as the working directory
    +    +    +    +  - Store target info on the `builds` table: `target_type`, `target_ref`, `working_dir`
    +         +    +
    +    -    +    +interface Props {
    +    -    +    +  projectId: string;
    +    -    +    +  tokenUsage: TokenUsage;
    +    -    +    +  model: string;
    +    -    +    +  onComplete: () => void;
    +    -    +    +}
    +    +    +    +- **DB migration 008** -- `build_targets`:
    +    +    +    +  - Add columns to `builds`: `target_type VARCHAR(20)`, `target_ref TEXT`, `working_dir TEXT`
    +         +    +
    +    -    +    +/* ------------------------------------------------------------------ */
    +    -    +    +/*  Styles                                                            */
    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    +    +- **File parser in build_service.py**:
    +    +    +    +  - Builder directive updated to instruct the LLM to emit file blocks in a canonical format:
    +    +    +    +    ```
    +    +    +    +    === FILE: path/to/file.py ===
    +    +    +    +    ```python
    +    +    +    +    <file contents>
    +    +    +    +    ```
    +    +    +    +    === END FILE ===
    +    +    +    +    ```
    +    +    +    +  - `_parse_file_blocks(accumulated_text)` -- extracts file path + content from builder output
    +    +    +    +  - When a file block is detected:
    +    +    +    +    1. Write the file to the working directory on disk
    +    +    +    +    2. Emit `file_created` WS event with `{ path, size_bytes, language }`
    +    +    +    +    3. Log the file write to build_logs
    +    +    +    +  - Handle file updates (same path written twice = overwrite with latest)
    +         +    +
    +    -    +    +const panelStyle: React.CSSProperties = {
    +    -    +    +  display: 'flex',
    +    -    +    +  flexDirection: 'column',
    +    -    +    +  gap: '12px',
    +    -    +    +  padding: '16px 20px',
    +    -    +    +  flex: 1,
    +    -    +    +  overflowY: 'auto',
    +    -    +    +};
    +    +    +    +- **Git operations** (for GitHub targets):
    +    +    +    +  - After each phase completes audit, stage + commit all new/modified files with message `"forge: Phase N complete"`
    +    +    +    +  - After build completes, push all commits to the remote
    +    +    +    +  - `app/clients/git_client.py` -- thin wrapper around `asyncio.subprocess` for git clone, add, commit, push (no heavy git library dependency)
    +         +    +
    +    -    +    +const stepRowStyle: React.CSSProperties = {
    +    -    +    +  display: 'flex',
    +    -    +    +  alignItems: 'center',
    +    -    +    +  gap: '10px',
    +    -    +    +  fontSize: '0.82rem',
    +    -    +    +  padding: '6px 0',
    +    -    +    +  borderBottom: '1px solid #1E293B',
    +    -    +    +};
    +    +    +    +- **Frontend: Build target picker** (shown before build starts):
    +    +    +    +  - Three-option card selector: "New GitHub Repo" / "Existing GitHub Repo" / "Local Directory"
    +    +    +    +  - For new repo: text input for repo name (validated against GitHub naming rules)
    +    +    +    +  - For existing repo: repo picker modal (reuse existing component)
    +    +    +    +  - For local: text input for absolute path with validation
    +    +    +    +  - Selected target stored in build state and sent with `POST /projects/{id}/build`
    +         +    +
    +    -    +    +const logPanelStyle: React.CSSProperties = {
    +    -    +    +  background: '#0F172A',
    +    -    +    +  borderRadius: '6px',
    +    -    +    +  padding: '10px 12px',
    +    -    +    +  fontFamily: 'monospace',
    +    -    +    +  fontSize: '0.72rem',
    +    -    +    +  color: '#94A3B8',
    +    -    +    +  maxHeight: '120px',
    +    -    +    +  overflowY: 'auto',
    +    -    +    +  lineHeight: '1.6',
    +    -    +    +};
    +    +    +    +- **Frontend: File tree panel** on BuildProgress page:
    +    +    +    +  - New collapsible panel (left column, below phase checklist) showing files created so far
    +    +    +    +  - Tree structure mirroring directory hierarchy
    +    +    +    +  - Each file shows: path, size, language icon
    +    +    +    +  - Updates in real-time via `file_created` WS events
    +    +    +    +  - Click a file to expand and see a syntax-highlighted preview of its content (read from build logs or a dedicated endpoint)
    +         +    +
    +    -    +    +const meterBarOuter: React.CSSProperties = {
    +    -    +    +  flex: 1,
    +    -    +    +  height: '8px',
    +    -    +    +  background: '#1E293B',
    +    -    +    +  borderRadius: '4px',
    +    -    +    +  overflow: 'hidden',
    +    -    +    +};
    +    +    +    +- **API for file retrieval**:
    +    +    +    +  - `GET /projects/{id}/build/files` -- list all files written during the build
    +    +    +    +  - `GET /projects/{id}/build/files/{path}` -- retrieve content of a specific file
    +         +    +
    +    -    +    +/* ------------------------------------------------------------------ */
    +    -    +    +/*  Component                                                         */
    +    -    +    +/* ------------------------------------------------------------------ */
    +    +    +    +**Schema coverage:**
    +    +    +    +- [x] builds (extended with target columns)
    +    +    +    +- [x] build_logs (Phase 9)
    +    +    +    +- [ ] No new tables -- file metadata derived from build_logs + filesystem
    +         +    +
    +    -    +    +export default function ContractProgress({ projectId, tokenUsage, model, onComplete }: Props) {
    +    -    +    +  const { token } = useAuth();
    +    -    +    +  const [statuses, setStatuses] = useState<Record<string, ContractStatus>>(() =>
    +    -    +    +    Object.fromEntries(ALL_CONTRACTS.map((c) => [c, 'pending' as const])),
    +    -    +    +  );
    +    -    +    +  const [log, setLog] = useState<LogEntry[]>([]);
    +    -    +    +  const [generating, setGenerating] = useState(false);
    +    -    +    +  const [allDone, setAllDone] = useState(false);
    +    -    +    +  const logEndRef = useRef<HTMLDivElement>(null);
    +    -    +    +  const startedRef = useRef(false);
    +    -    +    +
    +    -    +    +  const addLog = useCallback((msg: string) => {
    +    -    +    +    const now = new Date();
    +    -    +    +    const time = now.toLocaleTimeString('en-GB', { hour12: false });
    +    -    +    +    setLog((prev) => [...prev, { time, message: msg }]);
    +    -    +    +  }, []);
    +    -    +    +
    +    -    +    +  /* Auto-scroll log */
    +    -    +    +  useEffect(() => {
    +    -    +    +    logEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    +    -    +    +  }, [log]);
    +    -    +    +
    +    -    +    +  /* Handle WS progress messages */
    +    -    +    +  useWebSocket(
    +    -    +    +    useCallback(
    +    -    +    +      (data: { type: string; payload: any }) => {
    +    -    +    +        if (data.type !== 'contract_progress') return;
    +    -    +    +        const p = data.payload;
    +    -    +    +        if (p.project_id !== projectId) return;
    +    -    +    +
    +    -    +    +        const label = CONTRACT_LABELS[p.contract_type] ?? p.contract_type;
    +    -    +    +        if (p.status === 'generating') {
    +    -    +    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'generating' }));
    +    -    +    +          addLog(`Generating ${label}...`);
    +    -    +    +        } else if (p.status === 'done') {
    +    -    +    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'done' }));
    +    -    +    +          addLog(`├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├Â├▒ ${label} complete`);
    +    -    +    +
    +    -    +    +          /* Check if all done */
    +    -    +    +          setStatuses((prev) => {
    +    -    +    +            const values = Object.values(prev);
    +    -    +    +            if (values.every((s) => s === 'done')) {
    +    -    +    +              setAllDone(true);
    +    -    +    +              addLog('All contracts generated successfully.');
    +    -    +    +            }
    +    -    +    +            return prev;
    +    -    +    +          });
    +    -    +    +        }
    +    -    +    +      },
    +    -    +    +      [projectId, addLog],
    +    -    +    +    ),
    +    -    +    +  );
    +    -    +    +
    +    -    +    +  /* Kick off generation on mount */
    +    -    +    +  useEffect(() => {
    +    -    +    +    if (startedRef.current) return;
    +    -    +    +    startedRef.current = true;
    +    -    +    +    setGenerating(true);
    +    -    +    +    addLog('Starting contract generation...');
    +    -    +    +
    +    -    +    +    fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    -    +    +      method: 'POST',
    +    -    +    +      headers: { Authorization: `Bearer ${token}` },
    +    -    +    +    })
    +    -    +    +      .then((res) => {
    +    -    +    +        if (!res.ok) throw new Error('Generation failed');
    +    -    +    +        /* Mark any remaining as done (safety net) */
    +    -    +    +        setStatuses((prev) => {
    +    -    +    +          const updated = { ...prev };
    +    -    +    +          for (const key of ALL_CONTRACTS) {
    +    -    +    +            if (updated[key] !== 'done') updated[key] = 'done';
    +    -    +    +          }
    +    -    +    +          return updated;
    +    -    +    +        });
    +    -    +    +        setAllDone(true);
    +    -    +    +        setGenerating(false);
    +    -    +    +      })
    +    -    +    +      .catch(() => {
    +    -    +    +        addLog('├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├▓├║ Contract generation failed');
    +    -    +    +        setGenerating(false);
    +    -    +    +      });
    +    -    +    +  }, [projectId, token, addLog]);
    +    -    +    +
    +    -    +    +  /* Derived values */
    +    -    +    +  const contextWindow = MODEL_CONTEXT_WINDOWS[model] ?? DEFAULT_CONTEXT_WINDOW;
    +    -    +    +  const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    -    +    +  const ctxPercent = Math.min(100, (totalTokens / contextWindow) * 100);
    +    -    +    +  const doneCount = Object.values(statuses).filter((s) => s === 'done').length;
    +    -    +    +
    +    -    +    +  /* Color for context bar */
    +    -    +    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    +    +    +    +**Exit criteria:**
    +    +    +    +- User can select "New GitHub Repo" and the build creates the repo + writes files into it
    +    +    +    +- User can select "Existing GitHub Repo" and the build writes files into the cloned repo
    +    +    +    +- User can select "Local Directory" and files are written to that path
    +    +    +    +- Files appear in the file tree panel in real-time as the builder creates them
    +    +    +    +- After each phase audit pass, files are committed with a phase-specific message
    +    +    +    +- After build completion (GitHub targets), all commits are pushed to the remote
    +    +    +    +- File content is retrievable via API
    +    +    +    +- All existing tests still pass + new tests for file parsing, git operations, and target selection
    +    +    +    +- `run_audit.ps1` passes all checks
    +    +         +
    +    +    +    +---
    +    +         +
    +    +    -    +async def set_anthropic_api_key(user_id: UUID, api_key: str | None) -> None:
    +    +    -    +    """Store (or clear) the user's Anthropic API key."""
    +    +    -    +    pool = await get_pool()
    +    +    -    +    await pool.execute(
    +    +    -    +        "UPDATE users SET anthropic_api_key = $2, updated_at = now() WHERE id = $1",
    +    +    -    +        user_id,
    +    +    -    +        api_key,
    +    +    -    +    )
    +    +    -    diff --git a/app/services/audit_service.py b/app/services/audit_service.py
    +    +    -    index ab835fe..1bf0d18 100644
    +    +    -    --- a/app/services/audit_service.py
    +    +    -    +++ b/app/services/audit_service.py
    +    +    -    @@ -1,5 +1,6 @@
    +    +    -     """Audit service -- orchestrates audit execution triggered by webhooks."""
    +    +    -     
    +    +    -    +import asyncio
    +    +    -     import json
    +    +    -     import logging
    +    +    -     import os
    +    +    -    @@ -12,6 +13,7 @@ from app.repos.audit_repo import (
    +    +    -         create_audit_run,
    +    +    -         get_existing_commit_shas,
    +    +    -         insert_audit_checks,
    +    +    -    +    mark_stale_audit_runs,
    +    +    -         update_audit_run,
    +    +    -     )
    +    +    -     from app.repos.repo_repo import get_repo_by_github_id, get_repo_by_id
    +    +    -    @@ -288,6 +290,11 @@ async def backfill_repo_commits(
    +    +    -         full_name = repo["full_name"]
    +    +    -         branch = repo.get("default_branch", "main")
    +    +    -     
    +    +    -    +    # Clean up any audit runs left stuck from a prior interrupted sync
    +    +    -    +    cleaned = await mark_stale_audit_runs(repo_id)
    +    +    -    +    if cleaned:
    +    +    -    +        logger.info("Cleaned %d stale audit runs for repo %s", cleaned, repo_id)
    +    +    -    +
    +    +    -         # Find the latest audit we already have so we only pull newer commits
    +    +    -         existing_shas = await get_existing_commit_shas(repo_id)
    +    +    -     
    +    +    -    @@ -365,6 +372,16 @@ async def backfill_repo_commits(
    +    +    -                 )
    +    +    -                 synced += 1
    +    +    -     
    +    +    -    +        except asyncio.CancelledError:
    +    +    -    +            logger.warning("Backfill cancelled for commit %s", sha)
    +    +    -    +            await update_audit_run(
    +    +    -    +                audit_run_id=audit_run["id"],
    +    +    -    +                status="error",
    +    +    -    +                overall_result="ERROR",
    +    +    -    +                files_checked=0,
    +    +    -    +            )
    +    +    -    +            raise  # re-raise so the request terminates properly
    +    +    -    +
    +    +    -             except Exception:
    +    +    -                 logger.exception("Backfill failed for commit %s", sha)
    +    +    -                 await update_audit_run(
    +    +    -    diff --git a/app/services/build_service.py b/app/services/build_service.py
    +    +    -    index e98f439..56edbd8 100644
    +    +    -    --- a/app/services/build_service.py
    +    +    -    +++ b/app/services/build_service.py
    +    +    -    @@ -17,6 +17,7 @@ from app.clients.agent_client import StreamUsage, stream_agent
    +    +    -     from app.config import settings
    +    +    -     from app.repos import build_repo
    +    +    -     from app.repos import project_repo
    +    +    -    +from app.repos.user_repo import get_user_by_id
    +    +    -     from app.ws_manager import manager
    +    +    -     
    +    +    -     # Maximum consecutive loopback failures before stopping
    +    +    -    @@ -31,9 +32,25 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
    +    +    -     # Active build tasks keyed by build_id
    +    +    -     _active_tasks: dict[str, asyncio.Task] = {}
    +    +    -     
    +    +    -    -# Cost-per-token estimates (USD) -- updated as pricing changes
    +    +    -    -_COST_PER_INPUT_TOKEN: Decimal = Decimal("0.000015")   # $15 / 1M input tokens
    +    +    -    -_COST_PER_OUTPUT_TOKEN: Decimal = Decimal("0.000075")  # $75 / 1M output tokens
    +    +    -    +# Cost-per-token estimates (USD) keyed by model prefix -- updated as pricing changes
    +    +    -    +_MODEL_PRICING: dict[str, tuple[Decimal, Decimal]] = {
    +    +    -    +    # (input $/token, output $/token)
    +    +    -    +    "claude-opus-4":       (Decimal("0.000015"),  Decimal("0.000075")),   # $15 / $75 per 1M
    +    +    -    +    "claude-sonnet-4":     (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    +    +    -    +    "claude-haiku-4":      (Decimal("0.000001"),  Decimal("0.000005")),   # $1 / $5 per 1M
    +    +    -    +    "claude-3-5-sonnet":   (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    +    +    -    +}
    +    +    -    +# Fallback: Opus pricing (most expensive = safest default)
    +    +    -    +_DEFAULT_INPUT_RATE = Decimal("0.000015")
    +    +    -    +_DEFAULT_OUTPUT_RATE = Decimal("0.000075")
    +    +    -    +
    +    +    -    +
    +    +    -    +def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
    +    +    -    +    """Return (input_rate, output_rate) per token for the given model."""
    +    +    -    +    for prefix, rates in _MODEL_PRICING.items():
    +    +    -    +        if model.startswith(prefix):
    +    +    -    +            return rates
    +    +    -    +    return (_DEFAULT_INPUT_RATE, _DEFAULT_OUTPUT_RATE)
    +    +    -     
    +    +    -     
    +    +    -     # ---------------------------------------------------------------------------
    +    +    -    @@ -72,6 +89,14 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    +    -         if latest and latest["status"] in ("pending", "running"):
    +    +    -             raise ValueError("A build is already in progress for this project")
    +    +    -     
    +    +    -    +    # BYOK: user must supply their own Anthropic API key for builds
    +    +    -    +    user = await get_user_by_id(user_id)
    +    +    -    +    user_api_key = (user or {}).get("anthropic_api_key") or ""
    +    +    -    +    if not user_api_key.strip():
    +    +    -    +        raise ValueError(
    +    +    -    +            "Anthropic API key required. Add your key in Settings to start a build."
    +    +    -    +        )
    +    +    -    +
    +    +    -         # Create build record
    +    +    -         build = await build_repo.create_build(project_id)
    +    +    -     
    +    +    -    @@ -80,7 +105,7 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    +    -     
    +    +    -         # Spawn background task
    +    +    -         task = asyncio.create_task(
    +    +    -    -        _run_build(build["id"], project_id, user_id, contracts)
    +    +    -    +        _run_build(build["id"], project_id, user_id, contracts, user_api_key)
    +    +    -         )
    +    +    -         _active_tasks[str(build["id"])] = task
    +    +    -     
    +    +    -    @@ -196,6 +221,7 @@ async def _run_build(
    +    +    -         project_id: UUID,
    +    +    -         user_id: UUID,
    +    +    -         contracts: list[dict],
    +    +    -    +    api_key: str,
    +    +    -     ) -> None:
    +    +    -         """Background task that orchestrates the full build lifecycle.
    +    +    -     
    +    +    -    @@ -232,7 +258,7 @@ async def _run_build(
    +    +    -     
    +    +    -             # Stream agent output
    +    +    -             async for chunk in stream_agent(
    +    +    -    -            api_key=settings.ANTHROPIC_API_KEY,
    +    +    -    +            api_key=api_key,
    +    +    -                 model=settings.LLM_BUILDER_MODEL,
    +    +    -                 system_prompt="You are an autonomous software builder operating under the Forge governance framework.",
    +    +    -                 messages=messages,
    +    +    -    @@ -270,10 +296,16 @@ async def _run_build(
    +    +    -                         source="system",
    +    +    -                         level="info",
    +    +    -                     )
    +    +    -    +                # Capture token usage BEFORE recording (which resets)
    +    +    -    +                phase_input_tokens = usage.input_tokens
    +    +    -    +                phase_output_tokens = usage.output_tokens
    +    +    -    +
    +    +    -                     await _broadcast_build_event(
    +    +    -                         user_id, build_id, "phase_complete", {
    +    +    -                             "phase": current_phase,
    +    +    -                             "status": "pass",
    +    +    -    +                        "input_tokens": phase_input_tokens,
    +    +    -    +                        "output_tokens": phase_output_tokens,
    +    +    -                         }
    +    +    -                     )
    +    +    -     
    +    +    -    @@ -337,9 +369,15 @@ async def _run_build(
    +    +    -             await build_repo.append_build_log(
    +    +    -                 build_id, "Build completed successfully", source="system", level="info"
    +    +    -             )
    +    +    -    +
    +    +    -    +        # Gather total cost summary for the final event
    +    +    -    +        cost_summary = await build_repo.get_build_cost_summary(build_id)
    +    +    -             await _broadcast_build_event(user_id, build_id, "build_complete", {
    +    +    -                 "id": str(build_id),
    +    +    -                 "status": "completed",
    +    +    -    +            "total_input_tokens": cost_summary["total_input_tokens"],
    +    +    -    +            "total_output_tokens": cost_summary["total_output_tokens"],
    +    +    -    +            "total_cost_usd": float(cost_summary["total_cost_usd"]),
    +    +    -             })
    +    +    -     
    +    +    -         except asyncio.CancelledError:
    +    +    -    @@ -446,8 +484,9 @@ async def _record_phase_cost(
    +    +    -         input_t = usage.input_tokens
    +    +    -         output_t = usage.output_tokens
    +    +    -         model = usage.model or settings.LLM_BUILDER_MODEL
    +    +    -    -    cost = (Decimal(input_t) * _COST_PER_INPUT_TOKEN
    +    +    -    -            + Decimal(output_t) * _COST_PER_OUTPUT_TOKEN)
    +    +    -    +    input_rate, output_rate = _get_token_rates(model)
    +    +    -    +    cost = (Decimal(input_t) * input_rate
    +    +    -    +            + Decimal(output_t) * output_rate)
    +    +    -         await build_repo.record_build_cost(
    +    +    -             build_id, phase, input_t, output_t, model, cost
    +    +    -         )
    +    +    -    @@ -538,6 +577,77 @@ async def get_build_instructions(project_id: UUID, user_id: UUID) -> dict:
    +    +    -         }
    +    +    -     
    +    +    -     
    +    +    -    +async def get_build_phases(project_id: UUID, user_id: UUID) -> list[dict]:
    +    +    -    +    """Parse the phases contract into a structured list of phase definitions.
    +    +    -    +
    +    +    -    +    Each entry contains: number, name, objective, deliverables (list of strings).
    +    +    -    +
    +    +    -    +    Raises:
    +    +    -    +        ValueError: If project not found, not owned, or no phases contract.
    +    +    -    +    """
    +    +    -    +    project = await project_repo.get_project_by_id(project_id)
    +    +    -    +    if not project or str(project["user_id"]) != str(user_id):
    +    +    -    +        raise ValueError("Project not found")
    +    +    -    +
    +    +    -    +    phases_contract = await project_repo.get_contract_by_type(project_id, "phases")
    +    +    -    +    if not phases_contract:
    +    +    -    +        raise ValueError("No phases contract found")
    +    +    -    +
    +    +    -    +    return _parse_phases_contract(phases_contract["content"])
    +    +    -    +
    +    +    -    +
    +    +    -    +def _parse_phases_contract(content: str) -> list[dict]:
    +    +    -    +    """Parse a phases contract markdown into structured phase definitions.
    +    +    -    +
    +    +    -    +    Expects sections like:
    +    +    -    +        ## Phase 0 -- Genesis
    +    +    -    +        **Objective:** ...
    +    +    -    +        **Deliverables:**
    +    +    -    +        - item 1
    +    +    -    +        - item 2
    +    +    -    +    """
    +    +    -    +    phases: list[dict] = []
    +    +    -    +    # Split on ## Phase headers
    +    +    -    +    phase_blocks = re.split(r"(?=^## Phase )", content, flags=re.MULTILINE)
    +    +    -    +
    +    +    -    +    for block in phase_blocks:
    +    +    -    +        # Match "## Phase N -- Name" or "## Phase N ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Name"
    +    +    -    +        header = re.match(
    +    +    -    +            r"^## Phase\s+(\d+)\s*[-├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├▒]+\s*(.+?)\s*$", block, re.MULTILINE
    +    +    -    +        )
    +    +    -    +        if not header:
    +    +    -    +            continue
    +    +    -    +
    +    +    -    +        phase_num = int(header.group(1))
    +    +    -    +        phase_name = header.group(2).strip()
    +    +    -    +
    +    +    -    +        # Extract objective
    +    +    -    +        obj_match = re.search(
    +    +    -    +            r"\*\*Objective:\*\*\s*(.+?)(?=\n\n|\n\*\*|$)", block, re.DOTALL
    +    +    -    +        )
    +    +    -    +        objective = obj_match.group(1).strip() if obj_match else ""
    +    +    -    +
    +    +    -    +        # Extract deliverables (bullet list after **Deliverables:**)
    +    +    -    +        deliverables: list[str] = []
    +    +    -    +        deliv_match = re.search(
    +    +    -    +            r"\*\*Deliverables:\*\*\s*\n((?:[-*]\s+.+\n?)+)", block
    +    +    -    +        )
    +    +    -    +        if deliv_match:
    +    +    -    +            for line in deliv_match.group(1).strip().splitlines():
    +    +    -    +                item = re.sub(r"^[-*]\s+", "", line).strip()
    +    +    -    +                if item:
    +    +    -    +                    deliverables.append(item)
    +    +    -    +
    +    +    -    +        phases.append({
    +    +    -    +            "number": phase_num,
    +    +    -    +            "name": phase_name,
    +    +    -    +            "objective": objective,
    +    +    -    +            "deliverables": deliverables,
    +    +    -    +        })
    +    +    -    +
    +    +    -    +    return phases
    +    +    -    +
    +    +    -    +
    +    +    -     def _generate_deploy_instructions(
    +    +    -         project_name: str, stack_content: str, blueprint_content: str
    +    +    -     ) -> str:
    +    +    -    diff --git a/app/services/project_service.py b/app/services/project_service.py
    +    +    -    index 46ab7de..6994dd6 100644
    +    +    -    --- a/app/services/project_service.py
    +    +    -    +++ b/app/services/project_service.py
    +    +    -    @@ -7,6 +7,7 @@ from uuid import UUID
    +    +    -     
    +    +    -     from app.clients.llm_client import chat as llm_chat
    +    +    -     from app.config import settings
    +    +    -    +from app.ws_manager import manager
    +    +    -     from app.repos.project_repo import (
    +    +    -         create_project as repo_create_project,
    +    +    -         delete_project as repo_delete_project,
    +    +    -    @@ -34,7 +35,6 @@ QUESTIONNAIRE_SECTIONS = [
    +    +    -         "ui_requirements",
    +    +    -         "architectural_boundaries",
    +    +    -         "deployment_target",
    +    +    -    -    "phase_breakdown",
    +    +    -     ]
    +    +    -     
    +    +    -     CONTRACT_TYPES = [
    +    +    -    @@ -46,11 +46,11 @@ CONTRACT_TYPES = [
    +    +    -         "boundaries",
    +    +    -         "phases",
    +    +    -         "ui",
    +    +    -    -    "builder_contract",
    +    +    -         "builder_directive",
    +    +    -     ]
    +    +    -     
    +    +    -     TEMPLATES_DIR = Path(__file__).resolve().parent.parent / "templates" / "contracts"
    +    +    -    +FORGE_CONTRACTS_DIR = Path(__file__).resolve().parent.parent.parent / "Forge" / "Contracts"
    +    +    -     
    +    +    -     _SYSTEM_PROMPT = """\
    +    +    -     You are a project intake specialist for Forge, an autonomous build system.
    +    +    -    @@ -65,31 +65,28 @@ The questionnaire has these sections (in order):
    +    +    -     5. ui_requirements ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Pages, components, design system, responsive needs
    +    +    -     6. architectural_boundaries ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Layer rules, forbidden imports, separation concerns
    +    +    -     7. deployment_target ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Where it runs, CI/CD, infrastructure
    +    +    -    -8. phase_breakdown ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Implementation phases with deliverables and exit criteria
    +    +    -    +
    +    +    -    +NOTE: Do NOT ask the user about implementation phases. Phases are auto-derived
    +    +    -    +architecturally during contract generation based on all gathered information.
    +    +    -     
    +    +    -     CRITICAL RULES:
    +    +    -    -- Ask AT MOST 2-3 focused questions per section, then COMPLETE IT.
    +    +    -    -- Do NOT over-ask. If the user gives a reasonable answer, mark the section
    +    +    -    -  complete and move on. You can infer sensible defaults for anything unclear.
    +    +    -    -- One section at a time. After completing one, immediately ask about the next.
    +    +    -    -- If the user's single answer covers multiple sections, mark ALL covered
    +    +    -    -  sections as complete in one response.
    +    +    -    +- Ask AT MOST 1-2 focused questions per section, then set section_complete=true.
    +    +    -    +- After the user answers, ALWAYS set section_complete to true and move on.
    +    +    -    +  Do NOT ask follow-ups within the same section. One answer per section is enough.
    +    +    -    +- Infer sensible defaults for anything unclear ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® DO NOT ask for clarification.
    +    +    -    +- ALWAYS include extracted_data with at least a summary of what you captured.
    +    +    -     - Your response MUST be ONLY valid JSON ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® no markdown fences, no extra text:
    +    +    -       {
    +    +    -    -    "reply": "<your conversational message to the user>",
    +    +    -    -    "section": "<current section name>",
    +    +    -    +    "reply": "<your message ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® summarise what you captured, then ask about the NEXT section>",
    +    +    -    +    "section": "<the section you just completed or are asking about>",
    +    +    -         "section_complete": true|false,
    +    +    -         "extracted_data": { <key-value pairs of captured information> }
    +    +    -       }
    +    +    -    -- When section_complete is true, extracted_data MUST contain the collected data.
    +    +    -    -- When section_complete is false, extracted_data should be {} or partial data.
    +    +    -    -- ALWAYS set section_complete to true after AT MOST 2 exchanges per section.
    +    +    -    -  Don't let any section drag on ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® keep momentum. The user sees a progress bar;
    +    +    -    -  it must visibly advance.
    +    +    -    -- Be conversational but FAST. Prefer completing a section and moving on over
    +    +    -    -  asking the perfect follow-up question.
    +    +    -    -- When all sections are done, set section to "complete" and section_complete
    +    +    -    -  to true.
    +    +    -    +- When section_complete is true, extracted_data MUST contain the captured data.
    +    +    -    +  extracted_data must NEVER be empty or null when section_complete is true.
    +    +    -    +- The user sees a progress bar. Every response MUST advance it. If the user
    +    +    -    +  answered your question, section_complete MUST be true.
    +    +    -    +- When all 7 sections are done, set section to "complete".
    +    +    -     """
    +    +    -     
    +    +    -     
    +    +    -    @@ -202,7 +199,10 @@ async def process_questionnaire_message(
    +    +    -             f"Project description: {project.get('description', 'N/A')}\n"
    +    +    -             f"Current section: {current_section}\n"
    +    +    -             f"Completed sections: {', '.join(completed) if completed else 'none'}\n"
    +    +    -    -        f"Previously collected data: {json.dumps(answers, indent=2)}"
    +    +    -    +        f"Previously collected data: {json.dumps(answers, indent=2)}\n"
    +    +    -    +        f"IMPORTANT: The user has been on '{current_section}' for "
    +    +    -    +        f"{sum(1 for m in history if m['role'] == 'user' and m.get('section') == current_section)} "
    +    +    -    +        f"messages already. Set section_complete=true NOW and move to the next section."
    +    +    -         )
    +    +    -     
    +    +    -         # Anthropic requires strictly alternating user/assistant roles.
    +    +    -    @@ -244,7 +244,7 @@ async def process_questionnaire_message(
    +    +    -         )
    +    +    -     
    +    +    -         try:
    +    +    -    -        raw_reply = await llm_chat(
    +    +    -    +        llm_result = await llm_chat(
    +    +    -                 api_key=llm_api_key,
    +    +    -                 model=llm_model,
    +    +    -                 system_prompt=dynamic_system,
    +    +    -    @@ -255,6 +255,8 @@ async def process_questionnaire_message(
    +    +    -             logger.exception("LLM chat failed for project %s", project_id)
    +    +    -             raise ValueError(f"LLM service error: {exc}") from exc
    +    +    -     
    +    +    -    +    raw_reply = llm_result["text"]
    +    +    -    +    usage = llm_result.get("usage", {})
    +    +    -         logger.info("LLM raw response (first 500 chars): %s", raw_reply[:500])
    +    +    -     
    +    +    -         # Parse the structured JSON response from the LLM
    +    +    -    @@ -263,19 +265,73 @@ async def process_questionnaire_message(
    +    +    -                     parsed.get("section_complete"), parsed.get("section"))
    +    +    -     
    +    +    -         # Update state based on LLM response
    +    +    -    -    history.append({"role": "user", "content": message})
    +    +    -    -    history.append({"role": "assistant", "content": parsed["reply"]})
    +    +    -    -
    +    +    -    -    if parsed.get("section_complete") and parsed.get("extracted_data"):
    +    +    -    -        section_name = parsed.get("section", current_section)
    +    +    -    -        answers[section_name] = parsed["extracted_data"]
    +    +    -    +    history.append({"role": "user", "content": message, "section": current_section})
    +    +    -    +
    +    +    -    +    # --- Section-completion logic (3 independent triggers) ---
    +    +    -    +    llm_section = parsed.get("section") or current_section
    +    +    -    +    llm_says_complete = bool(parsed.get("section_complete"))
    +    +    -    +    extracted = parsed.get("extracted_data")
    +    +    -    +
    +    +    -    +    # Trigger 1: LLM explicitly says section_complete=true
    +    +    -    +    if llm_says_complete:
    +    +    -    +        section_name = llm_section if llm_section in QUESTIONNAIRE_SECTIONS else current_section
    +    +    -    +        if extracted and isinstance(extracted, dict):
    +    +    -    +            answers[section_name] = extracted
    +    +    -    +        elif section_name not in answers:
    +    +    -    +            answers[section_name] = {"auto": "completed by LLM"}
    +    +    -             if section_name not in completed:
    +    +    -                 completed.append(section_name)
    +    +    -    +        logger.info("Section completed (LLM explicit): %s", section_name)
    +    +    -    +
    +    +    -    +    # Trigger 2: LLM jumped ahead ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® mentions a later section, implying
    +    +    -    +    #            the current one is done.  Complete all sections up to
    +    +    -    +    #            (but not including) the one the LLM is now asking about.
    +    +    -    +    if llm_section in QUESTIONNAIRE_SECTIONS and llm_section != current_section:
    +    +    -    +        llm_idx = QUESTIONNAIRE_SECTIONS.index(llm_section)
    +    +    -    +        cur_idx = QUESTIONNAIRE_SECTIONS.index(current_section)
    +    +    -    +        if llm_idx > cur_idx:
    +    +    -    +            for i in range(cur_idx, llm_idx):
    +    +    -    +                s = QUESTIONNAIRE_SECTIONS[i]
    +    +    -    +                if s not in completed:
    +    +    -    +                    completed.append(s)
    +    +    -    +                    if s not in answers:
    +    +    -    +                        answers[s] = {"auto": "inferred from conversation"}
    +    +    -    +                    logger.info("Section auto-completed (LLM jumped ahead): %s", s)
    +    +    -    +
    +    +    -    +    # Trigger 3: Exchange-count safety net ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® if we've had >= 3 user
    +    +    -    +    #            messages in the same section, force-complete it so
    +    +    -    +    #            the user always sees progress.
    +    +    -    +    section_user_msgs = sum(
    +    +    -    +        1 for m in history if m["role"] == "user" and m.get("section") == current_section
    +    +    -    +    )
    +    +    -    +    if section_user_msgs >= 3 and current_section not in completed:
    +    +    -    +        completed.append(current_section)
    +    +    -    +        if current_section not in answers:
    +    +    -    +            answers[current_section] = {"auto": "force-completed after 3 exchanges"}
    +    +    -    +        logger.info("Section force-completed (3 exchanges): %s", current_section)
    +    +    -    +
    +    +    -    +    # Determine the next section for tagging the assistant reply
    +    +    -    +    next_section = None
    +    +    -    +    for s in QUESTIONNAIRE_SECTIONS:
    +    +    -    +        if s not in completed:
    +    +    -    +            next_section = s
    +    +    -    +            break
    +    +    -    +    reply_section = next_section or current_section
    +    +    -    +
    +    +    -    +    history.append({"role": "assistant", "content": parsed["reply"], "section": reply_section})
    +    +    -    +
    +    +    -    +    # Accumulate token usage
    +    +    -    +    prev_usage = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    +    +    -    +    total_usage = {
    +    +    -    +        "input_tokens": prev_usage.get("input_tokens", 0) + usage.get("input_tokens", 0),
    +    +    -    +        "output_tokens": prev_usage.get("output_tokens", 0) + usage.get("output_tokens", 0),
    +    +    -    +    }
    +    +    -     
    +    +    -         new_state = {
    +    +    -             "completed_sections": completed,
    +    +    -             "answers": answers,
    +    +    -             "conversation_history": history,
    +    +    -    +        "token_usage": total_usage,
    +    +    -         }
    +    +    -         await update_questionnaire_state(project_id, new_state)
    +    +    -     
    +    +    -    @@ -292,6 +348,7 @@ async def process_questionnaire_message(
    +    +    -             "completed_sections": completed,
    +    +    -             "remaining_sections": remaining,
    +    +    -             "is_complete": is_complete,
    +    +    -    +        "token_usage": total_usage,
    +    +    -         }
    +    +    -     
    +    +    -     
    +    +    -    @@ -309,9 +366,26 @@ async def get_questionnaire_state(
    +    +    -         qs = project.get("questionnaire_state") or {}
    +    +    -         progress = _questionnaire_progress(qs)
    +    +    -         progress["conversation_history"] = qs.get("conversation_history", [])
    +    +    -    +    progress["token_usage"] = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    +    +    -         return progress
    +    +    -     
    +    +    -     
    +    +    -    +async def reset_questionnaire(
    +    +    -    +    user_id: UUID,
    +    +    -    +    project_id: UUID,
    +    +    -    +) -> dict:
    +    +    -    +    """Clear all questionnaire state and reset the project to draft."""
    +    +    -    +    project = await get_project_by_id(project_id)
    +    +    -    +    if not project:
    +    +    -    +        raise ValueError("Project not found")
    +    +    -    +    if str(project["user_id"]) != str(user_id):
    +    +    -    +        raise ValueError("Project not found")
    +    +    -    +
    +    +    -    +    await update_questionnaire_state(project_id, {})
    +    +    -    +    await update_project_status(project_id, "draft")
    +    +    -    +    return {"status": "reset"}
    +    +    -    +
    +    +    -    +
    +    +    -     # ---------------------------------------------------------------------------
    +    +    -     # Contract generation
    +    +    -     # ---------------------------------------------------------------------------
    +    +    -    @@ -321,8 +395,10 @@ async def generate_contracts(
    +    +    -         user_id: UUID,
    +    +    -         project_id: UUID,
    +    +    -     ) -> list[dict]:
    +    +    -    -    """Generate all contract files from questionnaire answers.
    +    +    -    +    """Generate all contract files from questionnaire answers using the LLM.
    +    +    -     
    +    +    -    +    Each contract is generated individually with a contract-specific system
    +    +    -    +    prompt that references the Forge example contract as a structural blueprint.
    +    +    -         Raises ValueError if questionnaire is not complete.
    +    +    -         """
    +    +    -         project = await get_project_by_id(project_id)
    +    +    -    @@ -341,11 +417,37 @@ async def generate_contracts(
    +    +    -             )
    +    +    -     
    +    +    -         answers = qs.get("answers", {})
    +    +    -    -    template_vars = _build_template_vars(project, answers)
    +    +    -    +    answers_text = _format_answers_for_prompt(project, answers)
    +    +    -    +
    +    +    -    +    # Pick LLM provider
    +    +    -    +    provider = settings.LLM_PROVIDER.strip().lower() if settings.LLM_PROVIDER else ""
    +    +    -    +    if not provider:
    +    +    -    +        provider = "anthropic" if settings.ANTHROPIC_API_KEY else "openai"
    +    +    -    +    if provider == "openai":
    +    +    -    +        llm_api_key = settings.OPENAI_API_KEY
    +    +    -    +        llm_model = settings.OPENAI_MODEL
    +    +    -    +    else:
    +    +    -    +        llm_api_key = settings.ANTHROPIC_API_KEY
    +    +    -    +        llm_model = settings.LLM_QUESTIONNAIRE_MODEL
    +    +    -     
    +    +    -         generated = []
    +    +    -    -    for contract_type in CONTRACT_TYPES:
    +    +    -    -        content = _render_template(contract_type, template_vars)
    +    +    -    +    total = len(CONTRACT_TYPES)
    +    +    -    +    for idx, contract_type in enumerate(CONTRACT_TYPES):
    +    +    -    +        # Notify client that generation of this contract has started
    +    +    -    +        await manager.send_to_user(str(user_id), {
    +    +    -    +            "type": "contract_progress",
    +    +    -    +            "payload": {
    +    +    -    +                "project_id": str(project_id),
    +    +    -    +                "contract_type": contract_type,
    +    +    -    +                "status": "generating",
    +    +    -    +                "index": idx,
    +    +    -    +                "total": total,
    +    +    -    +            },
    +    +    -    +        })
    +    +    -    +
    +    +    -    +        content, usage = await _generate_contract_content(
    +    +    -    +            contract_type, project, answers_text, llm_api_key, llm_model, provider
    +    +    -    +        )
    +    +    -             row = await upsert_contract(project_id, contract_type, content)
    +    +    -             generated.append({
    +    +    -                 "id": str(row["id"]),
    +    +    -    @@ -356,6 +458,20 @@ async def generate_contracts(
    +    +    -                 "updated_at": row["updated_at"],
    +    +    -             })
    +    +    -     
    +    +    -    +        # Notify client that this contract is done
    +    +    -    +        await manager.send_to_user(str(user_id), {
    +    +    -    +            "type": "contract_progress",
    +    +    -    +            "payload": {
    +    +    -    +                "project_id": str(project_id),
    +    +    -    +                "contract_type": contract_type,
    +    +    -    +                "status": "done",
    +    +    -    +                "index": idx,
    +    +    -    +                "total": total,
    +    +    -    +                "input_tokens": usage.get("input_tokens", 0),
    +    +    -    +                "output_tokens": usage.get("output_tokens", 0),
    +    +    -    +            },
    +    +    -    +        })
    +    +    -    +
    +    +    -         await update_project_status(project_id, "contracts_ready")
    +    +    -         return generated
    +    +    -     
    +    +    -    @@ -481,48 +597,252 @@ def _parse_llm_response(raw: str) -> dict:
    +    +    -         }
    +    +    -     
    +    +    -     
    +    +    -    -def _build_template_vars(project: dict, answers: dict) -> dict:
    +    +    -    -    """Flatten questionnaire answers into template variables."""
    +    +    -    -    variables = {
    +    +    -    -        "project_name": project["name"],
    +    +    -    -        "project_description": project.get("description", ""),
    +    +    -    +def _format_answers_for_prompt(project: dict, answers: dict) -> str:
    +    +    -    +    """Format all questionnaire answers into a readable text block for prompts."""
    +    +    -    +    lines = [
    +    +    -    +        f"Project name: {project['name']}",
    +    +    -    +        f"Description: {project.get('description', 'N/A')}",
    +    +    -    +        "",
    +    +    -    +    ]
    +    +    -    +    for section in QUESTIONNAIRE_SECTIONS:
    +    +    -    +        section_data = answers.get(section)
    +    +    -    +        lines.append(f"### {section}")
    +    +    -    +        if not section_data:
    +    +    -    +            lines.append("(no data collected)")
    +    +    -    +        elif isinstance(section_data, dict):
    +    +    -    +            for k, v in section_data.items():
    +    +    -    +                if isinstance(v, list):
    +    +    -    +                    lines.append(f"- {k}:")
    +    +    -    +                    for item in v:
    +    +    -    +                        lines.append(f"  - {item}")
    +    +    -    +                elif isinstance(v, dict):
    +    +    -    +                    lines.append(f"- {k}: {json.dumps(v, indent=2)}")
    +    +    -    +                else:
    +    +    -    +                    lines.append(f"- {k}: {v}")
    +    +    -    +        else:
    +    +    -    +            lines.append(str(section_data))
    +    +    -    +        lines.append("")
    +    +    -    +    return "\n".join(lines)
    +    +    -    +
    +    +    -    +
    +    +    -    +def _load_forge_example(contract_type: str) -> str | None:
    +    +    -    +    """Load the Forge example contract as a structural reference, if it exists."""
    +    +    -    +    ext_map = {
    +    +    -    +        "physics": "physics.yaml",
    +    +    -    +        "boundaries": "boundaries.json",
    +    +    -         }
    +    +    -    +    filename = ext_map.get(contract_type, f"{contract_type}.md")
    +    +    -    +    path = FORGE_CONTRACTS_DIR / filename
    +    +    -    +    if path.exists():
    +    +    -    +        try:
    +    +    -    +            return path.read_text(encoding="utf-8")
    +    +    -    +        except Exception:
    +    +    -    +            return None
    +    +    -    +    return None
    +    +    -    +
    +    +    -    +
    +    +    -    +# Per-contract generation instructions
    +    +    -    +_CONTRACT_INSTRUCTIONS: dict[str, str] = {
    +    +    -    +    "blueprint": """\
    +    +    -    +Generate a comprehensive project blueprint. Include:
    +    +    -    +1) Product intent ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® what it does, who it's for, why it exists (2-3 paragraphs)
    +    +    -    +2) Core interaction invariants ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® 5-7 MUST-hold rules (bullet list)
    +    +    -    +3) MVP scope ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Must-ship features (numbered, with sub-details) AND explicitly-not-MVP list
    +    +    -    +4) Hard boundaries ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® anti-godfile rules per architectural layer (Routers, Services, Repos, Clients, etc.)
    +    +    -    +5) Deployment target ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® where it runs, scale expectations
    +    +    -    +
    +    +    -    +Use specific, concrete language. No vagueness. Every feature must be described precisely enough
    +    +    -    +that a developer could implement it without asking questions.""",
    +    +    -    +
    +    +    -    +    "manifesto": """\
    +    +    -    +Generate a project manifesto defining 5-7 non-negotiable principles.
    +    +    -    +Each principle should have:
    +    +    -    +- A descriptive title (e.g. "Contract-first, schema-first")
    +    +    -    +- 3-5 bullet points elaborating the rule
    +    +    -    +- Project-specific details (not generic platitudes)
    +    +    -    +
    +    +    -    +Include a "Confirm-before-write" section listing what requires user confirmation
    +    +    -    +and what is exempt. Include any privacy or security principles relevant to this project.""",
    +    +    -    +
    +    +    -    +    "stack": """\
    +    +    -    +Generate a technology stack document. Include sections for:
    +    +    -    +- Backend (language, framework, version, key libraries)
    +    +    -    +- Database (engine, version, connection method)
    +    +    -    +- Auth (method, provider, flow)
    +    +    -    +- Frontend (framework, bundler, key libraries)
    +    +    -    +- Testing (framework, coverage requirements)
    +    +    -    +- Deployment (platform, expected scale)
    +    +    -    +- Environment Variables table (name, description, required/optional)
    +    +    -    +- forge.json schema (JSON block showing project metadata structure)
    +    +    -    +
    +    +    -    +For each technology choice, briefly explain WHY it was chosen.""",
    +    +    -    +
    +    +    -    +    "schema": """\
    +    +    -    +Generate a complete database schema document. Include:
    +    +    -    +- Schema version header
    +    +    -    +- Conventions section (naming patterns, common columns like id/created_at/updated_at)
    +    +    -    +- Full CREATE TABLE SQL for EVERY table, including:
    +    +    -    +  - Column definitions with types and constraints
    +    +    -    +  - PRIMARY KEY, FOREIGN KEY, UNIQUE constraints
    +    +    -    +  - Indexes
    +    +    -    +  - ENUM descriptions where applicable
    +    +    -    +- Schema-to-Phase traceability matrix (which table is built in which phase)
    +    +    -    +
    +    +    -    +Use PostgreSQL syntax. Be thorough ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® every column the app needs must be defined.""",
    +    +    -    +
    +    +    -    +    "phases": """\
    +    +    -    +Generate a detailed phase breakdown document with 6-12 phases.
    +    +    -    +Each phase MUST include:
    +    +    -    +- Phase number and name (e.g. "Phase 0 ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Genesis")
    +    +    -    +- Objective (1-2 sentences)
    +    +    -    +- Deliverables (detailed bullet list of what gets built)
    +    +    -    +- Schema coverage (which tables/columns are created or modified)
    +    +    -    +- Exit criteria (bullet list of concrete, testable conditions)
    +    +    -    +
    +    +    -    +Phase 0 is always Genesis (project scaffold, config, tooling).
    +    +    -    +The final phase should be Ship & Deploy.
    +    +    -    +Phases should be ordered by dependency ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® earlier phases provide foundations for later ones.""",
    +    +    -    +
    +    +    -    +    "ui": """\
    +    +    -    +Generate a UI/UX blueprint document. Include:
    +    +    -    +1) App Shell & Layout ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® device priority, shell structure, navigation model
    +    +    -    +2) Screens/Views ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® detailed spec for each page (what it shows, key interactions, empty states)
    +    +    -    +3) Component Inventory ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® table of reusable components
    +    +    -    +4) Visual Style ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® color palette, typography, visual density, tone
    +    +    -    +5) Interaction Patterns ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® data loading, empty states, error states, confirmation dialogs, responsive behavior
    +    +    -    +6) User Flows ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® 3-4 key user journeys described step by step
    +    +    -    +7) What This Is NOT ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® explicit list of out-of-scope UI features
    +    +    -    +
    +    +    -    +Be specific about layout, data displayed, and interaction triggers.""",
    +    +    -    +
    +    +    -    +    "physics": """\
    +    +    -    +Generate an API physics specification in YAML format. Structure:
    +    +    -    +- info: title, version, description
    +    +    -    +- paths: every API endpoint with:
    +    +    -    +  - HTTP method (get/post/put/delete)
    +    +    -    +  - summary
    +    +    -    +  - auth requirement (none, token, github-token)
    +    +    -    +  - request body shape (if applicable)
    +    +    -    +  - response shape
    +    +    -    +  - query parameters (if applicable)
    +    +    -    +- schemas: Pydantic/data model definitions
    +    +    -    +
    +    +    -    +Use the custom Forge physics YAML format (NOT OpenAPI).
    +    +    -    +Group endpoints by resource with comments.
    +    +    -    +Every endpoint the app needs MUST be listed.""",
    +    +    -    +
    +    +    -    +    "boundaries": """\
    +    +    -    +Generate an architectural boundaries specification in JSON format. Structure:
    +    +    -    +{
    +    +    -    +  "description": "Layer boundary rules for <project_name>...",
    +    +    -    +  "layers": [
    +    +    -    +    {
    +    +    -    +      "name": "<layer_name>",
    +    +    -    +      "glob": "<file_glob_pattern>",
    +    +    -    +      "forbidden": [
    +    +    -    +        { "pattern": "<regex_or_import>", "reason": "<why forbidden>" }
    +    +    -    +      ]
    +    +    -    +    }
    +    +    -    +  ],
    +    +    -    +  "known_violations": []
    +    +    -    +}
    +    +    -     
    +    +    -    -    # Flatten all answer sections into the variables dict
    +    +    -    -    for section_name, section_data in answers.items():
    +    +    -    -        if isinstance(section_data, dict):
    +    +    -    -            for key, value in section_data.items():
    +    +    -    -                if isinstance(value, list):
    +    +    -    -                    variables[key] = "\n".join(f"- {v}" for v in value)
    +    +    -    -                else:
    +    +    -    -                    variables[key] = str(value)
    +    +    -    -        elif isinstance(section_data, str):
    +    +    -    -            variables[section_name] = section_data
    +    +    -    +Define 4-6 layers (e.g. routers, services, repos, clients, audit/engine).
    +    +    -    +Each layer has forbidden imports/patterns that enforce separation of concerns.
    +    +    -    +Output MUST be valid JSON.""",
    +    +    -     
    +    +    -    -    return variables
    +    +    -    +    "builder_directive": """\
    +    +    -    +Generate a builder directive ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® the operational instructions for an AI builder.
    +    +    -    +Include:
    +    +    -    +- AEM status (enabled/disabled) and auto-authorize setting
    +    +    -    +- Step-by-step instructions (read contracts ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ execute phases ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ run audit ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ commit)
    +    +    -    +- Autonomy rules (when to auto-commit, when to stop and ask)
    +    +    -    +- Phase list with phase numbers and names
    +    +    -    +- Project summary (one paragraph)
    +    +    -    +- boot_script flag
    +    +    -     
    +    +    -    +Keep it concise but complete ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® this is the builder's startup instructions.""",
    +    +    -    +}
    +    +    -     
    +    +    -    -def _render_template(contract_type: str, variables: dict) -> str:
    +    +    -    -    """Render a contract template with the given variables.
    +    +    -     
    +    +    -    -    Uses safe substitution -- missing variables become empty strings.
    +    +    -    +async def _generate_contract_content(
    +    +    -    +    contract_type: str,
    +    +    -    +    project: dict,
    +    +    -    +    answers_text: str,
    +    +    -    +    api_key: str,
    +    +    -    +    model: str,
    +    +    -    +    provider: str,
    +    +    -    +) -> tuple[str, dict]:
    +    +    -    +    """Generate a single contract using the LLM.
    +    +    -    +
    +    +    -    +    Returns (content, usage) where usage has input_tokens / output_tokens.
    +    +    -         """
    +    +    -    -    template_file = TEMPLATES_DIR / f"{contract_type}.md"
    +    +    -    -    if contract_type == "physics":
    +    +    -    -        template_file = TEMPLATES_DIR / "physics.yaml"
    +    +    -    -    elif contract_type == "boundaries":
    +    +    -    -        template_file = TEMPLATES_DIR / "boundaries.json"
    +    +    -    -
    +    +    -    -    if not template_file.exists():
    +    +    -    -        return f"# {variables.get('project_name', 'Project')} ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® {contract_type}\n\nTemplate not found."
    +    +    -    +    # Load the Forge example as a structural reference (if available)
    +    +    -    +    example = _load_forge_example(contract_type)
    +    +    -    +
    +    +    -    +    instructions = _CONTRACT_INSTRUCTIONS.get(contract_type, f"Generate a {contract_type} contract document.")
    +    +    -    +
    +    +    -    +    system_parts = [
    +    +    -    +        f"You are a Forge contract generator. You produce detailed, production-quality "
    +    +    -    +        f"project specification documents for the Forge autonomous build system.\n\n"
    +    +    -    +        f"You are generating the **{contract_type}** contract for the project "
    +    +    -    +        f'"{project["name"]}".\n\n'
    +    +    -    +        f"INSTRUCTIONS:\n{instructions}\n\n"
    +    +    -    +        f"RULES:\n"
    +    +    -    +        f"- Output ONLY the contract content. No preamble, no 'Here is...', no explanations.\n"
    +    +    -    +        f"- Be thorough and detailed. Each contract should be comprehensive enough that a "
    +    +    -    +        f"developer can build from it without asking questions.\n"
    +    +    -    +        f"- Use the project information provided to fill in ALL sections with real, "
    +    +    -    +        f"project-specific content.\n"
    +    +    -    +        f"- Do NOT leave any section empty or with placeholder text.\n"
    +    +    -    +        f"- Match the structural depth and detail level of the reference example.\n"
    +    +    -    +    ]
    +    +    -     
    +    +    -    -    raw = template_file.read_text(encoding="utf-8")
    +    +    -    +    if example:
    +    +    -    +        # Truncate very long examples to avoid hitting context limits
    +    +    -    +        if len(example) > 6000:
    +    +    -    +            example = example[:6000] + "\n\n... (truncated for brevity) ..."
    +    +    -    +        system_parts.append(
    +    +    -    +            f"\n--- STRUCTURAL REFERENCE (match this level of detail and format) ---\n"
    +    +    -    +            f"{example}\n"
    +    +    -    +            f"--- END REFERENCE ---\n"
    +    +    -    +        )
    +    +    -     
    +    +    -    -    # Safe substitution: replace {key} with value, leave unknown keys empty
    +    +    -    -    import re
    +    +    -    +    system_prompt = "\n".join(system_parts)
    +    +    -     
    +    +    -    -    def _replacer(match: re.Match) -> str:
    +    +    -    -        key = match.group(1)
    +    +    -    -        return variables.get(key, "")
    +    +    -    +    user_msg = (
    +    +    -    +        f"Generate the {contract_type} contract for this project.\n\n"
    +    +    -    +        f"--- PROJECT INFORMATION (from questionnaire) ---\n"
    +    +    -    +        f"{answers_text}\n"
    +    +    -    +        f"--- END PROJECT INFORMATION ---"
    +    +    -    +    )
    +    +    -     
    +    +    -    -    return re.sub(r"\{(\w+)\}", _replacer, raw)
    +    +    -    +    try:
    +    +    -    +        result = await llm_chat(
    +    +    -    +            api_key=api_key,
    +    +    -    +            model=model,
    +    +    -    +            system_prompt=system_prompt,
    +    +    -    +            messages=[{"role": "user", "content": user_msg}],
    +    +    -    +            provider=provider,
    +    +    -    +            max_tokens=16384,
    +    +    -    +        )
    +    +    -    +        usage = result.get("usage", {"input_tokens": 0, "output_tokens": 0})
    +    +    -    +        content = result["text"].strip()
    +    +    -    +        # Strip markdown code fences if the LLM wrapped the output
    +    +    -    +        if content.startswith("```"):
    +    +    -    +            lines = content.split("\n")
    +    +    -    +            # Remove first and last ``` lines
    +    +    -    +            if lines[0].startswith("```"):
    +    +    -    +                lines = lines[1:]
    +    +    -    +            if lines and lines[-1].strip() == "```":
    +    +    -    +                lines = lines[:-1]
    +    +    -    +            content = "\n".join(lines).strip()
    +    +    -    +        return content, usage
    +    +    -    +    except Exception as exc:
    +    +    -    +        logger.exception("LLM contract generation failed for %s: %s", contract_type, exc)
    +    +    -    +        # Fall back to a minimal template so the user at least gets something
    +    +    -    +        return (
    +    +    -    +            f"# {project['name']} ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® {contract_type}\n\n"
    +    +    -    +            f"**Generation failed:** {exc}\n\n"
    +    +    -    +            f"Please regenerate this contract or edit it manually."
    +    +    -    +        ), {"input_tokens": 0, "output_tokens": 0}
    +    +    -    diff --git a/db/migrations/006_user_api_key.sql b/db/migrations/006_user_api_key.sql
    +    +    -    new file mode 100644
    +    +    -    index 0000000..13156c9
    +    +    -    --- /dev/null
    +    +    -    +++ b/db/migrations/006_user_api_key.sql
    +    +    -    @@ -0,0 +1,4 @@
    +    +    -    +-- Phase 12: BYOK ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├▒ user-supplied Anthropic API key for builds
    +    +    -    +-- Adds an encrypted API key column to the users table.
    +    +    -    +
    +    +    -    +ALTER TABLE users ADD COLUMN IF NOT EXISTS anthropic_api_key TEXT;
    +    +    -    diff --git a/tests/test_audit_service.py b/tests/test_audit_service.py
    +    +    -    index 0f0451e..94d6f01 100644
    +    +    -    --- a/tests/test_audit_service.py
    +    +    -    +++ b/tests/test_audit_service.py
    +    +    -    @@ -32,6 +32,7 @@ def _make_patches():
    +    +    -             "get_user_by_id": AsyncMock(return_value=MOCK_USER),
    +    +    -             "list_commits": AsyncMock(return_value=[]),
    +    +    -             "get_existing_commit_shas": AsyncMock(return_value=set()),
    +    +    -    +        "mark_stale_audit_runs": AsyncMock(return_value=0),
    +    +    -             "create_audit_run": AsyncMock(return_value={"id": UUID("aaaa1111-1111-1111-1111-111111111111")}),
    +    +    -             "update_audit_run": AsyncMock(),
    +    +    -             "get_commit_files": AsyncMock(return_value=["README.md"]),
    +    +    -    @@ -156,3 +157,54 @@ async def test_backfill_handles_commit_error_gracefully():
    +    +    -         # Both count as "synced" (processed) even if one errored
    +    +    -         assert result["synced"] == 2
    +    +    -         assert result["skipped"] == 0
    +    +    -    +
    +    +    -    +
    +    +    -    +@pytest.mark.asyncio
    +    +    -    +async def test_backfill_cleans_stale_runs():
    +    +    -    +    """backfill_repo_commits calls mark_stale_audit_runs before processing."""
    +    +    -    +    mocks = _make_patches()
    +    +    -    +    mocks["list_commits"].return_value = []
    +    +    -    +    mocks["mark_stale_audit_runs"].return_value = 3
    +    +    -    +
    +    +    -    +    patches = _apply_patches(mocks)
    +    +    -    +    for p in patches:
    +    +    -    +        p.start()
    +    +    -    +    try:
    +    +    -    +        result = await backfill_repo_commits(REPO_ID, USER_ID)
    +    +    -    +    finally:
    +    +    -    +        for p in patches:
    +    +    -    +            p.stop()
    +    +    -    +
    +    +    -    +    mocks["mark_stale_audit_runs"].assert_called_once_with(REPO_ID)
    +    +    -    +    assert result["synced"] == 0
    +    +    -    +    assert result["skipped"] == 0
    +    +    -    +
    +    +    -    +
    +    +    -    +@pytest.mark.asyncio
    +    +    -    +async def test_backfill_marks_error_on_cancel():
    +    +    -    +    """If backfill is cancelled mid-commit, the in-progress row is marked error."""
    +    +    -    +    import asyncio
    +    +    -    +
    +    +    -    +    mocks = _make_patches()
    +    +    -    +    mocks["list_commits"].return_value = [
    +    +    -    +        {"sha": "aaa111", "message": "first", "author": "Alice"},
    +    +    -    +    ]
    +    +    -    +    mocks["get_existing_commit_shas"].return_value = set()
    +    +    -    +    mocks["get_commit_files"].side_effect = asyncio.CancelledError()
    +    +    -    +
    +    +    -    +    patches = _apply_patches(mocks)
    +    +    -    +    for p in patches:
    +    +    -    +        p.start()
    +    +    -    +    try:
    +    +    -    +        with pytest.raises(asyncio.CancelledError):
    +    +    -    +            await backfill_repo_commits(REPO_ID, USER_ID)
    +    +    -    +    finally:
    +    +    -    +        for p in patches:
    +    +    -    +            p.stop()
    +    +    -    +
    +    +    -    +    # The audit run should have been marked as error before re-raising
    +    +    -    +    error_calls = [
    +    +    -    +        c for c in mocks["update_audit_run"].call_args_list
    +    +    -    +        if c.kwargs.get("status") == "error" or (c.args and len(c.args) > 1 and c.args[1] == "error")
    +    +    -    +    ]
    +    +    -    +    assert len(error_calls) >= 1
    +    +    -    diff --git a/tests/test_auth_router.py b/tests/test_auth_router.py
    +    +    -    index 4cd5836..9dc3526 100644
    +    +    -    --- a/tests/test_auth_router.py
    +    +    -    +++ b/tests/test_auth_router.py
    +    +    -    @@ -57,6 +57,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    +    +    -             "github_id": 12345,
    +    +    -             "github_login": "octocat",
    +    +    -             "avatar_url": "https://example.com/avatar.png",
    +    +    -    +        "anthropic_api_key": "sk-ant-test",
    +    +    -         }
    +    +    -     
    +    +    -         token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    +    -    @@ -68,6 +69,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    +    +    -         data = response.json()
    +    +    -         assert data["github_login"] == "octocat"
    +    +    -         assert data["id"] == "11111111-1111-1111-1111-111111111111"
    +    +    -    +    assert data["has_anthropic_key"] is True
    +    +    -     
    +    +    -     
    +    +    -     @patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    -    @@ -80,3 +82,57 @@ def test_auth_me_returns_401_when_user_not_found(mock_get_user):
    +    +    -             headers={"Authorization": f"Bearer {token}"},
    +    +    -         )
    +    +    -         assert response.status_code == 401
    +    +    -    +
    +    +    -    +
    +    +    -    +# ---------------------------------------------------------------------------
    +    +    -    +# Tests: API key management (BYOK)
    +    +    -    +# ---------------------------------------------------------------------------
    +    +    -    +
    +    +    -    +_USER_DICT = {
    +    +    -    +    "id": "11111111-1111-1111-1111-111111111111",
    +    +    -    +    "github_id": 12345,
    +    +    -    +    "github_login": "octocat",
    +    +    -    +    "avatar_url": "https://example.com/avatar.png",
    +    +    -    +    "anthropic_api_key": None,
    +    +    -    +}
    +    +    -    +
    +    +    -    +
    +    +    -    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    +    +    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +def test_save_api_key(mock_get_user, mock_set_key):
    +    +    -    +    mock_get_user.return_value = _USER_DICT
    +    +    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    +    -    +    response = client.put(
    +    +    -    +        "/auth/api-key",
    +    +    -    +        json={"api_key": "sk-ant-api03-test"},
    +    +    -    +        headers={"Authorization": f"Bearer {token}"},
    +    +    -    +    )
    +    +    -    +    assert response.status_code == 200
    +    +    -    +    assert response.json()["saved"] is True
    +    +    -    +    mock_set_key.assert_called_once()
    +    +    -    +
    +    +    -    +
    +    +    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +def test_save_api_key_empty_rejected(mock_get_user):
    +    +    -    +    mock_get_user.return_value = _USER_DICT
    +    +    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    +    -    +    response = client.put(
    +    +    -    +        "/auth/api-key",
    +    +    -    +        json={"api_key": "   "},
    +    +    -    +        headers={"Authorization": f"Bearer {token}"},
    +    +    -    +    )
    +    +    -    +    assert response.status_code == 400
    +    +    -    +
    +    +    -    +
    +    +    -    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    +    +    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +def test_remove_api_key(mock_get_user, mock_set_key):
    +    +    -    +    mock_get_user.return_value = _USER_DICT
    +    +    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    +    -    +    response = client.delete(
    +    +    -    +        "/auth/api-key",
    +    +    -    +        headers={"Authorization": f"Bearer {token}"},
    +    +    -    +    )
    +    +    -    +    assert response.status_code == 200
    +    +    -    +    assert response.json()["removed"] is True
    +    +    -    +    mock_set_key.assert_called_once()
    +    +    -    diff --git a/tests/test_build_service.py b/tests/test_build_service.py
    +    +    -    index 1c7792e..9861a64 100644
    +    +    -    --- a/tests/test_build_service.py
    +    +    -    +++ b/tests/test_build_service.py
    +    +    -    @@ -63,7 +63,8 @@ def _build(**overrides):
    +    +    -     @patch("app.services.build_service.asyncio.create_task")
    +    +    -     @patch("app.services.build_service.project_repo")
    +    +    -     @patch("app.services.build_service.build_repo")
    +    +    -    -async def test_start_build_success(mock_build_repo, mock_project_repo, mock_create_task):
    +    +    -    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    +    -         """start_build creates a build record and spawns a background task."""
    +    +    -         mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    -         mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    +    -    @@ -71,6 +72,7 @@ async def test_start_build_success(mock_build_repo, mock_project_repo, mock_crea
    +    +    -         mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    +    -         mock_build_repo.create_build = AsyncMock(return_value=_build())
    +    +    -         mock_create_task.return_value = MagicMock()
    +    +    -    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    +    +    -     
    +    +    -         result = await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    +    -     
    +    +    -    @@ -133,6 +135,21 @@ async def test_start_build_already_running(mock_build_repo, mock_project_repo):
    +    +    -             await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    +    -     
    +    +    -     
    +    +    -    +@pytest.mark.asyncio
    +    +    -    +@patch("app.services.build_service.project_repo")
    +    +    -    +@patch("app.services.build_service.build_repo")
    +    +    -    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    +    -    +async def test_start_build_no_api_key(mock_get_user, mock_build_repo, mock_project_repo):
    +    +    -    +    """start_build raises ValueError when user has no Anthropic API key."""
    +    +    -    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    -    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    +    -    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    +    -    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": None}
    +    +    -    +
    +    +    -    +    with pytest.raises(ValueError, match="API key required"):
    +    +    -    +        await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    +    -    +
    +    +    -    +
    +    +    -     # ---------------------------------------------------------------------------
    +    +    -     # Tests: cancel_build
    +    +    -     # ---------------------------------------------------------------------------
    +    +    -    @@ -431,3 +448,21 @@ async def test_record_phase_cost(mock_build_repo):
    +    +    -         mock_build_repo.record_build_cost.assert_called_once()
    +    +    -         assert usage.input_tokens == 0
    +    +    -         assert usage.output_tokens == 0
    +    +    -    +
    +    +    -    +
    +    +    -    +def test_get_token_rates_model_aware():
    +    +    -    +    """_get_token_rates returns correct pricing per model family."""
    +    +    -    +    from decimal import Decimal
    +    +    -    +
    +    +    -    +    opus_in, opus_out = build_service._get_token_rates("claude-opus-4-6")
    +    +    -    +    assert opus_in == Decimal("0.000015")
    +    +    -    +    assert opus_out == Decimal("0.000075")
    +    +    -    +
    +    +    -    +    haiku_in, haiku_out = build_service._get_token_rates("claude-haiku-4-5-20251001")
    +    +    -    +    assert haiku_in == Decimal("0.000001")
    +    +    -    +    assert haiku_out == Decimal("0.000005")
    +    +    -    +
    +    +    -    +    # Unknown model falls back to Opus (safest = most expensive)
    +    +    -    +    unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
    +    +    -    +    assert unk_in == Decimal("0.000015")
    +    +    -    +    assert unk_out == Decimal("0.000075")
    +    +    -    diff --git a/tests/test_llm_client.py b/tests/test_llm_client.py
    +    +    -    index c7c4f8e..4f323a2 100644
    +    +    -    --- a/tests/test_llm_client.py
    +    +    -    +++ b/tests/test_llm_client.py
    +    +    -    @@ -34,6 +34,7 @@ async def test_chat_success(mock_client_cls):
    +    +    -             "content": [{"type": "text", "text": "Hello from Haiku!"}],
    +    +    -             "model": "claude-3-5-haiku-20241022",
    +    +    -             "role": "assistant",
    +    +    -    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    +    -         })
    +    +    -         mock_client_cls.return_value = mock_client
    +    +    -     
    +    +    -    @@ -44,7 +45,9 @@ async def test_chat_success(mock_client_cls):
    +    +    -             messages=[{"role": "user", "content": "Hi"}],
    +    +    -         )
    +    +    -     
    +    +    -    -    assert result == "Hello from Haiku!"
    +    +    -    +    assert result["text"] == "Hello from Haiku!"
    +    +    -    +    assert result["usage"]["input_tokens"] == 10
    +    +    -    +    assert result["usage"]["output_tokens"] == 20
    +    +    -         mock_client.post.assert_called_once()
    +    +    -         call_kwargs = mock_client.post.call_args
    +    +    -         body = call_kwargs.kwargs["json"] if "json" in call_kwargs.kwargs else call_kwargs[1]["json"]
    +    +    -    @@ -141,6 +144,7 @@ async def test_chat_openai_success(mock_client_cls):
    +    +    -         """Successful OpenAI chat returns message content."""
    +    +    -         mock_client = _make_mock_client({
    +    +    -             "choices": [{"message": {"role": "assistant", "content": "Hello from GPT!"}}],
    +    +    -    +        "usage": {"prompt_tokens": 5, "completion_tokens": 15},
    +    +    -         })
    +    +    -         mock_client_cls.return_value = mock_client
    +    +    -     
    +    +    -    @@ -151,7 +155,9 @@ async def test_chat_openai_success(mock_client_cls):
    +    +    -             messages=[{"role": "user", "content": "Hi"}],
    +    +    -         )
    +    +    -     
    +    +    -    -    assert result == "Hello from GPT!"
    +    +    -    +    assert result["text"] == "Hello from GPT!"
    +    +    -    +    assert result["usage"]["input_tokens"] == 5
    +    +    -    +    assert result["usage"]["output_tokens"] == 15
    +    +    -         call_kwargs = mock_client.post.call_args
    +    +    -         body = call_kwargs.kwargs.get("json", call_kwargs[1].get("json", {}))
    +    +    -         assert body["model"] == "gpt-4o"
    +    +    -    @@ -226,6 +232,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    +    +    -         """chat(provider='openai') routes to OpenAI endpoint."""
    +    +    -         mock_client = _make_mock_client({
    +    +    -             "choices": [{"message": {"role": "assistant", "content": "dispatched"}}],
    +    +    -    +        "usage": {"prompt_tokens": 0, "completion_tokens": 0},
    +    +    -         })
    +    +    -         mock_client_cls.return_value = mock_client
    +    +    -     
    +    +    -    @@ -237,7 +244,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    +    +    -             provider="openai",
    +    +    -         )
    +    +    -     
    +    +    -    -    assert result == "dispatched"
    +    +    -    +    assert result["text"] == "dispatched"
    +    +    -         call_kwargs = mock_client.post.call_args
    +    +    -         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    +    +    -         assert "openai.com" in url
    +    +    -    @@ -249,6 +256,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    +    +    -         """chat() defaults to Anthropic."""
    +    +    -         mock_client = _make_mock_client({
    +    +    -             "content": [{"type": "text", "text": "default"}],
    +    +    -    +        "usage": {"input_tokens": 0, "output_tokens": 0},
    +    +    -         })
    +    +    -         mock_client_cls.return_value = mock_client
    +    +    -     
    +    +    -    @@ -259,7 +267,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    +    +    -             messages=[{"role": "user", "content": "Hi"}],
    +    +    -         )
    +    +    -     
    +    +    -    -    assert result == "default"
    +    +    -    +    assert result["text"] == "default"
    +    +    -         call_kwargs = mock_client.post.call_args
    +    +    -         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    +    +    -         assert "anthropic.com" in url
    +    +    -    diff --git a/tests/test_project_service.py b/tests/test_project_service.py
    +    +    -    index 1957ba3..1b410b3 100644
    +    +    -    --- a/tests/test_project_service.py
    +    +    -    +++ b/tests/test_project_service.py
    +    +    -    @@ -191,17 +191,22 @@ async def test_process_questionnaire_first_message(
    +    +    -             "status": "draft",
    +    +    -             "questionnaire_state": {},
    +    +    -         }
    +    +    -    -    mock_llm.return_value = json.dumps({
    +    +    -    -        "reply": "Tell me about your product.",
    +    +    -    -        "section": "product_intent",
    +    +    -    -        "section_complete": False,
    +    +    -    -        "extracted_data": None,
    +    +    -    -    })
    +    +    -    +    mock_llm.return_value = {
    +    +    -    +        "text": json.dumps({
    +    +    -    +            "reply": "Tell me about your product.",
    +    +    -    +            "section": "product_intent",
    +    +    -    +            "section_complete": False,
    +    +    -    +            "extracted_data": None,
    +    +    -    +        }),
    +    +    -    +        "usage": {"input_tokens": 50, "output_tokens": 30},
    +    +    -    +    }
    +    +    -     
    +    +    -         result = await process_questionnaire_message(USER_ID, PROJECT_ID, "Hi")
    +    +    -     
    +    +    -         assert result["reply"] == "Tell me about your product."
    +    +    -         assert result["is_complete"] is False
    +    +    -    +    assert result["token_usage"]["input_tokens"] == 50
    +    +    -    +    assert result["token_usage"]["output_tokens"] == 30
    +    +    -         mock_status.assert_called_once()  # draft -> questionnaire
    +    +    -     
    +    +    -     
    +    +    -    @@ -255,10 +260,11 @@ async def test_process_questionnaire_already_complete(mock_project):
    +    +    -     
    +    +    -     
    +    +    -     @pytest.mark.asyncio
    +    +    -    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    +    +    -     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    +    +    -     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    +    +    -     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    +    +    -    -async def test_generate_contracts_success(mock_project, mock_upsert, mock_status):
    +    +    -    +async def test_generate_contracts_success(mock_project, mock_upsert, mock_status, mock_ws):
    +    +    -         mock_project.return_value = {
    +    +    -             "id": PROJECT_ID,
    +    +    -             "user_id": USER_ID,
    +    +    -    diff --git a/tests/test_projects_router.py b/tests/test_projects_router.py
    +    +    -    index 862c16d..dc7c5ff 100644
    +    +    -    --- a/tests/test_projects_router.py
    +    +    -    +++ b/tests/test_projects_router.py
    +    +    -    @@ -21,7 +21,7 @@ def _set_test_config(monkeypatch):
    +    +    -         monkeypatch.setattr("app.config.settings.APP_URL", "http://localhost:8000")
    +    +    -         monkeypatch.setattr("app.config.settings.GITHUB_WEBHOOK_SECRET", "whsec_test")
    +    +    -         monkeypatch.setattr("app.config.settings.ANTHROPIC_API_KEY", "test-api-key")
    +    +    -    -    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022")
    +    +    -    +    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5")
    +    +    -     
    +    +    -     
    +    +    -     USER_ID = "22222222-2222-2222-2222-222222222222"
    +    +    -    @@ -248,7 +248,10 @@ def test_questionnaire_message(
    +    +    -             "status": "draft",
    +    +    -             "questionnaire_state": {},
    +    +    -         }
    +    +    -    -    mock_llm.return_value = '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}'
    +    +    -    +    mock_llm.return_value = {
    +    +    -    +        "text": '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}',
    +    +    -    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    +    -    +    }
    +    +    -     
    +    +    -         resp = client.post(
    +    +    -             f"/projects/{PROJECT_ID}/questionnaire",
    +    +    -    @@ -332,8 +335,9 @@ def test_generate_contracts_incomplete(mock_project, mock_get_user):
    +    +    -     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    +    +    -     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    +    +    -     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    +    +    -    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    +    +    -     def test_generate_contracts_success(
    +    +    -    -    mock_status, mock_upsert, mock_project, mock_get_user
    +    +    -    +    mock_ws, mock_status, mock_upsert, mock_project, mock_get_user
    +    +    -     ):
    +    +    -         mock_get_user.return_value = MOCK_USER
    +    +    -         all_sections = [
    +    +    -    diff --git a/web/src/App.tsx b/web/src/App.tsx
    +    +    -    index 7a6f811..8eadcd4 100644
    +    +    -    --- a/web/src/App.tsx
    +    +    -    +++ b/web/src/App.tsx
    +    +    -    @@ -7,6 +7,7 @@ import AuditDetailPage from './pages/AuditDetail';
    +    +    -     import ProjectDetail from './pages/ProjectDetail';
    +    +    -     import BuildProgress from './pages/BuildProgress';
    +    +    -     import BuildComplete from './pages/BuildComplete';
    +    +    -    +import Settings from './pages/Settings';
    +    +    -     import { AuthProvider, useAuth } from './context/AuthContext';
    +    +    -     import { ToastProvider } from './context/ToastContext';
    +    +    -     
    +    +    -    @@ -72,6 +73,14 @@ function App() {
    +    +    -                     </ProtectedRoute>
    +    +    -                   }
    +    +    -                 />
    +    +    -    +            <Route
    +    +    -    +              path="/settings"
    +    +    -    +              element={
    +    +    -    +                <ProtectedRoute>
    +    +    -    +                  <Settings />
    +    +    -    +                </ProtectedRoute>
    +    +    -    +              }
    +    +    -    +            />
    +    +    -                 <Route path="*" element={<Navigate to="/" replace />} />
    +    +    -               </Routes>
    +    +    -             </BrowserRouter>
    +    +    -    diff --git a/web/src/__tests__/App.test.tsx b/web/src/__tests__/App.test.tsx
    +    +    -    index 7678f4e..0d8a335 100644
    +    +    -    --- a/web/src/__tests__/App.test.tsx
    +    +    -    +++ b/web/src/__tests__/App.test.tsx
    +    +    -    @@ -298,7 +298,7 @@ describe('QuestionnaireModal', () => {
    +    +    -         expect(onClose).toHaveBeenCalled();
    +    +    -       });
    +    +    -     
    +    +    -    -  it('has a voice toggle button', () => {
    +    +    -    +  it('has a restart button', () => {
    +    +    -         render(
    +    +    -           <QuestionnaireModal
    +    +    -             projectId="test-id"
    +    +    -    @@ -307,7 +307,7 @@ describe('QuestionnaireModal', () => {
    +    +    -             onContractsGenerated={() => {}}
    +    +    -           />,
    +    +    -         );
    +    +    -    -    expect(screen.getByTestId('voice-toggle')).toBeInTheDocument();
    +    +    -    +    expect(screen.getByTestId('restart-btn')).toBeInTheDocument();
    +    +    -       });
    +    +    -     
    +    +    -       it('shows generate banner when questionnaire is complete', async () => {
    +    +    -    diff --git a/web/src/__tests__/Build.test.tsx b/web/src/__tests__/Build.test.tsx
    +    +    -    index daae829..ecfc67f 100644
    +    +    -    --- a/web/src/__tests__/Build.test.tsx
    +    +    -    +++ b/web/src/__tests__/Build.test.tsx
    +    +    -    @@ -162,7 +162,7 @@ describe('ProjectCard', () => {
    +    +    -     // ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║ BuildComplete ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├é├ö├Â┬úÔö£├®├ö├Â┬úÔö£┬║
    +    +    -     
    +    +    -     vi.mock('../context/AuthContext', () => ({
    +    +    -    -  useAuth: () => ({ token: 'test-token' }),
    +    +    -    +  useAuth: () => ({ token: 'test-token', loading: false, authFetch: globalThis.fetch }),
    +    +    -       AuthProvider: ({ children }: { children: unknown }) => children,
    +    +    -     }));
    +    +    -     
    +    +    -    diff --git a/web/src/components/AppShell.tsx b/web/src/components/AppShell.tsx
    +    +    -    index 47a1098..b8f1f3c 100644
    +    +    -    --- a/web/src/components/AppShell.tsx
    +    +    -    +++ b/web/src/components/AppShell.tsx
    +    +    -    @@ -103,7 +103,6 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    +    +    -                   style={{ width: 28, height: 28, borderRadius: '50%' }}
    +    +    -                 />
    +    +    -               )}
    +    +    -    -          <span style={{ color: '#94A3B8', fontSize: '0.85rem' }}>{user?.github_login}</span>
    +    +    -               <button
    +    +    -                 onClick={logout}
    +    +    -                 style={{
    +    +    -    @@ -192,11 +191,50 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    +    +    -                     marginTop: 'auto',
    +    +    -                     padding: '12px 16px',
    +    +    -                     borderTop: '1px solid #1E293B',
    +    +    -    -                color: '#64748B',
    +    +    -    -                fontSize: '0.7rem',
    +    +    -    +                display: 'flex',
    +    +    -    +                alignItems: 'center',
    +    +    -    +                justifyContent: 'space-between',
    +    +    -                   }}
    +    +    -                 >
    +    +    -    -              v0.1.0
    +    +    -    +              <div
    +    +    -    +                onClick={() => navigate('/settings')}
    +    +    -    +                style={{
    +    +    -    +                  display: 'flex',
    +    +    -    +                  alignItems: 'center',
    +    +    -    +                  gap: '8px',
    +    +    -    +                  cursor: 'pointer',
    +    +    -    +                  flex: 1,
    +    +    -    +                  minWidth: 0,
    +    +    -    +                }}
    +    +    -    +                title={user?.github_login ?? 'Settings'}
    +    +    -    +              >
    +    +    -    +                {user?.avatar_url && (
    +    +    -    +                  <img
    +    +    -    +                    src={user.avatar_url}
    +    +    -    +                    alt={user.github_login}
    +    +    -    +                    style={{ width: 22, height: 22, borderRadius: '50%', flexShrink: 0 }}
    +    +    -    +                  />
    +    +    -    +                )}
    +    +    -    +                <span style={{ color: '#CBD5E1', fontSize: '0.75rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    +    +    -    +                  {user?.github_login}
    +    +    -    +                </span>
    +    +    -    +              </div>
    +    +    -    +              <button
    +    +    -    +                onClick={() => navigate('/settings')}
    +    +    -    +                title="Settings"
    +    +    -    +                style={{
    +    +    -    +                  background: 'transparent',
    +    +    -    +                  border: 'none',
    +    +    -    +                  color: '#64748B',
    +    +    -    +                  cursor: 'pointer',
    +    +    -    +                  fontSize: '0.95rem',
    +    +    -    +                  padding: '4px',
    +    +    -    +                  flexShrink: 0,
    +    +    -    +                  lineHeight: 1,
    +    +    -    +                }}
    +    +    -    +              >
    +    +    -    +                ├ö├Â┬úÔö£├é├ö├Â┬úÔö¼├║├ö├Â┬úÔö£Ôòù
    +    +    -    +              </button>
    +    +    -                 </div>
    +    +    -               </aside>
    +    +    -             )}
    +    +    -    diff --git a/web/src/components/ContractProgress.tsx b/web/src/components/ContractProgress.tsx
    +    +    -    new file mode 100644
    +    +    -    index 0000000..821fec7
    +    +    -    --- /dev/null
    +    +    -    +++ b/web/src/components/ContractProgress.tsx
    +    +    -    @@ -0,0 +1,294 @@
    +    +    -    +/**
    +    +    -    + * ContractProgress -- live step-by-step contract generation progress panel.
    +    +    -    + *
    +    +    -    + * Shows each contract being generated with status indicators, a running log,
    +    +    -    + * context window meter, and cumulative token usage from the questionnaire.
    +    +    -    + */
    +    +    -    +import { useState, useEffect, useRef, useCallback } from 'react';
    +    +    -    +import { useAuth } from '../context/AuthContext';
    +    +    -    +import { useWebSocket } from '../hooks/useWebSocket';
    +    +    -    +
    +    +    -    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -    +
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Contract type labels                                              */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -    +const CONTRACT_LABELS: Record<string, string> = {
    +    +    -    +  blueprint: 'Blueprint',
    +    +    -    +  manifesto: 'Manifesto',
    +    +    -    +  stack: 'Stack',
    +    +    -    +  schema: 'Schema',
    +    +    -    +  physics: 'Physics',
    +    +    -    +  boundaries: 'Boundaries',
    +    +    -    +  phases: 'Phases',
    +    +    -    +  ui: 'UI',
    +    +    -    +  builder_contract: 'Builder Contract',
    +    +    -    +  builder_directive: 'Builder Directive',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const ALL_CONTRACTS = Object.keys(CONTRACT_LABELS);
    +    +    -    +
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Context window constants                                          */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -    +const MODEL_CONTEXT_WINDOWS: Record<string, number> = {
    +    +    -    +  'claude-haiku-4-5': 200_000,
    +    +    -    +  'claude-sonnet-4-5': 200_000,
    +    +    -    +  'claude-opus-4-6': 200_000,
    +    +    -    +  'gpt-4o': 128_000,
    +    +    -    +};
    +    +    -    +const DEFAULT_CONTEXT_WINDOW = 200_000;
    +    +    -    +
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Types                                                             */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -    +interface TokenUsage {
    +    +    -    +  input_tokens: number;
    +    +    -    +  output_tokens: number;
    +    +    -    +}
    +    +    -    +
    +    +    -    +type ContractStatus = 'pending' | 'generating' | 'done';
    +    +    -    +
    +    +    -    +interface LogEntry {
    +    +    -    +  time: string;
    +    +    -    +  message: string;
    +    +    -    +}
    +    +    -    +
    +    +    -    +interface Props {
    +    +    -    +  projectId: string;
    +    +    -    +  tokenUsage: TokenUsage;
    +    +    -    +  model: string;
    +    +    -    +  onComplete: () => void;
    +    +    -    +}
    +    +    -    +
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Styles                                                            */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -    +const panelStyle: React.CSSProperties = {
    +    +    -    +  display: 'flex',
    +    +    -    +  flexDirection: 'column',
    +    +    -    +  gap: '12px',
    +    +    -    +  padding: '16px 20px',
    +    +    -    +  flex: 1,
    +    +    -    +  overflowY: 'auto',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const stepRowStyle: React.CSSProperties = {
    +    +    -    +  display: 'flex',
    +    +    -    +  alignItems: 'center',
    +    +    -    +  gap: '10px',
    +    +    -    +  fontSize: '0.82rem',
    +    +    -    +  padding: '6px 0',
    +    +    -    +  borderBottom: '1px solid #1E293B',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const logPanelStyle: React.CSSProperties = {
    +    +    -    +  background: '#0F172A',
    +    +    -    +  borderRadius: '6px',
    +    +    -    +  padding: '10px 12px',
    +    +    -    +  fontFamily: 'monospace',
    +    +    -    +  fontSize: '0.72rem',
    +    +    -    +  color: '#94A3B8',
    +    +    -    +  maxHeight: '120px',
    +    +    -    +  overflowY: 'auto',
    +    +    -    +  lineHeight: '1.6',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const meterBarOuter: React.CSSProperties = {
    +    +    -    +  flex: 1,
    +    +    -    +  height: '8px',
    +    +    -    +  background: '#1E293B',
    +    +    -    +  borderRadius: '4px',
    +    +    -    +  overflow: 'hidden',
    +    +    -    +};
    +    +    -    +
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Component                                                         */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -    +export default function ContractProgress({ projectId, tokenUsage, model, onComplete }: Props) {
    +    +    -    +  const { token } = useAuth();
    +    +    -    +  const [statuses, setStatuses] = useState<Record<string, ContractStatus>>(() =>
    +    +    -    +    Object.fromEntries(ALL_CONTRACTS.map((c) => [c, 'pending' as const])),
    +    +    -    +  );
    +    +    -    +  const [log, setLog] = useState<LogEntry[]>([]);
    +    +    -    +  const [generating, setGenerating] = useState(false);
    +    +    -    +  const [allDone, setAllDone] = useState(false);
    +    +    -    +  const logEndRef = useRef<HTMLDivElement>(null);
    +    +    -    +  const startedRef = useRef(false);
    +    +    -    +
    +    +    -    +  const addLog = useCallback((msg: string) => {
    +    +    -    +    const now = new Date();
    +    +    -    +    const time = now.toLocaleTimeString('en-GB', { hour12: false });
    +    +    -    +    setLog((prev) => [...prev, { time, message: msg }]);
    +    +    -    +  }, []);
    +    +    -    +
    +    +    -    +  /* Auto-scroll log */
    +    +    -    +  useEffect(() => {
    +    +    -    +    logEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    +    +    -    +  }, [log]);
    +    +    -    +
    +    +    -    +  /* Handle WS progress messages */
    +    +    -    +  useWebSocket(
    +    +    -    +    useCallback(
    +    +    -    +      (data: { type: string; payload: any }) => {
    +    +    -    +        if (data.type !== 'contract_progress') return;
    +    +    -    +        const p = data.payload;
    +    +    -    +        if (p.project_id !== projectId) return;
    +    +    -    +
    +    +    -    +        const label = CONTRACT_LABELS[p.contract_type] ?? p.contract_type;
    +    +    -    +        if (p.status === 'generating') {
    +    +    -    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'generating' }));
    +    +    -    +          addLog(`Generating ${label}...`);
    +    +    -    +        } else if (p.status === 'done') {
    +    +    -    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'done' }));
    +    +    -    +          addLog(`├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├Â├▒ ${label} complete`);
    +    +    -    +
    +    +    -    +          /* Check if all done */
    +    +    -    +          setStatuses((prev) => {
    +    +    -    +            const values = Object.values(prev);
    +    +    -    +            if (values.every((s) => s === 'done')) {
    +    +    -    +              setAllDone(true);
    +    +    -    +              addLog('All contracts generated successfully.');
    +    +    -    +            }
    +    +    -    +            return prev;
    +    +    -    +          });
    +    +    -    +        }
    +    +    -    +      },
    +    +    -    +      [projectId, addLog],
    +    +    -    +    ),
    +    +    -    +  );
    +    +    -    +
    +    +    -    +  /* Kick off generation on mount */
    +    +    -    +  useEffect(() => {
    +    +    -    +    if (startedRef.current) return;
    +    +    -    +    startedRef.current = true;
    +    +    -    +    setGenerating(true);
    +    +    -    +    addLog('Starting contract generation...');
    +    +    -    +
    +    +    -    +    fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    +    -    +      method: 'POST',
    +    +    -    +      headers: { Authorization: `Bearer ${token}` },
    +    +    -    +    })
    +    +    -    +      .then((res) => {
    +    +    -    +        if (!res.ok) throw new Error('Generation failed');
    +    +    -    +        /* Mark any remaining as done (safety net) */
    +    +    -    +        setStatuses((prev) => {
    +    +    -    +          const updated = { ...prev };
    +    +    -    +          for (const key of ALL_CONTRACTS) {
    +    +    -    +            if (updated[key] !== 'done') updated[key] = 'done';
    +    +    -    +          }
    +    +    -    +          return updated;
    +    +    -    +        });
    +    +    -    +        setAllDone(true);
    +    +    -    +        setGenerating(false);
    +    +    -    +      })
    +    +    -    +      .catch(() => {
    +    +    -    +        addLog('├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├▓├║ Contract generation failed');
    +    +    -    +        setGenerating(false);
    +    +    -    +      });
    +    +    -    +  }, [projectId, token, addLog]);
    +    +    -    +
    +    +    -    +  /* Derived values */
    +    +    -    +  const contextWindow = MODEL_CONTEXT_WINDOWS[model] ?? DEFAULT_CONTEXT_WINDOW;
    +    +    -    +  const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    +    -    +  const ctxPercent = Math.min(100, (totalTokens / contextWindow) * 100);
    +    +    -    +  const doneCount = Object.values(statuses).filter((s) => s === 'done').length;
    +    +    -    +
    +    +    -    +  /* Color for context bar */
    +    +    -    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    +    +    -    +
    +    +    -    +  return (
    +    +    -    +    <div style={panelStyle} data-testid="contract-progress">
    +    +    -    +      {/* Header */}
    +    +    -    +      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
    +    +    -    +        <h4 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    +    -    +          {allDone ? '├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├Â├▒ Contracts Ready' : `Generating Contracts├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬╝Ôö¼┬╝ (${doneCount}/${ALL_CONTRACTS.length})`}
    +    +    -    +        </h4>
    +    +    -    +      </div>
    +    +    -    +
    +    +    -    +      {/* Context window meter */}
    +    +    -    +      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    +    +    -    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.7rem', color: '#94A3B8' }}>
    +    +    -    +          <span>Context Window ({model})</span>
    +    +    -    +          <span>
    +    +    -    +            {totalTokens.toLocaleString()} / {contextWindow.toLocaleString()} tokens ({ctxPercent.toFixed(1)}%)
    +    +    -    +          </span>
    +    +    -    +        </div>
    +    +    -    +        <div style={meterBarOuter}>
    +    +    -    +          <div
    +    +    -    +            style={{
    +    +    -    +              width: `${ctxPercent}%`,
    +    +    -    +              height: '100%',
    +    +    -    +              background: ctxColor,
    +    +    -    +              borderRadius: '4px',
    +    +    -    +              transition: 'width 0.4s ease',
    +    +    -    +            }}
    +    +    -    +          />
    +    +    -    +        </div>
    +    +    -    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#64748B' }}>
    +    +    -    +          <span>Input: {tokenUsage.input_tokens.toLocaleString()}</span>
    +    +    -    +          <span>Output: {tokenUsage.output_tokens.toLocaleString()}</span>
    +    +    -    +        </div>
    +    +    -    +      </div>
    +    +    -    +
    +    +    -    +      {/* Step list */}
    +    +    -    +      <div>
    +    +    -    +        {ALL_CONTRACTS.map((ct) => {
    +    +    -    +          const st = statuses[ct];
    +    +    -    +          const icon = st === 'done' ? '├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬úÔö£├¡' : st === 'generating' ? '├ö├Â┬úÔö£├é├ö├Â┬úÔö£├íÔö£├ÂÔö£├éÔö£┬«' : '├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö¼Ôòù';
    +    +    -    +          const color = st === 'done' ? '#22C55E' : st === 'generating' ? '#F59E0B' : '#475569';
    +    +    -    +          return (
    +    +    -    +            <div key={ct} style={stepRowStyle}>
    +    +    -    +              <span style={{ width: '20px', textAlign: 'center' }}>{icon}</span>
    +    +    -    +              <span style={{ flex: 1, color }}>{CONTRACT_LABELS[ct]}</span>
    +    +    -    +              <span style={{ fontSize: '0.7rem', color: '#64748B', textTransform: 'uppercase' }}>{st}</span>
    +    +    -    +            </div>
    +    +    -    +          );
    +    +    -    +        })}
    +    +    -    +      </div>
    +    +    -    +
    +    +    -    +      {/* Log panel */}
    +    +    -    +      <div style={logPanelStyle} data-testid="contract-log">
    +    +    -    +        {log.map((entry, i) => (
    +    +    -    +          <div key={i}>
    +    +    -    +            <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    +    +    -    +            {entry.message}
    +    +    -    +          </div>
    +    +    -    +        ))}
    +    +    -    +        <div ref={logEndRef} />
    +    +    -    +      </div>
    +    +    -    +
    +    +    -    +      {/* Done button */}
    +    +    -    +      {allDone && (
    +    +    -    +        <button
    +    +    -    +          onClick={onComplete}
    +    +    -    +          data-testid="contracts-done-btn"
    +    +    -    +          style={{
    +    +    -    +            background: '#16A34A',
    +    +    -    +            color: '#fff',
    +    +    -    +            border: 'none',
    +    +    -    +            borderRadius: '8px',
    +    +    -    +            padding: '10px 20px',
    +    +    -    +            cursor: 'pointer',
    +    +    -    +            fontSize: '0.8rem',
    +    +    -    +            fontWeight: 600,
    +    +    -    +            alignSelf: 'center',
    +    +    -    +          }}
    +    +    -    +        >
    +    +    -    +          Done ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® View Contracts
    +    +    -    +        </button>
    +    +    -    +      )}
    +    +    -    +
    +    +    -    +      {generating && !allDone && (
    +    +    -    +        <p style={{ textAlign: 'center', color: '#64748B', fontSize: '0.75rem', margin: 0 }}>
    +    +    -    +          Generating├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬╝Ôö¼┬╝
    +    +    -    +        </p>
    +    +    -    +      )}
    +    +    -    +    </div>
    +    +    -    +  );
    +    +    -    +}
    +    +    -    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    +    +    -    index 2b28280..5aa4c71 100644
    +    +    -    --- a/web/src/components/QuestionnaireModal.tsx
    +    +    -    +++ b/web/src/components/QuestionnaireModal.tsx
    +    +    -    @@ -7,6 +7,7 @@
    +    +    -      */
    +    +    -     import { useState, useEffect, useRef, useCallback } from 'react';
    +    +    -     import { useAuth } from '../context/AuthContext';
    +    +    -    +import ContractProgress from './ContractProgress';
    +    +    -     
    +    +    -     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -     
    +    +    -    @@ -22,7 +23,6 @@ const SECTION_LABELS: Record<string, string> = {
    +    +    -       ui_requirements: 'UI Requirements',
    +    +    -       architectural_boundaries: 'Boundaries',
    +    +    -       deployment_target: 'Deployment',
    +    +    -    -  phase_breakdown: 'Phase Breakdown',
    +    +    -     };
    +    +    -     
    +    +    -     const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    +    +    -    @@ -34,6 +34,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    +    +    -     interface ChatMessage {
    +    +    -       role: 'user' | 'assistant';
    +    +    -       content: string;
    +    +    -    +  section?: string;
    +    +    -     }
    +    +    -     
    +    +    -     interface QuestionnaireState {
    +    +    -    @@ -150,83 +151,178 @@ const SpeechRecognition =
    +    +    -         : null;
    +    +    -     
    +    +    -     function useSpeechRecognition(onResult: (text: string) => void) {
    +    +    -    -  const recognitionRef = useRef<any>(null);
    +    +    -       const [listening, setListening] = useState(false);
    +    +    -       const listeningRef = useRef(false);
    +    +    -    +  const recRef = useRef<any>(null);
    +    +    -    +  const onResultRef = useRef(onResult);
    +    +    -    +  onResultRef.current = onResult;
    +    +    -    +  /* Generation counter ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® bumped on every stop/start so stale restarts are ignored */
    +    +    -    +  const genRef = useRef(0);
    +    +    -    +  /* Restart timer ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® ensures only ONE pending restart at a time */
    +    +    -    +  const restartTimer = useRef<ReturnType<typeof setTimeout> | null>(null);
    +    +    -    +  /* Consecutive network-error counter ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® give up after too many */
    +    +    -    +  const netErrCount = useRef(0);
    +    +    -    +
    +    +    -    +  /* Tear down the current instance completely */
    +    +    -    +  const killRec = useCallback(() => {
    +    +    -    +    const old = recRef.current;
    +    +    -    +    recRef.current = null;
    +    +    -    +    if (old) {
    +    +    -    +      old.onresult = null;
    +    +    -    +      old.onerror = null;
    +    +    -    +      old.onend = null;
    +    +    -    +      old.onaudiostart = null;
    +    +    -    +      old.onaudioend = null;
    +    +    -    +      try { old.abort(); } catch { /* ignore */ }
    +    +    -    +    }
    +    +    -    +  }, []);
    +    +    -     
    +    +    -    -  useEffect(() => {
    +    +    -    -    if (!SpeechRecognition) return;
    +    +    -    -    const rec = new SpeechRecognition();
    +    +    -    -    rec.continuous = true;
    +    +    -    -    rec.interimResults = true;
    +    +    -    -    rec.lang = 'en-US';
    +    +    -    -
    +    +    -    -    rec.onresult = (e: any) => {
    +    +    -    -      let finalTranscript = '';
    +    +    -    -      for (let i = e.resultIndex; i < e.results.length; i++) {
    +    +    -    -        if (e.results[i].isFinal) {
    +    +    -    -          finalTranscript += e.results[i][0].transcript;
    +    +    -    -        }
    +    +    -    -      }
    +    +    -    -      if (finalTranscript) {
    +    +    -    -        onResult(finalTranscript);
    +    +    -    -      }
    +    +    -    -    };
    +    +    -    +  /* Cancel any pending restart */
    +    +    -    +  const cancelRestart = useCallback(() => {
    +    +    -    +    if (restartTimer.current) {
    +    +    -    +      clearTimeout(restartTimer.current);
    +    +    -    +      restartTimer.current = null;
    +    +    -    +    }
    +    +    -    +  }, []);
    +    +    -     
    +    +    -    -    rec.onerror = (e: any) => {
    +    +    -    -      /* 'no-speech' and 'aborted' are normal during pauses ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® auto-restart */
    +    +    -    -      if (e.error === 'no-speech' || e.error === 'aborted') {
    +    +    -    -        if (listeningRef.current) {
    +    +    -    -          try { rec.start(); } catch { /* already running */ }
    +    +    -    -        }
    +    +    -    -        return;
    +    +    -    -      }
    +    +    -    -      listeningRef.current = false;
    +    +    -    -      setListening(false);
    +    +    -    -    };
    +    +    -    +  /* Build a fresh SpeechRecognition (never reused) */
    +    +    -    +  const makeRec = useCallback(() => {
    +    +    -    +    if (!SpeechRecognition) return null;
    +    +    -    +    const r = new SpeechRecognition();
    +    +    -    +    r.continuous = true;
    +    +    -    +    r.interimResults = true;
    +    +    -    +    r.lang = 'en-US';
    +    +    -    +    return r;
    +    +    -    +  }, []);
    +    +    -     
    +    +    -    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    +    +    -    -    rec.onend = () => {
    +    +    -    -      if (listeningRef.current) {
    +    +    -    -        try { rec.start(); } catch { /* already running */ }
    +    +    -    -      } else {
    +    +    -    -        setListening(false);
    +    +    -    -      }
    +    +    -    -    };
    +    +    -    +  const stop = useCallback(() => {
    +    +    -    +    console.debug('[mic] stop()');
    +    +    -    +    genRef.current++;
    +    +    -    +    listeningRef.current = false;
    +    +    -    +    setListening(false);
    +    +    -    +    cancelRestart();
    +    +    -    +    killRec();
    +    +    -    +  }, [killRec, cancelRestart]);
    +    +    -     
    +    +    -    -    recognitionRef.current = rec;
    +    +    -    -    return () => {
    +    +    -    -      listeningRef.current = false;
    +    +    -    -      rec.abort();
    +    +    -    +  const start = useCallback(() => {
    +    +    -    +    if (!SpeechRecognition) return;
    +    +    -    +    console.debug('[mic] start()');
    +    +    -    +
    +    +    -    +    /* Tear down any previous instance */
    +    +    -    +    cancelRestart();
    +    +    -    +    killRec();
    +    +    -    +    netErrCount.current = 0;
    +    +    -    +
    +    +    -    +    const gen = ++genRef.current;
    +    +    -    +
    +    +    -    +    /**
    +    +    -    +     * Schedule a (re)start with a fresh SpeechRecognition instance.
    +    +    -    +     * Uses a delay to let Chrome fully release the network connection
    +    +    -    +     * from the previous instance.  Only ONE restart can be pending.
    +    +    -    +     */
    +    +    -    +    const scheduleStart = (delay: number) => {
    +    +    -    +      cancelRestart();
    +    +    -    +      restartTimer.current = setTimeout(() => {
    +    +    -    +        restartTimer.current = null;
    +    +    -    +        if (!listeningRef.current || genRef.current !== gen) return;
    +    +    -    +
    +    +    -    +        killRec();                        // ensure nothing lingering
    +    +    -    +        const r = makeRec();
    +    +    -    +        if (!r) return;
    +    +    -    +        recRef.current = r;
    +    +    -    +
    +    +    -    +        r.onresult = (e: any) => {
    +    +    -    +          netErrCount.current = 0;        // got results ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® connection is healthy
    +    +    -    +          let finalText = '';
    +    +    -    +          for (let i = e.resultIndex; i < e.results.length; i++) {
    +    +    -    +            if (e.results[i].isFinal) {
    +    +    -    +              finalText += e.results[i][0].transcript;
    +    +    -    +            }
    +    +    -    +          }
    +    +    -    +          if (finalText) {
    +    +    -    +            console.debug('[mic] transcript:', finalText.slice(0, 60));
    +    +    -    +            onResultRef.current(finalText);
    +    +    -    +          }
    +    +    -    +        };
    +    +    -    +
    +    +    -    +        r.onerror = (e: any) => {
    +    +    -    +          console.debug('[mic] error:', e.error);
    +    +    -    +          if (e.error === 'not-allowed') {
    +    +    -    +            genRef.current++;
    +    +    -    +            listeningRef.current = false;
    +    +    -    +            setListening(false);
    +    +    -    +            cancelRestart();
    +    +    -    +            killRec();
    +    +    -    +            return;
    +    +    -    +          }
    +    +    -    +          if (e.error === 'network') {
    +    +    -    +            netErrCount.current++;
    +    +    -    +            if (netErrCount.current > 3) {
    +    +    -    +              console.debug('[mic] too many network errors, giving up');
    +    +    -    +              genRef.current++;
    +    +    -    +              listeningRef.current = false;
    +    +    -    +              setListening(false);
    +    +    -    +              cancelRestart();
    +    +    -    +              killRec();
    +    +    -    +              return;
    +    +    -    +            }
    +    +    -    +          }
    +    +    -    +          /* Do NOT restart here ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® onend always fires after onerror
    +    +    -    +             and will handle the restart.  Restarting from both causes
    +    +    -    +             two competing instances ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ more network errors. */
    +    +    -    +        };
    +    +    -    +
    +    +    -    +        r.onend = () => {
    +    +    -    +          console.debug('[mic] onend, listening=', listeningRef.current, 'gen=', genRef.current === gen);
    +    +    -    +          if (listeningRef.current && genRef.current === gen) {
    +    +    -    +            /* Delay restart so Chrome fully tears down the connection.
    +    +    -    +               Longer delay after network errors to let things settle. */
    +    +    -    +            const d = netErrCount.current > 0 ? 800 : 300;
    +    +    -    +            console.debug('[mic] scheduling restart in', d, 'ms');
    +    +    -    +            scheduleStart(d);
    +    +    -    +          }
    +    +    -    +        };
    +    +    -    +
    +    +    -    +        try {
    +    +    -    +          r.start();
    +    +    -    +          console.debug('[mic] started OK');
    +    +    -    +        } catch (e) {
    +    +    -    +          console.debug('[mic] start threw:', e);
    +    +    -    +          listeningRef.current = false;
    +    +    -    +          setListening(false);
    +    +    -    +          cancelRestart();
    +    +    -    +          killRec();
    +    +    -    +        }
    +    +    -    +      }, delay);
    +    +    -         };
    +    +    -    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    +    +    -    -  }, []);
    +    +    -    +
    +    +    -    +    listeningRef.current = true;
    +    +    -    +    setListening(true);
    +    +    -    +    scheduleStart(50);                     // tiny initial delay
    +    +    -    +  }, [killRec, makeRec, cancelRestart]);
    +    +    -     
    +    +    -       const toggle = useCallback(() => {
    +    +    -    -    const rec = recognitionRef.current;
    +    +    -    -    if (!rec) return;
    +    +    -         if (listening) {
    +    +    -    -      listeningRef.current = false;
    +    +    -    -      rec.abort();
    +    +    -    -      setListening(false);
    +    +    -    +      stop();
    +    +    -         } else {
    +    +    -    -      listeningRef.current = true;
    +    +    -    -      rec.start();
    +    +    -    -      setListening(true);
    +    +    -    +      start();
    +    +    -         }
    +    +    -    -  }, [listening]);
    +    +    -    +  }, [listening, start, stop]);
    +    +    -    +
    +    +    -    +  /* Cleanup on unmount */
    +    +    -    +  useEffect(() => {
    +    +    -    +    return () => {
    +    +    -    +      genRef.current++;
    +    +    -    +      listeningRef.current = false;
    +    +    -    +      cancelRestart();
    +    +    -    +      killRec();
    +    +    -    +    };
    +    +    -    +  }, [killRec]);
    +    +    -     
    +    +    -       return { listening, toggle, supported: !!SpeechRecognition };
    +    +    -     }
    +    +    -     
    +    +    -    -function speak(text: string) {
    +    +    -    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    +    +    -    -  window.speechSynthesis.cancel();
    +    +    -    -  const utter = new SpeechSynthesisUtterance(text);
    +    +    -    -  utter.rate = 1.05;
    +    +    -    -  utter.pitch = 1;
    +    +    -    -  window.speechSynthesis.speak(utter);
    +    +    -    -}
    +    +    -    +
    +    +    -     
    +    +    -     /* ------------------------------------------------------------------ */
    +    +    -     /*  Progress bar                                                      */
    +    +    -    @@ -265,7 +361,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -       const [messages, setMessages] = useState<ChatMessage[]>([]);
    +    +    -       const [input, setInput] = useState('');
    +    +    -       const [sending, setSending] = useState(false);
    +    +    -    -  const [generating, setGenerating] = useState(false);
    +    +    -       const [qState, setQState] = useState<QuestionnaireState>({
    +    +    -         current_section: 'product_intent',
    +    +    -         completed_sections: [],
    +    +    -    @@ -273,9 +368,12 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -         is_complete: false,
    +    +    -       });
    +    +    -       const [error, setError] = useState('');
    +    +    -    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    +    +    -    +  const [resetting, setResetting] = useState(false);
    +    +    -    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    +    +    -    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    +    +    -       const messagesEndRef = useRef<HTMLDivElement>(null);
    +    +    -       const textareaRef = useRef<HTMLTextAreaElement>(null);
    +    +    -    +  const loadedRef = useRef(false);
    +    +    -     
    +    +    -       /* auto-scroll on new messages */
    +    +    -       useEffect(() => {
    +    +    -    @@ -294,6 +392,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -     
    +    +    -       /* ---- Load existing state on mount ---- */
    +    +    -       useEffect(() => {
    +    +    -    +    if (loadedRef.current) return;   // StrictMode double-mount guard
    +    +    -    +    loadedRef.current = true;
    +    +    -    +
    +    +    -         const load = async () => {
    +    +    -           try {
    +    +    -             const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire/state`, {
    +    +    -    @@ -307,13 +408,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -                 remaining_sections: state.remaining_sections,
    +    +    -                 is_complete: state.is_complete,
    +    +    -               });
    +    +    -    -          /* Restore prior conversation */
    +    +    -    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    +    +    -    -            (m: { role: string; content: string }) => ({
    +    +    -    -              role: m.role as 'user' | 'assistant',
    +    +    -    -              content: m.content,
    +    +    -    -            }),
    +    +    -    -          );
    +    +    -    +          /* Restore prior conversation ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® only messages from the current section */
    +    +    -    +          const currentSec = state.current_section;
    +    +    -    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    +    +    -    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    +    +    -    +            .map(
    +    +    -    +              (m: { role: string; content: string; section?: string }) => ({
    +    +    -    +                role: m.role as 'user' | 'assistant',
    +    +    -    +                content: m.content,
    +    +    -    +                section: m.section,
    +    +    -    +              }),
    +    +    -    +            );
    +    +    -    +          /* Restore token usage */
    +    +    -    +          if (state.token_usage) {
    +    +    -    +            setTokenUsage(state.token_usage);
    +    +    -    +          }
    +    +    -               if (history.length > 0) {
    +    +    -                 setMessages(history);
    +    +    -               } else if (!state.is_complete) {
    +    +    -    @@ -367,18 +476,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -           }
    +    +    -     
    +    +    -           const data = await res.json();
    +    +    -    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    +    +    -    +
    +    +    -    +      /* Detect section transition ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® clear visible messages for a fresh screen */
    +    +    -    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    +    +    -    +      const prevSection = qState.current_section;
    +    +    -    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    +    +    -    +
    +    +    -    +      if (sectionChanged) {
    +    +    -    +        /* Section just completed ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® start fresh with only the transition reply */
    +    +    -    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    +    +    -    +      } else {
    +    +    -    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    +    +    -    +      }
    +    +    -    +
    +    +    -           setQState({
    +    +    -    -        current_section: data.remaining_sections[0] ?? null,
    +    +    -    +        current_section: newCurrentSection,
    +    +    -             completed_sections: data.completed_sections,
    +    +    -             remaining_sections: data.remaining_sections,
    +    +    -             is_complete: data.is_complete,
    +    +    -           });
    +    +    -     
    +    +    -    -      /* auto-read assistant reply with TTS */
    +    +    -    -      if (voiceEnabled) {
    +    +    -    -        speak(data.reply);
    +    +    -    +      /* Update token usage */
    +    +    -    +      if (data.token_usage) {
    +    +    -    +        setTokenUsage(data.token_usage);
    +    +    -           }
    +    +    -    +
    +    +    -         } catch {
    +    +    -           setError('Network error');
    +    +    -         } finally {
    +    +    -    @@ -387,25 +509,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -       };
    +    +    -     
    +    +    -       /* ---- Generate contracts ---- */
    +    +    -    -  const handleGenerate = async () => {
    +    +    -    -    setGenerating(true);
    +    +    -    -    setError('');
    +    +    -    -    try {
    +    +    -    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    +    -    -        method: 'POST',
    +    +    -    -        headers: { Authorization: `Bearer ${token}` },
    +    +    -    -      });
    +    +    -    -      if (res.ok) {
    +    +    -    -        onContractsGenerated();
    +    +    -    -      } else {
    +    +    -    -        const d = await res.json().catch(() => ({}));
    +    +    -    -        setError(d.detail || 'Failed to generate contracts');
    +    +    -    -      }
    +    +    -    -    } catch {
    +    +    -    -      setError('Network error');
    +    +    -    -    } finally {
    +    +    -    -      setGenerating(false);
    +    +    -    -    }
    +    +    -    +  const handleStartGenerate = () => {
    +    +    -    +    setGeneratingContracts(true);
    +    +    -       };
    +    +    -     
    +    +    -       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    +    +    -    @@ -442,21 +547,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    +    +    -                       : 'Starting...'}
    +    +    -                 </p>
    +    +    -    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    +    +    -    +              Model: claude-haiku-4-5
    +    +    -    +            </p>
    +    +    -    +            {/* Context window meter */}
    +    +    -    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    +    +    -    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    +    -    +              const contextWindow = 200_000;
    +    +    -    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    +    +    -    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    +    +    -    +              return (
    +    +    -    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    +    +    -    +                  <div style={{
    +    +    -    +                    flex: 1,
    +    +    -    +                    height: '4px',
    +    +    -    +                    background: '#1E293B',
    +    +    -    +                    borderRadius: '2px',
    +    +    -    +                    overflow: 'hidden',
    +    +    -    +                    maxWidth: '120px',
    +    +    -    +                  }}>
    +    +    -    +                    <div style={{
    +    +    -    +                      width: `${pct}%`,
    +    +    -    +                      height: '100%',
    +    +    -    +                      background: barColor,
    +    +    -    +                      borderRadius: '2px',
    +    +    -    +                      transition: 'width 0.3s',
    +    +    -    +                    }} />
    +    +    -    +                  </div>
    +    +    -    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    +    +    -    +                    {totalTokens.toLocaleString()} / 200K
    +    +    -    +                  </span>
    +    +    -    +                </div>
    +    +    -    +              );
    +    +    -    +            })()}
    +    +    -               </div>
    +    +    -               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    +    +    -    -            {/* Voice toggle */}
    +    +    -    +            {/* Restart questionnaire */}
    +    +    -                 <button
    +    +    -    -              onClick={() => setVoiceEnabled((v) => !v)}
    +    +    -    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    +    +    -    -              data-testid="voice-toggle"
    +    +    -    +              onClick={async () => {
    +    +    -    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    +    +    -    +                setResetting(true);
    +    +    -    +                try {
    +    +    -    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    +    +    -    +                    method: 'DELETE',
    +    +    -    +                    headers: { Authorization: `Bearer ${token}` },
    +    +    -    +                  });
    +    +    -    +                  if (res.ok) {
    +    +    -    +                    setMessages([]);
    +    +    -    +                    setQState({
    +    +    -    +                      current_section: 'product_intent',
    +    +    -    +                      completed_sections: [],
    +    +    -    +                      remaining_sections: [...ALL_SECTIONS],
    +    +    -    +                      is_complete: false,
    +    +    -    +                    });
    +    +    -    +                    setInput('');
    +    +    -    +                    setError('');
    +    +    -    +                  }
    +    +    -    +                } catch { /* ignore */ }
    +    +    -    +                setResetting(false);
    +    +    -    +              }}
    +    +    -    +              disabled={resetting}
    +    +    -    +              title="Restart questionnaire"
    +    +    -    +              data-testid="restart-btn"
    +    +    -                   style={{
    +    +    -                     ...btnGhost,
    +    +    -                     padding: '6px 10px',
    +    +    -    -                fontSize: '1rem',
    +    +    -    -                opacity: voiceEnabled ? 1 : 0.5,
    +    +    -    +                fontSize: '0.7rem',
    +    +    -    +                fontWeight: 600,
    +    +    -    +                color: '#F59E0B',
    +    +    -    +                borderColor: '#F59E0B33',
    +    +    -    +                opacity: resetting ? 0.5 : 1,
    +    +    -                   }}
    +    +    -                 >
    +    +    -    -              {voiceEnabled ? '├ö├Â┬╝Ôö¼├¡Ôö£├║Ôö£├Ñ├ö├Â┬úÔö£├®├ö├Â┬úÔö¼ÔöÉ' : '├ö├Â┬╝Ôö¼├¡Ôö£├║Ôö£├Ñ├ö├Â┬úÔö£├®├ö├Â┬úÔö¼Ôòæ'}
    +    +    -    +              ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ªÔö£├ÂÔö£ÔûôÔö£Ôòú Restart
    +    +    -                 </button>
    +    +    -                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    +    +    -                   ├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├╗├┤
    +    +    -    @@ -514,8 +677,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -               </div>
    +    +    -             )}
    +    +    -     
    +    +    -    +        {/* Contract generation progress */}
    +    +    -    +        {generatingContracts && (
    +    +    -    +          <ContractProgress
    +    +    -    +            projectId={projectId}
    +    +    -    +            tokenUsage={tokenUsage}
    +    +    -    +            model="claude-haiku-4-5"
    +    +    -    +            onComplete={onContractsGenerated}
    +    +    -    +          />
    +    +    -    +        )}
    +    +    -    +
    +    +    -             {/* Generate contracts banner */}
    +    +    -    -        {qState.is_complete && (
    +    +    -    +        {qState.is_complete && !generatingContracts && (
    +    +    -               <div
    +    +    -                 style={{
    +    +    -                   padding: '12px 20px',
    +    +    -    @@ -533,17 +706,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    +    -                   ├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├Â├▒ All sections complete ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® ready to generate contracts
    +    +    -                 </span>
    +    +    -                 <button
    +    +    -    -              onClick={handleGenerate}
    +    +    -    -              disabled={generating}
    +    +    -    +              onClick={handleStartGenerate}
    +    +    -                   data-testid="generate-contracts-btn"
    +    +    -                   style={{
    +    +    -                     ...btnPrimary,
    +    +    -                     background: '#16A34A',
    +    +    -    -                opacity: generating ? 0.6 : 1,
    +    +    -    -                cursor: generating ? 'wait' : 'pointer',
    +    +    -    +                cursor: 'pointer',
    +    +    -                   }}
    +    +    -                 >
    +    +    -    -              {generating ? 'Generating...' : 'Generate Contracts'}
    +    +    -    +              Generate Contracts
    +    +    -                 </button>
    +    +    -               </div>
    +    +    -             )}
    +    +    -    diff --git a/web/src/context/AuthContext.tsx b/web/src/context/AuthContext.tsx
    +    +    -    index 3f217e2..0430bc8 100644
    +    +    -    --- a/web/src/context/AuthContext.tsx
    +    +    -    +++ b/web/src/context/AuthContext.tsx
    +    +    -    @@ -4,6 +4,7 @@ interface User {
    +    +    -       id: string;
    +    +    -       github_login: string;
    +    +    -       avatar_url: string | null;
    +    +    -    +  has_anthropic_key?: boolean;
    +    +    -     }
    +    +    -     
    +    +    -     interface AuthContextValue {
    +    +    -    @@ -11,6 +12,7 @@ interface AuthContextValue {
    +    +    -       user: User | null;
    +    +    -       login: (token: string, user: User) => void;
    +    +    -       logout: () => void;
    +    +    -    +  updateUser: (patch: Partial<User>) => void;
    +    +    -     }
    +    +    -     
    +    +    -     const AuthContext = createContext<AuthContextValue | null>(null);
    +    +    -    @@ -38,6 +40,15 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    +    +    -         localStorage.removeItem('forgeguard_user');
    +    +    -       };
    +    +    -     
    +    +    -    +  const updateUser = (patch: Partial<User>) => {
    +    +    -    +    setUser((prev) => {
    +    +    -    +      if (!prev) return prev;
    +    +    -    +      const updated = { ...prev, ...patch };
    +    +    -    +      localStorage.setItem('forgeguard_user', JSON.stringify(updated));
    +    +    -    +      return updated;
    +    +    -    +    });
    +    +    -    +  };
    +    +    -    +
    +    +    -       useEffect(() => {
    +    +    -         if (!token) return;
    +    +    -         // Validate token on mount by calling /auth/me
    +    +    -    @@ -53,7 +64,7 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    +    +    -       }, []); // eslint-disable-line react-hooks/exhaustive-deps
    +    +    -     
    +    +    -       return (
    +    +    -    -    <AuthContext.Provider value={{ token, user, login, logout }}>
    +    +    -    +    <AuthContext.Provider value={{ token, user, login, logout, updateUser }}>
    +    +    -           {children}
    +    +    -         </AuthContext.Provider>
    +    +    -       );
    +    +    -    diff --git a/web/src/pages/BuildComplete.tsx b/web/src/pages/BuildComplete.tsx
    +    +    -    index e419947..19ece0f 100644
    +    +    -    --- a/web/src/pages/BuildComplete.tsx
    +    +    -    +++ b/web/src/pages/BuildComplete.tsx
    +    +    -    @@ -184,6 +184,7 @@ export default function BuildComplete() {
    +    +    -               <h3 style={{ color: '#F8FAFC', margin: '0 0 12px' }}>Token Usage by Phase</h3>
    +    +    -               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', borderBottom: '1px solid #334155', color: '#94A3B8', fontSize: 13 }}>
    +    +    -                 <span style={{ flex: 2 }}>Phase</span>
    +    +    -    +            <span style={{ flex: 1 }}>Model</span>
    +    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>Input</span>
    +    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>Output</span>
    +    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>Cost</span>
    +    +    -    @@ -191,6 +192,7 @@ export default function BuildComplete() {
    +    +    -               {summary.cost.phases.map((entry, i) => (
    +    +    -                 <div key={i} style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #1E293B', color: '#F8FAFC', fontSize: 14 }}>
    +    +    -                   <span style={{ flex: 2 }}>{entry.phase}</span>
    +    +    -    +              <span style={{ flex: 1, color: '#A78BFA', fontSize: 12 }}>{entry.model.replace('claude-', '')}</span>
    +    +    -                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.input_tokens)}</span>
    +    +    -                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.output_tokens)}</span>
    +    +    -                   <span style={{ flex: 1, textAlign: 'right' }}>${entry.estimated_cost_usd.toFixed(4)}</span>
    +    +    -    @@ -198,6 +200,7 @@ export default function BuildComplete() {
    +    +    -               ))}
    +    +    -               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0 0', color: '#F8FAFC', fontWeight: 600, fontSize: 14 }}>
    +    +    -                 <span style={{ flex: 2 }}>Total</span>
    +    +    -    +            <span style={{ flex: 1 }}></span>
    +    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_input_tokens)}</span>
    +    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_output_tokens)}</span>
    +    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>${summary.cost.total_cost_usd.toFixed(4)}</span>
    +    +    -    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    +    +    -    index a4f1808..021b634 100644
    +    +    -    --- a/web/src/pages/BuildProgress.tsx
    +    +    -    +++ b/web/src/pages/BuildProgress.tsx
    +    +    -    @@ -1,25 +1,49 @@
    +    +    -     /**
    +    +    -      * BuildProgress -- real-time build progress visualization.
    +    +    -    - * Shows phase progress bar, streaming logs, audit results, and cancel button.
    +    +    -    + *
    +    +    -    + * Two-column layout:
    +    +    -    + *   Left  (40%) ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Phase checklist with summaries, status icons, per-phase tokens
    +    +    -    + *   Right (60%) ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® Token/cost metrics card, live activity feed, cancel button
    +    +    -    + *
    +    +    -    + * All data streamed via WebSocket; initial state fetched from REST.
    +    +    -      */
    +    +    -    -import { useState, useEffect, useCallback } from 'react';
    +    +    -    +import { useState, useEffect, useRef, useCallback } from 'react';
    +    +    -     import { useParams, useNavigate } from 'react-router-dom';
    +    +    -     import { useAuth } from '../context/AuthContext';
    +    +    -     import { useToast } from '../context/ToastContext';
    +    +    -     import { useWebSocket } from '../hooks/useWebSocket';
    +    +    -     import AppShell from '../components/AppShell';
    +    +    -    -import PhaseProgressBar from '../components/PhaseProgressBar';
    +    +    -    -import type { Phase } from '../components/PhaseProgressBar';
    +    +    -    -import BuildLogViewer from '../components/BuildLogViewer';
    +    +    -    -import type { LogEntry } from '../components/BuildLogViewer';
    +    +    -    -import BuildAuditCard from '../components/BuildAuditCard';
    +    +    -    -import type { AuditCheck } from '../components/BuildAuditCard';
    +    +    -     import ConfirmDialog from '../components/ConfirmDialog';
    +    +    -     import EmptyState from '../components/EmptyState';
    +    +    -     import Skeleton from '../components/Skeleton';
    +    +    -     
    +    +    -     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -     
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Pricing ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® matches backend _MODEL_PRICING                          */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -    +const MODEL_PRICING: Record<string, { input: number; output: number }> = {
    +    +    -    +  'claude-opus-4':     { input: 15 / 1_000_000, output: 75 / 1_000_000 },
    +    +    -    +  'claude-sonnet-4':   { input: 3 / 1_000_000,  output: 15 / 1_000_000 },
    +    +    -    +  'claude-haiku-4':    { input: 1 / 1_000_000,  output: 5 / 1_000_000 },
    +    +    -    +  'claude-3-5-sonnet': { input: 3 / 1_000_000,  output: 15 / 1_000_000 },
    +    +    -    +};
    +    +    -    +const DEFAULT_PRICING = { input: 15 / 1_000_000, output: 75 / 1_000_000 };
    +    +    -    +
    +    +    -    +function getTokenCost(model: string, input: number, output: number): number {
    +    +    -    +  for (const [prefix, rates] of Object.entries(MODEL_PRICING)) {
    +    +    -    +    if (model.startsWith(prefix)) {
    +    +    -    +      return input * rates.input + output * rates.output;
    +    +    -    +    }
    +    +    -    +  }
    +    +    -    +  return input * DEFAULT_PRICING.input + output * DEFAULT_PRICING.output;
    +    +    -    +}
    +    +    -    +
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Types                                                             */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -     interface BuildStatus {
    +    +    -       id: string;
    +    +    -       project_id: string;
    +    +    -    @@ -32,140 +56,389 @@ interface BuildStatus {
    +    +    -       created_at: string;
    +    +    -     }
    +    +    -     
    +    +    -    -interface AuditResult {
    +    +    -    -  phase: string;
    +    +    -    -  iteration: number;
    +    +    -    -  overall: string;
    +    +    -    -  checks: AuditCheck[];
    +    +    -    +interface PhaseDefinition {
    +    +    -    +  number: number;
    +    +    -    +  name: string;
    +    +    -    +  objective: string;
    +    +    -    +  deliverables: string[];
    +    +    -     }
    +    +    -     
    +    +    -    +type PhaseStatus = 'pending' | 'active' | 'pass' | 'fail';
    +    +    -    +
    +    +    -    +interface PhaseState {
    +    +    -    +  def: PhaseDefinition;
    +    +    -    +  status: PhaseStatus;
    +    +    -    +  input_tokens: number;
    +    +    -    +  output_tokens: number;
    +    +    -    +  elapsed_ms: number;
    +    +    -    +}
    +    +    -    +
    +    +    -    +interface ActivityEntry {
    +    +    -    +  time: string;
    +    +    -    +  message: string;
    +    +    -    +  level: 'info' | 'warn' | 'error' | 'system';
    +    +    -    +}
    +    +    -    +
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Styles                                                            */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -    +const pageStyle: React.CSSProperties = {
    +    +    -    +  padding: '24px',
    +    +    -    +  maxWidth: '1280px',
    +    +    -    +  margin: '0 auto',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const twoColStyle: React.CSSProperties = {
    +    +    -    +  display: 'grid',
    +    +    -    +  gridTemplateColumns: '2fr 3fr',
    +    +    -    +  gap: '20px',
    +    +    -    +  alignItems: 'start',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const cardStyle: React.CSSProperties = {
    +    +    -    +  background: '#1E293B',
    +    +    -    +  borderRadius: '8px',
    +    +    -    +  padding: '16px 20px',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const phaseRowStyle = (isActive: boolean): React.CSSProperties => ({
    +    +    -    +  display: 'flex',
    +    +    -    +  gap: '10px',
    +    +    -    +  padding: '10px 12px',
    +    +    -    +  borderRadius: '6px',
    +    +    -    +  background: isActive ? '#1E3A5F' : 'transparent',
    +    +    -    +  borderLeft: isActive ? '3px solid #2563EB' : '3px solid transparent',
    +    +    -    +  transition: 'background 0.2s',
    +    +    -    +  cursor: 'pointer',
    +    +    -    +});
    +    +    -    +
    +    +    -    +const metricBoxStyle: React.CSSProperties = {
    +    +    -    +  display: 'flex',
    +    +    -    +  flexDirection: 'column',
    +    +    -    +  gap: '2px',
    +    +    -    +  flex: 1,
    +    +    -    +  minWidth: '100px',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const feedStyle: React.CSSProperties = {
    +    +    -    +  background: '#0B1120',
    +    +    -    +  borderRadius: '8px',
    +    +    -    +  border: '1px solid #1E293B',
    +    +    -    +  padding: '12px 16px',
    +    +    -    +  maxHeight: '420px',
    +    +    -    +  overflowY: 'auto',
    +    +    -    +  fontFamily: 'monospace',
    +    +    -    +  fontSize: '0.72rem',
    +    +    -    +  lineHeight: 1.7,
    +    +    -    +};
    +    +    -    +
    +    +    -    +const LEVEL_COLOR: Record<string, string> = {
    +    +    -    +  info: '#F8FAFC',
    +    +    -    +  warn: '#EAB308',
    +    +    -    +  error: '#EF4444',
    +    +    -    +  system: '#2563EB',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const STATUS_ICON: Record<PhaseStatus, string> = {
    +    +    -    +  pending: '├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö¼Ôòù',
    +    +    -    +  active: '├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£┬¢',
    +    +    -    +  pass: '├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£├í',
    +    +    -    +  fail: '├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├╗├┤',
    +    +    -    +};
    +    +    -    +
    +    +    -    +const STATUS_COLOR: Record<PhaseStatus, string> = {
    +    +    -    +  pending: '#475569',
    +    +    -    +  active: '#2563EB',
    +    +    -    +  pass: '#22C55E',
    +    +    -    +  fail: '#EF4444',
    +    +    -    +};
    +    +    -    +
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +/*  Component                                                         */
    +    +    -    +/* ------------------------------------------------------------------ */
    +    +    -    +
    +    +    -     function BuildProgress() {
    +    +    -       const { projectId } = useParams<{ projectId: string }>();
    +    +    -       const { token } = useAuth();
    +    +    -       const { addToast } = useToast();
    +    +    -       const navigate = useNavigate();
    +    +    -     
    +    +    -    +  /* State */
    +    +    -       const [build, setBuild] = useState<BuildStatus | null>(null);
    +    +    -    -  const [logs, setLogs] = useState<LogEntry[]>([]);
    +    +    -    -  const [auditResults, setAuditResults] = useState<AuditResult[]>([]);
    +    +    -    +  const [phaseDefs, setPhaseDefs] = useState<PhaseDefinition[]>([]);
    +    +    -    +  const [phaseStates, setPhaseStates] = useState<Map<number, PhaseState>>(new Map());
    +    +    -    +  const [activity, setActivity] = useState<ActivityEntry[]>([]);
    +    +    -    +  const [totalTokens, setTotalTokens] = useState({ input: 0, output: 0 });
    +    +    -       const [loading, setLoading] = useState(true);
    +    +    -       const [noBuild, setNoBuild] = useState(false);
    +    +    -       const [showCancelConfirm, setShowCancelConfirm] = useState(false);
    +    +    -    +  const [expandedPhase, setExpandedPhase] = useState<number | null>(null);
    +    +    -    +  const [startTime] = useState(() => Date.now());
    +    +    -    +  const [elapsed, setElapsed] = useState(0);
    +    +    -    +  const feedEndRef = useRef<HTMLDivElement>(null);
    +    +    -    +  const phaseStartRef = useRef<number>(Date.now());
    +    +    -    +
    +    +    -    +  /* ------ helpers ------ */
    +    +    -    +
    +    +    -    +  const addActivity = useCallback((msg: string, level: ActivityEntry['level'] = 'info') => {
    +    +    -    +    const time = new Date().toLocaleTimeString('en-GB', { hour12: false });
    +    +    -    +    setActivity((prev) => [...prev, { time, message: msg, level }]);
    +    +    -    +  }, []);
    +    +    -     
    +    +    -    -  // Parse phase number from phase string like "Phase 3"
    +    +    -       const parsePhaseNum = (phaseStr: string): number => {
    +    +    -    -    const match = phaseStr.match(/\d+/);
    +    +    -    -    return match ? parseInt(match[0], 10) : 0;
    +    +    -    +    const m = phaseStr.match(/\d+/);
    +    +    -    +    return m ? parseInt(m[0], 10) : 0;
    +    +    -       };
    +    +    -     
    +    +    -    -  // Generate phases array for the progress bar
    +    +    -    -  const generatePhases = useCallback((): Phase[] => {
    +    +    -    -    if (!build) return [];
    +    +    -    -    const totalPhases = 12; // Phase 0-11
    +    +    -    -    const currentPhase = parsePhaseNum(build.phase);
    +    +    -    -    const phases: Phase[] = [];
    +    +    -    -    for (let i = 0; i <= totalPhases - 1; i++) {
    +    +    -    -      let status: Phase['status'] = 'pending';
    +    +    -    -      if (i < currentPhase) status = 'pass';
    +    +    -    -      else if (i === currentPhase) {
    +    +    -    -        if (build.status === 'completed') status = 'pass';
    +    +    -    -        else if (build.status === 'failed') status = 'fail';
    +    +    -    -        else status = 'active';
    +    +    -    -      }
    +    +    -    -      phases.push({ label: `P${i}`, status });
    +    +    -    -    }
    +    +    -    -    return phases;
    +    +    -    -  }, [build]);
    +    +    -    +  /* ------ auto-scroll feed ------ */
    +    +    -    +  useEffect(() => {
    +    +    -    +    feedEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    +    +    -    +  }, [activity]);
    +    +    -    +
    +    +    -    +  /* ------ elapsed timer ------ */
    +    +    -    +  useEffect(() => {
    +    +    -    +    if (!build || !['pending', 'running'].includes(build.status)) return;
    +    +    -    +    const ref = build.started_at ? new Date(build.started_at).getTime() : startTime;
    +    +    -    +    const iv = setInterval(() => setElapsed(Math.floor((Date.now() - ref) / 1000)), 1000);
    +    +    -    +    return () => clearInterval(iv);
    +    +    -    +  }, [build, startTime]);
    +    +    -     
    +    +    -    -  // Fetch initial build status
    +    +    -    +  /* ------ fetch initial data ------ */
    +    +    -       useEffect(() => {
    +    +    -    -    const fetchBuild = async () => {
    +    +    -    +    const load = async () => {
    +    +    -           try {
    +    +    -    -        const res = await fetch(`${API_BASE}/projects/${projectId}/build/status`, {
    +    +    -    -          headers: { Authorization: `Bearer ${token}` },
    +    +    -    -        });
    +    +    -    -        if (res.ok) {
    +    +    -    -          setBuild(await res.json());
    +    +    -    -        } else if (res.status === 400) {
    +    +    -    +        const [statusRes, phasesRes, logsRes] = await Promise.all([
    +    +    -    +          fetch(`${API_BASE}/projects/${projectId}/build/status`, {
    +    +    -    +            headers: { Authorization: `Bearer ${token}` },
    +    +    -    +          }),
    +    +    -    +          fetch(`${API_BASE}/projects/${projectId}/build/phases`, {
    +    +    -    +            headers: { Authorization: `Bearer ${token}` },
    +    +    -    +          }),
    +    +    -    +          fetch(`${API_BASE}/projects/${projectId}/build/logs?limit=500`, {
    +    +    -    +            headers: { Authorization: `Bearer ${token}` },
    +    +    -    +          }),
    +    +    -    +        ]);
    +    +    -    +
    +    +    -    +        if (statusRes.status === 400) {
    +    +    -               setNoBuild(true);
    +    +    -    +          setLoading(false);
    +    +    -    +          return;
    +    +    -    +        }
    +    +    -    +
    +    +    -    +        if (statusRes.ok) {
    +    +    -    +          const buildData: BuildStatus = await statusRes.json();
    +    +    -    +          setBuild(buildData);
    +    +    -    +
    +    +    -    +          /* Seed activity from historical logs */
    +    +    -    +          if (logsRes.ok) {
    +    +    -    +            const logData = await logsRes.json();
    +    +    -    +            const items = (logData.items ?? []) as {
    +    +    -    +              timestamp: string;
    +    +    -    +              message: string;
    +    +    -    +              level: string;
    +    +    -    +            }[];
    +    +    -    +            setActivity(
    +    +    -    +              items.map((l) => ({
    +    +    -    +                time: new Date(l.timestamp).toLocaleTimeString('en-GB', { hour12: false }),
    +    +    -    +                message: l.message,
    +    +    -    +                level: (l.level ?? 'info') as ActivityEntry['level'],
    +    +    -    +              })),
    +    +    -    +            );
    +    +    -    +          }
    +    +    -    +
    +    +    -    +          /* Seed token totals from cost summary */
    +    +    -    +          try {
    +    +    -    +            const costRes = await fetch(`${API_BASE}/projects/${projectId}/build/summary`, {
    +    +    -    +              headers: { Authorization: `Bearer ${token}` },
    +    +    -    +            });
    +    +    -    +            if (costRes.ok) {
    +    +    -    +              const costData = await costRes.json();
    +    +    -    +              setTotalTokens({
    +    +    -    +                input: costData.cost?.total_input_tokens ?? 0,
    +    +    -    +                output: costData.cost?.total_output_tokens ?? 0,
    +    +    -    +              });
    +    +    -    +            }
    +    +    -    +          } catch { /* best effort */ }
    +    +    -             } else {
    +    +    -    -          addToast('Failed to load build status');
    +    +    -    +          addToast('Failed to load build');
    +    +    -    +        }
    +    +    -    +
    +    +    -    +        /* Phase definitions */
    +    +    -    +        if (phasesRes.ok) {
    +    +    -    +          const defs: PhaseDefinition[] = await phasesRes.json();
    +    +    -    +          setPhaseDefs(defs);
    +    +    -    +
    +    +    -    +          /* Build initial phase states from current build status */
    +    +    -    +          const statusData: BuildStatus | null = statusRes.ok ? await statusRes.json().catch(() => null) : null;
    +    +    -    +          const currentPhaseNum = statusData ? parsePhaseNum(statusData.phase) : 0;
    +    +    -    +
    +    +    -    +          const map = new Map<number, PhaseState>();
    +    +    -    +          for (const def of defs) {
    +    +    -    +            let status: PhaseStatus = 'pending';
    +    +    -    +            if (statusData) {
    +    +    -    +              if (def.number < currentPhaseNum) status = 'pass';
    +    +    -    +              else if (def.number === currentPhaseNum) {
    +    +    -    +                if (statusData.status === 'completed') status = 'pass';
    +    +    -    +                else if (statusData.status === 'failed') status = 'fail';
    +    +    -    +                else status = 'active';
    +    +    -    +              }
    +    +    -    +            }
    +    +    -    +            map.set(def.number, {
    +    +    -    +              def,
    +    +    -    +              status,
    +    +    -    +              input_tokens: 0,
    +    +    -    +              output_tokens: 0,
    +    +    -    +              elapsed_ms: 0,
    +    +    -    +            });
    +    +    -    +          }
    +    +    -    +          setPhaseStates(map);
    +    +    -             }
    +    +    -           } catch {
    +    +    -    -        addToast('Network error loading build status');
    +    +    -    +        addToast('Network error loading build');
    +    +    -           } finally {
    +    +    -             setLoading(false);
    +    +    -           }
    +    +    -         };
    +    +    -    -    fetchBuild();
    +    +    -    +    load();
    +    +    -       }, [projectId, token, addToast]);
    +    +    -     
    +    +    -    -  // Fetch initial logs
    +    +    -    -  useEffect(() => {
    +    +    -    -    if (!build) return;
    +    +    -    -    const fetchLogs = async () => {
    +    +    -    -      try {
    +    +    -    -        const res = await fetch(`${API_BASE}/projects/${projectId}/build/logs?limit=500`, {
    +    +    -    -          headers: { Authorization: `Bearer ${token}` },
    +    +    -    -        });
    +    +    -    -        if (res.ok) {
    +    +    -    -          const data = await res.json();
    +    +    -    -          setLogs(data.items ?? []);
    +    +    -    -        }
    +    +    -    -      } catch {
    +    +    -    -        /* best effort */
    +    +    -    -      }
    +    +    -    -    };
    +    +    -    -    fetchLogs();
    +    +    -    -  }, [build?.id, projectId, token]);
    +    +    -    -
    +    +    -    -  // Handle WebSocket events
    +    +    -    +  /* ------ WebSocket handler ------ */
    +    +    -       useWebSocket(
    +    +    -         useCallback(
    +    +    -           (data) => {
    +    +    -             const payload = data.payload as Record<string, unknown>;
    +    +    -    -        const eventProjectId = payload.project_id as string;
    +    +    -    -        if (eventProjectId !== projectId) return;
    +    +    -    +        const eventPid = payload.project_id as string;
    +    +    -    +        if (eventPid && eventPid !== projectId) return;
    +    +    -     
    +    +    -             switch (data.type) {
    +    +    -    -          case 'build_started':
    +    +    -    -            setBuild(payload.build as BuildStatus);
    +    +    -    +          case 'build_started': {
    +    +    -    +            setBuild(payload.build as BuildStatus ?? payload as unknown as BuildStatus);
    +    +    -                 setNoBuild(false);
    +    +    -    +            addActivity('Build started', 'system');
    +    +    -    +
    +    +    -    +            /* Set all phases to pending, first phase active */
    +    +    -    +            setPhaseStates((prev) => {
    +    +    -    +              const next = new Map(prev);
    +    +    -    +              for (const [num, ps] of next) {
    +    +    -    +                next.set(num, { ...ps, status: num === 0 ? 'active' : 'pending' });
    +    +    -    +              }
    +    +    -    +              return next;
    +    +    -    +            });
    +    +    -    +            phaseStartRef.current = Date.now();
    +    +    -                 break;
    +    +    -    +          }
    +    +    -    +
    +    +    -               case 'build_log': {
    +    +    -    -            const log = payload as unknown as LogEntry;
    +    +    -    -            setLogs((prev) => [...prev, log]);
    +    +    -    +            const msg = (payload.message ?? payload.msg ?? '') as string;
    +    +    -    +            const lvl = (payload.level ?? 'info') as ActivityEntry['level'];
    +    +    -    +            if (msg) addActivity(msg, lvl);
    +    +    -    +            break;
    +    +    -    +          }
    +    +    -    +
    +    +    -    +          case 'phase_complete': {
    +    +    -    +            const phase = payload.phase as string;
    +    +    -    +            const phaseNum = parsePhaseNum(phase);
    +    +    -    +            const inTok = (payload.input_tokens ?? 0) as number;
    +    +    -    +            const outTok = (payload.output_tokens ?? 0) as number;
    +    +    -    +            const elapsed_ms = Date.now() - phaseStartRef.current;
    +    +    -    +
    +    +    -    +            addActivity(`├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├Â├▒ ${phase} complete (${inTok.toLocaleString()} in / ${outTok.toLocaleString()} out)`, 'system');
    +    +    -    +
    +    +    -    +            /* Accumulate total tokens */
    +    +    -    +            setTotalTokens((prev) => ({
    +    +    -    +              input: prev.input + inTok,
    +    +    -    +              output: prev.output + outTok,
    +    +    -    +            }));
    +    +    -    +
    +    +    -    +            /* Update phase states: mark this phase pass, next phase active */
    +    +    -    +            setPhaseStates((prev) => {
    +    +    -    +              const next = new Map(prev);
    +    +    -    +              const current = next.get(phaseNum);
    +    +    -    +              if (current) {
    +    +    -    +                next.set(phaseNum, {
    +    +    -    +                  ...current,
    +    +    -    +                  status: 'pass',
    +    +    -    +                  input_tokens: inTok,
    +    +    -    +                  output_tokens: outTok,
    +    +    -    +                  elapsed_ms,
    +    +    -    +                });
    +    +    -    +              }
    +    +    -    +              /* Mark next phase active */
    +    +    -    +              const nextPhase = next.get(phaseNum + 1);
    +    +    -    +              if (nextPhase && nextPhase.status === 'pending') {
    +    +    -    +                next.set(phaseNum + 1, { ...nextPhase, status: 'active' });
    +    +    -    +              }
    +    +    -    +              return next;
    +    +    -    +            });
    +    +    -    +
    +    +    -    +            setBuild((prev) => prev ? { ...prev, phase: phase } : prev);
    +    +    -    +            phaseStartRef.current = Date.now();
    +    +    -                 break;
    +    +    -               }
    +    +    -    -          case 'phase_complete':
    +    +    -    -          case 'build_complete':
    +    +    -    -          case 'build_error':
    +    +    -    -          case 'build_cancelled':
    +    +    -    -            setBuild(payload.build as BuildStatus);
    +    +    -    -            if (data.type === 'build_complete') {
    +    +    -    -              addToast('Build completed successfully!', 'success');
    +    +    -    -              navigate(`/projects/${projectId}/build/complete`);
    +    +    -    -            } else if (data.type === 'build_error') {
    +    +    -    -              addToast('Build failed: ' + (payload.error ?? 'Unknown error'));
    +    +    -    +
    +    +    -    +          case 'build_complete': {
    +    +    -    +            setBuild((prev) => prev ? { ...prev, status: 'completed' } : prev);
    +    +    -    +            const totalIn = (payload.total_input_tokens ?? 0) as number;
    +    +    -    +            const totalOut = (payload.total_output_tokens ?? 0) as number;
    +    +    -    +            if (totalIn || totalOut) {
    +    +    -    +              setTotalTokens({ input: totalIn, output: totalOut });
    +    +    -                 }
    +    +    -    +            addActivity('Build completed successfully!', 'system');
    +    +    -    +
    +    +    -    +            /* Mark all phases as pass */
    +    +    -    +            setPhaseStates((prev) => {
    +    +    -    +              const next = new Map(prev);
    +    +    -    +              for (const [num, ps] of next) {
    +    +    -    +                if (ps.status !== 'fail') next.set(num, { ...ps, status: 'pass' });
    +    +    -    +              }
    +    +    -    +              return next;
    +    +    -    +            });
    +    +    -    +            addToast('Build completed!', 'success');
    +    +    -    +            break;
    +    +    -    +          }
    +    +    -    +
    +    +    -    +          case 'build_error': {
    +    +    -    +            setBuild((prev) => prev ? { ...prev, status: 'failed', error_detail: (payload.error_detail ?? payload.error ?? '') as string } : prev);
    +    +    -    +            addActivity(`Build failed: ${payload.error_detail ?? payload.error ?? 'Unknown error'}`, 'error');
    +    +    -    +
    +    +    -    +            /* Mark current active phase as fail */
    +    +    -    +            setPhaseStates((prev) => {
    +    +    -    +              const next = new Map(prev);
    +    +    -    +              for (const [num, ps] of next) {
    +    +    -    +                if (ps.status === 'active') next.set(num, { ...ps, status: 'fail' });
    +    +    -    +              }
    +    +    -    +              return next;
    +    +    -    +            });
    +    +    -                 break;
    +    +    -    -          case 'audit_pass':
    +    +    -    +          }
    +    +    -    +
    +    +    -    +          case 'build_cancelled': {
    +    +    -    +            setBuild((prev) => prev ? { ...prev, status: 'cancelled' } : prev);
    +    +    -    +            addActivity('Build cancelled by user', 'warn');
    +    +    -    +            break;
    +    +    -    +          }
    +    +    -    +
    +    +    -    +          case 'audit_pass': {
    +    +    -    +            const phase = payload.phase as string;
    +    +    -    +            addActivity(`Audit PASS for ${phase}`, 'system');
    +    +    -    +            break;
    +    +    -    +          }
    +    +    -    +
    +    +    -               case 'audit_fail': {
    +    +    -    -            const result: AuditResult = {
    +    +    -    -              phase: (payload.phase as string) ?? '',
    +    +    -    -              iteration: (payload.iteration as number) ?? 1,
    +    +    -    -              overall: data.type === 'audit_pass' ? 'PASS' : 'FAIL',
    +    +    -    -              checks: (payload.checks as AuditCheck[]) ?? [],
    +    +    -    -            };
    +    +    -    -            setAuditResults((prev) => [...prev, result]);
    +    +    -    +            const phase = payload.phase as string;
    +    +    -    +            const loop = payload.loop_count as number;
    +    +    -    +            addActivity(`Audit FAIL for ${phase} (loop ${loop})`, 'warn');
    +    +    -                 break;
    +    +    -               }
    +    +    -             }
    +    +    -           },
    +    +    -    -      [projectId, addToast],
    +    +    -    +      [projectId, addActivity, addToast],
    +    +    -         ),
    +    +    -       );
    +    +    -     
    +    +    -    +  /* ------ actions ------ */
    +    +    -    +
    +    +    -       const handleCancel = async () => {
    +    +    -         try {
    +    +    -           const res = await fetch(`${API_BASE}/projects/${projectId}/build/cancel`, {
    +    +    -    @@ -195,8 +468,8 @@ function BuildProgress() {
    +    +    -             const newBuild = await res.json();
    +    +    -             setBuild(newBuild);
    +    +    -             setNoBuild(false);
    +    +    -    -        setLogs([]);
    +    +    -    -        setAuditResults([]);
    +    +    -    +        setActivity([]);
    +    +    -    +        setTotalTokens({ input: 0, output: 0 });
    +    +    -             addToast('Build started', 'success');
    +    +    -           } else {
    +    +    -             const data = await res.json().catch(() => ({ detail: 'Failed to start build' }));
    +    +    -    @@ -207,22 +480,45 @@ function BuildProgress() {
    +    +    -         }
    +    +    -       };
    +    +    -     
    +    +    -    +  /* ------ derived values ------ */
    +    +    -    +
    +    +    -    +  const isActive = build && ['pending', 'running'].includes(build.status);
    +    +    -    +  const buildModel = 'claude-opus-4-6';
    +    +    -    +  const contextWindow = 200_000;
    +    +    -    +  const totalTok = totalTokens.input + totalTokens.output;
    +    +    -    +  const ctxPercent = Math.min(100, (totalTok / contextWindow) * 100);
    +    +    -    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    +    +    -    +  const estimatedCost = getTokenCost(buildModel, totalTokens.input, totalTokens.output);
    +    +    -    +  const elapsedStr = elapsed > 0 ? `${Math.floor(elapsed / 60)}m ${elapsed % 60}s` : '0s';
    +    +    -    +
    +    +    -    +  const doneCount = Array.from(phaseStates.values()).filter((p) => p.status === 'pass').length;
    +    +    -    +  const totalPhases = phaseStates.size || phaseDefs.length;
    +    +    -    +
    +    +    -    +  /* ------ render: loading ------ */
    +    +    -    +
    +    +    -       if (loading) {
    +    +    -         return (
    +    +    -           <AppShell>
    +    +    -    -        <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    +    +    -    +        <div style={pageStyle}>
    +    +    -               <Skeleton style={{ width: '100%', height: '40px', marginBottom: '24px' }} />
    +    +    -    -          <Skeleton style={{ width: '100%', height: '300px', marginBottom: '16px' }} />
    +    +    -    -          <Skeleton style={{ width: '100%', height: '120px' }} />
    +    +    -    +          <div style={twoColStyle}>
    +    +    -    +            <Skeleton style={{ width: '100%', height: '400px' }} />
    +    +    -    +            <div>
    +    +    -    +              <Skeleton style={{ width: '100%', height: '120px', marginBottom: '16px' }} />
    +    +    -    +              <Skeleton style={{ width: '100%', height: '300px' }} />
    +    +    -    +            </div>
    +    +    -    +          </div>
    +    +    -             </div>
    +    +    -           </AppShell>
    +    +    -         );
    +    +    -       }
    +    +    -     
    +    +    -    +  /* ------ render: no build ------ */
    +    +    -    +
    +    +    -       if (noBuild) {
    +    +    -         return (
    +    +    -           <AppShell>
    +    +    -    -        <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    +    +    -    +        <div style={pageStyle}>
    +    +    -               <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    +    +    -                 <button
    +    +    -                   onClick={() => navigate(`/projects/${projectId}`)}
    +    +    -    @@ -242,16 +538,12 @@ function BuildProgress() {
    +    +    -         );
    +    +    -       }
    +    +    -     
    +    +    -    -  const isActive = build && ['pending', 'running'].includes(build.status);
    +    +    -    -  const elapsed = build?.started_at
    +    +    -    -    ? Math.round((Date.now() - new Date(build.started_at).getTime()) / 1000)
    +    +    -    -    : 0;
    +    +    -    -  const elapsedStr = elapsed > 0 ? `${Math.floor(elapsed / 60)}m ${elapsed % 60}s` : '';
    +    +    -    +  /* ------ render: main ------ */
    +    +    -     
    +    +    -       return (
    +    +    -         <AppShell>
    +    +    -    -      <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    +    +    -    -        {/* Header */}
    +    +    -    +      <div style={pageStyle}>
    +    +    -    +        {/* ---- Header ---- */}
    +    +    -             <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '20px' }}>
    +    +    -               <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    +    +    -                 <button
    +    +    -    @@ -277,77 +569,187 @@ function BuildProgress() {
    +    +    -                   </span>
    +    +    -                 )}
    +    +    -               </div>
    +    +    -    -          {isActive && (
    +    +    -    -            <button
    +    +    -    -              onClick={() => setShowCancelConfirm(true)}
    +    +    -    -              style={{
    +    +    -    -                background: 'transparent',
    +    +    -    -                color: '#EF4444',
    +    +    -    -                border: '1px solid #EF4444',
    +    +    -    -                borderRadius: '6px',
    +    +    -    -                padding: '6px 16px',
    +    +    -    -                cursor: 'pointer',
    +    +    -    -                fontSize: '0.8rem',
    +    +    -    -                fontWeight: 600,
    +    +    -    -              }}
    +    +    -    -            >
    +    +    -    -              Cancel Build
    +    +    -    -            </button>
    +    +    -    -          )}
    +    +    -    +          <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>
    +    +    -    +            {build?.status === 'completed' && (
    +    +    -    +              <button
    +    +    -    +                onClick={() => navigate(`/projects/${projectId}/build/complete`)}
    +    +    -    +                style={{
    +    +    -    +                  background: '#16A34A',
    +    +    -    +                  color: '#fff',
    +    +    -    +                  border: 'none',
    +    +    -    +                  borderRadius: '6px',
    +    +    -    +                  padding: '6px 16px',
    +    +    -    +                  cursor: 'pointer',
    +    +    -    +                  fontSize: '0.8rem',
    +    +    -    +                  fontWeight: 600,
    +    +    -    +                }}
    +    +    -    +              >
    +    +    -    +                View Summary
    +    +    -    +              </button>
    +    +    -    +            )}
    +    +    -    +            {isActive && (
    +    +    -    +              <button
    +    +    -    +                onClick={() => setShowCancelConfirm(true)}
    +    +    -    +                style={{
    +    +    -    +                  background: 'transparent',
    +    +    -    +                  color: '#EF4444',
    +    +    -    +                  border: '1px solid #EF4444',
    +    +    -    +                  borderRadius: '6px',
    +    +    -    +                  padding: '6px 16px',
    +    +    -    +                  cursor: 'pointer',
    +    +    -    +                  fontSize: '0.8rem',
    +    +    -    +                  fontWeight: 600,
    +    +    -    +                }}
    +    +    -    +              >
    +    +    -    +                Cancel Build
    +    +    -    +              </button>
    +    +    -    +            )}
    +    +    -    +          </div>
    +    +    -             </div>
    +    +    -     
    +    +    -    -        {/* Build Summary Header */}
    +    +    -    -        {build && (
    +    +    -    -          <div style={{ background: '#1E293B', borderRadius: '8px', padding: '14px 20px', marginBottom: '16px', display: 'flex', gap: '24px', fontSize: '0.8rem', flexWrap: 'wrap' }}>
    +    +    -    -            <div>
    +    +    -    -              <span style={{ color: '#94A3B8' }}>Phase: </span>
    +    +    -    -              <span style={{ fontWeight: 600 }}>{build.phase}</span>
    +    +    -    +        {/* ---- Two-column layout ---- */}
    +    +    -    +        <div style={twoColStyle}>
    +    +    -    +
    +    +    -    +          {/* ======== LEFT: Phase Checklist ======== */}
    +    +    -    +          <div style={{ ...cardStyle, padding: '12px 16px' }}>
    +    +    -    +            <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    +    -    +              Phases ({doneCount}/{totalPhases})
    +    +    -    +            </h3>
    +    +    -    +            <div style={{ display: 'flex', flexDirection: 'column', gap: '2px' }}>
    +    +    -    +              {(phaseStates.size > 0
    +    +    -    +                ? Array.from(phaseStates.entries()).sort((a, b) => a[0] - b[0]).map(([num, ps]) => ({ num, ps }))
    +    +    -    +                : phaseDefs.map((d) => ({ num: d.number, ps: { def: d, status: 'pending' as PhaseStatus, input_tokens: 0, output_tokens: 0, elapsed_ms: 0 } }))
    +    +    -    +              ).map(({ num, ps }) => {
    +    +    -    +                const isExp = expandedPhase === num;
    +    +    -    +                const isActivePhase = ps.status === 'active';
    +    +    -    +                const phaseElapsed = ps.elapsed_ms > 0 ? `${Math.floor(ps.elapsed_ms / 60000)}m ${Math.floor((ps.elapsed_ms % 60000) / 1000)}s` : '';
    +    +    -    +
    +    +    -    +                return (
    +    +    -    +                  <div key={num}>
    +    +    -    +                    <div
    +    +    -    +                      style={phaseRowStyle(isActivePhase)}
    +    +    -    +                      onClick={() => setExpandedPhase(isExp ? null : num)}
    +    +    -    +                    >
    +    +    -    +                      {/* Status icon */}
    +    +    -    +                      <span style={{ color: STATUS_COLOR[ps.status], fontSize: '1rem', width: '20px', textAlign: 'center', flexShrink: 0 }}>
    +    +    -    +                        {isActivePhase ? (
    +    +    -    +                          <span style={{ display: 'inline-block', animation: 'spin 1.2s linear infinite' }}>├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£┬¢</span>
    +    +    -    +                        ) : (
    +    +    -    +                          STATUS_ICON[ps.status]
    +    +    -    +                        )}
    +    +    -    +                      </span>
    +    +    -    +
    +    +    -    +                      {/* Phase name + objective */}
    +    +    -    +                      <div style={{ flex: 1, minWidth: 0 }}>
    +    +    -    +                        <div style={{ fontSize: '0.8rem', fontWeight: 600, color: STATUS_COLOR[ps.status] }}>
    +    +    -    +                          Phase {num} ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® {ps.def.name}
    +    +    -    +                        </div>
    +    +    -    +                        <div style={{ fontSize: '0.68rem', color: '#94A3B8', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    +    +    -    +                          {ps.def.objective}
    +    +    -    +                        </div>
    +    +    -    +                      </div>
    +    +    -    +
    +    +    -    +                      {/* Per-phase tokens (when done) */}
    +    +    -    +                      {ps.status === 'pass' && (ps.input_tokens > 0 || ps.output_tokens > 0) && (
    +    +    -    +                        <div style={{ fontSize: '0.6rem', color: '#64748B', textAlign: 'right', flexShrink: 0 }}>
    +    +    -    +                          <div>{ps.input_tokens.toLocaleString()} in</div>
    +    +    -    +                          <div>{ps.output_tokens.toLocaleString()} out</div>
    +    +    -    +                          {phaseElapsed && <div>{phaseElapsed}</div>}
    +    +    -    +                        </div>
    +    +    -    +                      )}
    +    +    -    +
    +    +    -    +                      {/* Expand chevron */}
    +    +    -    +                      <span style={{ color: '#475569', fontSize: '0.65rem', flexShrink: 0, transition: 'transform 0.15s', transform: isExp ? 'rotate(180deg)' : 'rotate(0)' }}>├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├╣Ôö£├ÂÔö£ÔûôÔö£├┐</span>
    +    +    -    +                    </div>
    +    +    -    +
    +    +    -    +                    {/* Expanded deliverables */}
    +    +    -    +                    {isExp && ps.def.deliverables.length > 0 && (
    +    +    -    +                      <div style={{ paddingLeft: '40px', paddingRight: '12px', paddingBottom: '8px' }}>
    +    +    -    +                        {ps.def.deliverables.map((d, i) => (
    +    +    -    +                          <div key={i} style={{ fontSize: '0.68rem', color: '#94A3B8', paddingTop: '3px', display: 'flex', gap: '6px' }}>
    +    +    -    +                            <span style={{ color: '#475569' }}>├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®</span>
    +    +    -    +                            <span>{d}</span>
    +    +    -    +                          </div>
    +    +    -    +                        ))}
    +    +    -    +                      </div>
    +    +    -    +                    )}
    +    +    -    +                  </div>
    +    +    -    +                );
    +    +    -    +              })}
    +    +    -                 </div>
    +    +    -    -            {elapsedStr && (
    +    +    -    -              <div>
    +    +    -    -                <span style={{ color: '#94A3B8' }}>Elapsed: </span>
    +    +    -    -                {elapsedStr}
    +    +    -    +          </div>
    +    +    -    +
    +    +    -    +          {/* ======== RIGHT: Metrics + Activity Feed ======== */}
    +    +    -    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
    +    +    -    +
    +    +    -    +            {/* -- Metrics Card -- */}
    +    +    -    +            <div style={cardStyle}>
    +    +    -    +              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '16px', marginBottom: '12px' }}>
    +    +    -    +                <div style={metricBoxStyle}>
    +    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Input Tokens</span>
    +    +    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{totalTokens.input.toLocaleString()}</span>
    +    +    -    +                </div>
    +    +    -    +                <div style={metricBoxStyle}>
    +    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Output Tokens</span>
    +    +    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{totalTokens.output.toLocaleString()}</span>
    +    +    -    +                </div>
    +    +    -    +                <div style={metricBoxStyle}>
    +    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Est. Cost</span>
    +    +    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#22C55E' }}>${estimatedCost.toFixed(4)}</span>
    +    +    -    +                </div>
    +    +    -    +                <div style={metricBoxStyle}>
    +    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Elapsed</span>
    +    +    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{elapsedStr}</span>
    +    +    -    +                </div>
    +    +    -    +                <div style={metricBoxStyle}>
    +    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Model</span>
    +    +    -    +                  <span style={{ fontSize: '0.85rem', fontWeight: 600, color: '#A78BFA' }}>{buildModel}</span>
    +    +    -    +                </div>
    +    +    -    +                {(build?.loop_count ?? 0) > 0 && (
    +    +    -    +                  <div style={metricBoxStyle}>
    +    +    -    +                    <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Loopbacks</span>
    +    +    -    +                    <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#EAB308' }}>{build?.loop_count}</span>
    +    +    -    +                  </div>
    +    +    -    +                )}
    +    +    -                   </div>
    +    +    -    -            )}
    +    +    -    -            {build.loop_count > 0 && (
    +    +    -    -              <div>
    +    +    -    -                <span style={{ color: '#EAB308' }}>Loopback:</span>{' '}
    +    +    -    -                <span style={{ color: '#EAB308', fontWeight: 600 }}>Iteration {build.loop_count}</span>
    +    +    -    +
    +    +    -    +              {/* Context window meter */}
    +    +    -    +              <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    +    +    -    +                <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#94A3B8' }}>
    +    +    -    +                  <span>Context Window</span>
    +    +    -    +                  <span>{totalTok.toLocaleString()} / {contextWindow.toLocaleString()} ({ctxPercent.toFixed(1)}%)</span>
    +    +    -    +                </div>
    +    +    -    +                <div style={{ width: '100%', height: '8px', background: '#0F172A', borderRadius: '4px', overflow: 'hidden' }}>
    +    +    -    +                  <div style={{ width: `${ctxPercent}%`, height: '100%', background: ctxColor, borderRadius: '4px', transition: 'width 0.4s ease' }} />
    +    +    -    +                </div>
    +    +    -                   </div>
    +    +    -    -            )}
    +    +    -    -            {build.error_detail && (
    +    +    -    -              <div style={{ color: '#EF4444', flex: '1 1 100%', marginTop: '4px', fontSize: '0.75rem' }}>
    +    +    -    -                Error: {build.error_detail}
    +    +    -    +            </div>
    +    +    -    +
    +    +    -    +            {/* -- Error banner -- */}
    +    +    -    +            {build?.error_detail && (
    +    +    -    +              <div style={{ background: '#7F1D1D', borderRadius: '6px', padding: '10px 16px', fontSize: '0.78rem', color: '#FCA5A5' }}>
    +    +    -    +                <strong>Error:</strong> {build.error_detail}
    +    +    -                   </div>
    +    +    -                 )}
    +    +    -    -          </div>
    +    +    -    -        )}
    +    +    -    -
    +    +    -    -        {/* Phase Progress Bar */}
    +    +    -    -        <div style={{ marginBottom: '20px' }}>
    +    +    -    -          <PhaseProgressBar phases={generatePhases()} />
    +    +    -    -        </div>
    +    +    -     
    +    +    -    -        {/* Audit Results */}
    +    +    -    -        {auditResults.length > 0 && (
    +    +    -    -          <div style={{ marginBottom: '20px' }}>
    +    +    -    -            <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#94A3B8' }}>Audit Results</h3>
    +    +    -    -            {auditResults.map((result, i) => (
    +    +    -    -              <BuildAuditCard
    +    +    -    -                key={i}
    +    +    -    -                phase={result.phase}
    +    +    -    -                iteration={result.iteration}
    +    +    -    -                checks={result.checks}
    +    +    -    -                overall={result.overall}
    +    +    -    -              />
    +    +    -    -            ))}
    +    +    -    +            {/* -- Activity Feed -- */}
    +    +    -    +            <div>
    +    +    -    +              <h3 style={{ margin: '0 0 8px', fontSize: '0.85rem', color: '#94A3B8' }}>Activity</h3>
    +    +    -    +              <div style={feedStyle} data-testid="build-activity-feed">
    +    +    -    +                {activity.length === 0 ? (
    +    +    -    +                  <div style={{ color: '#475569' }}>Waiting for build output...</div>
    +    +    -    +                ) : (
    +    +    -    +                  activity.map((entry, i) => (
    +    +    -    +                    <div key={i} style={{ color: LEVEL_COLOR[entry.level] ?? LEVEL_COLOR.info }}>
    +    +    -    +                      <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    +    +    -    +                      {entry.message}
    +    +    -    +                    </div>
    +    +    -    +                  ))
    +    +    -    +                )}
    +    +    -    +                <div ref={feedEndRef} />
    +    +    -    +              </div>
    +    +    -    +            </div>
    +    +    -               </div>
    +    +    -    -        )}
    +    +    -    -
    +    +    -    -        {/* Streaming Logs */}
    +    +    -    -        <div>
    +    +    -    -          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#94A3B8' }}>Build Logs</h3>
    +    +    -    -          <BuildLogViewer logs={logs} maxHeight={500} />
    +    +    -             </div>
    +    +    -           </div>
    +    +    -     
    +    +    -    diff --git a/web/src/pages/ProjectDetail.tsx b/web/src/pages/ProjectDetail.tsx
    +    +    -    index bbb2777..78a0f36 100644
    +    +    -    --- a/web/src/pages/ProjectDetail.tsx
    +    +    -    +++ b/web/src/pages/ProjectDetail.tsx
    +    +    -    @@ -13,6 +13,28 @@ import QuestionnaireModal from '../components/QuestionnaireModal';
    +    +    -     
    +    +    -     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -     
    +    +    -    +const needsKeyBanner = (
    +    +    -    +  <div style={{
    +    +    -    +    background: '#1E293B',
    +    +    -    +    border: '1px solid #92400E',
    +    +    -    +    borderRadius: '6px',
    +    +    -    +    padding: '10px 16px',
    +    +    -    +    marginBottom: '16px',
    +    +    -    +    fontSize: '0.8rem',
    +    +    -    +    color: '#FBBF24',
    +    +    -    +    display: 'flex',
    +    +    -    +    alignItems: 'center',
    +    +    -    +    gap: '10px',
    +    +    -    +  }}>
    +    +    -    +    <span style={{ fontSize: '1rem' }}>├ö├Â┬╝Ôö¼├¡Ôö£├║Ôö£├Ñ├ö├Â┬úÔö£├®├ö├Â┬úÔö¼┬¼</span>
    +    +    -    +    <span>
    +    +    -    +      Add your Anthropic API key in{' '}
    +    +    -    +      <Link to="/settings" style={{ color: '#60A5FA', textDecoration: 'underline' }}>Settings</Link>{' '}
    +    +    -    +      to start a build. Questionnaires and audits are free.
    +    +    -    +    </span>
    +    +    -    +  </div>
    +    +    -    +);
    +    +    -    +
    +    +    -     interface ProjectDetailData {
    +    +    -       id: string;
    +    +    -       name: string;
    +    +    -    @@ -34,7 +56,7 @@ interface ProjectDetailData {
    +    +    -     
    +    +    -     function ProjectDetail() {
    +    +    -       const { projectId } = useParams<{ projectId: string }>();
    +    +    -    -  const { token } = useAuth();
    +    +    -    +  const { user, token } = useAuth();
    +    +    -       const { addToast } = useToast();
    +    +    -       const navigate = useNavigate();
    +    +    -       const [project, setProject] = useState<ProjectDetailData | null>(null);
    +    +    -    @@ -282,6 +304,9 @@ function ProjectDetail() {
    +    +    -               </div>
    +    +    -             </div>
    +    +    -     
    +    +    -    +        {/* BYOK warning */}
    +    +    -    +        {hasContracts && !buildActive && !(user?.has_anthropic_key) && needsKeyBanner}
    +    +    -    +
    +    +    -             {/* Build Actions */}
    +    +    -             <div style={{ display: 'flex', gap: '12px', marginBottom: '24px' }}>
    +    +    -               {!buildActive && (
    +    +    -    diff --git a/web/src/pages/Settings.tsx b/web/src/pages/Settings.tsx
    +    +    -    new file mode 100644
    +    +    -    index 0000000..29c213d
    +    +    -    --- /dev/null
    +    +    -    +++ b/web/src/pages/Settings.tsx
    +    +    -    @@ -0,0 +1,280 @@
    +    +    -    +/**
    +    +    -    + * Settings -- user settings page with BYOK API key management.
    +    +    -    + */
    +    +    -    +import { useState } from 'react';
    +    +    -    +import { useNavigate } from 'react-router-dom';
    +    +    -    +import { useAuth } from '../context/AuthContext';
    +    +    -    +import { useToast } from '../context/ToastContext';
    +    +    -    +import AppShell from '../components/AppShell';
    +    +    -    +
    +    +    -    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    -    +
    +    +    -    +function Settings() {
    +    +    -    +  const { user, token, updateUser } = useAuth();
    +    +    -    +  const { addToast } = useToast();
    +    +    -    +  const navigate = useNavigate();
    +    +    -    +
    +    +    -    +  const [apiKey, setApiKey] = useState('');
    +    +    -    +  const [saving, setSaving] = useState(false);
    +    +    -    +  const [removing, setRemoving] = useState(false);
    +    +    -    +
    +    +    -    +  const hasKey = user?.has_anthropic_key ?? false;
    +    +    -    +
    +    +    -    +  const handleSaveKey = async () => {
    +    +    -    +    const trimmed = apiKey.trim();
    +    +    -    +    if (!trimmed) return;
    +    +    -    +    setSaving(true);
    +    +    -    +    try {
    +    +    -    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    +    +    -    +        method: 'PUT',
    +    +    -    +        headers: {
    +    +    -    +          Authorization: `Bearer ${token}`,
    +    +    -    +          'Content-Type': 'application/json',
    +    +    -    +        },
    +    +    -    +        body: JSON.stringify({ api_key: trimmed }),
    +    +    -    +      });
    +    +    -    +      if (res.ok) {
    +    +    -    +        addToast('API key saved', 'success');
    +    +    -    +        setApiKey('');
    +    +    -    +        updateUser({ has_anthropic_key: true });
    +    +    -    +      } else {
    +    +    -    +        const data = await res.json().catch(() => ({ detail: 'Failed to save key' }));
    +    +    -    +        addToast(data.detail || 'Failed to save key');
    +    +    -    +      }
    +    +    -    +    } catch {
    +    +    -    +      addToast('Network error saving key');
    +    +    -    +    } finally {
    +    +    -    +      setSaving(false);
    +    +    -    +    }
    +    +    -    +  };
    +    +    -    +
    +    +    -    +  const handleRemoveKey = async () => {
    +    +    -    +    setRemoving(true);
    +    +    -    +    try {
    +    +    -    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    +    +    -    +        method: 'DELETE',
    +    +    -    +        headers: { Authorization: `Bearer ${token}` },
    +    +    -    +      });
    +    +    -    +      if (res.ok) {
    +    +    -    +        addToast('API key removed', 'info');
    +    +    -    +        updateUser({ has_anthropic_key: false });
    +    +    -    +      } else {
    +    +    -    +        addToast('Failed to remove key');
    +    +    -    +      }
    +    +    -    +    } catch {
    +    +    -    +      addToast('Network error removing key');
    +    +    -    +    } finally {
    +    +    -    +      setRemoving(false);
    +    +    -    +    }
    +    +    -    +  };
    +    +    -    +
    +    +    -    +  return (
    +    +    -    +    <AppShell>
    +    +    -    +      <div style={{ padding: '24px', maxWidth: '720px', margin: '0 auto' }}>
    +    +    -    +        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    +    +    -    +          <button
    +    +    -    +            onClick={() => navigate('/')}
    +    +    -    +            style={{
    +    +    -    +              background: 'transparent',
    +    +    -    +              color: '#94A3B8',
    +    +    -    +              border: '1px solid #334155',
    +    +    -    +              borderRadius: '6px',
    +    +    -    +              padding: '6px 12px',
    +    +    -    +              cursor: 'pointer',
    +    +    -    +              fontSize: '0.8rem',
    +    +    -    +            }}
    +    +    -    +          >
    +    +    -    +            Back
    +    +    -    +          </button>
    +    +    -    +          <h2 style={{ margin: 0, fontSize: '1.1rem' }}>Settings</h2>
    +    +    -    +        </div>
    +    +    -    +
    +    +    -    +        {/* Profile Section */}
    +    +    -    +        <div
    +    +    -    +          style={{
    +    +    -    +            background: '#1E293B',
    +    +    -    +            borderRadius: '8px',
    +    +    -    +            padding: '20px',
    +    +    -    +            marginBottom: '16px',
    +    +    -    +          }}
    +    +    -    +        >
    +    +    -    +          <h3 style={{ margin: '0 0 16px', fontSize: '0.9rem', color: '#F8FAFC' }}>Profile</h3>
    +    +    -    +          <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
    +    +    -    +            {user?.avatar_url && (
    +    +    -    +              <img
    +    +    -    +                src={user.avatar_url}
    +    +    -    +                alt={user.github_login}
    +    +    -    +                style={{ width: 48, height: 48, borderRadius: '50%' }}
    +    +    -    +              />
    +    +    -    +            )}
    +    +    -    +            <div>
    +    +    -    +              <div style={{ fontWeight: 600, fontSize: '0.95rem' }}>{user?.github_login}</div>
    +    +    -    +              <div style={{ color: '#64748B', fontSize: '0.8rem', marginTop: '2px' }}>
    +    +    -    +                Authenticated via GitHub
    +    +    -    +              </div>
    +    +    -    +            </div>
    +    +    -    +          </div>
    +    +    -    +        </div>
    +    +    -    +
    +    +    -    +        {/* BYOK API Key Section */}
    +    +    -    +        <div
    +    +    -    +          style={{
    +    +    -    +            background: '#1E293B',
    +    +    -    +            borderRadius: '8px',
    +    +    -    +            padding: '20px',
    +    +    -    +            marginBottom: '16px',
    +    +    -    +          }}
    +    +    -    +          data-testid="byok-section"
    +    +    -    +        >
    +    +    -    +          <h3 style={{ margin: '0 0 4px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    +    -    +            Anthropic API Key
    +    +    -    +          </h3>
    +    +    -    +          <p style={{ margin: '0 0 14px', fontSize: '0.75rem', color: '#64748B', lineHeight: 1.5 }}>
    +    +    -    +            Builds use Claude Opus and run on your own Anthropic API key.
    +    +    -    +            Planning, questionnaires, and audits are free ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® powered by Haiku on us.
    +    +    -    +          </p>
    +    +    -    +
    +    +    -    +          {hasKey ? (
    +    +    -    +            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    +    +    -    +              <div style={{
    +    +    -    +                flex: 1,
    +    +    -    +                display: 'flex',
    +    +    -    +                alignItems: 'center',
    +    +    -    +                gap: '8px',
    +    +    -    +                padding: '8px 12px',
    +    +    -    +                background: '#0F172A',
    +    +    -    +                borderRadius: '6px',
    +    +    -    +                fontSize: '0.8rem',
    +    +    -    +              }}>
    +    +    -    +                <span style={{ color: '#22C55E', fontSize: '0.7rem' }}>├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£├í</span>
    +    +    -    +                <span style={{ color: '#94A3B8' }}>Key configured</span>
    +    +    -    +                <span style={{ color: '#64748B', fontFamily: 'monospace' }}>sk-ant-├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®</span>
    +    +    -    +              </div>
    +    +    -    +              <button
    +    +    -    +                onClick={handleRemoveKey}
    +    +    -    +                disabled={removing}
    +    +    -    +                data-testid="remove-api-key-btn"
    +    +    -    +                style={{
    +    +    -    +                  background: 'transparent',
    +    +    -    +                  color: '#EF4444',
    +    +    -    +                  border: '1px solid #7F1D1D',
    +    +    -    +                  borderRadius: '6px',
    +    +    -    +                  padding: '6px 14px',
    +    +    -    +                  cursor: removing ? 'not-allowed' : 'pointer',
    +    +    -    +                  fontSize: '0.75rem',
    +    +    -    +                  opacity: removing ? 0.6 : 1,
    +    +    -    +                }}
    +    +    -    +              >
    +    +    -    +                {removing ? 'Removing...' : 'Remove'}
    +    +    -    +              </button>
    +    +    -    +            </div>
    +    +    -    +          ) : (
    +    +    -    +            <div>
    +    +    -    +              <div style={{ display: 'flex', gap: '8px' }}>
    +    +    -    +                <input
    +    +    -    +                  type="password"
    +    +    -    +                  value={apiKey}
    +    +    -    +                  onChange={(e) => setApiKey(e.target.value)}
    +    +    -    +                  placeholder="sk-ant-api03-..."
    +    +    -    +                  data-testid="api-key-input"
    +    +    -    +                  style={{
    +    +    -    +                    flex: 1,
    +    +    -    +                    background: '#0F172A',
    +    +    -    +                    border: '1px solid #334155',
    +    +    -    +                    borderRadius: '6px',
    +    +    -    +                    padding: '8px 12px',
    +    +    -    +                    color: '#F8FAFC',
    +    +    -    +                    fontSize: '0.8rem',
    +    +    -    +                    fontFamily: 'monospace',
    +    +    -    +                    outline: 'none',
    +    +    -    +                  }}
    +    +    -    +                  onKeyDown={(e) => { if (e.key === 'Enter') handleSaveKey(); }}
    +    +    -    +                />
    +    +    -    +                <button
    +    +    -    +                  onClick={handleSaveKey}
    +    +    -    +                  disabled={saving || !apiKey.trim()}
    +    +    -    +                  data-testid="save-api-key-btn"
    +    +    -    +                  style={{
    +    +    -    +                    background: saving ? '#1E293B' : '#2563EB',
    +    +    -    +                    color: '#fff',
    +    +    -    +                    border: 'none',
    +    +    -    +                    borderRadius: '6px',
    +    +    -    +                    padding: '8px 18px',
    +    +    -    +                    cursor: saving || !apiKey.trim() ? 'not-allowed' : 'pointer',
    +    +    -    +                    fontSize: '0.8rem',
    +    +    -    +                    opacity: saving || !apiKey.trim() ? 0.6 : 1,
    +    +    -    +                  }}
    +    +    -    +                >
    +    +    -    +                  {saving ? 'Saving...' : 'Save Key'}
    +    +    -    +                </button>
    +    +    -    +              </div>
    +    +    -    +              <p style={{ margin: '8px 0 0', fontSize: '0.7rem', color: '#64748B' }}>
    +    +    -    +                Your key is stored securely and only used for build operations.
    +    +    -    +                Get one at{' '}
    +    +    -    +                <a
    +    +    -    +                  href="https://console.anthropic.com/settings/keys"
    +    +    -    +                  target="_blank"
    +    +    -    +                  rel="noopener noreferrer"
    +    +    -    +                  style={{ color: '#60A5FA' }}
    +    +    -    +                >
    +    +    -    +                  console.anthropic.com
    +    +    -    +                </a>
    +    +    -    +              </p>
    +    +    -    +            </div>
    +    +    -    +          )}
    +    +    -    +        </div>
    +    +    +    +## Phase 13 -- Multi-Turn Builder & Structured Build Plan
    +         +    +
    +    -    +    +  return (
    +    -    +    +    <div style={panelStyle} data-testid="contract-progress">
    +    -    +    +      {/* Header */}
    +    -    +    +      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
    +    -    +    +        <h4 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    -    +    +          {allDone ? '├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├Â├▒ Contracts Ready' : `Generating Contracts├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬╝Ôö¼┬╝ (${doneCount}/${ALL_CONTRACTS.length})`}
    +    -    +    +        </h4>
    +    -    +    +      </div>
    +    +    +    +**Objective:** Convert the builder from a single streaming call to a multi-turn conversation. The builder emits a structured plan at the start, and after audit failures the audit feedback is injected back into the conversation so the builder can self-correct. This gives the builder full context of what it's already done, what failed, and why.
    +         +    +
    +    -    +    +      {/* Context window meter */}
    +    -    +    +      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    +    -    +    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.7rem', color: '#94A3B8' }}>
    +    -    +    +          <span>Context Window ({model})</span>
    +    -    +    +          <span>
    +    -    +    +            {totalTokens.toLocaleString()} / {contextWindow.toLocaleString()} tokens ({ctxPercent.toFixed(1)}%)
    +    -    +    +          </span>
    +    -    +    +        </div>
    +    -    +    +        <div style={meterBarOuter}>
    +    -    +    +          <div
    +    -    +    +            style={{
    +    -    +    +              width: `${ctxPercent}%`,
    +    -    +    +              height: '100%',
    +    -    +    +              background: ctxColor,
    +    -    +    +              borderRadius: '4px',
    +    -    +    +              transition: 'width 0.4s ease',
    +    -    +    +            }}
    +    -    +    +          />
    +    -    +    +        </div>
    +    -    +    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#64748B' }}>
    +    -    +    +          <span>Input: {tokenUsage.input_tokens.toLocaleString()}</span>
    +    -    +    +          <span>Output: {tokenUsage.output_tokens.toLocaleString()}</span>
    +    -    +    +        </div>
    +    -    +    +      </div>
    +    +    +    +**Background:** Currently `_run_build()` creates `messages = [{"role":"user","content": directive}]` and makes one `stream_agent()` call. The audit runs but its feedback is never sent back to the builder. The builder has no ability to self-correct -- it just gets a loop count incremented and the build eventually fails. Real builds took ~7 iterations because the diff log retained TODO placeholders that the auditor kept flagging.
    +         +    +
    +    -    +    +      {/* Step list */}
    +    -    +    +      <div>
    +    -    +    +        {ALL_CONTRACTS.map((ct) => {
    +    -    +    +          const st = statuses[ct];
    +    -    +    +          const icon = st === 'done' ? '├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬úÔö£├¡' : st === 'generating' ? '├ö├Â┬úÔö£├é├ö├Â┬úÔö£├íÔö£├ÂÔö£├éÔö£┬«' : '├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö¼Ôòù';
    +    -    +    +          const color = st === 'done' ? '#22C55E' : st === 'generating' ? '#F59E0B' : '#475569';
    +    -    +    +          return (
    +    -    +    +            <div key={ct} style={stepRowStyle}>
    +    -    +    +              <span style={{ width: '20px', textAlign: 'center' }}>{icon}</span>
    +    -    +    +              <span style={{ flex: 1, color }}>{CONTRACT_LABELS[ct]}</span>
    +    -    +    +              <span style={{ fontSize: '0.7rem', color: '#64748B', textTransform: 'uppercase' }}>{st}</span>
    +    -    +    +            </div>
    +    -    +    +          );
    +    -    +    +        })}
    +    -    +    +      </div>
    +    +    +    +**Deliverables:**
    +         +    +
    +    -    +    +      {/* Log panel */}
    +    -    +    +      <div style={logPanelStyle} data-testid="contract-log">
    +    -    +    +        {log.map((entry, i) => (
    +    -    +    +          <div key={i}>
    +    -    +    +            <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    +    -    +    +            {entry.message}
    +    -    +    +          </div>
    +    -    +    +        ))}
    +    -    +    +        <div ref={logEndRef} />
    +    -    +    +      </div>
    +    +    +    +- **Structured build plan emission**:
    +    +    +    +  - Update builder directive (system prompt / builder_contract.md) to instruct the LLM:
    +    +    +    +    > Before writing any code, emit a `=== BUILD PLAN ===` block listing all tasks you will perform, grouped by phase. Each task should be a single line: `- [ ] Task description`. End the plan with `=== END BUILD PLAN ===`.
    +    +    +    +  - `_parse_build_plan(text)` in build_service.py -- extracts task list from the plan block
    +    +    +    +  - Emit `build_plan` WS event: `{ tasks: [{ id, description, phase, status }] }`
    +    +    +    +  - As the builder works, detect task completion signals (`=== TASK DONE: <id> ===`) and emit `task_complete` WS events
    +    +    +    +  - Frontend: Build Plan checklist panel in BuildProgress (right column, above activity feed), showing all tasks with check/pending/fail icons, updating in real-time
    +         +    +
    +    -    +    +      {/* Done button */}
    +    -    +    +      {allDone && (
    +    -    +    +        <button
    +    -    +    +          onClick={onComplete}
    +    -    +    +          data-testid="contracts-done-btn"
    +    -    +    +          style={{
    +    -    +    +            background: '#16A34A',
    +    -    +    +            color: '#fff',
    +    -    +    +            border: 'none',
    +    -    +    +            borderRadius: '8px',
    +    -    +    +            padding: '10px 20px',
    +    -    +    +            cursor: 'pointer',
    +    -    +    +            fontSize: '0.8rem',
    +    -    +    +            fontWeight: 600,
    +    -    +    +            alignSelf: 'center',
    +    -    +    +          }}
    +    -    +    +        >
    +    -    +    +          Done ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® View Contracts
    +    -    +    +        </button>
    +    -    +    +      )}
    +    +    +    +- **Multi-turn conversation loop**:
    +    +    +    +  - Replace single `stream_agent()` call with a conversation loop:
    +    +    +    +    ```
    +    +    +    +    messages = [{"role": "user", "content": directive}]
    +    +    +    +    while not build_complete:
    +    +    +    +        async for chunk in stream_agent(..., messages=messages):
    +    +    +    +            # accumulate, parse files, detect signals
    +    +    +    +        messages.append({"role": "assistant", "content": accumulated_text})
    +    +    +    +        
    +    +    +    +        if phase_complete_detected:
    +    +    +    +            audit_result = await _run_inline_audit(...)
    +    +    +    +            if audit_result == "PASS":
    +    +    +    +                # continue to next phase
    +    +    +    +                messages.append({"role": "user", "content": f"Audit PASSED for {phase}. Proceed to the next phase."})
    +    +    +    +            else:
    +    +    +    +                # loopback with audit feedback
    +    +    +    +                messages.append({"role": "user", "content": f"Audit FAILED for {phase}.\n\nAudit feedback:\n{audit_detail}\n\nFix the issues identified above and re-submit {phase}."})
    +    +    +    +    ```
    +    +    +    +  - The conversation grows with each turn -- the builder sees everything it's already produced + audit results
    +    +    +    +  - No separate database table for "state" -- the conversation history IS the state
    +         +    +
    +    -    +    +      {generating && !allDone && (
    +    -    +    +        <p style={{ textAlign: 'center', color: '#64748B', fontSize: '0.75rem', margin: 0 }}>
    +    -    +    +          Generating├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬╝Ôö¼┬╝
    +    -    +    +        </p>
    +    -    +    +      )}
    +    -    +    +    </div>
    +    -    +    +  );
    +    -    +    +}
    +    -    +    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    +    -    +    index 2b28280..bd8693a 100644
    +    -    +    --- a/web/src/components/QuestionnaireModal.tsx
    +    -    +    +++ b/web/src/components/QuestionnaireModal.tsx
    +    -    +    @@ -7,6 +7,7 @@
    +    -    +      */
    +    -    +     import { useState, useEffect, useRef, useCallback } from 'react';
    +    -    +     import { useAuth } from '../context/AuthContext';
    +    -    +    +import ContractProgress from './ContractProgress';
    +    -    +     
    +    -    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    -    +     
    +    -    +    @@ -34,6 +35,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    +    -    +     interface ChatMessage {
    +    -    +       role: 'user' | 'assistant';
    +    -    +       content: string;
    +    -    +    +  section?: string;
    +    -    +     }
    +    -    +     
    +    -    +     interface QuestionnaireState {
    +    -    +    @@ -150,12 +152,21 @@ const SpeechRecognition =
    +    -    +         : null;
    +    -    +     
    +    -    +     function useSpeechRecognition(onResult: (text: string) => void) {
    +    -    +    -  const recognitionRef = useRef<any>(null);
    +    -    +       const [listening, setListening] = useState(false);
    +    -    +       const listeningRef = useRef(false);
    +    -    +    +  const recRef = useRef<any>(null);
    +    -    +    +  const onResultRef = useRef(onResult);
    +    -    +    +  onResultRef.current = onResult;
    +    +    +    +- **Audit feedback forwarding**:
    +    +    +    +  - `_run_inline_audit()` updated to return audit detail (not just PASS/FAIL) -- the full auditor response including specific findings
    +    +    +    +  - Return type changes from `str` to `AuditResult` dataclass: `{ verdict: str, detail: str, findings: list[str] }`
    +    +    +    +  - On FAIL: the audit detail is appended to messages so the builder knows exactly what to fix
    +    +    +    +  - Emit `audit_fail` WS event extended with `{ findings: [...] }` so the frontend can show what failed
    +         +    +
    +    -    +    +  /* Lazily create a single SpeechRecognition instance and keep it for the
    +    -    +    +     lifetime of the component.  Browsers throttle or block new instances
    +    -    +    +     created outside a user-gesture context, which is why creating a fresh
    +    -    +    +     instance on every start() caused the second activation to silently die
    +    -    +    +     after a few seconds. */
    +    -    +    +  const getRec = useCallback(() => {
    +    -    +    +    if (recRef.current) return recRef.current;
    +    -    +    +    if (!SpeechRecognition) return null;
    +    -    +     
    +    -    +    -  useEffect(() => {
    +    -    +    -    if (!SpeechRecognition) return;
    +    -    +         const rec = new SpeechRecognition();
    +    -    +         rec.continuous = true;
    +    -    +         rec.interimResults = true;
    +    -    +    @@ -169,64 +180,93 @@ function useSpeechRecognition(onResult: (text: string) => void) {
    +    -    +             }
    +    -    +           }
    +    -    +           if (finalTranscript) {
    +    -    +    -        onResult(finalTranscript);
    +    -    +    +        onResultRef.current(finalTranscript);
    +    -    +           }
    +    -    +         };
    +    -    +     
    +    -    +         rec.onerror = (e: any) => {
    +    -    +    -      /* 'no-speech' and 'aborted' are normal during pauses ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® auto-restart */
    +    -    +           if (e.error === 'no-speech' || e.error === 'aborted') {
    +    -    +    +        /* Browser fires these during normal pauses ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® restart if still active */
    +    -    +             if (listeningRef.current) {
    +    -    +    -          try { rec.start(); } catch { /* already running */ }
    +    -    +    +          setTimeout(() => {
    +    -    +    +            if (listeningRef.current) {
    +    -    +    +              try { rec.start(); } catch { /* already running */ }
    +    -    +    +            }
    +    -    +    +          }, 300);
    +    -    +             }
    +    -    +             return;
    +    -    +           }
    +    -    +    +      /* Real error ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® stop */
    +    -    +           listeningRef.current = false;
    +    -    +           setListening(false);
    +    -    +         };
    +    -    +     
    +    -    +    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    +    -    +         rec.onend = () => {
    +    -    +    +      /* Browser ends recognition after silence; auto-restart if user hasn't toggled off */
    +    -    +           if (listeningRef.current) {
    +    -    +    -        try { rec.start(); } catch { /* already running */ }
    +    -    +    -      } else {
    +    -    +    -        setListening(false);
    +    -    +    +        setTimeout(() => {
    +    -    +    +          if (listeningRef.current) {
    +    -    +    +            try { rec.start(); } catch { /* already running */ }
    +    -    +    +          }
    +    -    +    +        }, 300);
    +    -    +           }
    +    -    +         };
    +    -    +     
    +    -    +    -    recognitionRef.current = rec;
    +    -    +    -    return () => {
    +    -    +    -      listeningRef.current = false;
    +    -    +    -      rec.abort();
    +    -    +    -    };
    +    -    +    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    +    -    +    +    recRef.current = rec;
    +    -    +    +    return rec;
    +    -    +       }, []);
    +    -    +     
    +    -    +    -  const toggle = useCallback(() => {
    +    -    +    -    const rec = recognitionRef.current;
    +    -    +    +  const stop = useCallback(() => {
    +    -    +    +    listeningRef.current = false;
    +    -    +    +    setListening(false);
    +    -    +    +    const rec = recRef.current;
    +    -    +    +    if (rec) {
    +    -    +    +      try { rec.stop(); } catch { /* ignore */ }
    +    -    +    +    }
    +    -    +    +  }, []);
    +    +    +    +- **Context window management**:
    +    +    +    +  - Track total conversation tokens (input + output across turns)
    +    +    +    +  - If conversation approaches model context limit (200K for Opus), truncate earlier turns while preserving: (1) original directive, (2) last 2 turns, (3) all audit feedback messages
    +    +    +    +  - `_compact_messages(messages, max_tokens)` helper for intelligent truncation
    +    +    +    +  - Log a warning when compaction occurs
    +         +    +
    +    -    +    +  const start = useCallback(() => {
    +    -    +    +    const rec = getRec();
    +    -    +         if (!rec) return;
    +    -    +    +    /* Stop any active session first, then restart */
    +    -    +    +    try { rec.stop(); } catch { /* not running */ }
    +    -    +    +    listeningRef.current = true;
    +    -    +    +    setListening(true);
    +    -    +    +    /* Small delay to let the previous stop() settle */
    +    -    +    +    setTimeout(() => {
    +    -    +    +      if (listeningRef.current) {
    +    -    +    +        try { rec.start(); } catch { /* already running */ }
    +    -    +    +      }
    +    -    +    +    }, 100);
    +    -    +    +  }, [getRec]);
    +    +    +    +- **Builder directive updates**:
    +    +    +    +  - Update `Forge/Contracts/builder_contract.md` with file block format instructions
    +    +    +    +  - Add task signal format to builder_directive template
    +    +    +    +  - Instruct builder to emit `=== PHASE SIGN-OFF: PASS ===` only after ALL tasks for a phase are complete and the code is ready for audit
    +         +    +
    +    -    +    +  const toggle = useCallback(() => {
    +    -    +         if (listening) {
    +    -    +    -      listeningRef.current = false;
    +    -    +    -      rec.abort();
    +    -    +    -      setListening(false);
    +    -    +    +      stop();
    +    -    +         } else {
    +    -    +    -      listeningRef.current = true;
    +    -    +    -      rec.start();
    +    -    +    -      setListening(true);
    +    -    +    +      start();
    +    -    +         }
    +    -    +    -  }, [listening]);
    +    -    +    +  }, [listening, start, stop]);
    +    +    +    +**Schema coverage:**
    +    +    +    +- No new tables -- conversation state is in-memory during build execution
    +         +    +
    +    -    +    +  /* Cleanup on unmount */
    +    -    +    +  useEffect(() => {
    +    -    +    +    return () => {
    +    -    +    +      listeningRef.current = false;
    +    -    +    +      const rec = recRef.current;
    +    -    +    +      recRef.current = null;
    +    -    +    +      if (rec) {
    +    -    +    +        rec.onresult = null;
    +    -    +    +        rec.onerror = null;
    +    -    +    +        rec.onend = null;
    +    -    +    +        try { rec.abort(); } catch { /* ignore */ }
    +    -    +    +      }
    +    -    +    +    };
    +    -    +    +  }, []);
    +    -    +     
    +    -    +       return { listening, toggle, supported: !!SpeechRecognition };
    +    -    +     }
    +    -    +     
    +    -    +    -function speak(text: string) {
    +    -    +    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    +    -    +    -  window.speechSynthesis.cancel();
    +    -    +    -  const utter = new SpeechSynthesisUtterance(text);
    +    -    +    -  utter.rate = 1.05;
    +    -    +    -  utter.pitch = 1;
    +    -    +    -  window.speechSynthesis.speak(utter);
    +    -    +    -}
    +    +    +    +**Exit criteria:**
    +    +    +    +- Builder emits a structured plan at the start of the build
    +    +    +    +- Plan tasks are shown in the UI and checked off as they're completed
    +    +    +    +- After an audit failure, the audit feedback is sent back to the builder as a new conversation turn
    +    +    +    +- The builder successfully self-corrects based on audit feedback (verifiable in test with mocked responses)
    +    +    +    +- Conversation history grows across turns with full context preservation
    +    +    +    +- Context compaction triggers when approaching model limits (tested with mocked large conversations)
    +    +    +    +- All existing tests still pass + new tests for plan parsing, multi-turn loop, audit feedback injection, context compaction
    +    +    +    +- `run_audit.ps1` passes all checks
    +    +         +
    +    +    -    +        {/* AI Models info */}
    +    +    -    +        <div
    +    +    -    +          style={{
    +    +    -    +            background: '#1E293B',
    +    +    -    +            borderRadius: '8px',
    +    +    -    +            padding: '20px',
    +    +    -    +            marginBottom: '16px',
    +    +    -    +          }}
    +    +    -    +        >
    +    +    -    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>AI Models</h3>
    +    +    -    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', fontSize: '0.8rem' }}>
    +    +    -    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    +    +    -    +              <span style={{ color: '#94A3B8' }}>Questionnaire</span>
    +    +    -    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    +    +    -    +                <span style={{ color: '#22C55E', fontWeight: 600 }}>claude-haiku-4-5</span>
    +    +    -    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>FREE</span>
    +    +    -    +              </div>
    +    +    -    +            </div>
    +    +    -    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    +    +    -    +              <span style={{ color: '#94A3B8' }}>Builder</span>
    +    +    -    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    +    +    -    +                <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    +    +    -    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>BYOK</span>
    +    +    -    +              </div>
    +    +    -    +            </div>
    +    +    -    +          </div>
    +    +    -    +        </div>
    +    +    +    +---
    +    +         +
    +    +    -    +        {/* About Section */}
    +    +    -    +        <div
    +    +    -    +          style={{
    +    +    -    +            background: '#1E293B',
    +    +    -    +            borderRadius: '8px',
    +    +    -    +            padding: '20px',
    +    +    -    +          }}
    +    +    -    +        >
    +    +    -    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>About</h3>
    +    +    -    +          <div style={{ fontSize: '0.8rem', color: '#94A3B8', display: 'flex', flexDirection: 'column', gap: '6px' }}>
    +    +    -    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    +    +    -    +              <span>Version</span>
    +    +    -    +              <span style={{ color: '#F8FAFC' }}>v0.1.0</span>
    +    +    -    +            </div>
    +    +    -    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    +    +    -    +              <span>Framework</span>
    +    +    -    +              <span style={{ color: '#F8FAFC' }}>Forge Governance</span>
    +    +    -    +            </div>
    +    +    -    +          </div>
    +    +    -    +        </div>
    +    +    -    +      </div>
    +    +    -    +    </AppShell>
    +    +    -    +  );
    +    +    -    +}
    +    +    +    +## Phase 14 -- Build Pause, Resume & User Interjection
    +         +    +
    +    -    +     
    +    -    +     /* ------------------------------------------------------------------ */
    +    -    +     /*  Progress bar                                                      */
    +    -    +    @@ -265,7 +305,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +       const [messages, setMessages] = useState<ChatMessage[]>([]);
    +    -    +       const [input, setInput] = useState('');
    +    -    +       const [sending, setSending] = useState(false);
    +    -    +    -  const [generating, setGenerating] = useState(false);
    +    -    +       const [qState, setQState] = useState<QuestionnaireState>({
    +    -    +         current_section: 'product_intent',
    +    -    +         completed_sections: [],
    +    -    +    @@ -273,7 +312,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +         is_complete: false,
    +    -    +       });
    +    -    +       const [error, setError] = useState('');
    +    -    +    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    +    -    +    +  const [resetting, setResetting] = useState(false);
    +    -    +    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    +    -    +    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    +    -    +       const messagesEndRef = useRef<HTMLDivElement>(null);
    +    -    +       const textareaRef = useRef<HTMLTextAreaElement>(null);
    +    -    +     
    +    -    +    @@ -307,13 +348,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +                 remaining_sections: state.remaining_sections,
    +    -    +                 is_complete: state.is_complete,
    +    -    +               });
    +    -    +    -          /* Restore prior conversation */
    +    -    +    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    +    -    +    -            (m: { role: string; content: string }) => ({
    +    -    +    -              role: m.role as 'user' | 'assistant',
    +    -    +    -              content: m.content,
    +    -    +    -            }),
    +    -    +    -          );
    +    -    +    +          /* Restore prior conversation ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® only messages from the current section */
    +    -    +    +          const currentSec = state.current_section;
    +    -    +    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    +    -    +    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    +    -    +    +            .map(
    +    -    +    +              (m: { role: string; content: string; section?: string }) => ({
    +    -    +    +                role: m.role as 'user' | 'assistant',
    +    -    +    +                content: m.content,
    +    -    +    +                section: m.section,
    +    -    +    +              }),
    +    -    +    +            );
    +    -    +    +          /* Restore token usage */
    +    -    +    +          if (state.token_usage) {
    +    -    +    +            setTokenUsage(state.token_usage);
    +    -    +    +          }
    +    -    +               if (history.length > 0) {
    +    -    +                 setMessages(history);
    +    -    +               } else if (!state.is_complete) {
    +    -    +    @@ -367,18 +416,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +           }
    +    -    +     
    +    -    +           const data = await res.json();
    +    -    +    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    +    +    +    +**Objective:** When the builder hits a configurable failure threshold on a single phase, the build pauses instead of dying. The user sees what went wrong and can choose to: retry (with or without a message to the builder), skip the phase, or abort. The user can also proactively interject at any time during the build to send guidance to the builder.
    +         +    +
    +    -    +    +      /* Detect section transition ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® clear visible messages for a fresh screen */
    +    -    +    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    +    -    +    +      const prevSection = qState.current_section;
    +    -    +    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    +    +    +    +**Background:** Currently at `MAX_LOOP_COUNT = 3`, `_fail_build()` fires with "RISK_EXCEEDS_SCOPE" and the build is dead. The user can only start over. With Option D (multi-turn loopback + pause at threshold), the builder auto-corrects for the first N failures (Phase 13). When it still can't pass, it pauses and asks the human for help. The user can also press a button to interject mid-build at any time.
    +         +    +
    +    -    +    +      if (sectionChanged) {
    +    -    +    +        /* Section just completed ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® start fresh with only the transition reply */
    +    -    +    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    +    -    +    +      } else {
    +    -    +    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    +    -    +    +      }
    +    +    +    +**Deliverables:**
    +         +    +
    +    -    +           setQState({
    +    -    +    -        current_section: data.remaining_sections[0] ?? null,
    +    -    +    +        current_section: newCurrentSection,
    +    -    +             completed_sections: data.completed_sections,
    +    -    +             remaining_sections: data.remaining_sections,
    +    -    +             is_complete: data.is_complete,
    +    -    +           });
    +    -    +     
    +    -    +    -      /* auto-read assistant reply with TTS */
    +    -    +    -      if (voiceEnabled) {
    +    -    +    -        speak(data.reply);
    +    -    +    +      /* Update token usage */
    +    -    +    +      if (data.token_usage) {
    +    -    +    +        setTokenUsage(data.token_usage);
    +    -    +           }
    +    +    +    +- **Build pause mechanism** (backend):
    +    +    +    +  - New build status: `paused` (joins existing: `pending`, `running`, `completed`, `failed`, `cancelled`)
    +    +    +    +  - DB migration 009: add `paused_at TIMESTAMPTZ`, `pause_reason TEXT`, `pause_phase TEXT` to `builds` table
    +    +    +    +  - When `loop_count >= PAUSE_THRESHOLD` (configurable, default 3) on a single phase:
    +    +    +    +    1. Set build status to `paused` with reason and phase
    +    +    +    +    2. Emit `build_paused` WS event: `{ phase, loop_count, audit_findings, options: ["retry", "retry_with_message", "skip_phase", "abort"] }`
    +    +    +    +    3. The background task enters an `asyncio.Event` wait state (does not exit, preserving conversation context in memory)
    +    +    +    +  - `PAUSE_THRESHOLD` configurable via env var (default 3), replaces the hard `MAX_LOOP_COUNT` constant
    +         +    +
    +    -    +         } catch {
    +    -    +           setError('Network error');
    +    -    +         } finally {
    +    -    +    @@ -387,25 +449,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +       };
    +    -    +     
    +    -    +       /* ---- Generate contracts ---- */
    +    -    +    -  const handleGenerate = async () => {
    +    -    +    -    setGenerating(true);
    +    -    +    -    setError('');
    +    -    +    -    try {
    +    -    +    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    -    +    -        method: 'POST',
    +    -    +    -        headers: { Authorization: `Bearer ${token}` },
    +    -    +    -      });
    +    -    +    -      if (res.ok) {
    +    -    +    -        onContractsGenerated();
    +    -    +    -      } else {
    +    -    +    -        const d = await res.json().catch(() => ({}));
    +    -    +    -        setError(d.detail || 'Failed to generate contracts');
    +    -    +    -      }
    +    -    +    -    } catch {
    +    -    +    -      setError('Network error');
    +    -    +    -    } finally {
    +    -    +    -      setGenerating(false);
    +    -    +    -    }
    +    -    +    +  const handleStartGenerate = () => {
    +    -    +    +    setGeneratingContracts(true);
    +    -    +       };
    +    -    +     
    +    -    +       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    +    -    +    @@ -442,21 +487,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    +    -    +                       : 'Starting...'}
    +    -    +                 </p>
    +    -    +    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    +    -    +    +              Model: claude-haiku-4-5
    +    -    +    +            </p>
    +    -    +    +            {/* Context window meter */}
    +    -    +    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    +    -    +    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    -    +    +              const contextWindow = 200_000;
    +    -    +    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    +    -    +    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    +    -    +    +              return (
    +    -    +    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    +    -    +    +                  <div style={{
    +    -    +    +                    flex: 1,
    +    -    +    +                    height: '4px',
    +    -    +    +                    background: '#1E293B',
    +    -    +    +                    borderRadius: '2px',
    +    -    +    +                    overflow: 'hidden',
    +    -    +    +                    maxWidth: '120px',
    +    -    +    +                  }}>
    +    -    +    +                    <div style={{
    +    -    +    +                      width: `${pct}%`,
    +    -    +    +                      height: '100%',
    +    -    +    +                      background: barColor,
    +    -    +    +                      borderRadius: '2px',
    +    -    +    +                      transition: 'width 0.3s',
    +    -    +    +                    }} />
    +    -    +    +                  </div>
    +    -    +    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    +    -    +    +                    {totalTokens.toLocaleString()} / 200K
    +    -    +    +                  </span>
    +    -    +    +                </div>
    +    -    +    +              );
    +    -    +    +            })()}
    +    -    +               </div>
    +    -    +               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    +    -    +    -            {/* Voice toggle */}
    +    -    +    +            {/* Restart questionnaire */}
    +    -    +                 <button
    +    -    +    -              onClick={() => setVoiceEnabled((v) => !v)}
    +    -    +    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    +    -    +    -              data-testid="voice-toggle"
    +    -    +    +              onClick={async () => {
    +    -    +    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    +    -    +    +                setResetting(true);
    +    -    +    +                try {
    +    -    +    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    +    -    +    +                    method: 'DELETE',
    +    -    +    +                    headers: { Authorization: `Bearer ${token}` },
    +    -    +    +                  });
    +    -    +    +                  if (res.ok) {
    +    -    +    +                    setMessages([]);
    +    -    +    +                    setQState({
    +    -    +    +                      current_section: 'product_intent',
    +    -    +    +                      completed_sections: [],
    +    -    +    +                      remaining_sections: [...ALL_SECTIONS],
    +    -    +    +                      is_complete: false,
    +    -    +    +                    });
    +    -    +    +                    setInput('');
    +    -    +    +                    setError('');
    +    -    +    +                  }
    +    -    +    +                } catch { /* ignore */ }
    +    -    +    +                setResetting(false);
    +    -    +    +              }}
    +    -    +    +              disabled={resetting}
    +    -    +    +              title="Restart questionnaire"
    +    -    +    +              data-testid="restart-btn"
    +    -    +                   style={{
    +    -    +                     ...btnGhost,
    +    -    +                     padding: '6px 10px',
    +    -    +    -                fontSize: '1rem',
    +    -    +    -                opacity: voiceEnabled ? 1 : 0.5,
    +    -    +    +                fontSize: '0.7rem',
    +    -    +    +                fontWeight: 600,
    +    -    +    +                color: '#F59E0B',
    +    -    +    +                borderColor: '#F59E0B33',
    +    -    +    +                opacity: resetting ? 0.5 : 1,
    +    -    +                   }}
    +    -    +                 >
    +    -    +    -              {voiceEnabled ? '├ö├Â┬╝Ôö¼├¡Ôö£├║Ôö£├Ñ├ö├Â┬úÔö£├®├ö├Â┬úÔö¼ÔöÉ' : '├ö├Â┬╝Ôö¼├¡Ôö£├║Ôö£├Ñ├ö├Â┬úÔö£├®├ö├Â┬úÔö¼Ôòæ'}
    +    -    +    +              ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ªÔö£├ÂÔö£ÔûôÔö£Ôòú Restart
    +    -    +                 </button>
    +    -    +                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    +    -    +                   ├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├╗├┤
    +    -    +    @@ -514,8 +617,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +               </div>
    +    -    +             )}
    +    -    +     
    +    -    +    +        {/* Contract generation progress */}
    +    -    +    +        {generatingContracts && (
    +    -    +    +          <ContractProgress
    +    -    +    +            projectId={projectId}
    +    -    +    +            tokenUsage={tokenUsage}
    +    -    +    +            model="claude-haiku-4-5"
    +    -    +    +            onComplete={onContractsGenerated}
    +    -    +    +          />
    +    -    +    +        )}
    +    +    +    +- **Resume endpoints** (backend):
    +    +    +    +  - `POST /projects/{id}/build/resume` -- resume a paused build
    +    +    +    +    - Body: `{ "action": "retry" | "skip" | "abort", "message": "optional user message" }`
    +    +    +    +    - `retry`: append user message (if any) + "Please retry this phase, fixing the issues above." to conversation, set event, builder continues
    +    +    +    +    - `retry_with_message`: same as retry but user's message is mandatory and is prepended to the retry instruction
    +    +    +    +    - `skip`: append "Phase skipped by user. Proceed to the next phase." to conversation, advance phase, set event
    +    +    +    +    - `abort`: call `_fail_build()` with "Build aborted by user at {phase}"
    +    +    +    +  - The `asyncio.Event` is signalled, the background task wakes up and reads the action
    +         +    +
    +    -    +             {/* Generate contracts banner */}
    +    -    +    -        {qState.is_complete && (
    +    -    +    +        {qState.is_complete && !generatingContracts && (
    +    -    +               <div
    +    -    +                 style={{
    +    -    +                   padding: '12px 20px',
    +    -    +    @@ -533,17 +646,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -    +                   ├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├Â├▒ All sections complete ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® ready to generate contracts
    +    -    +                 </span>
    +    -    +                 <button
    +    -    +    -              onClick={handleGenerate}
    +    -    +    -              disabled={generating}
    +    -    +    +              onClick={handleStartGenerate}
    +    -    +                   data-testid="generate-contracts-btn"
    +    -    +                   style={{
    +    -    +                     ...btnPrimary,
    +    -    +                     background: '#16A34A',
    +    -    +    -                opacity: generating ? 0.6 : 1,
    +    -    +    -                cursor: generating ? 'wait' : 'pointer',
    +    -    +    +                cursor: 'pointer',
    +    -    +                   }}
    +    -    +                 >
    +    -    +    -              {generating ? 'Generating...' : 'Generate Contracts'}
    +    -    +    +              Generate Contracts
    +    -    +                 </button>
    +    -    +               </div>
    +    -    +             )}
    +    -    +    diff --git a/web/src/context/AuthContext.tsx b/web/src/context/AuthContext.tsx
    +    -    +    index 3f217e2..0430bc8 100644
    +    -    +    --- a/web/src/context/AuthContext.tsx
    +    -    +    +++ b/web/src/context/AuthContext.tsx
    +    -    +    @@ -4,6 +4,7 @@ interface User {
    +    -    +       id: string;
    +    -    +       github_login: string;
    +    -    +       avatar_url: string | null;
    +    -    +    +  has_anthropic_key?: boolean;
    +    -    +     }
    +    -    +     
    +    -    +     interface AuthContextValue {
    +    -    +    @@ -11,6 +12,7 @@ interface AuthContextValue {
    +    -    +       user: User | null;
    +    -    +       login: (token: string, user: User) => void;
    +    -    +       logout: () => void;
    +    -    +    +  updateUser: (patch: Partial<User>) => void;
    +    -    +     }
    +    -    +     
    +    -    +     const AuthContext = createContext<AuthContextValue | null>(null);
    +    -    +    @@ -38,6 +40,15 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    +    -    +         localStorage.removeItem('forgeguard_user');
    +    -    +       };
    +    -    +     
    +    -    +    +  const updateUser = (patch: Partial<User>) => {
    +    -    +    +    setUser((prev) => {
    +    -    +    +      if (!prev) return prev;
    +    -    +    +      const updated = { ...prev, ...patch };
    +    -    +    +      localStorage.setItem('forgeguard_user', JSON.stringify(updated));
    +    -    +    +      return updated;
    +    -    +    +    });
    +    -    +    +  };
    +    +    +    +- **Proactive interjection** (backend):
    +    +    +    +  - `POST /projects/{id}/build/interject` -- send a message to the builder mid-build (while status is `running`)
    +    +    +    +    - Body: `{ "message": "user guidance text" }`
    +    +    +    +    - Sets an interjection flag; at the next natural break point (after current chunk batch), the builder pauses streaming, appends the user message to conversation, and resumes with a new `stream_agent()` call that includes the user's guidance
    +    +    +    +    - Emit `build_interjection` WS event: `{ message, injected_at }`
    +    +    +    +  - Interjection queue: if multiple messages sent before the builder reaches a break point, they're concatenated into a single injection
    +         +    +
    +    -    +       useEffect(() => {
    +    -    +         if (!token) return;
    +    -    +         // Validate token on mount by calling /auth/me
    +    -    +    @@ -53,7 +64,7 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    +    -    +       }, []); // eslint-disable-line react-hooks/exhaustive-deps
    +    -    +     
    +    -    +       return (
    +    -    +    -    <AuthContext.Provider value={{ token, user, login, logout }}>
    +    -    +    +    <AuthContext.Provider value={{ token, user, login, logout, updateUser }}>
    +    -    +           {children}
    +    -    +         </AuthContext.Provider>
    +    -    +       );
    +    -    +    diff --git a/web/src/pages/BuildComplete.tsx b/web/src/pages/BuildComplete.tsx
    +    -    +    index e419947..19ece0f 100644
    +    -    +    --- a/web/src/pages/BuildComplete.tsx
    +    -    +    +++ b/web/src/pages/BuildComplete.tsx
    +    -    +    @@ -184,6 +184,7 @@ export default function BuildComplete() {
    +    -    +               <h3 style={{ color: '#F8FAFC', margin: '0 0 12px' }}>Token Usage by Phase</h3>
    +    -    +               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', borderBottom: '1px solid #334155', color: '#94A3B8', fontSize: 13 }}>
    +    -    +                 <span style={{ flex: 2 }}>Phase</span>
    +    -    +    +            <span style={{ flex: 1 }}>Model</span>
    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Input</span>
    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Output</span>
    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Cost</span>
    +    -    +    @@ -191,6 +192,7 @@ export default function BuildComplete() {
    +    -    +               {summary.cost.phases.map((entry, i) => (
    +    -    +                 <div key={i} style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #1E293B', color: '#F8FAFC', fontSize: 14 }}>
    +    -    +                   <span style={{ flex: 2 }}>{entry.phase}</span>
    +    -    +    +              <span style={{ flex: 1, color: '#A78BFA', fontSize: 12 }}>{entry.model.replace('claude-', '')}</span>
    +    -    +                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.input_tokens)}</span>
    +    -    +                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.output_tokens)}</span>
    +    -    +                   <span style={{ flex: 1, textAlign: 'right' }}>${entry.estimated_cost_usd.toFixed(4)}</span>
    +    -    +    @@ -198,6 +200,7 @@ export default function BuildComplete() {
    +    -    +               ))}
    +    -    +               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0 0', color: '#F8FAFC', fontWeight: 600, fontSize: 14 }}>
    +    -    +                 <span style={{ flex: 2 }}>Total</span>
    +    -    +    +            <span style={{ flex: 1 }}></span>
    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_input_tokens)}</span>
    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_output_tokens)}</span>
    +    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>${summary.cost.total_cost_usd.toFixed(4)}</span>
    +    -    +    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    +    -    +    index a4f1808..7e97168 100644
    +    -    +    --- a/web/src/pages/BuildProgress.tsx
    +    -    +    +++ b/web/src/pages/BuildProgress.tsx
    +    -    +    @@ -303,6 +303,10 @@ function BuildProgress() {
    +    -    +                   <span style={{ color: '#94A3B8' }}>Phase: </span>
    +    -    +                   <span style={{ fontWeight: 600 }}>{build.phase}</span>
    +    -    +                 </div>
    +    -    +    +            <div>
    +    -    +    +              <span style={{ color: '#94A3B8' }}>Model: </span>
    +    -    +    +              <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    +    -    +    +            </div>
    +    -    +                 {elapsedStr && (
    +    -    +                   <div>
    +    -    +                     <span style={{ color: '#94A3B8' }}>Elapsed: </span>
    +    -    +    diff --git a/web/src/pages/ProjectDetail.tsx b/web/src/pages/ProjectDetail.tsx
    +    -    +    index bbb2777..78a0f36 100644
    +    -    +    --- a/web/src/pages/ProjectDetail.tsx
    +    -    +    +++ b/web/src/pages/ProjectDetail.tsx
    +    -    +    @@ -13,6 +13,28 @@ import QuestionnaireModal from '../components/QuestionnaireModal';
    +    -    +     
    +    -    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    -    +     
    +    -    +    +const needsKeyBanner = (
    +    -    +    +  <div style={{
    +    -    +    +    background: '#1E293B',
    +    -    +    +    border: '1px solid #92400E',
    +    -    +    +    borderRadius: '6px',
    +    -    +    +    padding: '10px 16px',
    +    -    +    +    marginBottom: '16px',
    +    -    +    +    fontSize: '0.8rem',
    +    -    +    +    color: '#FBBF24',
    +    -    +    +    display: 'flex',
    +    -    +    +    alignItems: 'center',
    +    -    +    +    gap: '10px',
    +    -    +    +  }}>
    +    -    +    +    <span style={{ fontSize: '1rem' }}>├ö├Â┬╝Ôö¼├¡Ôö£├║Ôö£├Ñ├ö├Â┬úÔö£├®├ö├Â┬úÔö¼┬¼</span>
    +    -    +    +    <span>
    +    -    +    +      Add your Anthropic API key in{' '}
    +    -    +    +      <Link to="/settings" style={{ color: '#60A5FA', textDecoration: 'underline' }}>Settings</Link>{' '}
    +    -    +    +      to start a build. Questionnaires and audits are free.
    +    -    +    +    </span>
    +    -    +    +  </div>
    +    -    +    +);
    +    +    +    +- **Frontend: Pause UI** on BuildProgress page:
    +    +    +    +  - When `build_paused` event received, show a modal/overlay:
    +    +    +    +    - Header: "Build paused ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® audit failed {loop_count} times on {phase}"
    +    +    +    +    - Audit findings list (from the last audit failure)
    +    +    +    +    - Four action buttons:
    +    +    +    +      - **Retry** -- "Let the builder try again"
    +    +    +    +      - **Retry with guidance** -- expands a text input where user types a message, then sends `retry_with_message`
    +    +    +    +      - **Skip phase** -- "Skip this phase and continue" (with warning that skipped phases may cause issues)
    +    +    +    +      - **Abort build** -- "Stop the build entirely" (with confirmation dialog)
    +    +    +    +    - The user's typed message is sent as part of the resume request and injected into the builder's conversation
    +         +    +
    +    -    +     interface ProjectDetailData {
    +    -    +       id: string;
    +    -    +       name: string;
    +    -    +    @@ -34,7 +56,7 @@ interface ProjectDetailData {
    +    -    +     
    +    -    +     function ProjectDetail() {
    +    -    +       const { projectId } = useParams<{ projectId: string }>();
    +    -    +    -  const { token } = useAuth();
    +    -    +    +  const { user, token } = useAuth();
    +    -    +       const { addToast } = useToast();
    +    -    +       const navigate = useNavigate();
    +    -    +       const [project, setProject] = useState<ProjectDetailData | null>(null);
    +    -    +    @@ -282,6 +304,9 @@ function ProjectDetail() {
    +    -    +               </div>
    +    -    +             </div>
    +    -    +     
    +    -    +    +        {/* BYOK warning */}
    +    -    +    +        {hasContracts && !buildActive && !(user?.has_anthropic_key) && needsKeyBanner}
    +    +    +    +- **Frontend: Interjection button** on BuildProgress page:
    +    +    +    +  - Small "Send message to builder" button (or chat input) visible while build is `running`
    +    +    +    +  - Opens a text input; on submit, calls `POST /projects/{id}/build/interject`
    +    +    +    +  - Activity feed shows "You: {message}" entry when interjection is sent
    +    +    +    +  - Activity feed shows "Builder acknowledged interjection" when it's processed
    +         +    +
    +    -    +             {/* Build Actions */}
    +    -    +             <div style={{ display: 'flex', gap: '12px', marginBottom: '24px' }}>
    +    -    +               {!buildActive && (
    +    -    +    diff --git a/web/src/pages/Settings.tsx b/web/src/pages/Settings.tsx
    +    -    +    new file mode 100644
    +    -    +    index 0000000..29c213d
    +    -    +    --- /dev/null
    +    -    +    +++ b/web/src/pages/Settings.tsx
    +    -    +    @@ -0,0 +1,280 @@
    +    -    +    +/**
    +    -    +    + * Settings -- user settings page with BYOK API key management.
    +    -    +    + */
    +    -    +    +import { useState } from 'react';
    +    -    +    +import { useNavigate } from 'react-router-dom';
    +    -    +    +import { useAuth } from '../context/AuthContext';
    +    -    +    +import { useToast } from '../context/ToastContext';
    +    -    +    +import AppShell from '../components/AppShell';
    +    +    +    +- **Frontend: Paused state styling**:
    +    +    +    +  - Build status badge shows "Paused" in amber/yellow
    +    +    +    +  - Phase checklist shows the paused phase with a pause icon
    +    +    +    +  - Activity feed shows "Build paused ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® awaiting user input" entry
    +         +    +
    +    -    +    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    +    +- **Timeout safeguard**:
    +    +    +    +  - If a build is paused for longer than 30 minutes (configurable via `BUILD_PAUSE_TIMEOUT_MINUTES`), automatically abort with "Build timed out while paused"
    +    +    +    +  - Background task uses `asyncio.wait_for(event.wait(), timeout=1800)`
    +         +    +
    +    -    +    +function Settings() {
    +    -    +    +  const { user, token, updateUser } = useAuth();
    +    -    +    +  const { addToast } = useToast();
    +    -    +    +  const navigate = useNavigate();
    +    +    +    +**Schema coverage:**
    +    +    +    +- [x] builds (extended with pause columns)
    +         +    +
    +    -    +    +  const [apiKey, setApiKey] = useState('');
    +    -    +    +  const [saving, setSaving] = useState(false);
    +    -    +    +  const [removing, setRemoving] = useState(false);
    +    +    +    +**Exit criteria:**
    +    +    +    +- Build pauses after 3 audit failures on a single phase instead of dying
    +    +    +    +- Pause UI shows audit findings and four action options
    +    +    +    +- "Retry" resumes the build and the builder attempts the phase again
    +    +    +    +- "Retry with guidance" injects the user's message into the builder's conversation before retrying
    +    +    +    +- "Skip phase" advances to the next phase
    +    +    +    +- "Abort" stops the build with a clear status message
    +    +    +    +- Proactive interjection works mid-build -- user can send guidance at any time
    +    +    +    +- Interjection message appears in the builder's next conversation turn
    +    +    +    +- Paused build times out after 30 minutes if no action taken
    +    +    +    +- Activity feed shows all pause/resume/interjection events
    +    +    +    +- All existing tests still pass + new tests for pause/resume, interjection, timeout, and all action types
    +    +    +    +- `run_audit.ps1` passes all checks
    +    +         +
    +    +    -    +export default Settings;
    +    +    -    diff --git a/web/vite.config.ts b/web/vite.config.ts
    +    +    -    index 136369a..43cba1f 100644
    +    +    -    --- a/web/vite.config.ts
    +    +    -    +++ b/web/vite.config.ts
    +    +    -    @@ -1,6 +1,18 @@
    +    +    -     import { defineConfig } from 'vite';
    +    +    -     import react from '@vitejs/plugin-react';
    +    +    -     
    +    +    -    +/* Bypass proxy for browser page navigations (Accept: text/html) so Vite
    +    +    -    +   serves index.html and React Router handles the route. API fetch() calls
    +    +    -    +   (Accept: application/json) still proxy to the backend. */
    +    +    -    +const apiProxy = {
    +    +    -    +  target: 'http://localhost:8000',
    +    +    -    +  bypass(req: { headers: { accept?: string } }) {
    +    +    -    +    if (req.headers.accept?.includes('text/html')) {
    +    +    -    +      return '/index.html';
    +    +    -    +    }
    +    +    -    +  },
    +    +    -    +};
    +    +    +    +---
    +    +         +
    +    +    -     export default defineConfig({
    +    +    -       plugins: [react()],
    +    +    -       server: {
    +    +    -    @@ -10,11 +22,12 @@ export default defineConfig({
    +    +    -           '/auth/login': 'http://localhost:8000',
    +    +    -           '/auth/github': 'http://localhost:8000',
    +    +    -           '/auth/me': 'http://localhost:8000',
    +    +    -    -      '/repos': 'http://localhost:8000',
    +    +    -    -      '/projects': 'http://localhost:8000',
    +    +    -    +      '/auth/api-key': 'http://localhost:8000',
    +    +    -    +      '/repos': apiProxy,
    +    +    -    +      '/projects': apiProxy,
    +    +    -           '/webhooks': 'http://localhost:8000',
    +    +    -           '/ws': {
    +    +    -    -        target: 'ws://localhost:8000',
    +    +    -    +        target: 'http://localhost:8000',
    +    +    -             ws: true,
    +    +    -           },
    +    +    -         },
    +    +    +    +## Phase 15 -- Builder Intelligence Hardening
    +         +    +
    +    -    +    +  const hasKey = user?.has_anthropic_key ?? false;
    +    +    +    +**Objective:** End-to-end integration testing and refinement of the multi-turn builder pipeline. Validate that the full flow -- target selection ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ build plan ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ file writing ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ audit ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ self-correction ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ pause/resume ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ push -- works reliably. Harden edge cases, tune prompts, and ensure the builder produces genuinely usable code.
    +         +    +
    +    -    +    +  const handleSaveKey = async () => {
    +    -    +    +    const trimmed = apiKey.trim();
    +    -    +    +    if (!trimmed) return;
    +    -    +    +    setSaving(true);
    +    -    +    +    try {
    +    -    +    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    +    -    +    +        method: 'PUT',
    +    -    +    +        headers: {
    +    -    +    +          Authorization: `Bearer ${token}`,
    +    -    +    +          'Content-Type': 'application/json',
    +    -    +    +        },
    +    -    +    +        body: JSON.stringify({ api_key: trimmed }),
    +    -    +    +      });
    +    -    +    +      if (res.ok) {
    +    -    +    +        addToast('API key saved', 'success');
    +    -    +    +        setApiKey('');
    +    -    +    +        updateUser({ has_anthropic_key: true });
    +    -    +    +      } else {
    +    -    +    +        const data = await res.json().catch(() => ({ detail: 'Failed to save key' }));
    +    -    +    +        addToast(data.detail || 'Failed to save key');
    +    -    +    +      }
    +    -    +    +    } catch {
    +    -    +    +      addToast('Network error saving key');
    +    -    +    +    } finally {
    +    -    +    +      setSaving(false);
    +    -    +    +    }
    +    -    +    +  };
    +    +    +    +**Deliverables:**
    +         +    +
    +    -    +    +  const handleRemoveKey = async () => {
    +    -    +    +    setRemoving(true);
    +    -    +    +    try {
    +    -    +    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    +    -    +    +        method: 'DELETE',
    +    -    +    +        headers: { Authorization: `Bearer ${token}` },
    +    -    +    +      });
    +    -    +    +      if (res.ok) {
    +    -    +    +        addToast('API key removed', 'info');
    +    -    +    +        updateUser({ has_anthropic_key: false });
    +    -    +    +      } else {
    +    -    +    +        addToast('Failed to remove key');
    +    -    +    +      }
    +    -    +    +    } catch {
    +    -    +    +      addToast('Network error removing key');
    +    -    +    +    } finally {
    +    -    +    +      setRemoving(false);
    +    -    +    +    }
    +    -    +    +  };
    +    +    +    +- **Integration test suite** (`tests/test_build_integration.py`):
    +    +    +    +  - Full build lifecycle with mocked agent: target selection ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ plan emission ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ file blocks ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ phase sign-off ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ audit pass ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ next phase ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ completion ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ git push
    +    +    +    +  - Audit failure ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ self-correction loop (mock agent returns fixed output on second turn)
    +    +    +    +  - Audit failure ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ pause threshold ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ user retry with message ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ builder succeeds
    +    +    +    +  - Audit failure ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ pause ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ user skip ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ next phase
    +    +    +    +  - Audit failure ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ pause ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ user abort
    +    +    +    +  - Proactive interjection mid-build ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ message appears in conversation ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ builder adjusts
    +    +    +    +  - Context compaction trigger with large conversation
    +    +    +    +  - File overwrite (same path written twice)
    +    +    +    +  - Build target: local path (file writing verified on disk)
    +    +    +    +  - Build target: GitHub new repo (mocked GitHub API + git operations)
    +         +    +
    +    -    +    +  return (
    +    -    +    +    <AppShell>
    +    -    +    +      <div style={{ padding: '24px', maxWidth: '720px', margin: '0 auto' }}>
    +    -    +    +        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    +    -    +    +          <button
    +    -    +    +            onClick={() => navigate('/')}
    +    -    +    +            style={{
    +    -    +    +              background: 'transparent',
    +    -    +    +              color: '#94A3B8',
    +    -    +    +              border: '1px solid #334155',
    +    -    +    +              borderRadius: '6px',
    +    -    +    +              padding: '6px 12px',
    +    -    +    +              cursor: 'pointer',
    +    -    +    +              fontSize: '0.8rem',
    +    -    +    +            }}
    +    -    +    +          >
    +    -    +    +            Back
    +    -    +    +          </button>
    +    -    +    +          <h2 style={{ margin: 0, fontSize: '1.1rem' }}>Settings</h2>
    +    -    +    +        </div>
    +    +    +    +- **Prompt tuning**:
    +    +    +    +  - Refine builder_contract.md file block format instructions based on real LLM output patterns
    +    +    +    +  - Refine auditor_prompt.md to reduce false positives (especially the diff log TODO issue)
    +    +    +    +  - Add examples of correct file block format to the builder directive
    +    +    +    +  - Tune PAUSE_THRESHOLD default based on testing (may adjust from 3)
    +         +    +
    +    -    +    +        {/* Profile Section */}
    +    -    +    +        <div
    +    -    +    +          style={{
    +    -    +    +            background: '#1E293B',
    +    -    +    +            borderRadius: '8px',
    +    -    +    +            padding: '20px',
    +    -    +    +            marginBottom: '16px',
    +    -    +    +          }}
    +    -    +    +        >
    +    -    +    +          <h3 style={{ margin: '0 0 16px', fontSize: '0.9rem', color: '#F8FAFC' }}>Profile</h3>
    +    -    +    +          <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
    +    -    +    +            {user?.avatar_url && (
    +    -    +    +              <img
    +    -    +    +                src={user.avatar_url}
    +    -    +    +                alt={user.github_login}
    +    -    +    +                style={{ width: 48, height: 48, borderRadius: '50%' }}
    +    -    +    +              />
    +    -    +    +            )}
    +    -    +    +            <div>
    +    -    +    +              <div style={{ fontWeight: 600, fontSize: '0.95rem' }}>{user?.github_login}</div>
    +    -    +    +              <div style={{ color: '#64748B', fontSize: '0.8rem', marginTop: '2px' }}>
    +    -    +    +                Authenticated via GitHub
    +    -    +    +              </div>
    +    -    +    +            </div>
    +    -    +    +          </div>
    +    -    +    +        </div>
    +    +    +    +- **Edge case hardening**:
    +    +    +    +  - Builder emits malformed file blocks ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ graceful fallback (log warning, don't crash)
    +    +    +    +  - Builder never emits PHASE_COMPLETE_SIGNAL ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ timeout per phase (configurable, default 10 minutes)
    +    +    +    +  - Network error during git push ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ retry with backoff, then pause build with error details
    +    +    +    +  - Working directory cleanup on build completion/failure/cancellation
    +    +    +    +  - Concurrent builds per user prevention (existing rate limit enforcement)
    +    +    +    +  - Large file handling (>1MB file blocks) ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ª├ö├Â┬úÔö£├æ warn but still write
    +         +    +
    +    -    +    +        {/* BYOK API Key Section */}
    +    -    +    +        <div
    +    -    +    +          style={{
    +    -    +    +            background: '#1E293B',
    +    -    +    +            borderRadius: '8px',
    +    -    +    +            padding: '20px',
    +    -    +    +            marginBottom: '16px',
    +    -    +    +          }}
    +    -    +    +          data-testid="byok-section"
    +    -    +    +        >
    +    -    +    +          <h3 style={{ margin: '0 0 4px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    -    +    +            Anthropic API Key
    +    -    +    +          </h3>
    +    -    +    +          <p style={{ margin: '0 0 14px', fontSize: '0.75rem', color: '#64748B', lineHeight: 1.5 }}>
    +    -    +    +            Builds use Claude Opus and run on your own Anthropic API key.
    +    -    +    +            Planning, questionnaires, and audits are free ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® powered by Haiku on us.
    +    -    +    +          </p>
    +    +    +    +- **Observability**:
    +    +    +    +  - Build summary endpoint enhanced with: total turns, total audit attempts, files written count, git commits made, interjections received
    +    +    +    +  - Build logs searchable/filterable in the frontend (search bar on activity feed)
    +         +    +
    +    -    +    +          {hasKey ? (
    +    -    +    +            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    +    -    +    +              <div style={{
    +    -    +    +                flex: 1,
    +    -    +    +                display: 'flex',
    +    -    +    +                alignItems: 'center',
    +    -    +    +                gap: '8px',
    +    -    +    +                padding: '8px 12px',
    +    -    +    +                background: '#0F172A',
    +    -    +    +                borderRadius: '6px',
    +    -    +    +                fontSize: '0.8rem',
    +    -    +    +              }}>
    +    -    +    +                <span style={{ color: '#22C55E', fontSize: '0.7rem' }}>├ö├Â┬úÔö£├é├ö├Â┬ú├ö├▓├║├ö├Â┬úÔö£├í</span>
    +    -    +    +                <span style={{ color: '#94A3B8' }}>Key configured</span>
    +    -    +    +                <span style={{ color: '#64748B', fontFamily: 'monospace' }}>sk-ant-├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬ú├ö├Â├®</span>
    +    -    +    +              </div>
    +    -    +    +              <button
    +    -    +    +                onClick={handleRemoveKey}
    +    -    +    +                disabled={removing}
    +    -    +    +                data-testid="remove-api-key-btn"
    +    -    +    +                style={{
    +    -    +    +                  background: 'transparent',
    +    -    +    +                  color: '#EF4444',
    +    -    +    +                  border: '1px solid #7F1D1D',
    +    -    +    +                  borderRadius: '6px',
    +    -    +    +                  padding: '6px 14px',
    +    -    +    +                  cursor: removing ? 'not-allowed' : 'pointer',
    +    -    +    +                  fontSize: '0.75rem',
    +    -    +    +                  opacity: removing ? 0.6 : 1,
    +    -    +    +                }}
    +    -    +    +              >
    +    -    +    +                {removing ? 'Removing...' : 'Remove'}
    +    -    +    +              </button>
    +    -    +    +            </div>
    +    -    +    +          ) : (
    +    -    +    +            <div>
    +    -    +    +              <div style={{ display: 'flex', gap: '8px' }}>
    +    -    +    +                <input
    +    -    +    +                  type="password"
    +    -    +    +                  value={apiKey}
    +    -    +    +                  onChange={(e) => setApiKey(e.target.value)}
    +    -    +    +                  placeholder="sk-ant-api03-..."
    +    -    +    +                  data-testid="api-key-input"
    +    -    +    +                  style={{
    +    -    +    +                    flex: 1,
    +    -    +    +                    background: '#0F172A',
    +    -    +    +                    border: '1px solid #334155',
    +    -    +    +                    borderRadius: '6px',
    +    -    +    +                    padding: '8px 12px',
    +    -    +    +                    color: '#F8FAFC',
    +    -    +    +                    fontSize: '0.8rem',
    +    -    +    +                    fontFamily: 'monospace',
    +    -    +    +                    outline: 'none',
    +    -    +    +                  }}
    +    -    +    +                  onKeyDown={(e) => { if (e.key === 'Enter') handleSaveKey(); }}
    +    -    +    +                />
    +    -    +    +                <button
    +    -    +    +                  onClick={handleSaveKey}
    +    -    +    +                  disabled={saving || !apiKey.trim()}
    +    -    +    +                  data-testid="save-api-key-btn"
    +    -    +    +                  style={{
    +    -    +    +                    background: saving ? '#1E293B' : '#2563EB',
    +    -    +    +                    color: '#fff',
    +    -    +    +                    border: 'none',
    +    -    +    +                    borderRadius: '6px',
    +    -    +    +                    padding: '8px 18px',
    +    -    +    +                    cursor: saving || !apiKey.trim() ? 'not-allowed' : 'pointer',
    +    -    +    +                    fontSize: '0.8rem',
    +    -    +    +                    opacity: saving || !apiKey.trim() ? 0.6 : 1,
    +    -    +    +                  }}
    +    -    +    +                >
    +    -    +    +                  {saving ? 'Saving...' : 'Save Key'}
    +    -    +    +                </button>
    +    -    +    +              </div>
    +    -    +    +              <p style={{ margin: '8px 0 0', fontSize: '0.7rem', color: '#64748B' }}>
    +    -    +    +                Your key is stored securely and only used for build operations.
    +    -    +    +                Get one at{' '}
    +    -    +    +                <a
    +    -    +    +                  href="https://console.anthropic.com/settings/keys"
    +    -    +    +                  target="_blank"
    +    -    +    +                  rel="noopener noreferrer"
    +    -    +    +                  style={{ color: '#60A5FA' }}
    +    -    +    +                >
    +    -    +    +                  console.anthropic.com
    +    -    +    +                </a>
    +    -    +    +              </p>
    +    -    +    +            </div>
    +    -    +    +          )}
    +    -    +    +        </div>
    +    +    +    +- **Documentation**:
    +    +    +    +  - Update `USER_INSTRUCTIONS.md` with: build target options, how to use interjection, what happens on audit failure, pause/resume flow
    +    +    +    +  - Update `Forge/Contracts/builder_contract.md` with finalised file block format and plan format
    +         +    +
    +    -    +    +        {/* AI Models info */}
    +    -    +    +        <div
    +    -    +    +          style={{
    +    -    +    +            background: '#1E293B',
    +    -    +    +            borderRadius: '8px',
    +    -    +    +            padding: '20px',
    +    -    +    +            marginBottom: '16px',
    +    -    +    +          }}
    +    -    +    +        >
    +    -    +    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>AI Models</h3>
    +    -    +    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', fontSize: '0.8rem' }}>
    +    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    +    -    +    +              <span style={{ color: '#94A3B8' }}>Questionnaire</span>
    +    -    +    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    +    -    +    +                <span style={{ color: '#22C55E', fontWeight: 600 }}>claude-haiku-4-5</span>
    +    -    +    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>FREE</span>
    +    -    +    +              </div>
    +    -    +    +            </div>
    +    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    +    -    +    +              <span style={{ color: '#94A3B8' }}>Builder</span>
    +    -    +    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    +    -    +    +                <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    +    -    +    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>BYOK</span>
    +    -    +    +              </div>
    +    -    +    +            </div>
    +    -    +    +          </div>
    +    -    +    +        </div>
    +    +    +    +**Exit criteria:**
    +    +    +    +- All integration tests pass with mocked agent responses
    +    +    +    +- A real build (manual test) successfully creates a GitHub repo, writes files, passes audits, and pushes
    +    +    +    +- No crashes on malformed builder output
    +    +    +    +- Phase timeout triggers correctly
    +    +    +    +- Git push failures are handled gracefully
    +    +    +    +- Working directories are cleaned up
    +    +    +    +- `USER_INSTRUCTIONS.md` is comprehensive and accurate
    +    +    +    +- All tests pass (backend + frontend)
    +    +    +    +- `run_audit.ps1` passes all checks
    +    +    +    diff --git a/Forge/Contracts/physics.yaml b/Forge/Contracts/physics.yaml
    +    +    +    index b5337ec..f8e7053 100644
    +    +    +    --- a/Forge/Contracts/physics.yaml
    +    +    +    +++ b/Forge/Contracts/physics.yaml
    +    +    +    @@ -161,6 +161,8 @@ paths:
    +    +    +           messages_from_server:
    +    +    +             type: "audit_update"
    +    +    +             payload: AuditRunSummary
    +    +    +    +        type: "file_created"
    +    +    +    +        payload: BuildFileEvent
         +    +     
    -    +    +    -    recognitionRef.current = rec;
    -    +    +    -    return () => {
    -    +    +    -      listeningRef.current = false;
    -    +    +    -      rec.abort();
    -    +    +    -    };
    -    +    +    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    -    +    +    +    recRef.current = rec;
    -    +    +    +    return rec;
    -    +    +       }, []);
    +    +    +       # -- Projects (Phase 8) -------------------------------------------
         +    +     
    -    +    +    -  const toggle = useCallback(() => {
    -    +    +    -    const rec = recognitionRef.current;
    -    +    +    +  const stop = useCallback(() => {
    -    +    +    +    listeningRef.current = false;
    -    +    +    +    setListening(false);
    -    +    +    +    const rec = recRef.current;
    -    +    +    +    if (rec) {
    -    +    +    +      try { rec.stop(); } catch { /* ignore */ }
    -    +    +    +    }
    -    +    +    +  }, []);
    -    +    +    +
    -    +    +    +  const start = useCallback(() => {
    -    +    +    +    const rec = getRec();
    -    +    +         if (!rec) return;
    -    +    +    +    /* Stop any active session first, then restart */
    -    +    +    +    try { rec.stop(); } catch { /* not running */ }
    -    +    +    +    listeningRef.current = true;
    -    +    +    +    setListening(true);
    -    +    +    +    /* Small delay to let the previous stop() settle */
    -    +    +    +    setTimeout(() => {
    -    +    +    +      if (listeningRef.current) {
    -    +    +    +        try { rec.start(); } catch { /* already running */ }
    -    +    +    +      }
    -    +    +    +    }, 100);
    -    +    +    +  }, [getRec]);
    -    +    +    +
    -    +    +    +  const toggle = useCallback(() => {
    -    +    +         if (listening) {
    -    +    +    -      listeningRef.current = false;
    -    +    +    -      rec.abort();
    -    +    +    -      setListening(false);
    -    +    +    +      stop();
    -    +    +         } else {
    -    +    +    -      listeningRef.current = true;
    -    +    +    -      rec.start();
    -    +    +    -      setListening(true);
    -    +    +    +      start();
    -    +    +         }
    -    +    +    -  }, [listening]);
    -    +    +    +  }, [listening, start, stop]);
    -    +    +    +
    -    +    +    +  /* Cleanup on unmount */
    -    +    +    +  useEffect(() => {
    -    +    +    +    return () => {
    -    +    +    +      listeningRef.current = false;
    -    +    +    +      const rec = recRef.current;
    -    +    +    +      recRef.current = null;
    -    +    +    +      if (rec) {
    -    +    +    +        rec.onresult = null;
    -    +    +    +        rec.onerror = null;
    -    +    +    +        rec.onend = null;
    -    +    +    +        try { rec.abort(); } catch { /* ignore */ }
    -    +    +    +      }
    -    +    +    +    };
    -    +    +    +  }, []);
    +    +    +    @@ -267,11 +269,16 @@ paths:
    +    +    +         post:
    +    +    +           summary: "Start a build (validates contracts exist, spawns builder)"
    +    +    +           auth: bearer
    +    +    +    +      request:
    +    +    +    +        target_type: string (required, enum: github_new, github_existing, local_path)
    +    +    +    +        target_ref: string (required, repo name / full_name / absolute path)
    +    +    +           response:
    +    +    +             id: uuid
    +    +    +             project_id: uuid
    +    +    +             phase: string
    +    +    +             status: string
    +    +    +    +        target_type: string
    +    +    +    +        target_ref: string
    +    +    +             started_at: datetime
    +    +    +             created_at: datetime
         +    +     
    -    +    +       return { listening, toggle, supported: !!SpeechRecognition };
    -    +    +     }
    +    +    +    @@ -298,6 +305,23 @@ paths:
    +    +    +             error_detail: string | null
    +    +    +             created_at: datetime
         +    +     
    -    +    +    -function speak(text: string) {
    -    +    +    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    -    +    +    -  window.speechSynthesis.cancel();
    -    +    +    -  const utter = new SpeechSynthesisUtterance(text);
    -    +    +    -  utter.rate = 1.05;
    -    +    +    -  utter.pitch = 1;
    -    +    +    -  window.speechSynthesis.speak(utter);
    -    +    +    -}
    -    +    +    +
    +    +    +    +  /projects/{project_id}/build/files:
    +    +    +    +    get:
    +    +    +    +      summary: "List all files written during the build"
    +    +    +    +      auth: bearer
    +    +    +    +      response:
    +    +    +    +        items: BuildFile[]
    +         +    +
    +    -    +    +        {/* About Section */}
    +    -    +    +        <div
    +    -    +    +          style={{
    +    -    +    +            background: '#1E293B',
    +    -    +    +            borderRadius: '8px',
    +    -    +    +            padding: '20px',
    +    -    +    +          }}
    +    -    +    +        >
    +    -    +    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>About</h3>
    +    -    +    +          <div style={{ fontSize: '0.8rem', color: '#94A3B8', display: 'flex', flexDirection: 'column', gap: '6px' }}>
    +    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    +    -    +    +              <span>Version</span>
    +    -    +    +              <span style={{ color: '#F8FAFC' }}>v0.1.0</span>
    +    -    +    +            </div>
    +    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    +    -    +    +              <span>Framework</span>
    +    -    +    +              <span style={{ color: '#F8FAFC' }}>Forge Governance</span>
    +    -    +    +            </div>
    +    -    +    +          </div>
    +    -    +    +        </div>
    +    -    +    +      </div>
    +    -    +    +    </AppShell>
    +    -    +    +  );
    +    -    +    +}
    +    +    +    +  /projects/{project_id}/build/files/{path}:
    +    +    +    +    get:
    +    +    +    +      summary: "Retrieve content of a specific file written during the build"
    +    +    +    +      auth: bearer
    +    +    +    +      response:
    +    +    +    +        path: string
    +    +    +    +        content: string
    +    +    +    +        size_bytes: integer
    +    +    +    +        language: string
    +         +    +
    +    -    +    +export default Settings;
    +    -    +    diff --git a/web/vite.config.ts b/web/vite.config.ts
    +    -    +    index 136369a..43cba1f 100644
    +    -    +    --- a/web/vite.config.ts
    +    -    +    +++ b/web/vite.config.ts
    +    -    +    @@ -1,6 +1,18 @@
    +    -    +     import { defineConfig } from 'vite';
    +    -    +     import react from '@vitejs/plugin-react';
    +    -    +     
    +    -    +    +/* Bypass proxy for browser page navigations (Accept: text/html) so Vite
    +    -    +    +   serves index.html and React Router handles the route. API fetch() calls
    +    -    +    +   (Accept: application/json) still proxy to the backend. */
    +    -    +    +const apiProxy = {
    +    -    +    +  target: 'http://localhost:8000',
    +    -    +    +  bypass(req: { headers: { accept?: string } }) {
    +    -    +    +    if (req.headers.accept?.includes('text/html')) {
    +    -    +    +      return '/index.html';
    +    -    +    +    }
    +    -    +    +  },
    +    -    +    +};
    +    +    +       /projects/{project_id}/build/logs:
    +    +    +         get:
    +    +    +           summary: "Paginated build logs"
    +    +    +    @@ -422,12 +446,20 @@ schemas:
    +    +    +         message: string
    +    +    +         created_at: datetime
         +    +     
    -    +    +     /* ------------------------------------------------------------------ */
    -    +    +     /*  Progress bar                                                      */
    -    +    +    @@ -265,7 +305,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +    +       const [messages, setMessages] = useState<ChatMessage[]>([]);
    -    +    +       const [input, setInput] = useState('');
    -    +    +       const [sending, setSending] = useState(false);
    -    +    +    -  const [generating, setGenerating] = useState(false);
    -    +    +       const [qState, setQState] = useState<QuestionnaireState>({
    -    +    +         current_section: 'product_intent',
    -    +    +         completed_sections: [],
    -    +    +    @@ -273,7 +312,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +    +         is_complete: false,
    -    +    +       });
    -    +    +       const [error, setError] = useState('');
    -    +    +    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    -    +    +    +  const [resetting, setResetting] = useState(false);
    -    +    +    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    -    +    +    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    -    +    +       const messagesEndRef = useRef<HTMLDivElement>(null);
    -    +    +       const textareaRef = useRef<HTMLTextAreaElement>(null);
    +    +    +    +  BuildFile:
    +    +    +    +    path: string
    +    +    +    +    size_bytes: integer
    +    +    +    +    language: string
    +    +    +    +    created_at: datetime
    +         +    +
    +    -    +     export default defineConfig({
    +    -    +       plugins: [react()],
    +    -    +       server: {
    +    -    +    @@ -10,11 +22,12 @@ export default defineConfig({
    +    -    +           '/auth/login': 'http://localhost:8000',
    +    -    +           '/auth/github': 'http://localhost:8000',
    +    -    +           '/auth/me': 'http://localhost:8000',
    +    -    +    -      '/repos': 'http://localhost:8000',
    +    -    +    -      '/projects': 'http://localhost:8000',
    +    -    +    +      '/auth/api-key': 'http://localhost:8000',
    +    -    +    +      '/repos': apiProxy,
    +    -    +    +      '/projects': apiProxy,
    +    -    +           '/webhooks': 'http://localhost:8000',
    +    -    +           '/ws': {
    +    -    +    -        target: 'ws://localhost:8000',
    +    -    +    +        target: 'http://localhost:8000',
    +    -    +             ws: true,
    +    -    +           },
    +    -    +         },
    +    -     
    +    -    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    +    -    index 369350b..d8df0cf 100644
    +    -    --- a/Forge/scripts/run_audit.ps1
    +    -    +++ b/Forge/scripts/run_audit.ps1
    +    -    @@ -1,4 +1,4 @@
    +    -    -Ôö¼Ôöñ├ö├▓├╣├ö├Â├ë# scripts/run_audit.ps1
    +    -    +# scripts/run_audit.ps1
    +    -     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    +    -     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    +    -     # Reads layer boundaries from Contracts/boundaries.json.
    +    -    @@ -24,7 +24,7 @@ param(
    +    -     Set-StrictMode -Version Latest
    +    -     $ErrorActionPreference = "Stop"
    +    +    +       BuildStatus:
    +    +    +         id: uuid
    +    +    +         project_id: uuid
    +    +    +         phase: string
    +    +    +         status: string
    +    +    +         loop_count: integer
    +    +    +    +    target_type: string | null
    +    +    +    +    target_ref: string | null
    +    +    +         started_at: datetime | null
    +    +    +         completed_at: datetime | null
    +    +    +         error_detail: string | null
    +    +    +    diff --git a/Forge/Contracts/schema.md b/Forge/Contracts/schema.md
    +    +    +    index e68e84e..6871701 100644
    +    +    +    --- a/Forge/Contracts/schema.md
    +    +    +    +++ b/Forge/Contracts/schema.md
    +    +    +    @@ -183,6 +183,9 @@ CREATE TABLE builds (
    +    +    +         project_id      UUID NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
    +    +    +         phase           VARCHAR(100) NOT NULL DEFAULT 'Phase 0',
    +    +    +         status          VARCHAR(20) NOT NULL DEFAULT 'pending',
    +    +    +    +    target_type     VARCHAR(20),
    +    +    +    +    target_ref      TEXT,
    +    +    +    +    working_dir     TEXT,
    +    +    +         started_at      TIMESTAMPTZ,
    +    +    +         completed_at    TIMESTAMPTZ,
    +    +    +         loop_count      INTEGER NOT NULL DEFAULT 0,
    +    +    +    @@ -192,6 +195,7 @@ CREATE TABLE builds (
    +    +    +     ```
         +    +     
    -    +    +    @@ -307,13 +348,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +    +                 remaining_sections: state.remaining_sections,
    -    +    +                 is_complete: state.is_complete,
    -    +    +               });
    -    +    +    -          /* Restore prior conversation */
    -    +    +    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    -    +    +    -            (m: { role: string; content: string }) => ({
    -    +    +    -              role: m.role as 'user' | 'assistant',
    -    +    +    -              content: m.content,
    -    +    +    -            }),
    -    +    +    -          );
    -    +    +    +          /* Restore prior conversation ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® only messages from the current section */
    -    +    +    +          const currentSec = state.current_section;
    -    +    +    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    -    +    +    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    -    +    +    +            .map(
    -    +    +    +              (m: { role: string; content: string; section?: string }) => ({
    -    +    +    +                role: m.role as 'user' | 'assistant',
    -    +    +    +                content: m.content,
    -    +    +    +                section: m.section,
    -    +    +    +              }),
    -    +    +    +            );
    -    +    +    +          /* Restore token usage */
    -    +    +    +          if (state.token_usage) {
    -    +    +    +            setTokenUsage(state.token_usage);
    -    +    +    +          }
    -    +    +               if (history.length > 0) {
    -    +    +                 setMessages(history);
    -    +    +               } else if (!state.is_complete) {
    -    +    +    @@ -367,18 +416,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +    +           }
    +    +    +     `status` values: `pending`, `running`, `completed`, `failed`, `cancelled`
    +    +    +    +`target_type` values: `github_new`, `github_existing`, `local_path`, `null` (legacy builds)
         +    +     
    -    +    +           const data = await res.json();
    -    +    +    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    -    +    +    +
    -    +    +    +      /* Detect section transition ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® clear visible messages for a fresh screen */
    -    +    +    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    -    +    +    +      const prevSection = qState.current_section;
    -    +    +    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    -    +    +    +
    -    +    +    +      if (sectionChanged) {
    -    +    +    +        /* Section just completed ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® start fresh with only the transition reply */
    -    +    +    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    -    +    +    +      } else {
    -    +    +    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    -    +    +    +      }
    -    +    +    +
    -    +    +           setQState({
    -    +    +    -        current_section: data.remaining_sections[0] ?? null,
    -    +    +    +        current_section: newCurrentSection,
    -    +    +             completed_sections: data.completed_sections,
    -    +    +             remaining_sections: data.remaining_sections,
    -    +    +             is_complete: data.is_complete,
    -    +    +           });
    -    +    +     
    -    +    +    -      /* auto-read assistant reply with TTS */
    -    +    +    -      if (voiceEnabled) {
    -    +    +    -        speak(data.reply);
    -    +    +    +      /* Update token usage */
    -    +    +    +      if (data.token_usage) {
    -    +    +    +        setTokenUsage(data.token_usage);
    -    +    +           }
    -    +    +    +
    -    +    +         } catch {
    -    +    +           setError('Network error');
    -    +    +         } finally {
    -    +    +    @@ -387,25 +449,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +    +       };
    -    +    +     
    -    +    +       /* ---- Generate contracts ---- */
    -    +    +    -  const handleGenerate = async () => {
    -    +    +    -    setGenerating(true);
    -    +    +    -    setError('');
    -    +    +    -    try {
    -    +    +    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    -    +    +    -        method: 'POST',
    -    +    +    -        headers: { Authorization: `Bearer ${token}` },
    -    +    +    -      });
    -    +    +    -      if (res.ok) {
    -    +    +    -        onContractsGenerated();
    -    +    +    -      } else {
    -    +    +    -        const d = await res.json().catch(() => ({}));
    -    +    +    -        setError(d.detail || 'Failed to generate contracts');
    -    +    +    -      }
    -    +    +    -    } catch {
    -    +    +    -      setError('Network error');
    -    +    +    -    } finally {
    -    +    +    -      setGenerating(false);
    -    +    +    -    }
    -    +    +    +  const handleStartGenerate = () => {
    -    +    +    +    setGeneratingContracts(true);
    -    +    +       };
    -    +    +     
    -    +    +       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    -    +    +    @@ -442,21 +487,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +    +                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    -    +    +                       : 'Starting...'}
    -    +    +                 </p>
    -    +    +    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    -    +    +    +              Model: claude-haiku-4-5
    -    +    +    +            </p>
    -    +    +    +            {/* Context window meter */}
    -    +    +    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    -    +    +    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    -    +    +    +              const contextWindow = 200_000;
    -    +    +    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    -    +    +    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    -    +    +    +              return (
    -    +    +    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    -    +    +    +                  <div style={{
    -    +    +    +                    flex: 1,
    -    +    +    +                    height: '4px',
    -    +    +    +                    background: '#1E293B',
    -    +    +    +                    borderRadius: '2px',
    -    +    +    +                    overflow: 'hidden',
    -    +    +    +                    maxWidth: '120px',
    -    +    +    +                  }}>
    -    +    +    +                    <div style={{
    -    +    +    +                      width: `${pct}%`,
    -    +    +    +                      height: '100%',
    -    +    +    +                      background: barColor,
    -    +    +    +                      borderRadius: '2px',
    -    +    +    +                      transition: 'width 0.3s',
    -    +    +    +                    }} />
    -    +    +    +                  </div>
    -    +    +    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    -    +    +    +                    {totalTokens.toLocaleString()} / 200K
    -    +    +    +                  </span>
    -    +    +    +                </div>
    -    +    +    +              );
    -    +    +    +            })()}
    -    +    +               </div>
    -    +    +               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    -    +    +    -            {/* Voice toggle */}
    -    +    +    +            {/* Restart questionnaire */}
    -    +    +                 <button
    -    +    +    -              onClick={() => setVoiceEnabled((v) => !v)}
    -    +    +    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    -    +    +    -              data-testid="voice-toggle"
    -    +    +    +              onClick={async () => {
    -    +    +    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    -    +    +    +                setResetting(true);
    -    +    +    +                try {
    -    +    +    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    -    +    +    +                    method: 'DELETE',
    -    +    +    +                    headers: { Authorization: `Bearer ${token}` },
    -    +    +    +                  });
    -    +    +    +                  if (res.ok) {
    -    +    +    +                    setMessages([]);
    -    +    +    +                    setQState({
    -    +    +    +                      current_section: 'product_intent',
    -    +    +    +                      completed_sections: [],
    -    +    +    +                      remaining_sections: [...ALL_SECTIONS],
    -    +    +    +                      is_complete: false,
    -    +    +    +                    });
    -    +    +    +                    setInput('');
    -    +    +    +                    setError('');
    -    +    +    +                  }
    -    +    +    +                } catch { /* ignore */ }
    -    +    +    +                setResetting(false);
    -    +    +    +              }}
    -    +    +    +              disabled={resetting}
    -    +    +    +              title="Restart questionnaire"
    -    +    +    +              data-testid="restart-btn"
    -    +    +                   style={{
    -    +    +                     ...btnGhost,
    -    +    +                     padding: '6px 10px',
    -    +    +    -                fontSize: '1rem',
    -    +    +    -                opacity: voiceEnabled ? 1 : 0.5,
    -    +    +    +                fontSize: '0.7rem',
    -    +    +    +                fontWeight: 600,
    -    +    +    +                color: '#F59E0B',
    -    +    +    +                borderColor: '#F59E0B33',
    -    +    +    +                opacity: resetting ? 0.5 : 1,
    -    +    +                   }}
    -    +    +                 >
    -    +    +    -              {voiceEnabled ? '├ö├Â┬╝Ôö¼├¡Ôö£├║Ôö£├Ñ├ö├Â┬úÔö£├®├ö├Â┬úÔö¼ÔöÉ' : '├ö├Â┬╝Ôö¼├¡Ôö£├║Ôö£├Ñ├ö├Â┬úÔö£├®├ö├Â┬úÔö¼Ôòæ'}
    -    +    +    +              ├ö├Â┬úÔö£├é├ö├Â┬úÔö£├ªÔö£├ÂÔö£ÔûôÔö£Ôòú Restart
    -    +    +                 </button>
    -    +    +                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    -    +    +                   ├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├╗├┤
    -    +    +    @@ -514,8 +617,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +    +               </div>
    -    +    +             )}
    -    +    +     
    -    +    +    +        {/* Contract generation progress */}
    -    +    +    +        {generatingContracts && (
    -    +    +    +          <ContractProgress
    -    +    +    +            projectId={projectId}
    -    +    +    +            tokenUsage={tokenUsage}
    -    +    +    +            model="claude-haiku-4-5"
    -    +    +    +            onComplete={onContractsGenerated}
    -    +    +    +          />
    -    +    +    +        )}
    -    +    +    +
    -    +    +             {/* Generate contracts banner */}
    -    +    +    -        {qState.is_complete && (
    -    +    +    +        {qState.is_complete && !generatingContracts && (
    -    +    +               <div
    -    +    +                 style={{
    -    +    +                   padding: '12px 20px',
    -    +    +    @@ -533,17 +646,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +    +                   ├ö├Â┬úÔö£├é├ö├Â┬╝Ôö£Ôòæ├ö├Â┬ú├ö├Â├▒ All sections complete ├ö├Â┬úÔö£├é├ö├Â┬úÔö£┬║├ö├Â┬úÔö£├® ready to generate contracts
    -    +    +                 </span>
    -    +    +                 <button
    -    +    +    -              onClick={handleGenerate}
    -    +    +    -              disabled={generating}
    -    +    +    +              onClick={handleStartGenerate}
    -    +    +                   data-testid="generate-contracts-btn"
    -    +    +                   style={{
    -    +    +                     ...btnPrimary,
    -    +    +                     background: '#16A34A',
    -    +    +    -                opacity: generating ? 0.6 : 1,
    -    +    +    -                cursor: generating ? 'wait' : 'pointer',
    -    +    +    +                cursor: 'pointer',
    -    +    +                   }}
    -    +    +                 >
    -    +    +    -              {generating ? 'Generating...' : 'Generate Contracts'}
    -    +    +    +              Generate Contracts
    -    +    +                 </button>
    -    +    +               </div>
    -    +    +             )}
    -    +     
    -    +    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    -    +    index 369350b..d8df0cf 100644
    -    +    --- a/Forge/scripts/run_audit.ps1
    -    +    +++ b/Forge/scripts/run_audit.ps1
    -    +    @@ -1,4 +1,4 @@
    -    +    -Ôö¼Ôöñ├ö├▓├╣├ö├Â├ë# scripts/run_audit.ps1
    -    +    +# scripts/run_audit.ps1
    -    +     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    -    +     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    -    +     # Reads layer boundaries from Contracts/boundaries.json.
    -    +    @@ -24,7 +24,7 @@ param(
    -    +     Set-StrictMode -Version Latest
    -    +     $ErrorActionPreference = "Stop"
    -    +     
    -    +    -# Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Helpers Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +# -- Helpers ------------------------------------------------------------------
    -    +     
    -    +     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    -    +     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    -    +    @@ -41,7 +41,7 @@ function RepoRoot {
    -    +       return (& git rev-parse --show-toplevel).Trim()
    -    +     }
    -    +     
    -    +    -# Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Main Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +# -- Main ---------------------------------------------------------------------
    -    +     
    -    +     try {
    -    +       RequireGit
    -    +    @@ -54,10 +54,10 @@ try {
    -    +       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    -    +     
    -    +       # Parse claimed files into a sorted, normalized set
    -    +    -  $claimed = $ClaimedFiles.Split(",") |
    -    +    +  $claimed = @($ClaimedFiles.Split(",") |
    -    +         ForEach-Object { $_.Trim().Replace("\", "/") } |
    -    +         Where-Object { $_ -ne "" } |
    -    +    -    Sort-Object -Unique
    -    +    +    Sort-Object -Unique)
    -    +     
    -    +       if ($claimed.Count -eq 0) {
    -    +         throw "ClaimedFiles is empty."
    -    +    @@ -79,7 +79,7 @@ try {
    -    +       $warnings  = [ordered]@{}
    -    +       $anyFail   = $false
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A1: Scope compliance Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A1: Scope compliance -----------------------------------------------
    -    +     
    -    +       try {
    -    +         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    -    +    @@ -111,7 +111,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A2: Minimal-diff discipline Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A2: Minimal-diff discipline ----------------------------------------
    -    +     
    -    +       try {
    -    +         $summaryRaw = & git diff --cached --summary 2>&1
    -    +    @@ -133,7 +133,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A3: Evidence completeness Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A3: Evidence completeness ------------------------------------------
    -    +     
    -    +       try {
    -    +         $a3Failures = @()
    -    +    @@ -164,7 +164,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A4: Boundary compliance (reads Contracts/boundaries.json) Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
    -    +     
    -    +       try {
    -    +         $a4Violations = @()
    -    +    @@ -213,7 +213,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A5: Diff Log Gate Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A5: Diff Log Gate --------------------------------------------------
    -    +     
    -    +       try {
    -    +         if (-not (Test-Path $diffLog)) {
    -    +    @@ -237,7 +237,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A6: Authorization Gate Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A6: Authorization Gate ---------------------------------------------
    -    +     
    -    +       try {
    -    +         $lastAuthHash = $null
    -    +    @@ -268,7 +268,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A7: Verification hierarchy order Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A7: Verification hierarchy order -----------------------------------
    -    +     
    -    +       try {
    -    +         if (-not (Test-Path $diffLog)) {
    -    +    @@ -324,7 +324,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A8: Test gate Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A8: Test gate ------------------------------------------------------
    -    +     
    -    +       try {
    -    +         if (-not (Test-Path $testRunsLatest)) {
    -    +    @@ -344,7 +344,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A9: Dependency gate Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- A9: Dependency gate ------------------------------------------------
    -    +     
    -    +       try {
    -    +         $a9Failures = @()
    -    +    @@ -508,7 +508,7 @@ try {
    -    +         $anyFail = $true
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º W1: No secrets in diff Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- W1: No secrets in diff --------------------------------------------
    -    +     
    -    +       try {
    -    +         $diffContent = & git diff --cached 2>&1
    -    +    @@ -534,7 +534,7 @@ try {
    -    +         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º W2: Audit ledger integrity Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- W2: Audit ledger integrity ----------------------------------------
    -    +     
    -    +       try {
    -    +         if (-not (Test-Path $auditLedger)) {
    -    +    @@ -548,7 +548,7 @@ try {
    -    +         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º W3: Physics route coverage Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- W3: Physics route coverage ----------------------------------------
    -    +     
    -    +       try {
    -    +         if (-not (Test-Path $physicsYaml)) {
    -    +    @@ -613,7 +613,7 @@ try {
    -    +         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    -    +       }
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Build output Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- Build output ------------------------------------------------------
    -    +     
    -    +       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    -    +     
    -    +    @@ -643,7 +643,7 @@ Overall: $overall
    -    +     
    -    +       Write-Output $output
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Append to audit ledger Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- Append to audit ledger ---------------------------------------------
    -    +     
    -    +       $iteration = 1
    -    +       if (Test-Path $auditLedger) {
    -    +    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    -    +       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    -    +       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    -    +     
    -    +    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Exit Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    -    +    +  # -- Exit ---------------------------------------------------------------
    -    +     
    -    +       if ($anyFail) {
    -    +         exit 1
    -    +    diff --git a/USER_INSTRUCTIONS.md b/USER_INSTRUCTIONS.md
    -    +    index c76b33a..ad50c71 100644
    -    +    --- a/USER_INSTRUCTIONS.md
    -    +    +++ b/USER_INSTRUCTIONS.md
    -    +    @@ -87,7 +87,7 @@ APP_URL=http://localhost:8000
    -    +     - `APP_URL` Ôö£├ÂÔö£├ºÔö£├é `http://localhost:8000`
    -    +     - `ANTHROPIC_API_KEY` Ôö£├ÂÔö£├ºÔö£├é required for AI-powered builds (get one at [console.anthropic.com](https://console.anthropic.com))
    -    +     - `LLM_BUILDER_MODEL` Ôö£├ÂÔö£├ºÔö£├é model for builds (default: `claude-opus-4-6`)
    -    +    -- `LLM_QUESTIONNAIRE_MODEL` Ôö£├ÂÔö£├ºÔö£├é model for questionnaire (default: `claude-3-5-haiku-20241022`)
    -    +    +- `LLM_QUESTIONNAIRE_MODEL` Ôö£├ÂÔö£├ºÔö£├é model for questionnaire (default: `claude-haiku-4-5`)
    -    +     
    -    +     ---
    -    +     
    -    +    diff --git a/app/api/routers/auth.py b/app/api/routers/auth.py
    -    +    index dffd10d..cf3df44 100644
    -    +    --- a/app/api/routers/auth.py
    -    +    +++ b/app/api/routers/auth.py
    -    +    @@ -1,13 +1,15 @@
    -    +    -"""Authentication router -- GitHub OAuth flow and user info."""
    -    +    +"""Authentication router -- GitHub OAuth flow, user info, and BYOK API key management."""
    -    +     
    -    +     import secrets
    -    +     from urllib.parse import urlencode
    -    +     
    -    +     from fastapi import APIRouter, Depends, HTTPException, Query, status
    +    +    +     ```sql
    +    +    +     CREATE INDEX idx_builds_project_id ON builds(project_id);
    +    +    +    @@ -275,4 +279,8 @@ db/migrations/
    +    +    +       002_projects.sql
    +    +    +       003_builds.sql
    +    +    +       004_build_costs.sql
    +    +    +    +  005_questionnaire_state.sql
    +    +    +    +  006_user_api_key.sql
    +    +    +    +  007_audit_llm_toggle.sql
    +    +    +    +  008_build_targets.sql
    +    +    +     ```
    +          
    +    -    -# Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Helpers Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +# -- Helpers ------------------------------------------------------------------
    +    +    diff --git a/app/api/routers/builds.py b/app/api/routers/builds.py
    +    +    index 6ef15b8..6ed7f39 100644
    +    +    --- a/app/api/routers/builds.py
    +    +    +++ b/app/api/routers/builds.py
    +    +    @@ -3,6 +3,7 @@
    +    +     from uuid import UUID
    +          
    +    -     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    +    -     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    +    -    @@ -41,7 +41,7 @@ function RepoRoot {
    +    -       return (& git rev-parse --show-toplevel).Trim()
    +    -     }
    +    +     from fastapi import APIRouter, Depends, HTTPException, Query
         +    +from pydantic import BaseModel
    -    +     
    +          
    +    -    -# Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Main Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +# -- Main ---------------------------------------------------------------------
         +     from app.api.deps import get_current_user
    -    +     from app.clients.github_client import GITHUB_OAUTH_URL
    -    +     from app.config import settings
    -    +    +from app.repos.user_repo import set_anthropic_api_key
    -    +     from app.services.auth_service import handle_github_callback
    -    +     
    -    +     router = APIRouter(prefix="/auth", tags=["auth"])
    -    +    @@ -66,8 +68,36 @@ async def get_current_user_info(
    -    +         current_user: dict = Depends(get_current_user),
    -    +     ) -> dict:
    -    +         """Return the current authenticated user info."""
    -    +    +    has_api_key = bool(current_user.get("anthropic_api_key"))
    -    +         return {
    -    +             "id": str(current_user["id"]),
    -    +             "github_login": current_user["github_login"],
    -    +             "avatar_url": current_user.get("avatar_url"),
    -    +    +        "has_anthropic_key": has_api_key,
    -    +         }
    +    +     from app.api.rate_limit import build_limiter
    +    +    @@ -11,19 +12,31 @@ from app.services import build_service
    +    +     router = APIRouter(prefix="/projects", tags=["builds"])
    +          
    +    -     try {
    +    -       RequireGit
    +    -    @@ -54,10 +54,10 @@ try {
    +    -       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    +          
    +    -       # Parse claimed files into a sorted, normalized set
    +    -    -  $claimed = $ClaimedFiles.Split(",") |
    +    -    +  $claimed = @($ClaimedFiles.Split(",") |
    +    -         ForEach-Object { $_.Trim().Replace("\", "/") } |
    +    -         Where-Object { $_ -ne "" } |
    +    -    -    Sort-Object -Unique
    +    -    +    Sort-Object -Unique)
    +    +    +class StartBuildRequest(BaseModel):
    +    +    +    """Request body for starting a build."""
    +    +    +    target_type: str | None = None
    +    +    +    target_ref: str | None = None
         +    +
         +    +
    -    +    +class ApiKeyBody(BaseModel):
    -    +    +    api_key: str
    +    +     # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º POST /projects/{project_id}/build Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +          
    +    -       if ($claimed.Count -eq 0) {
    +    -         throw "ClaimedFiles is empty."
    +    -    @@ -79,7 +79,7 @@ try {
    +    -       $warnings  = [ordered]@{}
    +    -       $anyFail   = $false
    +          
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A1: Scope compliance Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A1: Scope compliance -----------------------------------------------
    +    -     
    +    -       try {
    +    -         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    +    -    @@ -111,7 +111,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A2: Minimal-diff discipline Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A2: Minimal-diff discipline ----------------------------------------
    +    -     
    +    -       try {
    +    -         $summaryRaw = & git diff --cached --summary 2>&1
    +    -    @@ -133,7 +133,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A3: Evidence completeness Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A3: Evidence completeness ------------------------------------------
    +    -     
    +    -       try {
    +    -         $a3Failures = @()
    +    -    @@ -164,7 +164,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A4: Boundary compliance (reads Contracts/boundaries.json) Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
    +    -     
    +    -       try {
    +    -         $a4Violations = @()
    +    -    @@ -213,7 +213,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A5: Diff Log Gate Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A5: Diff Log Gate --------------------------------------------------
    +    -     
    +    -       try {
    +    -         if (-not (Test-Path $diffLog)) {
    +    -    @@ -237,7 +237,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A6: Authorization Gate Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A6: Authorization Gate ---------------------------------------------
    +    -     
    +    -       try {
    +    -         $lastAuthHash = $null
    +    -    @@ -268,7 +268,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A7: Verification hierarchy order Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A7: Verification hierarchy order -----------------------------------
    +    -     
    +    -       try {
    +    -         if (-not (Test-Path $diffLog)) {
    +    -    @@ -324,7 +324,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A8: Test gate Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A8: Test gate ------------------------------------------------------
    +    -     
    +    -       try {
    +    -         if (-not (Test-Path $testRunsLatest)) {
    +    -    @@ -344,7 +344,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º A9: Dependency gate Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- A9: Dependency gate ------------------------------------------------
    +    -     
    +    -       try {
    +    -         $a9Failures = @()
    +    -    @@ -508,7 +508,7 @@ try {
    +    -         $anyFail = $true
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º W1: No secrets in diff Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- W1: No secrets in diff --------------------------------------------
    +    -     
    +    -       try {
    +    -         $diffContent = & git diff --cached 2>&1
    +    -    @@ -534,7 +534,7 @@ try {
    +    -         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º W2: Audit ledger integrity Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- W2: Audit ledger integrity ----------------------------------------
    +    -     
    +    -       try {
    +    -         if (-not (Test-Path $auditLedger)) {
    +    -    @@ -548,7 +548,7 @@ try {
    +    -         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º W3: Physics route coverage Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- W3: Physics route coverage ----------------------------------------
    +    -     
    +    -       try {
    +    -         if (-not (Test-Path $physicsYaml)) {
    +    -    @@ -613,7 +613,7 @@ try {
    +    -         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    +    -       }
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Build output Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- Build output ------------------------------------------------------
    +    -     
    +    -       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    +    -     
    +    -    @@ -643,7 +643,7 @@ Overall: $overall
    +    -     
    +    -       Write-Output $output
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Append to audit ledger Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- Append to audit ledger ---------------------------------------------
    +    -     
    +    -       $iteration = 1
    +    -       if (Test-Path $auditLedger) {
    +    -    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    +    -       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    +    -       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    +    -     
    +    -    -  # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º Exit Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -    +  # -- Exit ---------------------------------------------------------------
    +    -     
    +    -       if ($anyFail) {
    +    -         exit 1
    +    -    diff --git a/USER_INSTRUCTIONS.md b/USER_INSTRUCTIONS.md
    +    -    index c76b33a..ad50c71 100644
    +    -    --- a/USER_INSTRUCTIONS.md
    +    -    +++ b/USER_INSTRUCTIONS.md
    +    -    @@ -87,7 +87,7 @@ APP_URL=http://localhost:8000
    +    -     - `APP_URL` Ôö£├ÂÔö£├ºÔö£├é `http://localhost:8000`
    +    -     - `ANTHROPIC_API_KEY` Ôö£├ÂÔö£├ºÔö£├é required for AI-powered builds (get one at [console.anthropic.com](https://console.anthropic.com))
    +    -     - `LLM_BUILDER_MODEL` Ôö£├ÂÔö£├ºÔö£├é model for builds (default: `claude-opus-4-6`)
    +    -    -- `LLM_QUESTIONNAIRE_MODEL` Ôö£├ÂÔö£├ºÔö£├é model for questionnaire (default: `claude-3-5-haiku-20241022`)
    +    -    +- `LLM_QUESTIONNAIRE_MODEL` Ôö£├ÂÔö£├ºÔö£├é model for questionnaire (default: `claude-haiku-4-5`)
    +    -     
    +    -     ---
    +    -     
    +    -    diff --git a/app/api/routers/auth.py b/app/api/routers/auth.py
    +    -    index dffd10d..cf3df44 100644
    +    -    --- a/app/api/routers/auth.py
    +    -    +++ b/app/api/routers/auth.py
    +    -    @@ -1,13 +1,15 @@
    +    -    -"""Authentication router -- GitHub OAuth flow and user info."""
    +    -    +"""Authentication router -- GitHub OAuth flow, user info, and BYOK API key management."""
    +    -     
    +    -     import secrets
    +    -     from urllib.parse import urlencode
    +    -     
    +    -     from fastapi import APIRouter, Depends, HTTPException, Query, status
    +    -    +from pydantic import BaseModel
    +    +     @router.post("/{project_id}/build")
    +    +     async def start_build(
    +    +         project_id: UUID,
    +    +    +    body: StartBuildRequest | None = None,
    +    +         user: dict = Depends(get_current_user),
    +    +     ):
    +    +         """Start a build for a project."""
    +    +         if not build_limiter.is_allowed(str(user["id"])):
    +    +             raise HTTPException(status_code=429, detail="Build rate limit exceeded")
    +    +         try:
    +    +    -        build = await build_service.start_build(project_id, user["id"])
    +    +    +        build = await build_service.start_build(
    +    +    +            project_id,
    +    +    +            user["id"],
    +    +    +            target_type=body.target_type if body else None,
    +    +    +            target_ref=body.target_ref if body else None,
    +    +    +        )
    +    +             return build
    +    +         except ValueError as exc:
    +    +             detail = str(exc)
    +    +    @@ -51,6 +64,46 @@ async def cancel_build(
    +    +             raise HTTPException(status_code=400, detail=detail)
    +          
    +    -     from app.api.deps import get_current_user
    +    -     from app.clients.github_client import GITHUB_OAUTH_URL
    +    -     from app.config import settings
    +    -    +from app.repos.user_repo import set_anthropic_api_key
    +    -     from app.services.auth_service import handle_github_callback
    +          
    +    -     router = APIRouter(prefix="/auth", tags=["auth"])
    +    -    @@ -66,8 +68,36 @@ async def get_current_user_info(
    +    -         current_user: dict = Depends(get_current_user),
    +    -     ) -> dict:
    +    -         """Return the current authenticated user info."""
    +    -    +    has_api_key = bool(current_user.get("anthropic_api_key"))
    +    -         return {
    +    -             "id": str(current_user["id"]),
    +    -             "github_login": current_user["github_login"],
    +    -             "avatar_url": current_user.get("avatar_url"),
    +    -    +        "has_anthropic_key": has_api_key,
    +    -         }
    +    -    +
    +    +    +# Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º GET /projects/{project_id}/build/files Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +         +
    +    -    +class ApiKeyBody(BaseModel):
    +    -    +    api_key: str
    +         +
    +    -    +
    +    -    +@router.put("/api-key")
    +    -    +async def save_api_key(
    +    -    +    body: ApiKeyBody,
    +    -    +    current_user: dict = Depends(get_current_user),
    +    -    +) -> dict:
    +    -    +    """Save the user's Anthropic API key for BYOK builds."""
    +    -    +    key = body.api_key.strip()
    +    -    +    if not key:
    +    -    +        raise HTTPException(status_code=400, detail="API key cannot be empty")
    +    -    +    await set_anthropic_api_key(current_user["id"], key)
    +    -    +    return {"saved": True}
    +    +    +@router.get("/{project_id}/build/files")
    +    +    +async def get_build_files(
    +    +    +    project_id: UUID,
    +    +    +    user: dict = Depends(get_current_user),
    +    +    +):
    +    +    +    """List all files written during the build."""
    +    +    +    try:
    +    +    +        files = await build_service.get_build_files(project_id, user["id"])
    +    +    +        return {"items": files}
    +    +    +    except ValueError as exc:
    +    +    +        detail = str(exc)
    +    +    +        if "not found" in detail.lower():
    +    +    +            raise HTTPException(status_code=404, detail=detail)
    +    +    +        raise HTTPException(status_code=400, detail=detail)
    +         +
    +         +
    +    -    +@router.delete("/api-key")
    +    -    +async def remove_api_key(
    +    -    +    current_user: dict = Depends(get_current_user),
    +    -    +) -> dict:
    +    -    +    """Remove the user's stored Anthropic API key."""
    +    -    +    await set_anthropic_api_key(current_user["id"], None)
    +    -    +    return {"removed": True}
    +    -    diff --git a/app/api/routers/builds.py b/app/api/routers/builds.py
    +    -    index 9f0a5e0..6ef15b8 100644
    +    -    --- a/app/api/routers/builds.py
    +    -    +++ b/app/api/routers/builds.py
    +    -    @@ -92,6 +92,24 @@ async def get_build_logs(
    +    -             raise HTTPException(status_code=400, detail=detail)
    +    -     
    +    -     
    +    -    +# Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º GET /projects/{project_id}/build/phases Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    +    +# Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º GET /projects/{project_id}/build/files/{path} Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +         +
    +         +
    +    -    +@router.get("/{project_id}/build/phases")
    +    -    +async def get_build_phases(
    +    +    +@router.get("/{project_id}/build/files/{path:path}")
    +    +    +async def get_build_file_content(
    +         +    project_id: UUID,
    +    +    +    path: str,
    +         +    user: dict = Depends(get_current_user),
    +         +):
    +    -    +    """Phase definitions parsed from the project's phases contract."""
    +    +    +    """Retrieve content of a specific file written during the build."""
    +         +    try:
    +    -    +        return await build_service.get_build_phases(project_id, user["id"])
    +    +    +        return await build_service.get_build_file_content(
    +    +    +            project_id, user["id"], path
    +    +    +        )
    +         +    except ValueError as exc:
    +         +        detail = str(exc)
    +         +        if "not found" in detail.lower():
    +    @@ -3725,3645 +8462,2051 @@
    +         +        raise HTTPException(status_code=400, detail=detail)
    +         +
    +         +
    +    -     # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º GET /projects/{project_id}/build/summary Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -     
    +    -     
    +    -    diff --git a/app/api/routers/projects.py b/app/api/routers/projects.py
    +    -    index 0e72551..cc00763 100644
    +    -    --- a/app/api/routers/projects.py
    +    -    +++ b/app/api/routers/projects.py
    +    -    @@ -17,6 +17,7 @@ from app.services.project_service import (
    +    -         list_contracts,
    +    -         list_user_projects,
    +    -         process_questionnaire_message,
    +    -    +    reset_questionnaire,
    +    -         update_contract,
    +    -     )
    +    -     
    +    -    @@ -177,6 +178,20 @@ async def questionnaire_progress(
    +    -             )
    +    +     # Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º GET /projects/{project_id}/build/status Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +          
    +          
    +    -    +@router.delete("/{project_id}/questionnaire")
    +    -    +async def questionnaire_reset(
    +    -    +    project_id: UUID,
    +    -    +    current_user: dict = Depends(get_current_user),
    +    -    +) -> dict:
    +    -    +    """Reset questionnaire to start over."""
    +    +    diff --git a/app/clients/git_client.py b/app/clients/git_client.py
    +    +    new file mode 100644
    +    +    index 0000000..d0b2890
    +    +    --- /dev/null
    +    +    +++ b/app/clients/git_client.py
    +    +    @@ -0,0 +1,165 @@
    +    +    +"""Git client -- thin wrapper around asyncio.subprocess for git operations.
         +    +
    +    +    +Handles clone, add, commit, push for build targets. No database access,
    +    +    +no business logic, no HTTP framework imports.
    +    +    +"""
         +    +
    -    +    +@router.put("/api-key")
    -    +    +async def save_api_key(
    -    +    +    body: ApiKeyBody,
    -    +    +    current_user: dict = Depends(get_current_user),
    -    +    +) -> dict:
    -    +    +    """Save the user's Anthropic API key for BYOK builds."""
    -    +    +    key = body.api_key.strip()
    -    +    +    if not key:
    -    +    +        raise HTTPException(status_code=400, detail="API key cannot be empty")
    -    +    +    await set_anthropic_api_key(current_user["id"], key)
    -    +    +    return {"saved": True}
    +    +    +import asyncio
    +    +    +import logging
    +    +    +import os
    +    +    +from pathlib import Path
         +    +
    +    +    +logger = logging.getLogger(__name__)
         +    +
    -    +    +@router.delete("/api-key")
    -    +    +async def remove_api_key(
    -    +    +    current_user: dict = Depends(get_current_user),
    -    +    +) -> dict:
    -    +    +    """Remove the user's stored Anthropic API key."""
    -    +    +    await set_anthropic_api_key(current_user["id"], None)
    -    +    +    return {"removed": True}
    -    +    diff --git a/app/api/routers/projects.py b/app/api/routers/projects.py
    -    +    index 0e72551..cc00763 100644
    -    +    --- a/app/api/routers/projects.py
    -    +    +++ b/app/api/routers/projects.py
    -    +    @@ -17,6 +17,7 @@ from app.services.project_service import (
    -    +         list_contracts,
    -    +         list_user_projects,
    -    +         process_questionnaire_message,
    -    +    +    reset_questionnaire,
    -    +         update_contract,
    -    +     )
    -    +     
    -    +    @@ -177,6 +178,20 @@ async def questionnaire_progress(
    -    +             )
    -    +     
    -    +     
    -    +    +@router.delete("/{project_id}/questionnaire")
    -    +    +async def questionnaire_reset(
    -    +    +    project_id: UUID,
    -    +    +    current_user: dict = Depends(get_current_user),
    -    +    +) -> dict:
    -    +    +    """Reset questionnaire to start over."""
    +    +    +
    +    +    +async def _run_git(args: list[str], cwd: str | Path, env: dict | None = None) -> str:
    +    +    +    """Run a git command and return stdout. Raises on non-zero exit."""
    +    +    +    merged_env = {**os.environ, **(env or {})}
    +    +    +    proc = await asyncio.create_subprocess_exec(
    +    +    +        "git", *args,
    +    +    +        cwd=str(cwd),
    +    +    +        stdout=asyncio.subprocess.PIPE,
    +    +    +        stderr=asyncio.subprocess.PIPE,
    +    +    +        env=merged_env,
    +    +    +    )
    +    +    +    stdout, stderr = await proc.communicate()
    +    +    +    out = stdout.decode("utf-8", errors="replace").strip()
    +    +    +    err = stderr.decode("utf-8", errors="replace").strip()
    +    +    +
    +    +    +    if proc.returncode != 0:
    +    +    +        logger.error("git %s failed (rc=%d): %s", " ".join(args), proc.returncode, err)
    +    +    +        raise RuntimeError(f"git {args[0]} failed: {err}")
    +    +    +
    +    +    +    return out
    +    +    +
    +    +    +
    +    +    +async def clone_repo(
    +    +    +    clone_url: str,
    +    +    +    dest: str | Path,
    +    +    +    *,
    +    +    +    branch: str | None = None,
    +    +    +    shallow: bool = True,
    +    +    +    access_token: str | None = None,
    +    +    +) -> str:
    +    +    +    """Clone a git repository to dest. Returns the dest path.
    +    +    +
    +    +    +    For GitHub repos, inject the access token into the URL for auth.
    +    +    +    """
    +    +    +    url = clone_url
    +    +    +    if access_token and "github.com" in clone_url:
    +    +    +        # Inject token for HTTPS auth: https://TOKEN@github.com/owner/repo.git
    +    +    +        url = clone_url.replace("https://", f"https://{access_token}@")
    +    +    +
    +    +    +    args = ["clone"]
    +    +    +    if shallow:
    +    +    +        args.extend(["--depth", "1"])
    +    +    +    if branch:
    +    +    +        args.extend(["--branch", branch])
    +    +    +    args.extend([url, str(dest)])
    +    +    +
    +    +    +    parent = Path(dest).parent
    +    +    +    parent.mkdir(parents=True, exist_ok=True)
    +    +    +    await _run_git(args, cwd=str(parent))
    +    +    +    return str(dest)
    +    +    +
    +    +    +
    +    +    +async def init_repo(dest: str | Path) -> str:
    +    +    +    """Initialize a new git repo at dest. Returns the dest path."""
    +    +    +    path = Path(dest)
    +    +    +    path.mkdir(parents=True, exist_ok=True)
    +    +    +    await _run_git(["init"], cwd=path)
    +    +    +    # Set default branch to main
    +    +    +    await _run_git(["checkout", "-b", "main"], cwd=path)
    +    +    +    return str(path)
    +    +    +
    +    +    +
    +    +    +async def add_all(repo_path: str | Path) -> None:
    +    +    +    """Stage all changes in the repo."""
    +    +    +    await _run_git(["add", "-A"], cwd=repo_path)
    +    +    +
    +    +    +
    +    +    +async def commit(repo_path: str | Path, message: str) -> str | None:
    +    +    +    """Commit staged changes. Returns commit hash or None if nothing to commit."""
    +    +    +    # Check if there are staged changes
    +         +    try:
    +    -    +        return await reset_questionnaire(current_user["id"], project_id)
    +    -    +    except ValueError as exc:
    +    -    +        raise HTTPException(
    +    -    +            status_code=status.HTTP_404_NOT_FOUND, detail=str(exc)
    +    -    +        )
    +    +    +        status = await _run_git(["status", "--porcelain"], cwd=repo_path)
    +    +    +        if not status.strip():
    +    +    +            logger.info("Nothing to commit in %s", repo_path)
    +    +    +            return None
    +    +    +    except RuntimeError:
    +    +    +        return None
    +    +    +
    +    +    +    # Configure committer identity for the repo
         +    +    try:
    -    +    +        return await reset_questionnaire(current_user["id"], project_id)
    -    +    +    except ValueError as exc:
    -    +    +        raise HTTPException(
    -    +    +            status_code=status.HTTP_404_NOT_FOUND, detail=str(exc)
    -    +    +        )
    +    +    +        await _run_git(["config", "user.email", "forge@forgeguard.dev"], cwd=repo_path)
    +    +    +        await _run_git(["config", "user.name", "ForgeGuard Builder"], cwd=repo_path)
    +    +    +    except RuntimeError:
    +    +    +        pass  # May already be configured
         +    +
    +    +    +    await _run_git(["add", "-A"], cwd=repo_path)
    +    +    +    await _run_git(["commit", "-m", message], cwd=repo_path)
    +    +    +    sha = await _run_git(["rev-parse", "HEAD"], cwd=repo_path)
    +    +    +    return sha
         +    +
    -    +     # ---------------------------------------------------------------------------
    -    +     # Contracts
    -    +     # ---------------------------------------------------------------------------
    -    +    diff --git a/app/clients/llm_client.py b/app/clients/llm_client.py
    -    +    index 60b0218..19622bd 100644
    -    +    --- a/app/clients/llm_client.py
    -    +    +++ b/app/clients/llm_client.py
    -    +    @@ -47,13 +47,20 @@ async def chat_anthropic(
    -    +                 raise ValueError(f"Anthropic API {response.status_code}: {err_msg}")
    -    +     
    -    +         data = response.json()
    -    +    +    usage = data.get("usage", {})
    -    +         content_blocks = data.get("content", [])
    -    +         if not content_blocks:
    -    +             raise ValueError("Empty response from Anthropic API")
    -    +     
    -    +         for block in content_blocks:
    -    +             if block.get("type") == "text":
    -    +    -            return block["text"]
    -    +    +            return {
    -    +    +                "text": block["text"],
    -    +    +                "usage": {
    -    +    +                    "input_tokens": usage.get("input_tokens", 0),
    -    +    +                    "output_tokens": usage.get("output_tokens", 0),
    -    +    +                },
    -    +    +            }
    -    +     
    -    +         raise ValueError("No text block in Anthropic API response")
    -    +     
    -    +    @@ -112,7 +119,14 @@ async def chat_openai(
    -    +         if not content:
    -    +             raise ValueError("No content in OpenAI API response")
    -    +     
    -    +    -    return content
    -    +    +    usage = data.get("usage", {})
    -    +    +    return {
    -    +    +        "text": content,
    -    +    +        "usage": {
    -    +    +            "input_tokens": usage.get("prompt_tokens", 0),
    -    +    +            "output_tokens": usage.get("completion_tokens", 0),
    -    +    +        },
    -    +    +    }
    -    +     
    -    +     
    -    +     # ---------------------------------------------------------------------------
    -    +    @@ -147,8 +161,8 @@ async def chat(
    -    +     
    -    +         Returns
    -    +         -------
    -    +    -    str
    -    +    -        The assistant's text reply.
    -    +    +    dict
    -    +    +        ``{"text": str, "usage": {"input_tokens": int, "output_tokens": int}}``
    -    +         """
    -    +         if provider == "openai":
    -    +             return await chat_openai(api_key, model, system_prompt, messages, max_tokens)
    -    +    diff --git a/app/config.py b/app/config.py
    -    +    index dcff943..0845923 100644
    -    +    --- a/app/config.py
    -    +    +++ b/app/config.py
    -    +    @@ -44,7 +44,7 @@ class Settings:
    -    +         FRONTEND_URL: str = os.getenv("FRONTEND_URL", "http://localhost:5173")
    -    +         APP_URL: str = os.getenv("APP_URL", "http://localhost:8000")
    -    +         LLM_QUESTIONNAIRE_MODEL: str = os.getenv(
    -    +    -        "LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022"
    -    +    +        "LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5"
    -    +         )
    -    +         ANTHROPIC_API_KEY: str = os.getenv("ANTHROPIC_API_KEY", "")
    -    +         OPENAI_API_KEY: str = os.getenv("OPENAI_API_KEY", "")
    -    +    diff --git a/app/repos/audit_repo.py b/app/repos/audit_repo.py
    -    +    index 2bc2568..f30784b 100644
    -    +    --- a/app/repos/audit_repo.py
    -    +    +++ b/app/repos/audit_repo.py
    -    +    @@ -63,6 +63,26 @@ async def update_audit_run(
    -    +         )
    -    +     
    -    +     
    -    +    +async def mark_stale_audit_runs(repo_id: UUID, stale_minutes: int = 5) -> int:
    -    +    +    """Mark audit runs stuck in 'pending' or 'running' for longer than
    -    +    +    *stale_minutes* as 'error'. Returns the number of rows updated."""
    -    +    +    pool = await get_pool()
    -    +    +    result = await pool.execute(
    -    +    +        """
    -    +    +        UPDATE audit_runs
    -    +    +        SET status = 'error', overall_result = 'ERROR',
    -    +    +            completed_at = now()
    -    +    +        WHERE repo_id = $1
    -    +    +          AND status IN ('pending', 'running')
    -    +    +          AND created_at < now() - ($2 || ' minutes')::interval
    -    +    +        """,
    -    +    +        repo_id,
    -    +    +        str(stale_minutes),
    -    +    +    )
    -    +    +    # asyncpg returns 'UPDATE N'
    -    +    +    return int(result.split()[-1])
    -    +    +
    -    +    +
    -    +     async def insert_audit_checks(
    -    +         audit_run_id: UUID,
    -    +         checks: list[dict],
    -    +    diff --git a/app/repos/user_repo.py b/app/repos/user_repo.py
    -    +    index f8a2386..689f7a9 100644
    -    +    --- a/app/repos/user_repo.py
    -    +    +++ b/app/repos/user_repo.py
    -    +    @@ -38,7 +38,17 @@ async def get_user_by_id(user_id: UUID) -> dict | None:
    -    +         """Fetch a user by primary key. Returns None if not found."""
    +    +    +
    +    +    +async def push(
    +    +    +    repo_path: str | Path,
    +    +    +    *,
    +    +    +    remote: str = "origin",
    +    +    +    branch: str = "main",
    +    +    +    access_token: str | None = None,
    +    +    +) -> None:
    +    +    +    """Push all commits to the remote."""
    +    +    +    env = {}
    +    +    +    if access_token:
    +    +    +        # Use credential helper to inject token
    +    +    +        env["GIT_ASKPASS"] = "echo"
    +    +    +        # Set the remote URL with token for auth
    +    +    +        try:
    +    +    +            remote_url = await _run_git(["remote", "get-url", remote], cwd=repo_path)
    +    +    +            if "github.com" in remote_url and "@" not in remote_url:
    +    +    +                authed_url = remote_url.replace(
    +    +    +                    "https://", f"https://{access_token}@"
    +    +    +                )
    +    +    +                await _run_git(
    +    +    +                    ["remote", "set-url", remote, authed_url], cwd=repo_path
    +    +    +                )
    +    +    +        except RuntimeError:
    +    +    +            pass
    +    +    +
    +    +    +    await _run_git(["push", "-u", remote, branch], cwd=repo_path, env=env if env else None)
    +    +    +
    +    +    +
    +    +    +async def set_remote(
    +    +    +    repo_path: str | Path,
    +    +    +    remote_url: str,
    +    +    +    *,
    +    +    +    remote_name: str = "origin",
    +    +    +) -> None:
    +    +    +    """Set or update the remote URL for a repo."""
    +    +    +    try:
    +    +    +        await _run_git(["remote", "add", remote_name, remote_url], cwd=repo_path)
    +    +    +    except RuntimeError:
    +    +    +        # Remote already exists, update it
    +    +    +        await _run_git(["remote", "set-url", remote_name, remote_url], cwd=repo_path)
    +         +
    +         +
    +    +    +async def get_file_list(repo_path: str | Path) -> list[str]:
    +    +    +    """List all tracked + untracked files in the repo (relative paths)."""
    +    +    +    try:
    +    +    +        # Get tracked files
    +    +    +        tracked = await _run_git(["ls-files"], cwd=repo_path)
    +    +    +        # Get untracked files
    +    +    +        untracked = await _run_git(
    +    +    +            ["ls-files", "--others", "--exclude-standard"], cwd=repo_path
    +    +    +        )
    +    +    +        files = set()
    +    +    +        for line in tracked.splitlines():
    +    +    +            if line.strip():
    +    +    +                files.add(line.strip())
    +    +    +        for line in untracked.splitlines():
    +    +    +            if line.strip():
    +    +    +                files.add(line.strip())
    +    +    +        return sorted(files)
    +    +    +    except RuntimeError:
    +    +    +        return []
    +    +    diff --git a/app/repos/build_repo.py b/app/repos/build_repo.py
    +    +    index b1d4781..44442e5 100644
    +    +    --- a/app/repos/build_repo.py
    +    +    +++ b/app/repos/build_repo.py
    +    +    @@ -13,17 +13,27 @@ from app.repos.db import get_pool
    +          # ---------------------------------------------------------------------------
    +    -     # Contracts
    +    -     # ---------------------------------------------------------------------------
    +    -    diff --git a/app/clients/llm_client.py b/app/clients/llm_client.py
    +    -    index 60b0218..19622bd 100644
    +    -    --- a/app/clients/llm_client.py
    +    -    +++ b/app/clients/llm_client.py
    +    -    @@ -47,13 +47,20 @@ async def chat_anthropic(
    +    -                 raise ValueError(f"Anthropic API {response.status_code}: {err_msg}")
    +    -     
    +    -         data = response.json()
    +    -    +    usage = data.get("usage", {})
    +    -         content_blocks = data.get("content", [])
    +    -         if not content_blocks:
    +    -             raise ValueError("Empty response from Anthropic API")
    +    -     
    +    -         for block in content_blocks:
    +    -             if block.get("type") == "text":
    +    -    -            return block["text"]
    +    -    +            return {
    +    -    +                "text": block["text"],
    +    -    +                "usage": {
    +    -    +                    "input_tokens": usage.get("input_tokens", 0),
    +    -    +                    "output_tokens": usage.get("output_tokens", 0),
    +    -    +                },
    +    -    +            }
    +          
    +    -         raise ValueError("No text block in Anthropic API response")
    +          
    +    -    @@ -112,7 +119,14 @@ async def chat_openai(
    +    -         if not content:
    +    -             raise ValueError("No content in OpenAI API response")
    +    -     
    +    -    -    return content
    +    -    +    usage = data.get("usage", {})
    +    -    +    return {
    +    -    +        "text": content,
    +    -    +        "usage": {
    +    -    +            "input_tokens": usage.get("prompt_tokens", 0),
    +    -    +            "output_tokens": usage.get("completion_tokens", 0),
    +    -    +        },
    +    -    +    }
    +    -     
    +    -     
    +    -     # ---------------------------------------------------------------------------
    +    -    @@ -147,8 +161,8 @@ async def chat(
    +    -     
    +    -         Returns
    +    -         -------
    +    -    -    str
    +    -    -        The assistant's text reply.
    +    -    +    dict
    +    -    +        ``{"text": str, "usage": {"input_tokens": int, "output_tokens": int}}``
    +    -         """
    +    -         if provider == "openai":
    +    -             return await chat_openai(api_key, model, system_prompt, messages, max_tokens)
    +    -    diff --git a/app/config.py b/app/config.py
    +    -    index dcff943..0845923 100644
    +    -    --- a/app/config.py
    +    -    +++ b/app/config.py
    +    -    @@ -44,7 +44,7 @@ class Settings:
    +    -         FRONTEND_URL: str = os.getenv("FRONTEND_URL", "http://localhost:5173")
    +    -         APP_URL: str = os.getenv("APP_URL", "http://localhost:8000")
    +    -         LLM_QUESTIONNAIRE_MODEL: str = os.getenv(
    +    -    -        "LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022"
    +    -    +        "LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5"
    +    -         )
    +    -         ANTHROPIC_API_KEY: str = os.getenv("ANTHROPIC_API_KEY", "")
    +    -         OPENAI_API_KEY: str = os.getenv("OPENAI_API_KEY", "")
    +    -    diff --git a/app/repos/audit_repo.py b/app/repos/audit_repo.py
    +    -    index 2bc2568..f30784b 100644
    +    -    --- a/app/repos/audit_repo.py
    +    -    +++ b/app/repos/audit_repo.py
    +    -    @@ -63,6 +63,26 @@ async def update_audit_run(
    +    +    -async def create_build(project_id: UUID) -> dict:
    +    +    +async def create_build(
    +    +    +    project_id: UUID,
    +    +    +    *,
    +    +    +    target_type: str | None = None,
    +    +    +    target_ref: str | None = None,
    +    +    +    working_dir: str | None = None,
    +    +    +) -> dict:
    +    +         """Create a new build record in pending status."""
         +         pool = await get_pool()
         +         row = await pool.fetchrow(
    -    +    -        "SELECT id, github_id, github_login, avatar_url, access_token, created_at, updated_at FROM users WHERE id = $1",
    -    +    +        "SELECT id, github_id, github_login, avatar_url, access_token, anthropic_api_key, created_at, updated_at FROM users WHERE id = $1",
    -    +             user_id,
    -    +         )
    -    +         return dict(row) if row else None
    -    +    +
    +    +             """
    +    +    -        INSERT INTO builds (project_id, phase, status)
    +    +    -        VALUES ($1, 'Phase 0', 'pending')
    +    +    -        RETURNING id, project_id, phase, status, started_at, completed_at,
    +    +    +        INSERT INTO builds (project_id, phase, status, target_type, target_ref, working_dir)
    +    +    +        VALUES ($1, 'Phase 0', 'pending', $2, $3, $4)
    +    +    +        RETURNING id, project_id, phase, status, target_type, target_ref,
    +    +    +                  working_dir, started_at, completed_at,
    +    +                       loop_count, error_detail, created_at
    +    +             """,
    +    +             project_id,
    +    +    +        target_type,
    +    +    +        target_ref,
    +    +    +        working_dir,
    +              )
    +    +         return dict(row)
    +          
    +    -     
    +    -    +async def mark_stale_audit_runs(repo_id: UUID, stale_minutes: int = 5) -> int:
    +    -    +    """Mark audit runs stuck in 'pending' or 'running' for longer than
    +    -    +    *stale_minutes* as 'error'. Returns the number of rows updated."""
    +    -    +    pool = await get_pool()
    +    -    +    result = await pool.execute(
    +    -    +        """
    +    -    +        UPDATE audit_runs
    +    -    +        SET status = 'error', overall_result = 'ERROR',
    +    -    +            completed_at = now()
    +    -    +        WHERE repo_id = $1
    +    -    +          AND status IN ('pending', 'running')
    +    -    +          AND created_at < now() - ($2 || ' minutes')::interval
    +    -    +        """,
    +    -    +        repo_id,
    +    -    +        str(stale_minutes),
    +    -    +    )
    +    -    +    # asyncpg returns 'UPDATE N'
    +    -    +    return int(result.split()[-1])
    +    -    +
    +    -    +
    +    -     async def insert_audit_checks(
    +    -         audit_run_id: UUID,
    +    -         checks: list[dict],
    +    -    diff --git a/app/repos/user_repo.py b/app/repos/user_repo.py
    +    -    index f8a2386..689f7a9 100644
    +    -    --- a/app/repos/user_repo.py
    +    -    +++ b/app/repos/user_repo.py
    +    -    @@ -38,7 +38,17 @@ async def get_user_by_id(user_id: UUID) -> dict | None:
    +    -         """Fetch a user by primary key. Returns None if not found."""
    +    +    @@ -33,7 +43,8 @@ async def get_build_by_id(build_id: UUID) -> dict | None:
    +              pool = await get_pool()
    +              row = await pool.fetchrow(
    +    -    -        "SELECT id, github_id, github_login, avatar_url, access_token, created_at, updated_at FROM users WHERE id = $1",
    +    -    +        "SELECT id, github_id, github_login, avatar_url, access_token, anthropic_api_key, created_at, updated_at FROM users WHERE id = $1",
    +    -             user_id,
    +    -         )
    +    -         return dict(row) if row else None
    +    +             """
    +    +    -        SELECT id, project_id, phase, status, started_at, completed_at,
    +    +    +        SELECT id, project_id, phase, status, target_type, target_ref,
    +    +    +               working_dir, started_at, completed_at,
    +    +                    loop_count, error_detail, created_at
    +    +             FROM builds WHERE id = $1
    +    +             """,
    +    +    @@ -47,7 +58,8 @@ async def get_latest_build_for_project(project_id: UUID) -> dict | None:
    +    +         pool = await get_pool()
    +    +         row = await pool.fetchrow(
    +    +             """
    +    +    -        SELECT id, project_id, phase, status, started_at, completed_at,
    +    +    +        SELECT id, project_id, phase, status, target_type, target_ref,
    +    +    +               working_dir, started_at, completed_at,
    +    +                    loop_count, error_detail, created_at
    +    +             FROM builds WHERE project_id = $1
    +    +             ORDER BY created_at DESC LIMIT 1
    +    +    @@ -240,3 +252,34 @@ async def get_build_cost_summary(build_id: UUID) -> dict:
    +    +             "total_cost_usd": Decimal("0"),
    +    +             "phase_count": 0,
    +    +         }
         +    +
    -    +    +async def set_anthropic_api_key(user_id: UUID, api_key: str | None) -> None:
    -    +    +    """Store (or clear) the user's Anthropic API key."""
    -    +    +    pool = await get_pool()
    -    +    +    await pool.execute(
    -    +    +        "UPDATE users SET anthropic_api_key = $2, updated_at = now() WHERE id = $1",
    -    +    +        user_id,
    -    +    +        api_key,
    -    +    +    )
    -    +    diff --git a/app/services/audit_service.py b/app/services/audit_service.py
    -    +    index ab835fe..1bf0d18 100644
    -    +    --- a/app/services/audit_service.py
    -    +    +++ b/app/services/audit_service.py
    -    +    @@ -1,5 +1,6 @@
    -    +     """Audit service -- orchestrates audit execution triggered by webhooks."""
    +         +
    +    +    +async def get_build_file_logs(build_id: UUID) -> list[dict]:
    +    +    +    """Fetch all file_created log entries for a build.
    +         +
    +    -    +async def set_anthropic_api_key(user_id: UUID, api_key: str | None) -> None:
    +    -    +    """Store (or clear) the user's Anthropic API key."""
    +    +    +    Returns list of dicts with path, size_bytes, language, created_at
    +    +    +    parsed from build_log messages where source='file'.
    +    +    +    """
    +         +    pool = await get_pool()
    +    -    +    await pool.execute(
    +    -    +        "UPDATE users SET anthropic_api_key = $2, updated_at = now() WHERE id = $1",
    +    -    +        user_id,
    +    -    +        api_key,
    +    +    +    rows = await pool.fetch(
    +    +    +        """
    +    +    +        SELECT message, created_at
    +    +    +        FROM build_logs
    +    +    +        WHERE build_id = $1 AND source = 'file'
    +    +    +        ORDER BY created_at ASC
    +    +    +        """,
    +    +    +        build_id,
    +         +    )
    +    -    diff --git a/app/services/audit_service.py b/app/services/audit_service.py
    +    -    index ab835fe..1bf0d18 100644
    +    -    --- a/app/services/audit_service.py
    +    -    +++ b/app/services/audit_service.py
    +    -    @@ -1,5 +1,6 @@
    +    -     """Audit service -- orchestrates audit execution triggered by webhooks."""
    +    -     
    +    -    +import asyncio
    +    -     import json
    +    -     import logging
    +    -     import os
    +    -    @@ -12,6 +13,7 @@ from app.repos.audit_repo import (
    +    -         create_audit_run,
    +    -         get_existing_commit_shas,
    +    -         insert_audit_checks,
    +    -    +    mark_stale_audit_runs,
    +    -         update_audit_run,
    +    -     )
    +    -     from app.repos.repo_repo import get_repo_by_github_id, get_repo_by_id
    +    -    @@ -288,6 +290,11 @@ async def backfill_repo_commits(
    +    -         full_name = repo["full_name"]
    +    -         branch = repo.get("default_branch", "main")
    +    -     
    +    -    +    # Clean up any audit runs left stuck from a prior interrupted sync
    +    -    +    cleaned = await mark_stale_audit_runs(repo_id)
    +    -    +    if cleaned:
    +    -    +        logger.info("Cleaned %d stale audit runs for repo %s", cleaned, repo_id)
    +    -    +
    +    -         # Find the latest audit we already have so we only pull newer commits
    +    -         existing_shas = await get_existing_commit_shas(repo_id)
    +    -     
    +    -    @@ -365,6 +372,16 @@ async def backfill_repo_commits(
    +    -                 )
    +    -                 synced += 1
    +    -     
    +    -    +        except asyncio.CancelledError:
    +    -    +            logger.warning("Backfill cancelled for commit %s", sha)
    +    -    +            await update_audit_run(
    +    -    +                audit_run_id=audit_run["id"],
    +    -    +                status="error",
    +    -    +                overall_result="ERROR",
    +    -    +                files_checked=0,
    +    -    +            )
    +    -    +            raise  # re-raise so the request terminates properly
    +    -    +
    +    -             except Exception:
    +    -                 logger.exception("Backfill failed for commit %s", sha)
    +    -                 await update_audit_run(
    +    +    +    files = []
    +    +    +    for r in rows:
    +    +    +        try:
    +    +    +            data = json.loads(r["message"])
    +    +    +            files.append({
    +    +    +                "path": data.get("path", ""),
    +    +    +                "size_bytes": data.get("size_bytes", 0),
    +    +    +                "language": data.get("language", ""),
    +    +    +                "created_at": r["created_at"],
    +    +    +            })
    +    +    +        except (ValueError, KeyError):
    +    +    +            continue
    +    +    +    return files
    +         diff --git a/app/services/build_service.py b/app/services/build_service.py
    +    -    index e98f439..56edbd8 100644
    +    +    index f49a2e8..e4a33e5 100644
    +         --- a/app/services/build_service.py
    +         +++ b/app/services/build_service.py
    +    -    @@ -17,6 +17,7 @@ from app.clients.agent_client import StreamUsage, stream_agent
    +    +    @@ -8,14 +8,20 @@ No SQL, no HTTP framework, no direct GitHub API calls.
    +    +     """
         +     
    -    +    +import asyncio
    -    +     import json
    +    +     import asyncio
    +    +    +import json
         +     import logging
    -    +     import os
    -    +    @@ -12,6 +13,7 @@ from app.repos.audit_repo import (
    -    +         create_audit_run,
    -    +         get_existing_commit_shas,
    -    +         insert_audit_checks,
    -    +    +    mark_stale_audit_runs,
    -    +         update_audit_run,
    -    +     )
    -    +     from app.repos.repo_repo import get_repo_by_github_id, get_repo_by_id
    -    +    @@ -288,6 +290,11 @@ async def backfill_repo_commits(
    -    +         full_name = repo["full_name"]
    -    +         branch = repo.get("default_branch", "main")
    -    +     
    -    +    +    # Clean up any audit runs left stuck from a prior interrupted sync
    -    +    +    cleaned = await mark_stale_audit_runs(repo_id)
    -    +    +    if cleaned:
    -    +    +        logger.info("Cleaned %d stale audit runs for repo %s", cleaned, repo_id)
    -    +    +
    -    +         # Find the latest audit we already have so we only pull newer commits
    -    +         existing_shas = await get_existing_commit_shas(repo_id)
    -    +     
    -    +    @@ -365,6 +372,16 @@ async def backfill_repo_commits(
    -    +                 )
    -    +                 synced += 1
    +    +    +import os
    +    +     import re
    +    +    +import shutil
    +    +    +import tempfile
    +    +     from decimal import Decimal
    +    +     from datetime import datetime, timezone
    +    +     from pathlib import Path
    +    +     from uuid import UUID
         +     
    -    +    +        except asyncio.CancelledError:
    -    +    +            logger.warning("Backfill cancelled for commit %s", sha)
    -    +    +            await update_audit_run(
    -    +    +                audit_run_id=audit_run["id"],
    -    +    +                status="error",
    -    +    +                overall_result="ERROR",
    -    +    +                files_checked=0,
    -    +    +            )
    -    +    +            raise  # re-raise so the request terminates properly
    -    +    +
    -    +             except Exception:
    -    +                 logger.exception("Backfill failed for commit %s", sha)
    -    +                 await update_audit_run(
    -    +    diff --git a/app/services/build_service.py b/app/services/build_service.py
    -    +    index e98f439..2dcc4bb 100644
    -    +    --- a/app/services/build_service.py
    -    +    +++ b/app/services/build_service.py
    -    +    @@ -17,6 +17,7 @@ from app.clients.agent_client import StreamUsage, stream_agent
    -    +     from app.config import settings
    -    +     from app.repos import build_repo
    -    +     from app.repos import project_repo
    -    +    +from app.repos.user_repo import get_user_by_id
    -    +     from app.ws_manager import manager
    +    +     from app.clients.agent_client import StreamUsage, stream_agent
    +    +    +from app.clients import git_client
    +    +    +from app.clients import github_client
    +          from app.config import settings
    +          from app.repos import build_repo
    +          from app.repos import project_repo
    +    -    +from app.repos.user_repo import get_user_by_id
    +    -     from app.ws_manager import manager
    +    -     
    +    -     # Maximum consecutive loopback failures before stopping
    +    -    @@ -31,9 +32,25 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
    +    -     # Active build tasks keyed by build_id
    +    -     _active_tasks: dict[str, asyncio.Task] = {}
    +    -     
    +    -    -# Cost-per-token estimates (USD) -- updated as pricing changes
    +    -    -_COST_PER_INPUT_TOKEN: Decimal = Decimal("0.000015")   # $15 / 1M input tokens
    +    -    -_COST_PER_OUTPUT_TOKEN: Decimal = Decimal("0.000075")  # $75 / 1M output tokens
    +    -    +# Cost-per-token estimates (USD) keyed by model prefix -- updated as pricing changes
    +    -    +_MODEL_PRICING: dict[str, tuple[Decimal, Decimal]] = {
    +    -    +    # (input $/token, output $/token)
    +    -    +    "claude-opus-4":       (Decimal("0.000015"),  Decimal("0.000075")),   # $15 / $75 per 1M
    +    -    +    "claude-sonnet-4":     (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    +    -    +    "claude-haiku-4":      (Decimal("0.000001"),  Decimal("0.000005")),   # $1 / $5 per 1M
    +    -    +    "claude-3-5-sonnet":   (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    +    +    @@ -36,6 +42,82 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
    +    +     # Universal governance contract (not per-project Ôö£├ÂÔö£├ºÔö£├é loaded from disk)
    +    +     FORGE_CONTRACTS_DIR = Path(__file__).resolve().parent.parent.parent / "Forge" / "Contracts"
         +     
    -    +     # Maximum consecutive loopback failures before stopping
    -    +    @@ -31,9 +32,25 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
    -    +     # Active build tasks keyed by build_id
    -    +     _active_tasks: dict[str, asyncio.Task] = {}
    -    +     
    -    +    -# Cost-per-token estimates (USD) -- updated as pricing changes
    -    +    -_COST_PER_INPUT_TOKEN: Decimal = Decimal("0.000015")   # $15 / 1M input tokens
    -    +    -_COST_PER_OUTPUT_TOKEN: Decimal = Decimal("0.000075")  # $75 / 1M output tokens
    -    +    +# Cost-per-token estimates (USD) keyed by model prefix -- updated as pricing changes
    -    +    +_MODEL_PRICING: dict[str, tuple[Decimal, Decimal]] = {
    -    +    +    # (input $/token, output $/token)
    -    +    +    "claude-opus-4":       (Decimal("0.000015"),  Decimal("0.000075")),   # $15 / $75 per 1M
    -    +    +    "claude-sonnet-4":     (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    -    +    +    "claude-haiku-4":      (Decimal("0.000001"),  Decimal("0.000005")),   # $1 / $5 per 1M
    -    +    +    "claude-3-5-sonnet":   (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    -    +    +}
    -    +    +# Fallback: Opus pricing (most expensive = safest default)
    -    +    +_DEFAULT_INPUT_RATE = Decimal("0.000015")
    -    +    +_DEFAULT_OUTPUT_RATE = Decimal("0.000075")
    +    +    +# File block delimiters for parsing builder output
    +    +    +FILE_START_PATTERN = re.compile(r"^=== FILE:\s*(.+?)\s*===$", re.MULTILINE)
    +    +    +FILE_END_PATTERN = re.compile(r"^=== END FILE ===$", re.MULTILINE)
         +    +
    +    +    +# Valid build target types
    +    +    +VALID_TARGET_TYPES = {"github_new", "github_existing", "local_path"}
         +    +
    -    +    +def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
    -    +    +    """Return (input_rate, output_rate) per token for the given model."""
    -    +    +    for prefix, rates in _MODEL_PRICING.items():
    -    +    +        if model.startswith(prefix):
    -    +    +            return rates
    -    +    +    return (_DEFAULT_INPUT_RATE, _DEFAULT_OUTPUT_RATE)
    -    +     
    -    +     
    -    +     # ---------------------------------------------------------------------------
    -    +    @@ -72,6 +89,14 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    -    +         if latest and latest["status"] in ("pending", "running"):
    -    +             raise ValueError("A build is already in progress for this project")
    -    +     
    -    +    +    # BYOK: user must supply their own Anthropic API key for builds
    -    +    +    user = await get_user_by_id(user_id)
    -    +    +    user_api_key = (user or {}).get("anthropic_api_key") or ""
    -    +    +    if not user_api_key.strip():
    -    +    +        raise ValueError(
    -    +    +            "Anthropic API key required. Add your key in Settings to start a build."
    -    +    +        )
    +    +    +# Language detection by file extension
    +    +    +_EXT_TO_LANG: dict[str, str] = {
    +    +    +    ".py": "python", ".js": "javascript", ".ts": "typescript",
    +    +    +    ".tsx": "typescriptreact", ".jsx": "javascriptreact",
    +    +    +    ".json": "json", ".yaml": "yaml", ".yml": "yaml",
    +    +    +    ".md": "markdown", ".html": "html", ".css": "css",
    +    +    +    ".sql": "sql", ".sh": "shell", ".ps1": "powershell",
    +    +    +    ".toml": "toml", ".txt": "plaintext", ".env": "dotenv",
    +    +    +    ".gitignore": "ignore",
    +         +}
    +    -    +# Fallback: Opus pricing (most expensive = safest default)
    +    -    +_DEFAULT_INPUT_RATE = Decimal("0.000015")
    +    -    +_DEFAULT_OUTPUT_RATE = Decimal("0.000075")
    +         +
    +         +
    +    -    +def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
    +    -    +    """Return (input_rate, output_rate) per token for the given model."""
    +    -    +    for prefix, rates in _MODEL_PRICING.items():
    +    -    +        if model.startswith(prefix):
    +    -    +            return rates
    +    -    +    return (_DEFAULT_INPUT_RATE, _DEFAULT_OUTPUT_RATE)
    +    -     
    +    +    +def _detect_language(file_path: str) -> str:
    +    +    +    """Detect language from file extension."""
    +    +    +    ext = Path(file_path).suffix.lower()
    +    +    +    name = Path(file_path).name.lower()
    +    +    +    if name in _EXT_TO_LANG:
    +    +    +        return _EXT_TO_LANG[name]
    +    +    +    return _EXT_TO_LANG.get(ext, "plaintext")
         +    +
    -    +         # Create build record
    -    +         build = await build_repo.create_build(project_id)
    -    +     
    -    +    @@ -80,7 +105,7 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    -    +     
    -    +         # Spawn background task
    -    +         task = asyncio.create_task(
    -    +    -        _run_build(build["id"], project_id, user_id, contracts)
    -    +    +        _run_build(build["id"], project_id, user_id, contracts, user_api_key)
    -    +         )
    -    +         _active_tasks[str(build["id"])] = task
    -    +     
    -    +    @@ -196,6 +221,7 @@ async def _run_build(
    -    +         project_id: UUID,
    -    +         user_id: UUID,
    -    +         contracts: list[dict],
    -    +    +    api_key: str,
    -    +     ) -> None:
    -    +         """Background task that orchestrates the full build lifecycle.
    -    +     
    -    +    @@ -232,7 +258,7 @@ async def _run_build(
    -    +     
    -    +             # Stream agent output
    -    +             async for chunk in stream_agent(
    -    +    -            api_key=settings.ANTHROPIC_API_KEY,
    -    +    +            api_key=api_key,
    -    +                 model=settings.LLM_BUILDER_MODEL,
    -    +                 system_prompt="You are an autonomous software builder operating under the Forge governance framework.",
    -    +                 messages=messages,
    -    +    @@ -446,8 +472,9 @@ async def _record_phase_cost(
    -    +         input_t = usage.input_tokens
    -    +         output_t = usage.output_tokens
    -    +         model = usage.model or settings.LLM_BUILDER_MODEL
    -    +    -    cost = (Decimal(input_t) * _COST_PER_INPUT_TOKEN
    -    +    -            + Decimal(output_t) * _COST_PER_OUTPUT_TOKEN)
    -    +    +    input_rate, output_rate = _get_token_rates(model)
    -    +    +    cost = (Decimal(input_t) * input_rate
    -    +    +            + Decimal(output_t) * output_rate)
    -    +         await build_repo.record_build_cost(
    -    +             build_id, phase, input_t, output_t, model, cost
    -    +         )
    -    +    diff --git a/app/services/project_service.py b/app/services/project_service.py
    -    +    index 46ab7de..491922c 100644
    -    +    --- a/app/services/project_service.py
    -    +    +++ b/app/services/project_service.py
    -    +    @@ -7,6 +7,7 @@ from uuid import UUID
    -    +     
    -    +     from app.clients.llm_client import chat as llm_chat
    -    +     from app.config import settings
    -    +    +from app.ws_manager import manager
    -    +     from app.repos.project_repo import (
    -    +         create_project as repo_create_project,
    -    +         delete_project as repo_delete_project,
    -    +    @@ -244,7 +245,7 @@ async def process_questionnaire_message(
    -    +         )
    +    +    +
    +    +    +def _parse_file_blocks(text: str) -> list[dict]:
    +    +    +    """Parse file blocks from builder output.
    +    +    +
    +    +    +    Expected format:
    +    +    +        === FILE: path/to/file.py ===
    +    +    +        <file contents>
    +    +    +        === END FILE ===
    +    +    +
    +    +    +    Returns list of {path, content} dicts.
    +    +    +    """
    +    +    +    blocks: list[dict] = []
    +    +    +    pos = 0
    +    +    +    while pos < len(text):
    +    +    +        start_match = FILE_START_PATTERN.search(text, pos)
    +    +    +        if not start_match:
    +    +    +            break
    +    +    +        file_path = start_match.group(1).strip()
    +    +    +        content_start = start_match.end()
    +    +    +
    +    +    +        end_match = FILE_END_PATTERN.search(text, content_start)
    +    +    +        if not end_match:
    +    +    +            # No closing delimiter -- skip this block
    +    +    +            pos = content_start
    +    +    +            break
    +    +    +
    +    +    +        raw_content = text[content_start:end_match.start()]
    +    +    +        # Strip optional code fence wrapping (```lang ... ```)
    +    +    +        content = _strip_code_fence(raw_content)
    +    +    +
    +    +    +        blocks.append({"path": file_path, "content": content})
    +    +    +        pos = end_match.end()
    +    +    +
    +    +    +    return blocks
    +    +    +
    +    +    +
    +    +    +def _strip_code_fence(text: str) -> str:
    +    +    +    """Strip optional markdown code fence wrapper from file content."""
    +    +    +    stripped = text.strip()
    +    +    +    if stripped.startswith("```"):
    +    +    +        # Remove opening fence (```lang or just ```)
    +    +    +        first_nl = stripped.find("\n")
    +    +    +        if first_nl >= 0:
    +    +    +            stripped = stripped[first_nl + 1:]
    +    +    +    if stripped.rstrip().endswith("```"):
    +    +    +        stripped = stripped.rstrip()[:-3]
    +    +    +    return stripped.rstrip("\n") + "\n" if stripped.strip() else ""
    +    +    +
    +    +    +
    +    +     # Active build tasks keyed by build_id
    +    +     _active_tasks: dict[str, asyncio.Task] = {}
    +          
    +    +    @@ -65,7 +147,13 @@ def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
    +          # ---------------------------------------------------------------------------
    +    -    @@ -72,6 +89,14 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    -         if latest and latest["status"] in ("pending", "running"):
    +    -             raise ValueError("A build is already in progress for this project")
    +          
    +    -    +    # BYOK: user must supply their own Anthropic API key for builds
    +    -    +    user = await get_user_by_id(user_id)
    +    -    +    user_api_key = (user or {}).get("anthropic_api_key") or ""
    +    -    +    if not user_api_key.strip():
    +    -    +        raise ValueError(
    +    -    +            "Anthropic API key required. Add your key in Settings to start a build."
    +    -    +        )
         +     
    -    +         try:
    -    +    -        raw_reply = await llm_chat(
    -    +    +        llm_result = await llm_chat(
    -    +                 api_key=llm_api_key,
    -    +                 model=llm_model,
    -    +                 system_prompt=dynamic_system,
    -    +    @@ -255,6 +256,8 @@ async def process_questionnaire_message(
    -    +             logger.exception("LLM chat failed for project %s", project_id)
    -    +             raise ValueError(f"LLM service error: {exc}") from exc
    +    +    -async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    +    +async def start_build(
    +    +    +    project_id: UUID,
    +    +    +    user_id: UUID,
    +    +    +    *,
    +    +    +    target_type: str | None = None,
    +    +    +    target_ref: str | None = None,
    +    +    +) -> dict:
    +    +         """Start a build for a project.
         +     
    -    +    +    raw_reply = llm_result["text"]
    -    +    +    usage = llm_result.get("usage", {})
    -    +         logger.info("LLM raw response (first 500 chars): %s", raw_reply[:500])
    +    +         Validates that contracts exist, creates a build record, and spawns
    +    +    @@ -74,6 +162,8 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    +         Args:
    +    +             project_id: The project to build.
    +    +             user_id: The authenticated user (for ownership check).
    +    +    +        target_type: Build target -- 'github_new', 'github_existing', or 'local_path'.
    +    +    +        target_ref: Target reference -- repo name, full_name, or absolute path.
         +     
    -    +         # Parse the structured JSON response from the LLM
    -    +    @@ -263,19 +266,42 @@ async def process_questionnaire_message(
    -    +                     parsed.get("section_complete"), parsed.get("section"))
    +    +         Returns:
    +    +             The created build record.
    +    +    @@ -106,15 +196,43 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
         +     
    -    +         # Update state based on LLM response
    -    +    -    history.append({"role": "user", "content": message})
    -    +    -    history.append({"role": "assistant", "content": parsed["reply"]})
    -    +    +    history.append({"role": "user", "content": message, "section": current_section})
    +    +         audit_llm_enabled = (user or {}).get("audit_llm_enabled", True)
         +     
    -    +    -    if parsed.get("section_complete") and parsed.get("extracted_data"):
    -    +    +    # If section just completed, tag the assistant reply with the NEXT section
    -    +    +    # so it appears in the new section's chat (it contains the transition question).
    -    +    +    section_just_completed = (
    -    +    +        parsed.get("section_complete") and parsed.get("extracted_data")
    +    +    +    # Validate target
    +    +    +    if target_type and target_type not in VALID_TARGET_TYPES:
    +    +    +        raise ValueError(f"Invalid target_type: {target_type}. Must be one of: {', '.join(VALID_TARGET_TYPES)}")
    +    +    +    if target_type and not target_ref:
    +    +    +        raise ValueError("target_ref is required when target_type is specified")
    +    +    +
    +    +    +    # Resolve working directory based on target type
    +    +    +    working_dir: str | None = None
    +    +    +    if target_type == "local_path":
    +    +    +        working_dir = str(Path(target_ref).resolve()) if target_ref else None
    +    +    +        if working_dir:
    +    +    +            Path(working_dir).mkdir(parents=True, exist_ok=True)
    +    +    +    elif target_type in ("github_new", "github_existing"):
    +    +    +        # Use a temp directory; clone/init happens in _run_build
    +    +    +        working_dir = tempfile.mkdtemp(prefix="forgeguard_build_")
    +         +
    +              # Create build record
    +    -         build = await build_repo.create_build(project_id)
    +    +    -    build = await build_repo.create_build(project_id)
    +    +    +    build = await build_repo.create_build(
    +    +    +        project_id,
    +    +    +        target_type=target_type,
    +    +    +        target_ref=target_ref,
    +    +    +        working_dir=working_dir,
         +    +    )
    -    +    +    if section_just_completed:
    -    +             section_name = parsed.get("section", current_section)
    -    +             answers[section_name] = parsed["extracted_data"]
    -    +             if section_name not in completed:
    -    +                 completed.append(section_name)
    -    +    +        # Determine the next section (if any) for tagging the reply
    -    +    +        next_section = None
    -    +    +        for s in QUESTIONNAIRE_SECTIONS:
    -    +    +            if s not in completed:
    -    +    +                next_section = s
    -    +    +                break
    -    +    +        reply_section = next_section or current_section
    -    +    +    else:
    -    +    +        reply_section = current_section
    -    +    +
    -    +    +    history.append({"role": "assistant", "content": parsed["reply"], "section": reply_section})
    -    +    +
    -    +    +    # Accumulate token usage
    -    +    +    prev_usage = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    -    +    +    total_usage = {
    -    +    +        "input_tokens": prev_usage.get("input_tokens", 0) + usage.get("input_tokens", 0),
    -    +    +        "output_tokens": prev_usage.get("output_tokens", 0) + usage.get("output_tokens", 0),
    -    +    +    }
    -    +     
    -    +         new_state = {
    -    +             "completed_sections": completed,
    -    +             "answers": answers,
    -    +             "conversation_history": history,
    -    +    +        "token_usage": total_usage,
    -    +         }
    -    +         await update_questionnaire_state(project_id, new_state)
    -    +     
    -    +    @@ -292,6 +318,7 @@ async def process_questionnaire_message(
    -    +             "completed_sections": completed,
    -    +             "remaining_sections": remaining,
    -    +             "is_complete": is_complete,
    -    +    +        "token_usage": total_usage,
    -    +         }
    -    +     
    -    +     
    -    +    @@ -309,9 +336,26 @@ async def get_questionnaire_state(
    -    +         qs = project.get("questionnaire_state") or {}
    -    +         progress = _questionnaire_progress(qs)
    -    +         progress["conversation_history"] = qs.get("conversation_history", [])
    -    +    +    progress["token_usage"] = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    -    +         return progress
    -    +     
    +          
    +    -    @@ -80,7 +105,7 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    +         # Update project status
    +    +         await project_repo.update_project_status(project_id, "building")
    +          
    +              # Spawn background task
    +              task = asyncio.create_task(
    +    -    -        _run_build(build["id"], project_id, user_id, contracts)
    +    -    +        _run_build(build["id"], project_id, user_id, contracts, user_api_key)
    +    +    -        _run_build(build["id"], project_id, user_id, contracts, user_api_key, audit_llm_enabled)
    +    +    +        _run_build(
    +    +    +            build["id"], project_id, user_id, contracts,
    +    +    +            user_api_key, audit_llm_enabled,
    +    +    +            target_type=target_type,
    +    +    +            target_ref=target_ref,
    +    +    +            working_dir=working_dir,
    +    +    +            access_token=(user or {}).get("access_token", ""),
    +    +    +        )
    +              )
    +              _active_tasks[str(build["id"])] = task
    +          
    +    -    @@ -196,6 +221,7 @@ async def _run_build(
    +    -         project_id: UUID,
    +    -         user_id: UUID,
    +    +    @@ -232,11 +350,18 @@ async def _run_build(
    +              contracts: list[dict],
    +    -    +    api_key: str,
    +    +         api_key: str,
    +    +         audit_llm_enabled: bool = True,
    +    +    +    *,
    +    +    +    target_type: str | None = None,
    +    +    +    target_ref: str | None = None,
    +    +    +    working_dir: str | None = None,
    +    +    +    access_token: str = "",
    +          ) -> None:
    +              """Background task that orchestrates the full build lifecycle.
    +          
    +    -    @@ -232,7 +258,7 @@ async def _run_build(
    +    -     
    +    -             # Stream agent output
    +    -             async for chunk in stream_agent(
    +    -    -            api_key=settings.ANTHROPIC_API_KEY,
    +    -    +            api_key=api_key,
    +    -                 model=settings.LLM_BUILDER_MODEL,
    +    -                 system_prompt="You are an autonomous software builder operating under the Forge governance framework.",
    +    -                 messages=messages,
    +    -    @@ -270,10 +296,16 @@ async def _run_build(
    +    -                         source="system",
    +    -                         level="info",
    +    -                     )
    +    -    +                # Capture token usage BEFORE recording (which resets)
    +    -    +                phase_input_tokens = usage.input_tokens
    +    -    +                phase_output_tokens = usage.output_tokens
    +    -    +
    +    -                     await _broadcast_build_event(
    +    -                         user_id, build_id, "phase_complete", {
    +    -                             "phase": current_phase,
    +    -                             "status": "pass",
    +    -    +                        "input_tokens": phase_input_tokens,
    +    -    +                        "output_tokens": phase_output_tokens,
    +    +         Streams agent output, detects phase completion signals, runs inline
    +    +         audits, handles loopback, and advances through phases.
    +    +    +    When a build target is configured, parses file blocks from the
    +    +    +    builder output and writes them to the working directory.
    +    +         """
    +    +         try:
    +    +             now = datetime.now(timezone.utc)
    +    +    @@ -255,6 +380,66 @@ async def _run_build(
    +    +             # Build the directive from contracts
    +    +             directive = _build_directive(contracts)
         +     
    -    +    +async def reset_questionnaire(
    +    +    +        # Set up working directory for file writing
    +    +    +        if target_type == "github_new" and target_ref and working_dir:
    +    +    +            try:
    +    +    +                # Create a new GitHub repo
    +    +    +                repo_data = await github_client.create_github_repo(
    +    +    +                    access_token, target_ref,
    +    +    +                    description=f"Built by ForgeGuard",
    +    +    +                    private=False,
    +    +    +                )
    +    +    +                clone_url = f"https://github.com/{repo_data['full_name']}.git"
    +    +    +                await git_client.clone_repo(
    +    +    +                    clone_url, working_dir,
    +    +    +                    access_token=access_token, shallow=False,
    +    +    +                )
    +    +    +                await build_repo.append_build_log(
    +    +    +                    build_id,
    +    +    +                    f"Created GitHub repo: {repo_data['full_name']}",
    +    +    +                    source="system", level="info",
    +    +    +                )
    +    +    +                await _broadcast_build_event(user_id, build_id, "build_log", {
    +    +    +                    "message": f"Created GitHub repo: {repo_data['full_name']}",
    +    +    +                    "source": "system", "level": "info",
    +    +    +                })
    +    +    +            except Exception as exc:
    +    +    +                await _fail_build(build_id, user_id, f"Failed to create GitHub repo: {exc}")
    +    +    +                return
    +    +    +        elif target_type == "github_existing" and target_ref and working_dir:
    +    +    +            try:
    +    +    +                clone_url = f"https://github.com/{target_ref}.git"
    +    +    +                await git_client.clone_repo(
    +    +    +                    clone_url, working_dir,
    +    +    +                    access_token=access_token, shallow=False,
    +    +    +                )
    +    +    +                await build_repo.append_build_log(
    +    +    +                    build_id,
    +    +    +                    f"Cloned existing repo: {target_ref}",
    +    +    +                    source="system", level="info",
    +    +    +                )
    +    +    +            except Exception as exc:
    +    +    +                await _fail_build(build_id, user_id, f"Failed to clone repo: {exc}")
    +    +    +                return
    +    +    +        elif target_type == "local_path" and working_dir:
    +    +    +            try:
    +    +    +                Path(working_dir).mkdir(parents=True, exist_ok=True)
    +    +    +                # Initialize git repo if not already one
    +    +    +                git_dir = Path(working_dir) / ".git"
    +    +    +                if not git_dir.exists():
    +    +    +                    await git_client.init_repo(working_dir)
    +    +    +                await build_repo.append_build_log(
    +    +    +                    build_id,
    +    +    +                    f"Using local path: {working_dir}",
    +    +    +                    source="system", level="info",
    +    +    +                )
    +    +    +            except Exception as exc:
    +    +    +                await _fail_build(build_id, user_id, f"Failed to initialize local path: {exc}")
    +    +    +                return
    +    +    +
    +    +    +        # Track files written during this build
    +    +    +        files_written: list[dict] = []
    +    +    +
    +    +             # Conversation history for the agent
    +    +             messages: list[dict] = [
    +    +                 {"role": "user", "content": directive},
    +    +    @@ -289,6 +474,17 @@ async def _run_build(
    +                              }
    +                          )
    +          
    +    -    @@ -337,9 +369,15 @@ async def _run_build(
    +    -             await build_repo.append_build_log(
    +    +    +            # Detect and write file blocks
    +    +    +            new_blocks = _parse_file_blocks(accumulated_text)
    +    +    +            already_written_count = len(files_written)
    +    +    +            if len(new_blocks) > already_written_count and working_dir:
    +    +    +                for block in new_blocks[already_written_count:]:
    +    +    +                    await _write_file_block(
    +    +    +                        build_id, user_id, working_dir,
    +    +    +                        block["path"], block["content"],
    +    +    +                        files_written,
    +    +    +                    )
    +    +    +
    +    +                 # Detect phase completion
    +    +                 if PHASE_COMPLETE_SIGNAL in accumulated_text:
    +    +                     phase_match = re.search(
    +    +    @@ -337,6 +533,22 @@ async def _run_build(
    +    +                                 "phase": current_phase,
    +    +                             }
    +    +                         )
    +    +    +
    +    +    +                    # Git commit after phase audit passes
    +    +    +                    if working_dir and files_written:
    +    +    +                        try:
    +    +    +                            sha = await git_client.commit(
    +    +    +                                working_dir,
    +    +    +                                f"forge: {current_phase} complete",
    +    +    +                            )
    +    +    +                            if sha:
    +    +    +                                await build_repo.append_build_log(
    +    +    +                                    build_id,
    +    +    +                                    f"Committed {current_phase}: {sha[:8]}",
    +    +    +                                    source="system", level="info",
    +    +    +                                )
    +    +    +                        except Exception as exc:
    +    +    +                            logger.warning("Git commit failed for %s: %s", current_phase, exc)
    +    +                     else:
    +    +                         loop_count = await build_repo.increment_loop_count(build_id)
    +    +                         await build_repo.append_build_log(
    +    +    @@ -383,6 +595,35 @@ async def _run_build(
    +                      build_id, "Build completed successfully", source="system", level="info"
    +                  )
    +    -    +
    +    -    +        # Gather total cost summary for the final event
    +    -    +        cost_summary = await build_repo.get_build_cost_summary(build_id)
    +    -             await _broadcast_build_event(user_id, build_id, "build_complete", {
    +    -                 "id": str(build_id),
    +    -                 "status": "completed",
    +    -    +            "total_input_tokens": cost_summary["total_input_tokens"],
    +    -    +            "total_output_tokens": cost_summary["total_output_tokens"],
    +    -    +            "total_cost_usd": float(cost_summary["total_cost_usd"]),
    +    -             })
    +    -     
    +    -         except asyncio.CancelledError:
    +    -    @@ -446,8 +484,9 @@ async def _record_phase_cost(
    +    -         input_t = usage.input_tokens
    +    -         output_t = usage.output_tokens
    +    -         model = usage.model or settings.LLM_BUILDER_MODEL
    +    -    -    cost = (Decimal(input_t) * _COST_PER_INPUT_TOKEN
    +    -    -            + Decimal(output_t) * _COST_PER_OUTPUT_TOKEN)
    +    -    +    input_rate, output_rate = _get_token_rates(model)
    +    -    +    cost = (Decimal(input_t) * input_rate
    +    -    +            + Decimal(output_t) * output_rate)
    +    -         await build_repo.record_build_cost(
    +    -             build_id, phase, input_t, output_t, model, cost
    +    -         )
    +    -    @@ -538,6 +577,77 @@ async def get_build_instructions(project_id: UUID, user_id: UUID) -> dict:
    +    -         }
    +          
    +    -     
    +    -    +async def get_build_phases(project_id: UUID, user_id: UUID) -> list[dict]:
    +    -    +    """Parse the phases contract into a structured list of phase definitions.
    +    +    +        # Final commit + push for GitHub targets
    +    +    +        if working_dir and files_written:
    +    +    +            try:
    +    +    +                sha = await git_client.commit(working_dir, "forge: build complete")
    +    +    +                if sha:
    +    +    +                    await build_repo.append_build_log(
    +    +    +                        build_id, f"Final commit: {sha[:8]}", source="system", level="info",
    +    +    +                    )
    +    +    +            except Exception as exc:
    +    +    +                logger.warning("Final git commit failed: %s", exc)
    +    +    +
    +    +    +            if target_type in ("github_new", "github_existing") and access_token:
    +    +    +                try:
    +    +    +                    await git_client.push(
    +    +    +                        working_dir, access_token=access_token,
    +    +    +                    )
    +    +    +                    await build_repo.append_build_log(
    +    +    +                        build_id, "Pushed to GitHub", source="system", level="info",
    +    +    +                    )
    +    +    +                    await _broadcast_build_event(user_id, build_id, "build_log", {
    +    +    +                        "message": "Pushed all commits to GitHub",
    +    +    +                        "source": "system", "level": "info",
    +    +    +                    })
    +    +    +                except Exception as exc:
    +    +    +                    logger.error("Git push failed: %s", exc)
    +    +    +                    await build_repo.append_build_log(
    +    +    +                        build_id, f"Git push failed: {exc}", source="system", level="error",
    +    +    +                    )
    +    +    +
    +    +             # Gather total cost summary for the final event
    +    +             cost_summary = await build_repo.get_build_cost_summary(build_id)
    +    +             await _broadcast_build_event(user_id, build_id, "build_complete", {
    +    +    @@ -401,6 +642,120 @@ async def _run_build(
    +    +             await _fail_build(build_id, user_id, str(exc))
    +    +         finally:
    +    +             _active_tasks.pop(str(build_id), None)
    +    +    +        # Cleanup temp working dir for GitHub targets on failure/cancel
    +    +    +        # (keep on success so user can inspect; they'll be cleaned up later)
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# File Writing Helpers
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +async def _write_file_block(
    +    +    +    build_id: UUID,
         +    +    user_id: UUID,
    -    +    +    project_id: UUID,
    -    +    +) -> dict:
    -    +    +    """Clear all questionnaire state and reset the project to draft."""
    -    +    +    project = await get_project_by_id(project_id)
    -    +    +    if not project:
    -    +    +        raise ValueError("Project not found")
    -    +    +    if str(project["user_id"]) != str(user_id):
    -    +    +        raise ValueError("Project not found")
    +    +    +    working_dir: str,
    +    +    +    file_path: str,
    +    +    +    content: str,
    +    +    +    files_written: list[dict],
    +    +    +) -> None:
    +    +    +    """Write a file block to the working directory and emit events."""
    +    +    +    try:
    +    +    +        # Sanitize path -- prevent directory traversal
    +    +    +        clean_path = Path(file_path).as_posix()
    +    +    +        if clean_path.startswith("/") or ".." in clean_path:
    +    +    +            logger.warning("Skipping suspicious file path: %s", file_path)
    +    +    +            return
         +    +
    -    +    +    await update_questionnaire_state(project_id, {})
    -    +    +    await update_project_status(project_id, "draft")
    -    +    +    return {"status": "reset"}
    +    +    +        full_path = Path(working_dir) / clean_path
    +    +    +        full_path.parent.mkdir(parents=True, exist_ok=True)
    +    +    +        full_path.write_text(content, encoding="utf-8")
         +    +
    +    +    +        size_bytes = len(content.encode("utf-8"))
    +    +    +        language = _detect_language(clean_path)
         +    +
    +    +    +        file_info = {
    +    +    +            "path": clean_path,
    +    +    +            "size_bytes": size_bytes,
    +    +    +            "language": language,
    +    +    +        }
    +    +    +        files_written.append(file_info)
    +    +    +
    +    +    +        # Log as structured file entry (source='file' for querying)
    +    +    +        await build_repo.append_build_log(
    +    +    +            build_id,
    +    +    +            json.dumps(file_info),
    +    +    +            source="file",
    +    +    +            level="info",
    +    +    +        )
    +    +    +
    +    +    +        # Broadcast file_created event
    +    +    +        await _broadcast_build_event(user_id, build_id, "file_created", file_info)
    +    +    +
    +    +    +        logger.info("Wrote file: %s (%d bytes)", clean_path, size_bytes)
    +    +    +
    +    +    +    except Exception as exc:
    +    +    +        logger.error("Failed to write file %s: %s", file_path, exc)
    +    +    +        await build_repo.append_build_log(
    +    +    +            build_id,
    +    +    +            f"Failed to write file {file_path}: {exc}",
    +    +    +            source="system",
    +    +    +            level="error",
    +    +    +        )
    +    +    +
    +         +
    +    -    +    Each entry contains: number, name, objective, deliverables (list of strings).
    +    +    +async def get_build_files(
    +    +    +    project_id: UUID, user_id: UUID
    +    +    +) -> list[dict]:
    +    +    +    """Get list of files written during the latest build.
    +         +
    +    -    +    Raises:
    +    -    +        ValueError: If project not found, not owned, or no phases contract.
    +    +    +    Returns list of {path, size_bytes, language, created_at}.
    +         +    """
    +         +    project = await project_repo.get_project_by_id(project_id)
    +         +    if not project or str(project["user_id"]) != str(user_id):
    +         +        raise ValueError("Project not found")
    +         +
    +    -    +    phases_contract = await project_repo.get_contract_by_type(project_id, "phases")
    +    -    +    if not phases_contract:
    +    -    +        raise ValueError("No phases contract found")
    +    +    +    latest = await build_repo.get_latest_build_for_project(project_id)
    +    +    +    if not latest:
    +    +    +        raise ValueError("No builds found for this project")
    +         +
    +    -    +    return _parse_phases_contract(phases_contract["content"])
    +    +    +    return await build_repo.get_build_file_logs(latest["id"])
    +         +
    +         +
    +    -    +def _parse_phases_contract(content: str) -> list[dict]:
    +    -    +    """Parse a phases contract markdown into structured phase definitions.
    +    +    +async def get_build_file_content(
    +    +    +    project_id: UUID, user_id: UUID, file_path: str
    +    +    +) -> dict:
    +    +    +    """Get content of a specific file from the build working directory.
    +         +
    +    -    +    Expects sections like:
    +    -    +        ## Phase 0 -- Genesis
    +    -    +        **Objective:** ...
    +    -    +        **Deliverables:**
    +    -    +        - item 1
    +    -    +        - item 2
    +    +    +    Returns {path, content, size_bytes, language}.
    +         +    """
    +    -    +    phases: list[dict] = []
    +    -    +    # Split on ## Phase headers
    +    -    +    phase_blocks = re.split(r"(?=^## Phase )", content, flags=re.MULTILINE)
    +    -    +
    +    -    +    for block in phase_blocks:
    +    -    +        # Match "## Phase N -- Name" or "## Phase N Ôö£├ÂÔö£├ºÔö£├é Name"
    +    -    +        header = re.match(
    +    -    +            r"^## Phase\s+(\d+)\s*[-Ôö£├ÂÔö£├ºÔö£├éÔö£├ÂÔö£├ºÔö£Ôöñ]+\s*(.+?)\s*$", block, re.MULTILINE
    +    -    +        )
    +    -    +        if not header:
    +    -    +            continue
    +    +    +    project = await project_repo.get_project_by_id(project_id)
    +    +    +    if not project or str(project["user_id"]) != str(user_id):
    +    +    +        raise ValueError("Project not found")
    +         +
    +    -    +        phase_num = int(header.group(1))
    +    -    +        phase_name = header.group(2).strip()
    +    +    +    latest = await build_repo.get_latest_build_for_project(project_id)
    +    +    +    if not latest:
    +    +    +        raise ValueError("No builds found for this project")
    +         +
    +    -    +        # Extract objective
    +    -    +        obj_match = re.search(
    +    -    +            r"\*\*Objective:\*\*\s*(.+?)(?=\n\n|\n\*\*|$)", block, re.DOTALL
    +    -    +        )
    +    -    +        objective = obj_match.group(1).strip() if obj_match else ""
    +    +    +    working_dir = latest.get("working_dir")
    +    +    +    if not working_dir:
    +    +    +        raise ValueError("Build has no working directory")
    +         +
    +    -    +        # Extract deliverables (bullet list after **Deliverables:**)
    +    -    +        deliverables: list[str] = []
    +    -    +        deliv_match = re.search(
    +    -    +            r"\*\*Deliverables:\*\*\s*\n((?:[-*]\s+.+\n?)+)", block
    +    -    +        )
    +    -    +        if deliv_match:
    +    -    +            for line in deliv_match.group(1).strip().splitlines():
    +    -    +                item = re.sub(r"^[-*]\s+", "", line).strip()
    +    -    +                if item:
    +    -    +                    deliverables.append(item)
    +    -    +
    +    -    +        phases.append({
    +    -    +            "number": phase_num,
    +    -    +            "name": phase_name,
    +    -    +            "objective": objective,
    +    -    +            "deliverables": deliverables,
    +    -    +        })
    +    -    +
    +    -    +    return phases
    +    -    +
    +    -    +
    +    -     def _generate_deploy_instructions(
    +    -         project_name: str, stack_content: str, blueprint_content: str
    +    -     ) -> str:
    +    -    diff --git a/app/services/project_service.py b/app/services/project_service.py
    +    -    index 46ab7de..6994dd6 100644
    +    -    --- a/app/services/project_service.py
    +    -    +++ b/app/services/project_service.py
    +    -    @@ -7,6 +7,7 @@ from uuid import UUID
    +    -     
    +    -     from app.clients.llm_client import chat as llm_chat
    +    -     from app.config import settings
    +    -    +from app.ws_manager import manager
    +    -     from app.repos.project_repo import (
    +    -         create_project as repo_create_project,
    +    -         delete_project as repo_delete_project,
    +    -    @@ -34,7 +35,6 @@ QUESTIONNAIRE_SECTIONS = [
    +    -         "ui_requirements",
    +    -         "architectural_boundaries",
    +    -         "deployment_target",
    +    -    -    "phase_breakdown",
    +    -     ]
    +    -     
    +    -     CONTRACT_TYPES = [
    +    -    @@ -46,11 +46,11 @@ CONTRACT_TYPES = [
    +    -         "boundaries",
    +    -         "phases",
    +    -         "ui",
    +    -    -    "builder_contract",
    +    -         "builder_directive",
    +    -     ]
    +    -     
    +    -     TEMPLATES_DIR = Path(__file__).resolve().parent.parent / "templates" / "contracts"
    +    -    +FORGE_CONTRACTS_DIR = Path(__file__).resolve().parent.parent.parent / "Forge" / "Contracts"
    +    -     
    +    -     _SYSTEM_PROMPT = """\
    +    -     You are a project intake specialist for Forge, an autonomous build system.
    +    -    @@ -65,31 +65,28 @@ The questionnaire has these sections (in order):
    +    -     5. ui_requirements Ôö£├ÂÔö£├ºÔö£├é Pages, components, design system, responsive needs
    +    -     6. architectural_boundaries Ôö£├ÂÔö£├ºÔö£├é Layer rules, forbidden imports, separation concerns
    +    -     7. deployment_target Ôö£├ÂÔö£├ºÔö£├é Where it runs, CI/CD, infrastructure
    +    -    -8. phase_breakdown Ôö£├ÂÔö£├ºÔö£├é Implementation phases with deliverables and exit criteria
    +    -    +
    +    -    +NOTE: Do NOT ask the user about implementation phases. Phases are auto-derived
    +    -    +architecturally during contract generation based on all gathered information.
    +    -     
    +    -     CRITICAL RULES:
    +    -    -- Ask AT MOST 2-3 focused questions per section, then COMPLETE IT.
    +    -    -- Do NOT over-ask. If the user gives a reasonable answer, mark the section
    +    -    -  complete and move on. You can infer sensible defaults for anything unclear.
    +    -    -- One section at a time. After completing one, immediately ask about the next.
    +    -    -- If the user's single answer covers multiple sections, mark ALL covered
    +    -    -  sections as complete in one response.
    +    -    +- Ask AT MOST 1-2 focused questions per section, then set section_complete=true.
    +    -    +- After the user answers, ALWAYS set section_complete to true and move on.
    +    -    +  Do NOT ask follow-ups within the same section. One answer per section is enough.
    +    -    +- Infer sensible defaults for anything unclear Ôö£├ÂÔö£├ºÔö£├é DO NOT ask for clarification.
    +    -    +- ALWAYS include extracted_data with at least a summary of what you captured.
    +    -     - Your response MUST be ONLY valid JSON Ôö£├ÂÔö£├ºÔö£├é no markdown fences, no extra text:
    +    -       {
    +    -    -    "reply": "<your conversational message to the user>",
    +    -    -    "section": "<current section name>",
    +    -    +    "reply": "<your message Ôö£├ÂÔö£├ºÔö£├é summarise what you captured, then ask about the NEXT section>",
    +    -    +    "section": "<the section you just completed or are asking about>",
    +    -         "section_complete": true|false,
    +    -         "extracted_data": { <key-value pairs of captured information> }
    +    -       }
    +    -    -- When section_complete is true, extracted_data MUST contain the collected data.
    +    -    -- When section_complete is false, extracted_data should be {} or partial data.
    +    -    -- ALWAYS set section_complete to true after AT MOST 2 exchanges per section.
    +    -    -  Don't let any section drag on Ôö£├ÂÔö£├ºÔö£├é keep momentum. The user sees a progress bar;
    +    -    -  it must visibly advance.
    +    -    -- Be conversational but FAST. Prefer completing a section and moving on over
    +    -    -  asking the perfect follow-up question.
    +    -    -- When all sections are done, set section to "complete" and section_complete
    +    -    -  to true.
    +    -    +- When section_complete is true, extracted_data MUST contain the captured data.
    +    -    +  extracted_data must NEVER be empty or null when section_complete is true.
    +    -    +- The user sees a progress bar. Every response MUST advance it. If the user
    +    -    +  answered your question, section_complete MUST be true.
    +    -    +- When all 7 sections are done, set section to "complete".
    +    -     """
    +    -     
    +    -     
    +    -    @@ -202,7 +199,10 @@ async def process_questionnaire_message(
    +    -             f"Project description: {project.get('description', 'N/A')}\n"
    +    -             f"Current section: {current_section}\n"
    +    -             f"Completed sections: {', '.join(completed) if completed else 'none'}\n"
    +    -    -        f"Previously collected data: {json.dumps(answers, indent=2)}"
    +    -    +        f"Previously collected data: {json.dumps(answers, indent=2)}\n"
    +    -    +        f"IMPORTANT: The user has been on '{current_section}' for "
    +    -    +        f"{sum(1 for m in history if m['role'] == 'user' and m.get('section') == current_section)} "
    +    -    +        f"messages already. Set section_complete=true NOW and move to the next section."
    +    -         )
    +    -     
    +    -         # Anthropic requires strictly alternating user/assistant roles.
    +    -    @@ -244,7 +244,7 @@ async def process_questionnaire_message(
    +    -         )
    +    -     
    +    -         try:
    +    -    -        raw_reply = await llm_chat(
    +    -    +        llm_result = await llm_chat(
    +    -                 api_key=llm_api_key,
    +    -                 model=llm_model,
    +    -                 system_prompt=dynamic_system,
    +    -    @@ -255,6 +255,8 @@ async def process_questionnaire_message(
    +    -             logger.exception("LLM chat failed for project %s", project_id)
    +    -             raise ValueError(f"LLM service error: {exc}") from exc
    +    -     
    +    -    +    raw_reply = llm_result["text"]
    +    -    +    usage = llm_result.get("usage", {})
    +    -         logger.info("LLM raw response (first 500 chars): %s", raw_reply[:500])
    +    -     
    +    -         # Parse the structured JSON response from the LLM
    +    -    @@ -263,19 +265,73 @@ async def process_questionnaire_message(
    +    -                     parsed.get("section_complete"), parsed.get("section"))
    +    -     
    +    -         # Update state based on LLM response
    +    -    -    history.append({"role": "user", "content": message})
    +    -    -    history.append({"role": "assistant", "content": parsed["reply"]})
    +    -    -
    +    -    -    if parsed.get("section_complete") and parsed.get("extracted_data"):
    +    -    -        section_name = parsed.get("section", current_section)
    +    -    -        answers[section_name] = parsed["extracted_data"]
    +    -    +    history.append({"role": "user", "content": message, "section": current_section})
    +    -    +
    +    -    +    # --- Section-completion logic (3 independent triggers) ---
    +    -    +    llm_section = parsed.get("section") or current_section
    +    -    +    llm_says_complete = bool(parsed.get("section_complete"))
    +    -    +    extracted = parsed.get("extracted_data")
    +    -    +
    +    -    +    # Trigger 1: LLM explicitly says section_complete=true
    +    -    +    if llm_says_complete:
    +    -    +        section_name = llm_section if llm_section in QUESTIONNAIRE_SECTIONS else current_section
    +    -    +        if extracted and isinstance(extracted, dict):
    +    -    +            answers[section_name] = extracted
    +    -    +        elif section_name not in answers:
    +    -    +            answers[section_name] = {"auto": "completed by LLM"}
    +    -             if section_name not in completed:
    +    -                 completed.append(section_name)
    +    -    +        logger.info("Section completed (LLM explicit): %s", section_name)
    +    -    +
    +    -    +    # Trigger 2: LLM jumped ahead Ôö£├ÂÔö£├ºÔö£├é mentions a later section, implying
    +    -    +    #            the current one is done.  Complete all sections up to
    +    -    +    #            (but not including) the one the LLM is now asking about.
    +    -    +    if llm_section in QUESTIONNAIRE_SECTIONS and llm_section != current_section:
    +    -    +        llm_idx = QUESTIONNAIRE_SECTIONS.index(llm_section)
    +    -    +        cur_idx = QUESTIONNAIRE_SECTIONS.index(current_section)
    +    -    +        if llm_idx > cur_idx:
    +    -    +            for i in range(cur_idx, llm_idx):
    +    -    +                s = QUESTIONNAIRE_SECTIONS[i]
    +    -    +                if s not in completed:
    +    -    +                    completed.append(s)
    +    -    +                    if s not in answers:
    +    -    +                        answers[s] = {"auto": "inferred from conversation"}
    +    -    +                    logger.info("Section auto-completed (LLM jumped ahead): %s", s)
    +    -    +
    +    -    +    # Trigger 3: Exchange-count safety net Ôö£├ÂÔö£├ºÔö£├é if we've had >= 3 user
    +    -    +    #            messages in the same section, force-complete it so
    +    -    +    #            the user always sees progress.
    +    -    +    section_user_msgs = sum(
    +    -    +        1 for m in history if m["role"] == "user" and m.get("section") == current_section
    +    -    +    )
    +    -    +    if section_user_msgs >= 3 and current_section not in completed:
    +    -    +        completed.append(current_section)
    +    -    +        if current_section not in answers:
    +    -    +            answers[current_section] = {"auto": "force-completed after 3 exchanges"}
    +    -    +        logger.info("Section force-completed (3 exchanges): %s", current_section)
    +    -    +
    +    -    +    # Determine the next section for tagging the assistant reply
    +    -    +    next_section = None
    +    -    +    for s in QUESTIONNAIRE_SECTIONS:
    +    -    +        if s not in completed:
    +    -    +            next_section = s
    +    -    +            break
    +    -    +    reply_section = next_section or current_section
    +    +    +    clean_path = Path(file_path).as_posix()
    +    +    +    if ".." in clean_path:
    +    +    +        raise ValueError("Invalid file path")
    +         +
    +    -    +    history.append({"role": "assistant", "content": parsed["reply"], "section": reply_section})
    +    +    +    full_path = Path(working_dir) / clean_path
    +    +    +    if not full_path.exists():
    +    +    +        raise ValueError(f"File not found: {clean_path}")
    +         +
    +    -    +    # Accumulate token usage
    +    -    +    prev_usage = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    +    -    +    total_usage = {
    +    -    +        "input_tokens": prev_usage.get("input_tokens", 0) + usage.get("input_tokens", 0),
    +    -    +        "output_tokens": prev_usage.get("output_tokens", 0) + usage.get("output_tokens", 0),
    +    +    +    content = full_path.read_text(encoding="utf-8")
    +    +    +    return {
    +    +    +        "path": clean_path,
    +    +    +        "content": content,
    +    +    +        "size_bytes": len(content.encode("utf-8")),
    +    +    +        "language": _detect_language(clean_path),
    +         +    }
    +          
    +    -         new_state = {
    +    -             "completed_sections": completed,
    +    -             "answers": answers,
    +    -             "conversation_history": history,
    +    -    +        "token_usage": total_usage,
    +    -         }
    +    -         await update_questionnaire_state(project_id, new_state)
    +    -     
    +    -    @@ -292,6 +348,7 @@ async def process_questionnaire_message(
    +    -             "completed_sections": completed,
    +    -             "remaining_sections": remaining,
    +    -             "is_complete": is_complete,
    +    -    +        "token_usage": total_usage,
    +    -         }
    +    -     
    +    -     
    +    -    @@ -309,9 +366,26 @@ async def get_questionnaire_state(
    +    -         qs = project.get("questionnaire_state") or {}
    +    -         progress = _questionnaire_progress(qs)
    +    -         progress["conversation_history"] = qs.get("conversation_history", [])
    +    -    +    progress["token_usage"] = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    +    -         return progress
    +          
         +     # ---------------------------------------------------------------------------
    -    +     # Contract generation
    -    +     # ---------------------------------------------------------------------------
    -    +    @@ -344,7 +388,20 @@ async def generate_contracts(
    -    +         template_vars = _build_template_vars(project, answers)
    -    +     
    -    +         generated = []
    -    +    -    for contract_type in CONTRACT_TYPES:
    -    +    +    total = len(CONTRACT_TYPES)
    -    +    +    for idx, contract_type in enumerate(CONTRACT_TYPES):
    -    +    +        # Notify client that generation of this contract has started
    -    +    +        await manager.send_to_user(str(user_id), {
    -    +    +            "type": "contract_progress",
    -    +    +            "payload": {
    -    +    +                "project_id": str(project_id),
    -    +    +                "contract_type": contract_type,
    -    +    +                "status": "generating",
    -    +    +                "index": idx,
    -    +    +                "total": total,
    -    +    +            },
    -    +    +        })
    -    +    +
    -    +             content = _render_template(contract_type, template_vars)
    -    +             row = await upsert_contract(project_id, contract_type, content)
    -    +             generated.append({
    -    +    @@ -356,6 +413,18 @@ async def generate_contracts(
    -    +                 "updated_at": row["updated_at"],
    -    +             })
    -    +     
    -    +    +        # Notify client that this contract is done
    -    +    +        await manager.send_to_user(str(user_id), {
    -    +    +            "type": "contract_progress",
    -    +    +            "payload": {
    -    +    +                "project_id": str(project_id),
    -    +    +                "contract_type": contract_type,
    -    +    +                "status": "done",
    -    +    +                "index": idx,
    -    +    +                "total": total,
    -    +    +            },
    -    +    +        })
    -    +    +
    -    +         await update_project_status(project_id, "contracts_ready")
    -    +         return generated
    -    +     
    -    +    diff --git a/db/migrations/006_user_api_key.sql b/db/migrations/006_user_api_key.sql
    +    +    diff --git a/db/migrations/008_build_targets.sql b/db/migrations/008_build_targets.sql
         +    new file mode 100644
    -    +    index 0000000..13156c9
    +    +    index 0000000..eb29b44
         +    --- /dev/null
    -    +    +++ b/db/migrations/006_user_api_key.sql
    -    +    @@ -0,0 +1,4 @@
    -    +    +-- Phase 12: BYOK Ôö£├ÂÔö£├ºÔö£Ôöñ user-supplied Anthropic API key for builds
    -    +    +-- Adds an encrypted API key column to the users table.
    -    +    +
    -    +    +ALTER TABLE users ADD COLUMN IF NOT EXISTS anthropic_api_key TEXT;
    -    +    diff --git a/tests/test_audit_service.py b/tests/test_audit_service.py
    -    +    index 0f0451e..94d6f01 100644
    -    +    --- a/tests/test_audit_service.py
    -    +    +++ b/tests/test_audit_service.py
    -    +    @@ -32,6 +32,7 @@ def _make_patches():
    -    +             "get_user_by_id": AsyncMock(return_value=MOCK_USER),
    -    +             "list_commits": AsyncMock(return_value=[]),
    -    +             "get_existing_commit_shas": AsyncMock(return_value=set()),
    -    +    +        "mark_stale_audit_runs": AsyncMock(return_value=0),
    -    +             "create_audit_run": AsyncMock(return_value={"id": UUID("aaaa1111-1111-1111-1111-111111111111")}),
    -    +             "update_audit_run": AsyncMock(),
    -    +             "get_commit_files": AsyncMock(return_value=["README.md"]),
    -    +    @@ -156,3 +157,54 @@ async def test_backfill_handles_commit_error_gracefully():
    -    +         # Both count as "synced" (processed) even if one errored
    -    +         assert result["synced"] == 2
    -    +         assert result["skipped"] == 0
    +    +    +++ b/db/migrations/008_build_targets.sql
    +    +    @@ -0,0 +1,7 @@
    +    +    +-- Phase 12: Build Target & File Writing
    +    +    +-- Adds target columns to builds table so builds can write files
    +    +    +-- to a GitHub repo (new or existing) or a local directory.
         +    +
    +    +    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS target_type VARCHAR(20);
    +    +    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS target_ref TEXT;
    +    +    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS working_dir TEXT;
    +    +    diff --git a/tests/test_build_repo.py b/tests/test_build_repo.py
    +    +    index 218e2b3..efcff9d 100644
    +    +    --- a/tests/test_build_repo.py
    +    +    +++ b/tests/test_build_repo.py
    +    +    @@ -264,3 +264,90 @@ async def test_get_build_cost_summary(mock_get_pool):
    +          
    +    -    +async def reset_questionnaire(
    +    -    +    user_id: UUID,
    +    -    +    project_id: UUID,
    +    -    +) -> dict:
    +    -    +    """Clear all questionnaire state and reset the project to draft."""
    +    -    +    project = await get_project_by_id(project_id)
    +    -    +    if not project:
    +    -    +        raise ValueError("Project not found")
    +    -    +    if str(project["user_id"]) != str(user_id):
    +    -    +        raise ValueError("Project not found")
    +    +         assert summary["total_input_tokens"] == 5000
    +    +         assert summary["phase_count"] == 3
    +         +
    +    -    +    await update_questionnaire_state(project_id, {})
    +    -    +    await update_project_status(project_id, "draft")
    +    -    +    return {"status": "reset"}
    +         +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: get_build_file_logs
    +    +    +# ---------------------------------------------------------------------------
    +         +
    +    -     # ---------------------------------------------------------------------------
    +    -     # Contract generation
    +    -     # ---------------------------------------------------------------------------
    +    -    @@ -321,8 +395,10 @@ async def generate_contracts(
    +    -         user_id: UUID,
    +    -         project_id: UUID,
    +    -     ) -> list[dict]:
    +    -    -    """Generate all contract files from questionnaire answers.
    +    -    +    """Generate all contract files from questionnaire answers using the LLM.
    +    -     
    +    -    +    Each contract is generated individually with a contract-specific system
    +    -    +    prompt that references the Forge example contract as a structural blueprint.
    +    -         Raises ValueError if questionnaire is not complete.
    +    -         """
    +    -         project = await get_project_by_id(project_id)
    +    -    @@ -341,11 +417,37 @@ async def generate_contracts(
    +    -             )
    +    -     
    +    -         answers = qs.get("answers", {})
    +    -    -    template_vars = _build_template_vars(project, answers)
    +    -    +    answers_text = _format_answers_for_prompt(project, answers)
    +    -    +
    +    -    +    # Pick LLM provider
    +    -    +    provider = settings.LLM_PROVIDER.strip().lower() if settings.LLM_PROVIDER else ""
    +    -    +    if not provider:
    +    -    +        provider = "anthropic" if settings.ANTHROPIC_API_KEY else "openai"
    +    -    +    if provider == "openai":
    +    -    +        llm_api_key = settings.OPENAI_API_KEY
    +    -    +        llm_model = settings.OPENAI_MODEL
    +    -    +    else:
    +    -    +        llm_api_key = settings.ANTHROPIC_API_KEY
    +    -    +        llm_model = settings.LLM_QUESTIONNAIRE_MODEL
    +    -     
    +    -         generated = []
    +    -    -    for contract_type in CONTRACT_TYPES:
    +    -    -        content = _render_template(contract_type, template_vars)
    +    -    +    total = len(CONTRACT_TYPES)
    +    -    +    for idx, contract_type in enumerate(CONTRACT_TYPES):
    +    -    +        # Notify client that generation of this contract has started
    +    -    +        await manager.send_to_user(str(user_id), {
    +    -    +            "type": "contract_progress",
    +    -    +            "payload": {
    +    -    +                "project_id": str(project_id),
    +    -    +                "contract_type": contract_type,
    +    -    +                "status": "generating",
    +    -    +                "index": idx,
    +    -    +                "total": total,
    +    -    +            },
    +    -    +        })
    +    -    +
    +    -    +        content, usage = await _generate_contract_content(
    +    -    +            contract_type, project, answers_text, llm_api_key, llm_model, provider
    +    -    +        )
    +    -             row = await upsert_contract(project_id, contract_type, content)
    +    -             generated.append({
    +    -                 "id": str(row["id"]),
    +    -    @@ -356,6 +458,20 @@ async def generate_contracts(
    +    -                 "updated_at": row["updated_at"],
    +    -             })
    +    -     
    +    -    +        # Notify client that this contract is done
    +    -    +        await manager.send_to_user(str(user_id), {
    +    -    +            "type": "contract_progress",
    +    -    +            "payload": {
    +    -    +                "project_id": str(project_id),
    +    -    +                "contract_type": contract_type,
    +    -    +                "status": "done",
    +    -    +                "index": idx,
    +    -    +                "total": total,
    +    -    +                "input_tokens": usage.get("input_tokens", 0),
    +    -    +                "output_tokens": usage.get("output_tokens", 0),
    +    -    +            },
    +    -    +        })
    +    -    +
    +    -         await update_project_status(project_id, "contracts_ready")
    +    -         return generated
    +    -     
    +    -    @@ -481,48 +597,252 @@ def _parse_llm_response(raw: str) -> dict:
    +    -         }
    +    -     
    +    -     
    +    -    -def _build_template_vars(project: dict, answers: dict) -> dict:
    +    -    -    """Flatten questionnaire answers into template variables."""
    +    -    -    variables = {
    +    -    -        "project_name": project["name"],
    +    -    -        "project_description": project.get("description", ""),
    +    -    +def _format_answers_for_prompt(project: dict, answers: dict) -> str:
    +    -    +    """Format all questionnaire answers into a readable text block for prompts."""
    +    -    +    lines = [
    +    -    +        f"Project name: {project['name']}",
    +    -    +        f"Description: {project.get('description', 'N/A')}",
    +    -    +        "",
         +    +
         +    +@pytest.mark.asyncio
    -    +    +async def test_backfill_cleans_stale_runs():
    -    +    +    """backfill_repo_commits calls mark_stale_audit_runs before processing."""
    -    +    +    mocks = _make_patches()
    -    +    +    mocks["list_commits"].return_value = []
    -    +    +    mocks["mark_stale_audit_runs"].return_value = 3
    -    +    +
    -    +    +    patches = _apply_patches(mocks)
    -    +    +    for p in patches:
    -    +    +        p.start()
    -    +    +    try:
    -    +    +        result = await backfill_repo_commits(REPO_ID, USER_ID)
    -    +    +    finally:
    -    +    +        for p in patches:
    -    +    +            p.stop()
    +    +    +@patch("app.repos.build_repo.get_pool")
    +    +    +async def test_get_build_file_logs(mock_get_pool):
    +    +    +    """get_build_file_logs returns parsed file entries."""
    +    +    +    import json
    +    +    +    pool = _fake_pool()
    +    +    +    pool.fetch.return_value = [
    +    +    +        {
    +    +    +            "message": json.dumps({"path": "src/main.py", "size_bytes": 42, "language": "python"}),
    +    +    +            "created_at": datetime.now(timezone.utc),
    +    +    +        },
    +    +    +        {
    +    +    +            "message": json.dumps({"path": "package.json", "size_bytes": 200, "language": "json"}),
    +    +    +            "created_at": datetime.now(timezone.utc),
    +    +    +        },
    +         +    ]
    +    -    +    for section in QUESTIONNAIRE_SECTIONS:
    +    -    +        section_data = answers.get(section)
    +    -    +        lines.append(f"### {section}")
    +    -    +        if not section_data:
    +    -    +            lines.append("(no data collected)")
    +    -    +        elif isinstance(section_data, dict):
    +    -    +            for k, v in section_data.items():
    +    -    +                if isinstance(v, list):
    +    -    +                    lines.append(f"- {k}:")
    +    -    +                    for item in v:
    +    -    +                        lines.append(f"  - {item}")
    +    -    +                elif isinstance(v, dict):
    +    -    +                    lines.append(f"- {k}: {json.dumps(v, indent=2)}")
    +    -    +                else:
    +    -    +                    lines.append(f"- {k}: {v}")
    +    -    +        else:
    +    -    +            lines.append(str(section_data))
    +    -    +        lines.append("")
    +    -    +    return "\n".join(lines)
    +    -    +
    +    -    +
    +    -    +def _load_forge_example(contract_type: str) -> str | None:
    +    -    +    """Load the Forge example contract as a structural reference, if it exists."""
    +    -    +    ext_map = {
    +    -    +        "physics": "physics.yaml",
    +    -    +        "boundaries": "boundaries.json",
    +    -         }
    +    -    +    filename = ext_map.get(contract_type, f"{contract_type}.md")
    +    -    +    path = FORGE_CONTRACTS_DIR / filename
    +    -    +    if path.exists():
    +    -    +        try:
    +    -    +            return path.read_text(encoding="utf-8")
    +    -    +        except Exception:
    +    -    +            return None
    +    -    +    return None
    +    -    +
    +    -    +
    +    -    +# Per-contract generation instructions
    +    -    +_CONTRACT_INSTRUCTIONS: dict[str, str] = {
    +    -    +    "blueprint": """\
    +    -    +Generate a comprehensive project blueprint. Include:
    +    -    +1) Product intent Ôö£├ÂÔö£├ºÔö£├é what it does, who it's for, why it exists (2-3 paragraphs)
    +    -    +2) Core interaction invariants Ôö£├ÂÔö£├ºÔö£├é 5-7 MUST-hold rules (bullet list)
    +    -    +3) MVP scope Ôö£├ÂÔö£├ºÔö£├é Must-ship features (numbered, with sub-details) AND explicitly-not-MVP list
    +    -    +4) Hard boundaries Ôö£├ÂÔö£├ºÔö£├é anti-godfile rules per architectural layer (Routers, Services, Repos, Clients, etc.)
    +    -    +5) Deployment target Ôö£├ÂÔö£├ºÔö£├é where it runs, scale expectations
    +    -    +
    +    -    +Use specific, concrete language. No vagueness. Every feature must be described precisely enough
    +    -    +that a developer could implement it without asking questions.""",
    +    -    +
    +    -    +    "manifesto": """\
    +    -    +Generate a project manifesto defining 5-7 non-negotiable principles.
    +    -    +Each principle should have:
    +    -    +- A descriptive title (e.g. "Contract-first, schema-first")
    +    -    +- 3-5 bullet points elaborating the rule
    +    -    +- Project-specific details (not generic platitudes)
    +    -    +
    +    -    +Include a "Confirm-before-write" section listing what requires user confirmation
    +    -    +and what is exempt. Include any privacy or security principles relevant to this project.""",
    +    -    +
    +    -    +    "stack": """\
    +    -    +Generate a technology stack document. Include sections for:
    +    -    +- Backend (language, framework, version, key libraries)
    +    -    +- Database (engine, version, connection method)
    +    -    +- Auth (method, provider, flow)
    +    -    +- Frontend (framework, bundler, key libraries)
    +    -    +- Testing (framework, coverage requirements)
    +    -    +- Deployment (platform, expected scale)
    +    -    +- Environment Variables table (name, description, required/optional)
    +    -    +- forge.json schema (JSON block showing project metadata structure)
    +    -    +
    +    -    +For each technology choice, briefly explain WHY it was chosen.""",
    +    -    +
    +    -    +    "schema": """\
    +    -    +Generate a complete database schema document. Include:
    +    -    +- Schema version header
    +    -    +- Conventions section (naming patterns, common columns like id/created_at/updated_at)
    +    -    +- Full CREATE TABLE SQL for EVERY table, including:
    +    -    +  - Column definitions with types and constraints
    +    -    +  - PRIMARY KEY, FOREIGN KEY, UNIQUE constraints
    +    -    +  - Indexes
    +    -    +  - ENUM descriptions where applicable
    +    -    +- Schema-to-Phase traceability matrix (which table is built in which phase)
    +    -    +
    +    -    +Use PostgreSQL syntax. Be thorough Ôö£├ÂÔö£├ºÔö£├é every column the app needs must be defined.""",
    +    -    +
    +    -    +    "phases": """\
    +    -    +Generate a detailed phase breakdown document with 6-12 phases.
    +    -    +Each phase MUST include:
    +    -    +- Phase number and name (e.g. "Phase 0 Ôö£├ÂÔö£├ºÔö£├é Genesis")
    +    -    +- Objective (1-2 sentences)
    +    -    +- Deliverables (detailed bullet list of what gets built)
    +    -    +- Schema coverage (which tables/columns are created or modified)
    +    -    +- Exit criteria (bullet list of concrete, testable conditions)
    +    -    +
    +    -    +Phase 0 is always Genesis (project scaffold, config, tooling).
    +    -    +The final phase should be Ship & Deploy.
    +    -    +Phases should be ordered by dependency Ôö£├ÂÔö£├ºÔö£├é earlier phases provide foundations for later ones.""",
    +    -    +
    +    -    +    "ui": """\
    +    -    +Generate a UI/UX blueprint document. Include:
    +    -    +1) App Shell & Layout Ôö£├ÂÔö£├ºÔö£├é device priority, shell structure, navigation model
    +    -    +2) Screens/Views Ôö£├ÂÔö£├ºÔö£├é detailed spec for each page (what it shows, key interactions, empty states)
    +    -    +3) Component Inventory Ôö£├ÂÔö£├ºÔö£├é table of reusable components
    +    -    +4) Visual Style Ôö£├ÂÔö£├ºÔö£├é color palette, typography, visual density, tone
    +    -    +5) Interaction Patterns Ôö£├ÂÔö£├ºÔö£├é data loading, empty states, error states, confirmation dialogs, responsive behavior
    +    -    +6) User Flows Ôö£├ÂÔö£├ºÔö£├é 3-4 key user journeys described step by step
    +    -    +7) What This Is NOT Ôö£├ÂÔö£├ºÔö£├é explicit list of out-of-scope UI features
    +    -    +
    +    -    +Be specific about layout, data displayed, and interaction triggers.""",
    +    -    +
    +    -    +    "physics": """\
    +    -    +Generate an API physics specification in YAML format. Structure:
    +    -    +- info: title, version, description
    +    -    +- paths: every API endpoint with:
    +    -    +  - HTTP method (get/post/put/delete)
    +    -    +  - summary
    +    -    +  - auth requirement (none, token, github-token)
    +    -    +  - request body shape (if applicable)
    +    -    +  - response shape
    +    -    +  - query parameters (if applicable)
    +    -    +- schemas: Pydantic/data model definitions
    +    -    +
    +    -    +Use the custom Forge physics YAML format (NOT OpenAPI).
    +    -    +Group endpoints by resource with comments.
    +    -    +Every endpoint the app needs MUST be listed.""",
    +    -    +
    +    -    +    "boundaries": """\
    +    -    +Generate an architectural boundaries specification in JSON format. Structure:
    +    -    +{
    +    -    +  "description": "Layer boundary rules for <project_name>...",
    +    -    +  "layers": [
    +    -    +    {
    +    -    +      "name": "<layer_name>",
    +    -    +      "glob": "<file_glob_pattern>",
    +    -    +      "forbidden": [
    +    -    +        { "pattern": "<regex_or_import>", "reason": "<why forbidden>" }
    +    -    +      ]
    +    -    +    }
    +    -    +  ],
    +    -    +  "known_violations": []
    +    -    +}
    +    -     
    +    -    -    # Flatten all answer sections into the variables dict
    +    -    -    for section_name, section_data in answers.items():
    +    -    -        if isinstance(section_data, dict):
    +    -    -            for key, value in section_data.items():
    +    -    -                if isinstance(value, list):
    +    -    -                    variables[key] = "\n".join(f"- {v}" for v in value)
    +    -    -                else:
    +    -    -                    variables[key] = str(value)
    +    -    -        elif isinstance(section_data, str):
    +    -    -            variables[section_name] = section_data
    +    -    +Define 4-6 layers (e.g. routers, services, repos, clients, audit/engine).
    +    -    +Each layer has forbidden imports/patterns that enforce separation of concerns.
    +    -    +Output MUST be valid JSON.""",
    +    -     
    +    -    -    return variables
    +    -    +    "builder_directive": """\
    +    -    +Generate a builder directive Ôö£├ÂÔö£├ºÔö£├é the operational instructions for an AI builder.
    +    -    +Include:
    +    -    +- AEM status (enabled/disabled) and auto-authorize setting
    +    -    +- Step-by-step instructions (read contracts Ôö£├ÂÔö£├æÔö£├Ñ execute phases Ôö£├ÂÔö£├æÔö£├Ñ run audit Ôö£├ÂÔö£├æÔö£├Ñ commit)
    +    -    +- Autonomy rules (when to auto-commit, when to stop and ask)
    +    -    +- Phase list with phase numbers and names
    +    -    +- Project summary (one paragraph)
    +    -    +- boot_script flag
    +    -     
    +    -    +Keep it concise but complete Ôö£├ÂÔö£├ºÔö£├é this is the builder's startup instructions.""",
    +    -    +}
    +    -     
    +    -    -def _render_template(contract_type: str, variables: dict) -> str:
    +    -    -    """Render a contract template with the given variables.
    +    -     
    +    -    -    Uses safe substitution -- missing variables become empty strings.
    +    -    +async def _generate_contract_content(
    +    -    +    contract_type: str,
    +    -    +    project: dict,
    +    -    +    answers_text: str,
    +    -    +    api_key: str,
    +    -    +    model: str,
    +    -    +    provider: str,
    +    -    +) -> tuple[str, dict]:
    +    -    +    """Generate a single contract using the LLM.
    +    -    +
    +    -    +    Returns (content, usage) where usage has input_tokens / output_tokens.
    +    -         """
    +    -    -    template_file = TEMPLATES_DIR / f"{contract_type}.md"
    +    -    -    if contract_type == "physics":
    +    -    -        template_file = TEMPLATES_DIR / "physics.yaml"
    +    -    -    elif contract_type == "boundaries":
    +    -    -        template_file = TEMPLATES_DIR / "boundaries.json"
    +    -    -
    +    -    -    if not template_file.exists():
    +    -    -        return f"# {variables.get('project_name', 'Project')} Ôö£├ÂÔö£├ºÔö£├é {contract_type}\n\nTemplate not found."
    +    -    +    # Load the Forge example as a structural reference (if available)
    +    -    +    example = _load_forge_example(contract_type)
    +    -    +
    +    -    +    instructions = _CONTRACT_INSTRUCTIONS.get(contract_type, f"Generate a {contract_type} contract document.")
    +    -    +
    +    -    +    system_parts = [
    +    -    +        f"You are a Forge contract generator. You produce detailed, production-quality "
    +    -    +        f"project specification documents for the Forge autonomous build system.\n\n"
    +    -    +        f"You are generating the **{contract_type}** contract for the project "
    +    -    +        f'"{project["name"]}".\n\n'
    +    -    +        f"INSTRUCTIONS:\n{instructions}\n\n"
    +    -    +        f"RULES:\n"
    +    -    +        f"- Output ONLY the contract content. No preamble, no 'Here is...', no explanations.\n"
    +    -    +        f"- Be thorough and detailed. Each contract should be comprehensive enough that a "
    +    -    +        f"developer can build from it without asking questions.\n"
    +    -    +        f"- Use the project information provided to fill in ALL sections with real, "
    +    -    +        f"project-specific content.\n"
    +    -    +        f"- Do NOT leave any section empty or with placeholder text.\n"
    +    -    +        f"- Match the structural depth and detail level of the reference example.\n"
    +    -    +    ]
    +    -     
    +    -    -    raw = template_file.read_text(encoding="utf-8")
    +    -    +    if example:
    +    -    +        # Truncate very long examples to avoid hitting context limits
    +    -    +        if len(example) > 6000:
    +    -    +            example = example[:6000] + "\n\n... (truncated for brevity) ..."
    +    -    +        system_parts.append(
    +    -    +            f"\n--- STRUCTURAL REFERENCE (match this level of detail and format) ---\n"
    +    -    +            f"{example}\n"
    +    -    +            f"--- END REFERENCE ---\n"
    +    -    +        )
    +    -     
    +    -    -    # Safe substitution: replace {key} with value, leave unknown keys empty
    +    -    -    import re
    +    -    +    system_prompt = "\n".join(system_parts)
    +    -     
    +    -    -    def _replacer(match: re.Match) -> str:
    +    -    -        key = match.group(1)
    +    -    -        return variables.get(key, "")
    +    -    +    user_msg = (
    +    -    +        f"Generate the {contract_type} contract for this project.\n\n"
    +    -    +        f"--- PROJECT INFORMATION (from questionnaire) ---\n"
    +    -    +        f"{answers_text}\n"
    +    -    +        f"--- END PROJECT INFORMATION ---"
    +    -    +    )
    +    -     
    +    -    -    return re.sub(r"\{(\w+)\}", _replacer, raw)
    +    -    +    try:
    +    -    +        result = await llm_chat(
    +    -    +            api_key=api_key,
    +    -    +            model=model,
    +    -    +            system_prompt=system_prompt,
    +    -    +            messages=[{"role": "user", "content": user_msg}],
    +    -    +            provider=provider,
    +    -    +            max_tokens=16384,
    +    -    +        )
    +    -    +        usage = result.get("usage", {"input_tokens": 0, "output_tokens": 0})
    +    -    +        content = result["text"].strip()
    +    -    +        # Strip markdown code fences if the LLM wrapped the output
    +    -    +        if content.startswith("```"):
    +    -    +            lines = content.split("\n")
    +    -    +            # Remove first and last ``` lines
    +    -    +            if lines[0].startswith("```"):
    +    -    +                lines = lines[1:]
    +    -    +            if lines and lines[-1].strip() == "```":
    +    -    +                lines = lines[:-1]
    +    -    +            content = "\n".join(lines).strip()
    +    -    +        return content, usage
    +    -    +    except Exception as exc:
    +    -    +        logger.exception("LLM contract generation failed for %s: %s", contract_type, exc)
    +    -    +        # Fall back to a minimal template so the user at least gets something
    +    -    +        return (
    +    -    +            f"# {project['name']} Ôö£├ÂÔö£├ºÔö£├é {contract_type}\n\n"
    +    -    +            f"**Generation failed:** {exc}\n\n"
    +    -    +            f"Please regenerate this contract or edit it manually."
    +    -    +        ), {"input_tokens": 0, "output_tokens": 0}
    +    -    diff --git a/db/migrations/006_user_api_key.sql b/db/migrations/006_user_api_key.sql
    +    -    new file mode 100644
    +    -    index 0000000..13156c9
    +    -    --- /dev/null
    +    -    +++ b/db/migrations/006_user_api_key.sql
    +    -    @@ -0,0 +1,4 @@
    +    -    +-- Phase 12: BYOK Ôö£├ÂÔö£├ºÔö£Ôöñ user-supplied Anthropic API key for builds
    +    -    +-- Adds an encrypted API key column to the users table.
    +    -    +
    +    -    +ALTER TABLE users ADD COLUMN IF NOT EXISTS anthropic_api_key TEXT;
    +    -    diff --git a/tests/test_audit_service.py b/tests/test_audit_service.py
    +    -    index 0f0451e..94d6f01 100644
    +    -    --- a/tests/test_audit_service.py
    +    -    +++ b/tests/test_audit_service.py
    +    -    @@ -32,6 +32,7 @@ def _make_patches():
    +    -             "get_user_by_id": AsyncMock(return_value=MOCK_USER),
    +    -             "list_commits": AsyncMock(return_value=[]),
    +    -             "get_existing_commit_shas": AsyncMock(return_value=set()),
    +    -    +        "mark_stale_audit_runs": AsyncMock(return_value=0),
    +    -             "create_audit_run": AsyncMock(return_value={"id": UUID("aaaa1111-1111-1111-1111-111111111111")}),
    +    -             "update_audit_run": AsyncMock(),
    +    -             "get_commit_files": AsyncMock(return_value=["README.md"]),
    +    -    @@ -156,3 +157,54 @@ async def test_backfill_handles_commit_error_gracefully():
    +    -         # Both count as "synced" (processed) even if one errored
    +    -         assert result["synced"] == 2
    +    -         assert result["skipped"] == 0
    +    +    +    mock_get_pool.return_value = pool
    +         +
    +    +    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +         +
    +    -    +@pytest.mark.asyncio
    +    -    +async def test_backfill_cleans_stale_runs():
    +    -    +    """backfill_repo_commits calls mark_stale_audit_runs before processing."""
    +    -    +    mocks = _make_patches()
    +    -    +    mocks["list_commits"].return_value = []
    +    -    +    mocks["mark_stale_audit_runs"].return_value = 3
    +    -    +
    +    -    +    patches = _apply_patches(mocks)
    +    -    +    for p in patches:
    +    -    +        p.start()
    +    -    +    try:
    +    -    +        result = await backfill_repo_commits(REPO_ID, USER_ID)
    +    -    +    finally:
    +    -    +        for p in patches:
    +    -    +            p.stop()
    +    -    +
    +    -    +    mocks["mark_stale_audit_runs"].assert_called_once_with(REPO_ID)
    +    -    +    assert result["synced"] == 0
    +    -    +    assert result["skipped"] == 0
    +    +    +    assert len(files) == 2
    +    +    +    assert files[0]["path"] == "src/main.py"
    +    +    +    assert files[0]["language"] == "python"
    +    +    +    assert files[1]["path"] == "package.json"
    +         +
    +         +
    +         +@pytest.mark.asyncio
    +    -    +async def test_backfill_marks_error_on_cancel():
    +    -    +    """If backfill is cancelled mid-commit, the in-progress row is marked error."""
    +    -    +    import asyncio
    +    -    +
    +    -    +    mocks = _make_patches()
    +    -    +    mocks["list_commits"].return_value = [
    +    -    +        {"sha": "aaa111", "message": "first", "author": "Alice"},
    +    +    +@patch("app.repos.build_repo.get_pool")
    +    +    +async def test_get_build_file_logs_invalid_json(mock_get_pool):
    +    +    +    """get_build_file_logs skips invalid JSON messages."""
    +    +    +    pool = _fake_pool()
    +    +    +    pool.fetch.return_value = [
    +    +    +        {
    +    +    +            "message": "not valid json",
    +    +    +            "created_at": datetime.now(timezone.utc),
    +    +    +        },
    +         +    ]
    +    -    +    mocks["get_existing_commit_shas"].return_value = set()
    +    -    +    mocks["get_commit_files"].side_effect = asyncio.CancelledError()
    +    +    +    mock_get_pool.return_value = pool
    +         +
    +    -    +    patches = _apply_patches(mocks)
    +    -    +    for p in patches:
    +    -    +        p.start()
    +    -    +    try:
    +    -    +        with pytest.raises(asyncio.CancelledError):
    +    -    +            await backfill_repo_commits(REPO_ID, USER_ID)
    +    -    +    finally:
    +    -    +        for p in patches:
    +    -    +            p.stop()
    +    -    +
    +    -    +    # The audit run should have been marked as error before re-raising
    +    -    +    error_calls = [
    +    -    +        c for c in mocks["update_audit_run"].call_args_list
    +    -    +        if c.kwargs.get("status") == "error" or (c.args and len(c.args) > 1 and c.args[1] == "error")
    +    -    +    ]
    +    -    +    assert len(error_calls) >= 1
    +    -    diff --git a/tests/test_auth_router.py b/tests/test_auth_router.py
    +    -    index 4cd5836..9dc3526 100644
    +    -    --- a/tests/test_auth_router.py
    +    -    +++ b/tests/test_auth_router.py
    +    -    @@ -57,6 +57,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    +    -             "github_id": 12345,
    +    -             "github_login": "octocat",
    +    -             "avatar_url": "https://example.com/avatar.png",
    +    -    +        "anthropic_api_key": "sk-ant-test",
    +    -         }
    +    -     
    +    -         token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    -    @@ -68,6 +69,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    +    -         data = response.json()
    +    -         assert data["github_login"] == "octocat"
    +    -         assert data["id"] == "11111111-1111-1111-1111-111111111111"
    +    -    +    assert data["has_anthropic_key"] is True
    +    -     
    +    -     
    +    -     @patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    -    @@ -80,3 +82,57 @@ def test_auth_me_returns_401_when_user_not_found(mock_get_user):
    +    -             headers={"Authorization": f"Bearer {token}"},
    +    -         )
    +    -         assert response.status_code == 401
    +    +    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +         +
    +    +    +    assert len(files) == 0
    +         +
    +    -    +# ---------------------------------------------------------------------------
    +    -    +# Tests: API key management (BYOK)
    +    -    +# ---------------------------------------------------------------------------
    +         +
    +    -    +_USER_DICT = {
    +    -    +    "id": "11111111-1111-1111-1111-111111111111",
    +    -    +    "github_id": 12345,
    +    -    +    "github_login": "octocat",
    +    -    +    "avatar_url": "https://example.com/avatar.png",
    +    -    +    "anthropic_api_key": None,
    +    -    +}
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.repos.build_repo.get_pool")
    +    +    +async def test_get_build_file_logs_empty(mock_get_pool):
    +    +    +    """get_build_file_logs returns empty list when no file logs."""
    +    +    +    pool = _fake_pool()
    +    +    +    pool.fetch.return_value = []
    +    +    +    mock_get_pool.return_value = pool
    +         +
    +    +    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +         +
    +    -    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    +    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    -    +def test_save_api_key(mock_get_user, mock_set_key):
    +    -    +    mock_get_user.return_value = _USER_DICT
    +    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    -    +    response = client.put(
    +    -    +        "/auth/api-key",
    +    -    +        json={"api_key": "sk-ant-api03-test"},
    +    -    +        headers={"Authorization": f"Bearer {token}"},
    +    -    +    )
    +    -    +    assert response.status_code == 200
    +    -    +    assert response.json()["saved"] is True
    +    -    +    mock_set_key.assert_called_once()
    +    +    +    assert files == []
    +         +
    +         +
    +    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    -    +def test_save_api_key_empty_rejected(mock_get_user):
    +    -    +    mock_get_user.return_value = _USER_DICT
    +    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    -    +    response = client.put(
    +    -    +        "/auth/api-key",
    +    -    +        json={"api_key": "   "},
    +    -    +        headers={"Authorization": f"Bearer {token}"},
    +    -    +    )
    +    -    +    assert response.status_code == 400
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: create_build with target params
    +    +    +# ---------------------------------------------------------------------------
    +         +
    +         +
    +    -    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    +    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    -    +def test_remove_api_key(mock_get_user, mock_set_key):
    +    -    +    mock_get_user.return_value = _USER_DICT
    +    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    +    -    +    response = client.delete(
    +    -    +        "/auth/api-key",
    +    -    +        headers={"Authorization": f"Bearer {token}"},
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.repos.build_repo.get_pool")
    +    +    +async def test_create_build_with_target(mock_get_pool):
    +    +    +    """create_build passes target params to the query."""
    +    +    +    pool = _fake_pool()
    +    +    +    row = _build_row()
    +    +    +    pool.fetchrow.return_value = row
    +    +    +    mock_get_pool.return_value = pool
    +    +    +
    +    +    +    result = await build_repo.create_build(
    +    +    +        row["project_id"],
    +    +    +        target_type="local_path",
    +    +    +        target_ref="/tmp/test",
    +    +    +        working_dir="/tmp/test",
    +         +    )
    +    -    +    assert response.status_code == 200
    +    -    +    assert response.json()["removed"] is True
    +    -    +    mock_set_key.assert_called_once()
    +    +    +
    +    +    +    pool.fetchrow.assert_called_once()
    +    +    +    assert result["project_id"] == row["project_id"]
    +         diff --git a/tests/test_build_service.py b/tests/test_build_service.py
    +    -    index 1c7792e..9861a64 100644
    +    +    index 2ea1cc9..61ebf81 100644
    +         --- a/tests/test_build_service.py
    +         +++ b/tests/test_build_service.py
    +    -    @@ -63,7 +63,8 @@ def _build(**overrides):
    +    -     @patch("app.services.build_service.asyncio.create_task")
    +    -     @patch("app.services.build_service.project_repo")
    +    -     @patch("app.services.build_service.build_repo")
    +    -    -async def test_start_build_success(mock_build_repo, mock_project_repo, mock_create_task):
    +    -    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    -    +async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    -         """start_build creates a build record and spawns a background task."""
    +    -         mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    -         mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    -    @@ -71,6 +72,7 @@ async def test_start_build_success(mock_build_repo, mock_project_repo, mock_crea
    +    -         mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    -         mock_build_repo.create_build = AsyncMock(return_value=_build())
    +    -         mock_create_task.return_value = MagicMock()
    +    -    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    +    -     
    +    +    @@ -77,7 +77,12 @@ async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_
    +              result = await build_service.start_build(_PROJECT_ID, _USER_ID)
    +          
    +    -    @@ -133,6 +135,21 @@ async def test_start_build_already_running(mock_build_repo, mock_project_repo):
    +    -             await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    -     
    +    -     
    +    -    +@pytest.mark.asyncio
    +    -    +@patch("app.services.build_service.project_repo")
    +    -    +@patch("app.services.build_service.build_repo")
    +    -    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    -    +async def test_start_build_no_api_key(mock_get_user, mock_build_repo, mock_project_repo):
    +    -    +    """start_build raises ValueError when user has no Anthropic API key."""
    +    -    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    -    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    -    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    -    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": None}
    +    +         assert result["status"] == "pending"
    +    +    -    mock_build_repo.create_build.assert_called_once_with(_PROJECT_ID)
    +    +    +    mock_build_repo.create_build.assert_called_once_with(
    +    +    +        _PROJECT_ID,
    +    +    +        target_type=None,
    +    +    +        target_ref=None,
    +    +    +        working_dir=None,
    +    +    +    )
    +    +         mock_project_repo.update_project_status.assert_called_once_with(
    +    +             _PROJECT_ID, "building"
    +    +         )
    +    +    @@ -484,3 +489,318 @@ def test_get_token_rates_model_aware():
    +    +         unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
    +    +         assert unk_in == Decimal("0.000015")
    +    +         assert unk_out == Decimal("0.000075")
    +         +
    +    -    +    with pytest.raises(ValueError, match="API key required"):
    +    -    +        await build_service.start_build(_PROJECT_ID, _USER_ID)
    +         +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: _detect_language
    +    +    +# ---------------------------------------------------------------------------
    +         +
    +    -     # ---------------------------------------------------------------------------
    +    -     # Tests: cancel_build
    +    -     # ---------------------------------------------------------------------------
    +    -    @@ -431,3 +448,21 @@ async def test_record_phase_cost(mock_build_repo):
    +    -         mock_build_repo.record_build_cost.assert_called_once()
    +    -         assert usage.input_tokens == 0
    +    -         assert usage.output_tokens == 0
    +    -    +
    +    -    +
    +    -    +def test_get_token_rates_model_aware():
    +    -    +    """_get_token_rates returns correct pricing per model family."""
    +    -    +    from decimal import Decimal
    +    -    +
    +    -    +    opus_in, opus_out = build_service._get_token_rates("claude-opus-4-6")
    +    -    +    assert opus_in == Decimal("0.000015")
    +    -    +    assert opus_out == Decimal("0.000075")
    +    -    +
    +    -    +    haiku_in, haiku_out = build_service._get_token_rates("claude-haiku-4-5-20251001")
    +    -    +    assert haiku_in == Decimal("0.000001")
    +    -    +    assert haiku_out == Decimal("0.000005")
    +    -    +
    +    -    +    # Unknown model falls back to Opus (safest = most expensive)
    +    -    +    unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
    +    -    +    assert unk_in == Decimal("0.000015")
    +    -    +    assert unk_out == Decimal("0.000075")
    +    -    diff --git a/tests/test_llm_client.py b/tests/test_llm_client.py
    +    -    index c7c4f8e..4f323a2 100644
    +    -    --- a/tests/test_llm_client.py
    +    -    +++ b/tests/test_llm_client.py
    +    -    @@ -34,6 +34,7 @@ async def test_chat_success(mock_client_cls):
    +    -             "content": [{"type": "text", "text": "Hello from Haiku!"}],
    +    -             "model": "claude-3-5-haiku-20241022",
    +    -             "role": "assistant",
    +    -    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    -         })
    +    -         mock_client_cls.return_value = mock_client
    +    -     
    +    -    @@ -44,7 +45,9 @@ async def test_chat_success(mock_client_cls):
    +    -             messages=[{"role": "user", "content": "Hi"}],
    +    -         )
    +    -     
    +    -    -    assert result == "Hello from Haiku!"
    +    -    +    assert result["text"] == "Hello from Haiku!"
    +    -    +    assert result["usage"]["input_tokens"] == 10
    +    -    +    assert result["usage"]["output_tokens"] == 20
    +    -         mock_client.post.assert_called_once()
    +    -         call_kwargs = mock_client.post.call_args
    +    -         body = call_kwargs.kwargs["json"] if "json" in call_kwargs.kwargs else call_kwargs[1]["json"]
    +    -    @@ -141,6 +144,7 @@ async def test_chat_openai_success(mock_client_cls):
    +    -         """Successful OpenAI chat returns message content."""
    +    -         mock_client = _make_mock_client({
    +    -             "choices": [{"message": {"role": "assistant", "content": "Hello from GPT!"}}],
    +    -    +        "usage": {"prompt_tokens": 5, "completion_tokens": 15},
    +    -         })
    +    -         mock_client_cls.return_value = mock_client
    +    -     
    +    -    @@ -151,7 +155,9 @@ async def test_chat_openai_success(mock_client_cls):
    +    -             messages=[{"role": "user", "content": "Hi"}],
    +    -         )
    +    -     
    +    -    -    assert result == "Hello from GPT!"
    +    -    +    assert result["text"] == "Hello from GPT!"
    +    -    +    assert result["usage"]["input_tokens"] == 5
    +    -    +    assert result["usage"]["output_tokens"] == 15
    +    -         call_kwargs = mock_client.post.call_args
    +    -         body = call_kwargs.kwargs.get("json", call_kwargs[1].get("json", {}))
    +    -         assert body["model"] == "gpt-4o"
    +    -    @@ -226,6 +232,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    +    -         """chat(provider='openai') routes to OpenAI endpoint."""
    +    -         mock_client = _make_mock_client({
    +    -             "choices": [{"message": {"role": "assistant", "content": "dispatched"}}],
    +    -    +        "usage": {"prompt_tokens": 0, "completion_tokens": 0},
    +    -         })
    +    -         mock_client_cls.return_value = mock_client
    +    -     
    +    -    @@ -237,7 +244,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    +    -             provider="openai",
    +    -         )
    +    -     
    +    -    -    assert result == "dispatched"
    +    -    +    assert result["text"] == "dispatched"
    +    -         call_kwargs = mock_client.post.call_args
    +    -         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    +    -         assert "openai.com" in url
    +    -    @@ -249,6 +256,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    +    -         """chat() defaults to Anthropic."""
    +    -         mock_client = _make_mock_client({
    +    -             "content": [{"type": "text", "text": "default"}],
    +    -    +        "usage": {"input_tokens": 0, "output_tokens": 0},
    +    -         })
    +    -         mock_client_cls.return_value = mock_client
    +    -     
    +    -    @@ -259,7 +267,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    +    -             messages=[{"role": "user", "content": "Hi"}],
    +    -         )
    +    -     
    +    -    -    assert result == "default"
    +    -    +    assert result["text"] == "default"
    +    -         call_kwargs = mock_client.post.call_args
    +    -         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    +    -         assert "anthropic.com" in url
    +    -    diff --git a/tests/test_project_service.py b/tests/test_project_service.py
    +    -    index 1957ba3..1b410b3 100644
    +    -    --- a/tests/test_project_service.py
    +    -    +++ b/tests/test_project_service.py
    +    -    @@ -191,17 +191,22 @@ async def test_process_questionnaire_first_message(
    +    -             "status": "draft",
    +    -             "questionnaire_state": {},
    +    -         }
    +    -    -    mock_llm.return_value = json.dumps({
    +    -    -        "reply": "Tell me about your product.",
    +    -    -        "section": "product_intent",
    +    -    -        "section_complete": False,
    +    -    -        "extracted_data": None,
    +    -    -    })
    +    -    +    mock_llm.return_value = {
    +    -    +        "text": json.dumps({
    +    -    +            "reply": "Tell me about your product.",
    +    -    +            "section": "product_intent",
    +    -    +            "section_complete": False,
    +    -    +            "extracted_data": None,
    +    -    +        }),
    +    -    +        "usage": {"input_tokens": 50, "output_tokens": 30},
    +    -    +    }
    +    -     
    +    -         result = await process_questionnaire_message(USER_ID, PROJECT_ID, "Hi")
    +    -     
    +    -         assert result["reply"] == "Tell me about your product."
    +    -         assert result["is_complete"] is False
    +    -    +    assert result["token_usage"]["input_tokens"] == 50
    +    -    +    assert result["token_usage"]["output_tokens"] == 30
    +    -         mock_status.assert_called_once()  # draft -> questionnaire
    +    -     
    +    -     
    +    -    @@ -255,10 +260,11 @@ async def test_process_questionnaire_already_complete(mock_project):
    +    -     
    +    -     
    +    -     @pytest.mark.asyncio
    +    -    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    +    -     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    +    -     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    +    -     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    +    -    -async def test_generate_contracts_success(mock_project, mock_upsert, mock_status):
    +    -    +async def test_generate_contracts_success(mock_project, mock_upsert, mock_status, mock_ws):
    +    -         mock_project.return_value = {
    +    -             "id": PROJECT_ID,
    +    -             "user_id": USER_ID,
    +    -    diff --git a/tests/test_projects_router.py b/tests/test_projects_router.py
    +    -    index 862c16d..dc7c5ff 100644
    +    -    --- a/tests/test_projects_router.py
    +    -    +++ b/tests/test_projects_router.py
    +    -    @@ -21,7 +21,7 @@ def _set_test_config(monkeypatch):
    +    -         monkeypatch.setattr("app.config.settings.APP_URL", "http://localhost:8000")
    +    -         monkeypatch.setattr("app.config.settings.GITHUB_WEBHOOK_SECRET", "whsec_test")
    +    -         monkeypatch.setattr("app.config.settings.ANTHROPIC_API_KEY", "test-api-key")
    +    -    -    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022")
    +    -    +    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5")
    +    -     
    +    -     
    +    -     USER_ID = "22222222-2222-2222-2222-222222222222"
    +    -    @@ -248,7 +248,10 @@ def test_questionnaire_message(
    +    -             "status": "draft",
    +    -             "questionnaire_state": {},
    +    -         }
    +    -    -    mock_llm.return_value = '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}'
    +    -    +    mock_llm.return_value = {
    +    -    +        "text": '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}',
    +    -    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    -    +    }
    +    -     
    +    -         resp = client.post(
    +    -             f"/projects/{PROJECT_ID}/questionnaire",
    +    -    @@ -332,8 +335,9 @@ def test_generate_contracts_incomplete(mock_project, mock_get_user):
    +    -     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    +    -     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    +    -     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    +    -    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    +    -     def test_generate_contracts_success(
    +    -    -    mock_status, mock_upsert, mock_project, mock_get_user
    +    -    +    mock_ws, mock_status, mock_upsert, mock_project, mock_get_user
    +    -     ):
    +    -         mock_get_user.return_value = MOCK_USER
    +    -         all_sections = [
    +    -    diff --git a/web/src/App.tsx b/web/src/App.tsx
    +    -    index 7a6f811..8eadcd4 100644
    +    -    --- a/web/src/App.tsx
    +    -    +++ b/web/src/App.tsx
    +    -    @@ -7,6 +7,7 @@ import AuditDetailPage from './pages/AuditDetail';
    +    -     import ProjectDetail from './pages/ProjectDetail';
    +    -     import BuildProgress from './pages/BuildProgress';
    +    -     import BuildComplete from './pages/BuildComplete';
    +    -    +import Settings from './pages/Settings';
    +    -     import { AuthProvider, useAuth } from './context/AuthContext';
    +    -     import { ToastProvider } from './context/ToastContext';
    +    -     
    +    -    @@ -72,6 +73,14 @@ function App() {
    +    -                     </ProtectedRoute>
    +    -                   }
    +    -                 />
    +    -    +            <Route
    +    -    +              path="/settings"
    +    -    +              element={
    +    -    +                <ProtectedRoute>
    +    -    +                  <Settings />
    +    -    +                </ProtectedRoute>
    +    -    +              }
    +    -    +            />
    +    -                 <Route path="*" element={<Navigate to="/" replace />} />
    +    -               </Routes>
    +    -             </BrowserRouter>
    +    -    diff --git a/web/src/__tests__/App.test.tsx b/web/src/__tests__/App.test.tsx
    +    -    index 7678f4e..0d8a335 100644
    +    -    --- a/web/src/__tests__/App.test.tsx
    +    -    +++ b/web/src/__tests__/App.test.tsx
    +    -    @@ -298,7 +298,7 @@ describe('QuestionnaireModal', () => {
    +    -         expect(onClose).toHaveBeenCalled();
    +    -       });
    +    -     
    +    -    -  it('has a voice toggle button', () => {
    +    -    +  it('has a restart button', () => {
    +    -         render(
    +    -           <QuestionnaireModal
    +    -             projectId="test-id"
    +    -    @@ -307,7 +307,7 @@ describe('QuestionnaireModal', () => {
    +    -             onContractsGenerated={() => {}}
    +    -           />,
    +    -         );
    +    -    -    expect(screen.getByTestId('voice-toggle')).toBeInTheDocument();
    +    -    +    expect(screen.getByTestId('restart-btn')).toBeInTheDocument();
    +    -       });
    +    -     
    +    -       it('shows generate banner when questionnaire is complete', async () => {
    +    -    diff --git a/web/src/__tests__/Build.test.tsx b/web/src/__tests__/Build.test.tsx
    +    -    index daae829..ecfc67f 100644
    +    -    --- a/web/src/__tests__/Build.test.tsx
    +    -    +++ b/web/src/__tests__/Build.test.tsx
    +    -    @@ -162,7 +162,7 @@ describe('ProjectCard', () => {
    +    -     // Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º BuildComplete Ôö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├ºÔö£├ÂÔö£├éÔö£├º
    +    -     
    +    -     vi.mock('../context/AuthContext', () => ({
    +    -    -  useAuth: () => ({ token: 'test-token' }),
    +    -    +  useAuth: () => ({ token: 'test-token', loading: false, authFetch: globalThis.fetch }),
    +    -       AuthProvider: ({ children }: { children: unknown }) => children,
    +    -     }));
    +    -     
    +    -    diff --git a/web/src/components/AppShell.tsx b/web/src/components/AppShell.tsx
    +    -    index 47a1098..b8f1f3c 100644
    +    -    --- a/web/src/components/AppShell.tsx
    +    -    +++ b/web/src/components/AppShell.tsx
    +    -    @@ -103,7 +103,6 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    +    -                   style={{ width: 28, height: 28, borderRadius: '50%' }}
    +    -                 />
    +    -               )}
    +    -    -          <span style={{ color: '#94A3B8', fontSize: '0.85rem' }}>{user?.github_login}</span>
    +    -               <button
    +    -                 onClick={logout}
    +    -                 style={{
    +    -    @@ -192,11 +191,50 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    +    -                     marginTop: 'auto',
    +    -                     padding: '12px 16px',
    +    -                     borderTop: '1px solid #1E293B',
    +    -    -                color: '#64748B',
    +    -    -                fontSize: '0.7rem',
    +    -    +                display: 'flex',
    +    -    +                alignItems: 'center',
    +    -    +                justifyContent: 'space-between',
    +    -                   }}
    +    -                 >
    +    -    -              v0.1.0
    +    -    +              <div
    +    -    +                onClick={() => navigate('/settings')}
    +    -    +                style={{
    +    -    +                  display: 'flex',
    +    -    +                  alignItems: 'center',
    +    -    +                  gap: '8px',
    +    -    +                  cursor: 'pointer',
    +    -    +                  flex: 1,
    +    -    +                  minWidth: 0,
    +    -    +                }}
    +    -    +                title={user?.github_login ?? 'Settings'}
    +    -    +              >
    +    -    +                {user?.avatar_url && (
    +    -    +                  <img
    +    -    +                    src={user.avatar_url}
    +    -    +                    alt={user.github_login}
    +    -    +                    style={{ width: 22, height: 22, borderRadius: '50%', flexShrink: 0 }}
    +    -    +                  />
    +    -    +                )}
    +    -    +                <span style={{ color: '#CBD5E1', fontSize: '0.75rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    +    -    +                  {user?.github_login}
    +    -    +                </span>
    +    -    +              </div>
    +    -    +              <button
    +    -    +                onClick={() => navigate('/settings')}
    +    -    +                title="Settings"
    +    -    +                style={{
    +    -    +                  background: 'transparent',
    +    -    +                  border: 'none',
    +    -    +                  color: '#64748B',
    +    -    +                  cursor: 'pointer',
    +    -    +                  fontSize: '0.95rem',
    +    -    +                  padding: '4px',
    +    -    +                  flexShrink: 0,
    +    -    +                  lineHeight: 1,
    +    -    +                }}
    +    -    +              >
    +    -    +                Ôö£├ÂÔö£┬úÔö£├╗
    +    -    +              </button>
    +    -                 </div>
    +    -               </aside>
    +    -             )}
    +    -    diff --git a/web/src/components/ContractProgress.tsx b/web/src/components/ContractProgress.tsx
    +    -    new file mode 100644
    +    -    index 0000000..821fec7
    +    -    --- /dev/null
    +    -    +++ b/web/src/components/ContractProgress.tsx
    +    -    @@ -0,0 +1,294 @@
    +    -    +/**
    +    -    + * ContractProgress -- live step-by-step contract generation progress panel.
    +    -    + *
    +    -    + * Shows each contract being generated with status indicators, a running log,
    +    -    + * context window meter, and cumulative token usage from the questionnaire.
    +    -    + */
    +    -    +import { useState, useEffect, useRef, useCallback } from 'react';
    +    -    +import { useAuth } from '../context/AuthContext';
    +    -    +import { useWebSocket } from '../hooks/useWebSocket';
    +    -    +
    +    -    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    -    +
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Contract type labels                                              */
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +
    +    -    +const CONTRACT_LABELS: Record<string, string> = {
    +    -    +  blueprint: 'Blueprint',
    +    -    +  manifesto: 'Manifesto',
    +    -    +  stack: 'Stack',
    +    -    +  schema: 'Schema',
    +    -    +  physics: 'Physics',
    +    -    +  boundaries: 'Boundaries',
    +    -    +  phases: 'Phases',
    +    -    +  ui: 'UI',
    +    -    +  builder_contract: 'Builder Contract',
    +    -    +  builder_directive: 'Builder Directive',
    +    -    +};
    +         +
    +    -    +const ALL_CONTRACTS = Object.keys(CONTRACT_LABELS);
    +    +    +def test_detect_language_python():
    +    +    +    assert build_service._detect_language("src/main.py") == "python"
    +         +
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Context window constants                                          */
    +    -    +/* ------------------------------------------------------------------ */
    +         +
    +    -    +const MODEL_CONTEXT_WINDOWS: Record<string, number> = {
    +    -    +  'claude-haiku-4-5': 200_000,
    +    -    +  'claude-sonnet-4-5': 200_000,
    +    -    +  'claude-opus-4-6': 200_000,
    +    -    +  'gpt-4o': 128_000,
    +    -    +};
    +    -    +const DEFAULT_CONTEXT_WINDOW = 200_000;
    +    +    +def test_detect_language_typescript():
    +    +    +    assert build_service._detect_language("src/App.tsx") == "typescriptreact"
    +         +
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Types                                                             */
    +    -    +/* ------------------------------------------------------------------ */
    +         +
    +    -    +interface TokenUsage {
    +    -    +  input_tokens: number;
    +    -    +  output_tokens: number;
    +    -    +}
    +    +    +def test_detect_language_json():
    +    +    +    assert build_service._detect_language("package.json") == "json"
    +         +
    +    -    +type ContractStatus = 'pending' | 'generating' | 'done';
    +         +
    +    -    +interface LogEntry {
    +    -    +  time: string;
    +    -    +  message: string;
    +    -    +}
    +    +    +def test_detect_language_unknown():
    +    +    +    assert build_service._detect_language("data.xyz") == "plaintext"
    +         +
    +    -    +interface Props {
    +    -    +  projectId: string;
    +    -    +  tokenUsage: TokenUsage;
    +    -    +  model: string;
    +    -    +  onComplete: () => void;
    +    -    +}
    +         +
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Styles                                                            */
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +
    +    -    +const panelStyle: React.CSSProperties = {
    +    -    +  display: 'flex',
    +    -    +  flexDirection: 'column',
    +    -    +  gap: '12px',
    +    -    +  padding: '16px 20px',
    +    -    +  flex: 1,
    +    -    +  overflowY: 'auto',
    +    -    +};
    +    +    +def test_detect_language_dotenv():
    +    +    +    assert build_service._detect_language(".env") == "dotenv"
    +         +
    +    -    +const stepRowStyle: React.CSSProperties = {
    +    -    +  display: 'flex',
    +    -    +  alignItems: 'center',
    +    -    +  gap: '10px',
    +    -    +  fontSize: '0.82rem',
    +    -    +  padding: '6px 0',
    +    -    +  borderBottom: '1px solid #1E293B',
    +    -    +};
    +         +
    +    -    +const logPanelStyle: React.CSSProperties = {
    +    -    +  background: '#0F172A',
    +    -    +  borderRadius: '6px',
    +    -    +  padding: '10px 12px',
    +    -    +  fontFamily: 'monospace',
    +    -    +  fontSize: '0.72rem',
    +    -    +  color: '#94A3B8',
    +    -    +  maxHeight: '120px',
    +    -    +  overflowY: 'auto',
    +    -    +  lineHeight: '1.6',
    +    -    +};
    +    +    +def test_detect_language_gitignore():
    +    +    +    assert build_service._detect_language(".gitignore") == "ignore"
    +         +
    +    -    +const meterBarOuter: React.CSSProperties = {
    +    -    +  flex: 1,
    +    -    +  height: '8px',
    +    -    +  background: '#1E293B',
    +    -    +  borderRadius: '4px',
    +    -    +  overflow: 'hidden',
    +    -    +};
    +         +
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Component                                                         */
    +    -    +/* ------------------------------------------------------------------ */
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: _parse_file_blocks
    +    +    +# ---------------------------------------------------------------------------
    +         +
    +    -    +export default function ContractProgress({ projectId, tokenUsage, model, onComplete }: Props) {
    +    -    +  const { token } = useAuth();
    +    -    +  const [statuses, setStatuses] = useState<Record<string, ContractStatus>>(() =>
    +    -    +    Object.fromEntries(ALL_CONTRACTS.map((c) => [c, 'pending' as const])),
    +    -    +  );
    +    -    +  const [log, setLog] = useState<LogEntry[]>([]);
    +    -    +  const [generating, setGenerating] = useState(false);
    +    -    +  const [allDone, setAllDone] = useState(false);
    +    -    +  const logEndRef = useRef<HTMLDivElement>(null);
    +    -    +  const startedRef = useRef(false);
    +    -    +
    +    -    +  const addLog = useCallback((msg: string) => {
    +    -    +    const now = new Date();
    +    -    +    const time = now.toLocaleTimeString('en-GB', { hour12: false });
    +    -    +    setLog((prev) => [...prev, { time, message: msg }]);
    +    -    +  }, []);
    +    -    +
    +    -    +  /* Auto-scroll log */
    +    -    +  useEffect(() => {
    +    -    +    logEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    +    -    +  }, [log]);
    +    -    +
    +    -    +  /* Handle WS progress messages */
    +    -    +  useWebSocket(
    +    -    +    useCallback(
    +    -    +      (data: { type: string; payload: any }) => {
    +    -    +        if (data.type !== 'contract_progress') return;
    +    -    +        const p = data.payload;
    +    -    +        if (p.project_id !== projectId) return;
    +    -    +
    +    -    +        const label = CONTRACT_LABELS[p.contract_type] ?? p.contract_type;
    +    -    +        if (p.status === 'generating') {
    +    -    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'generating' }));
    +    -    +          addLog(`Generating ${label}...`);
    +    -    +        } else if (p.status === 'done') {
    +    -    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'done' }));
    +    -    +          addLog(`Ôö£├ÂÔö¼├║Ôö£Ôöñ ${label} complete`);
    +    -    +
    +    -    +          /* Check if all done */
    +    -    +          setStatuses((prev) => {
    +    -    +            const values = Object.values(prev);
    +    -    +            if (values.every((s) => s === 'done')) {
    +    -    +              setAllDone(true);
    +    -    +              addLog('All contracts generated successfully.');
    +    -    +            }
    +    -    +            return prev;
    +    -    +          });
    +    -    +        }
    +    -    +      },
    +    -    +      [projectId, addLog],
    +    -    +    ),
    +    -    +  );
    +         +
    +    -    +  /* Kick off generation on mount */
    +    -    +  useEffect(() => {
    +    -    +    if (startedRef.current) return;
    +    -    +    startedRef.current = true;
    +    -    +    setGenerating(true);
    +    -    +    addLog('Starting contract generation...');
    +    -    +
    +    -    +    fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    -    +      method: 'POST',
    +    -    +      headers: { Authorization: `Bearer ${token}` },
    +    -    +    })
    +    -    +      .then((res) => {
    +    -    +        if (!res.ok) throw new Error('Generation failed');
    +    -    +        /* Mark any remaining as done (safety net) */
    +    -    +        setStatuses((prev) => {
    +    -    +          const updated = { ...prev };
    +    -    +          for (const key of ALL_CONTRACTS) {
    +    -    +            if (updated[key] !== 'done') updated[key] = 'done';
    +    -    +          }
    +    -    +          return updated;
    +    -    +        });
    +    -    +        setAllDone(true);
    +    -    +        setGenerating(false);
    +    -    +      })
    +    -    +      .catch(() => {
    +    -    +        addLog('Ôö£├ÂÔö¼├║Ôö£Ôòú Contract generation failed');
    +    -    +        setGenerating(false);
    +    -    +      });
    +    -    +  }, [projectId, token, addLog]);
    +    -    +
    +    -    +  /* Derived values */
    +    -    +  const contextWindow = MODEL_CONTEXT_WINDOWS[model] ?? DEFAULT_CONTEXT_WINDOW;
    +    -    +  const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    -    +  const ctxPercent = Math.min(100, (totalTokens / contextWindow) * 100);
    +    -    +  const doneCount = Object.values(statuses).filter((s) => s === 'done').length;
    +    -    +
    +    -    +  /* Color for context bar */
    +    -    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    +    +    +def test_parse_file_blocks_single():
    +    +    +    """Single file block parsed correctly."""
    +    +    +    text = """Some preamble text
    +    +    +=== FILE: src/main.py ===
    +    +    +print("hello")
    +    +    +=== END FILE ===
    +    +    +Some trailing text"""
         +    +
    -    +    +    mocks["mark_stale_audit_runs"].assert_called_once_with(REPO_ID)
    -    +    +    assert result["synced"] == 0
    -    +    +    assert result["skipped"] == 0
    +    +    +    blocks = build_service._parse_file_blocks(text)
    +    +    +    assert len(blocks) == 1
    +    +    +    assert blocks[0]["path"] == "src/main.py"
    +    +    +    assert 'print("hello")' in blocks[0]["content"]
         +    +
         +    +
    -    +    +@pytest.mark.asyncio
    -    +    +async def test_backfill_marks_error_on_cancel():
    -    +    +    """If backfill is cancelled mid-commit, the in-progress row is marked error."""
    -    +    +    import asyncio
    +    +    +def test_parse_file_blocks_multiple():
    +    +    +    """Multiple consecutive file blocks parsed."""
    +    +    +    text = """
    +    +    +=== FILE: file1.py ===
    +    +    +content1
    +    +    +=== END FILE ===
    +    +    +=== FILE: file2.ts ===
    +    +    +content2
    +    +    +=== END FILE ===
    +    +    +"""
    +    +    +    blocks = build_service._parse_file_blocks(text)
    +    +    +    assert len(blocks) == 2
    +    +    +    assert blocks[0]["path"] == "file1.py"
    +    +    +    assert blocks[1]["path"] == "file2.ts"
    +    +    +    assert "content1" in blocks[0]["content"]
    +    +    +    assert "content2" in blocks[1]["content"]
         +    +
    -    +    +    mocks = _make_patches()
    -    +    +    mocks["list_commits"].return_value = [
    -    +    +        {"sha": "aaa111", "message": "first", "author": "Alice"},
    -    +    +    ]
    -    +    +    mocks["get_existing_commit_shas"].return_value = set()
    -    +    +    mocks["get_commit_files"].side_effect = asyncio.CancelledError()
         +    +
    -    +    +    patches = _apply_patches(mocks)
    -    +    +    for p in patches:
    -    +    +        p.start()
    -    +    +    try:
    -    +    +        with pytest.raises(asyncio.CancelledError):
    -    +    +            await backfill_repo_commits(REPO_ID, USER_ID)
    -    +    +    finally:
    -    +    +        for p in patches:
    -    +    +            p.stop()
    -    +    +
    -    +    +    # The audit run should have been marked as error before re-raising
    -    +    +    error_calls = [
    -    +    +        c for c in mocks["update_audit_run"].call_args_list
    -    +    +        if c.kwargs.get("status") == "error" or (c.args and len(c.args) > 1 and c.args[1] == "error")
    -    +    +    ]
    -    +    +    assert len(error_calls) >= 1
    -    +    diff --git a/tests/test_auth_router.py b/tests/test_auth_router.py
    -    +    index 4cd5836..9dc3526 100644
    -    +    --- a/tests/test_auth_router.py
    -    +    +++ b/tests/test_auth_router.py
    -    +    @@ -57,6 +57,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    -    +             "github_id": 12345,
    -    +             "github_login": "octocat",
    -    +             "avatar_url": "https://example.com/avatar.png",
    -    +    +        "anthropic_api_key": "sk-ant-test",
    -    +         }
    -    +     
    -    +         token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    -    +    @@ -68,6 +69,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    -    +         data = response.json()
    -    +         assert data["github_login"] == "octocat"
    -    +         assert data["id"] == "11111111-1111-1111-1111-111111111111"
    -    +    +    assert data["has_anthropic_key"] is True
    -    +     
    -    +     
    -    +     @patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    -    +    @@ -80,3 +82,57 @@ def test_auth_me_returns_401_when_user_not_found(mock_get_user):
    -    +             headers={"Authorization": f"Bearer {token}"},
    -    +         )
    -    +         assert response.status_code == 401
    +    +    +def test_parse_file_blocks_with_code_fence():
    +    +    +    """File block wrapped in code fence gets fence stripped."""
    +    +    +    text = """=== FILE: test.py ===
    +    +    +```python
    +    +    +def hello():
    +    +    +    pass
    +    +    +```
    +    +    +=== END FILE ==="""
    +    +    +
    +    +    +    blocks = build_service._parse_file_blocks(text)
    +    +    +    assert len(blocks) == 1
    +    +    +    assert "def hello" in blocks[0]["content"]
    +    +    +    assert "```" not in blocks[0]["content"]
         +    +
         +    +
    +    +    +def test_parse_file_blocks_no_end_marker():
    +    +    +    """Missing END FILE marker Ôö£├ÂÔö£├ºÔö£├é block is skipped."""
    +    +    +    text = """=== FILE: orphan.py ===
    +    +    +some content without end marker
    +    +    +"""
    +    +    +    blocks = build_service._parse_file_blocks(text)
    +    +    +    assert len(blocks) == 0
    +    +    +
    +    +    +
    +    +    +def test_parse_file_blocks_empty_input():
    +    +    +    """Empty string returns empty list."""
    +    +    +    assert build_service._parse_file_blocks("") == []
    +         +
    +    -    +  return (
    +    -    +    <div style={panelStyle} data-testid="contract-progress">
    +    -    +      {/* Header */}
    +    -    +      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
    +    -    +        <h4 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    -    +          {allDone ? 'Ôö£├ÂÔö¼├║Ôö£Ôöñ Contracts Ready' : `Generating ContractsÔö£├ÂÔö£├ºÔö¼┬¼ (${doneCount}/${ALL_CONTRACTS.length})`}
    +    -    +        </h4>
    +    -    +      </div>
    +         +
    +    -    +      {/* Context window meter */}
    +    -    +      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    +    -    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.7rem', color: '#94A3B8' }}>
    +    -    +          <span>Context Window ({model})</span>
    +    -    +          <span>
    +    -    +            {totalTokens.toLocaleString()} / {contextWindow.toLocaleString()} tokens ({ctxPercent.toFixed(1)}%)
    +    -    +          </span>
    +    -    +        </div>
    +    -    +        <div style={meterBarOuter}>
    +    -    +          <div
    +    -    +            style={{
    +    -    +              width: `${ctxPercent}%`,
    +    -    +              height: '100%',
    +    -    +              background: ctxColor,
    +    -    +              borderRadius: '4px',
    +    -    +              transition: 'width 0.4s ease',
    +    -    +            }}
    +    -    +          />
    +    -    +        </div>
    +    -    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#64748B' }}>
    +    -    +          <span>Input: {tokenUsage.input_tokens.toLocaleString()}</span>
    +    -    +          <span>Output: {tokenUsage.output_tokens.toLocaleString()}</span>
    +    -    +        </div>
    +    -    +      </div>
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: _strip_code_fence
    +    +    +# ---------------------------------------------------------------------------
    +         +
    +    -    +      {/* Step list */}
    +    -    +      <div>
    +    -    +        {ALL_CONTRACTS.map((ct) => {
    +    -    +          const st = statuses[ct];
    +    -    +          const icon = st === 'done' ? 'Ôö£├ÂÔö¼├║Ôö£├í' : st === 'generating' ? 'Ôö£├ÂÔö£├á├ö├Â├®' : 'Ôö£├ÂÔö£ÔòúÔö£┬╗';
    +    -    +          const color = st === 'done' ? '#22C55E' : st === 'generating' ? '#F59E0B' : '#475569';
    +    -    +          return (
    +    -    +            <div key={ct} style={stepRowStyle}>
    +    -    +              <span style={{ width: '20px', textAlign: 'center' }}>{icon}</span>
    +    -    +              <span style={{ flex: 1, color }}>{CONTRACT_LABELS[ct]}</span>
    +    -    +              <span style={{ fontSize: '0.7rem', color: '#64748B', textTransform: 'uppercase' }}>{st}</span>
    +    -    +            </div>
    +    -    +          );
    +    -    +        })}
    +    -    +      </div>
    +         +
    +    -    +      {/* Log panel */}
    +    -    +      <div style={logPanelStyle} data-testid="contract-log">
    +    -    +        {log.map((entry, i) => (
    +    -    +          <div key={i}>
    +    -    +            <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    +    -    +            {entry.message}
    +    -    +          </div>
    +    -    +        ))}
    +    -    +        <div ref={logEndRef} />
    +    -    +      </div>
    +    +    +def test_strip_code_fence_basic():
    +    +    +    """Strip a basic code fence wrapper."""
    +    +    +    text = "```python\nprint('hi')\n```"
    +    +    +    result = build_service._strip_code_fence(text)
    +    +    +    assert "print('hi')" in result
    +    +    +    assert "```" not in result
    +         +
    +    -    +      {/* Done button */}
    +    -    +      {allDone && (
    +    -    +        <button
    +    -    +          onClick={onComplete}
    +    -    +          data-testid="contracts-done-btn"
    +    -    +          style={{
    +    -    +            background: '#16A34A',
    +    -    +            color: '#fff',
    +    -    +            border: 'none',
    +    -    +            borderRadius: '8px',
    +    -    +            padding: '10px 20px',
    +    -    +            cursor: 'pointer',
    +    -    +            fontSize: '0.8rem',
    +    -    +            fontWeight: 600,
    +    -    +            alignSelf: 'center',
    +    -    +          }}
    +    -    +        >
    +    -    +          Done Ôö£├ÂÔö£├ºÔö£├é View Contracts
    +    -    +        </button>
    +    -    +      )}
    +         +
    +    -    +      {generating && !allDone && (
    +    -    +        <p style={{ textAlign: 'center', color: '#64748B', fontSize: '0.75rem', margin: 0 }}>
    +    -    +          GeneratingÔö£├ÂÔö£├ºÔö¼┬¼
    +    -    +        </p>
    +    -    +      )}
    +    -    +    </div>
    +    -    +  );
    +    -    +}
    +    -    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    +    -    index 2b28280..5aa4c71 100644
    +    -    --- a/web/src/components/QuestionnaireModal.tsx
    +    -    +++ b/web/src/components/QuestionnaireModal.tsx
    +    -    @@ -7,6 +7,7 @@
    +    -      */
    +    -     import { useState, useEffect, useRef, useCallback } from 'react';
    +    -     import { useAuth } from '../context/AuthContext';
    +    -    +import ContractProgress from './ContractProgress';
    +    -     
    +    -     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    -     
    +    -    @@ -22,7 +23,6 @@ const SECTION_LABELS: Record<string, string> = {
    +    -       ui_requirements: 'UI Requirements',
    +    -       architectural_boundaries: 'Boundaries',
    +    -       deployment_target: 'Deployment',
    +    -    -  phase_breakdown: 'Phase Breakdown',
    +    -     };
    +    -     
    +    -     const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    +    -    @@ -34,6 +34,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    +    -     interface ChatMessage {
    +    -       role: 'user' | 'assistant';
    +    -       content: string;
    +    -    +  section?: string;
    +    -     }
    +    -     
    +    -     interface QuestionnaireState {
    +    -    @@ -150,83 +151,178 @@ const SpeechRecognition =
    +    -         : null;
    +    -     
    +    -     function useSpeechRecognition(onResult: (text: string) => void) {
    +    -    -  const recognitionRef = useRef<any>(null);
    +    -       const [listening, setListening] = useState(false);
    +    -       const listeningRef = useRef(false);
    +    -    +  const recRef = useRef<any>(null);
    +    -    +  const onResultRef = useRef(onResult);
    +    -    +  onResultRef.current = onResult;
    +    -    +  /* Generation counter Ôö£├ÂÔö£├ºÔö£├é bumped on every stop/start so stale restarts are ignored */
    +    -    +  const genRef = useRef(0);
    +    -    +  /* Restart timer Ôö£├ÂÔö£├ºÔö£├é ensures only ONE pending restart at a time */
    +    -    +  const restartTimer = useRef<ReturnType<typeof setTimeout> | null>(null);
    +    -    +  /* Consecutive network-error counter Ôö£├ÂÔö£├ºÔö£├é give up after too many */
    +    -    +  const netErrCount = useRef(0);
    +    -    +
    +    -    +  /* Tear down the current instance completely */
    +    -    +  const killRec = useCallback(() => {
    +    -    +    const old = recRef.current;
    +    -    +    recRef.current = null;
    +    -    +    if (old) {
    +    -    +      old.onresult = null;
    +    -    +      old.onerror = null;
    +    -    +      old.onend = null;
    +    -    +      old.onaudiostart = null;
    +    -    +      old.onaudioend = null;
    +    -    +      try { old.abort(); } catch { /* ignore */ }
    +    -    +    }
    +    -    +  }, []);
    +    -     
    +    -    -  useEffect(() => {
    +    -    -    if (!SpeechRecognition) return;
    +    -    -    const rec = new SpeechRecognition();
    +    -    -    rec.continuous = true;
    +    -    -    rec.interimResults = true;
    +    -    -    rec.lang = 'en-US';
    +    -    -
    +    -    -    rec.onresult = (e: any) => {
    +    -    -      let finalTranscript = '';
    +    -    -      for (let i = e.resultIndex; i < e.results.length; i++) {
    +    -    -        if (e.results[i].isFinal) {
    +    -    -          finalTranscript += e.results[i][0].transcript;
    +    -    -        }
    +    -    -      }
    +    -    -      if (finalTranscript) {
    +    -    -        onResult(finalTranscript);
    +    -    -      }
    +    -    -    };
    +    -    +  /* Cancel any pending restart */
    +    -    +  const cancelRestart = useCallback(() => {
    +    -    +    if (restartTimer.current) {
    +    -    +      clearTimeout(restartTimer.current);
    +    -    +      restartTimer.current = null;
    +    -    +    }
    +    -    +  }, []);
    +    -     
    +    -    -    rec.onerror = (e: any) => {
    +    -    -      /* 'no-speech' and 'aborted' are normal during pauses Ôö£├ÂÔö£├ºÔö£├é auto-restart */
    +    -    -      if (e.error === 'no-speech' || e.error === 'aborted') {
    +    -    -        if (listeningRef.current) {
    +    -    -          try { rec.start(); } catch { /* already running */ }
    +    -    -        }
    +    -    -        return;
    +    -    -      }
    +    -    -      listeningRef.current = false;
    +    -    -      setListening(false);
    +    -    -    };
    +    -    +  /* Build a fresh SpeechRecognition (never reused) */
    +    -    +  const makeRec = useCallback(() => {
    +    -    +    if (!SpeechRecognition) return null;
    +    -    +    const r = new SpeechRecognition();
    +    -    +    r.continuous = true;
    +    -    +    r.interimResults = true;
    +    -    +    r.lang = 'en-US';
    +    -    +    return r;
    +    -    +  }, []);
    +    -     
    +    -    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    +    -    -    rec.onend = () => {
    +    -    -      if (listeningRef.current) {
    +    -    -        try { rec.start(); } catch { /* already running */ }
    +    -    -      } else {
    +    -    -        setListening(false);
    +    -    -      }
    +    -    -    };
    +    -    +  const stop = useCallback(() => {
    +    -    +    console.debug('[mic] stop()');
    +    -    +    genRef.current++;
    +    -    +    listeningRef.current = false;
    +    -    +    setListening(false);
    +    -    +    cancelRestart();
    +    -    +    killRec();
    +    -    +  }, [killRec, cancelRestart]);
    +    -     
    +    -    -    recognitionRef.current = rec;
    +    -    -    return () => {
    +    -    -      listeningRef.current = false;
    +    -    -      rec.abort();
    +    -    +  const start = useCallback(() => {
    +    -    +    if (!SpeechRecognition) return;
    +    -    +    console.debug('[mic] start()');
    +    -    +
    +    -    +    /* Tear down any previous instance */
    +    -    +    cancelRestart();
    +    -    +    killRec();
    +    -    +    netErrCount.current = 0;
    +    -    +
    +    -    +    const gen = ++genRef.current;
    +    -    +
    +    -    +    /**
    +    -    +     * Schedule a (re)start with a fresh SpeechRecognition instance.
    +    -    +     * Uses a delay to let Chrome fully release the network connection
    +    -    +     * from the previous instance.  Only ONE restart can be pending.
    +    -    +     */
    +    -    +    const scheduleStart = (delay: number) => {
    +    -    +      cancelRestart();
    +    -    +      restartTimer.current = setTimeout(() => {
    +    -    +        restartTimer.current = null;
    +    -    +        if (!listeningRef.current || genRef.current !== gen) return;
    +    -    +
    +    -    +        killRec();                        // ensure nothing lingering
    +    -    +        const r = makeRec();
    +    -    +        if (!r) return;
    +    -    +        recRef.current = r;
    +    -    +
    +    -    +        r.onresult = (e: any) => {
    +    -    +          netErrCount.current = 0;        // got results Ôö£├ÂÔö£├ºÔö£├é connection is healthy
    +    -    +          let finalText = '';
    +    -    +          for (let i = e.resultIndex; i < e.results.length; i++) {
    +    -    +            if (e.results[i].isFinal) {
    +    -    +              finalText += e.results[i][0].transcript;
    +    -    +            }
    +    -    +          }
    +    -    +          if (finalText) {
    +    -    +            console.debug('[mic] transcript:', finalText.slice(0, 60));
    +    -    +            onResultRef.current(finalText);
    +    -    +          }
    +    -    +        };
    +    -    +
    +    -    +        r.onerror = (e: any) => {
    +    -    +          console.debug('[mic] error:', e.error);
    +    -    +          if (e.error === 'not-allowed') {
    +    -    +            genRef.current++;
    +    -    +            listeningRef.current = false;
    +    -    +            setListening(false);
    +    -    +            cancelRestart();
    +    -    +            killRec();
    +    -    +            return;
    +    -    +          }
    +    -    +          if (e.error === 'network') {
    +    -    +            netErrCount.current++;
    +    -    +            if (netErrCount.current > 3) {
    +    -    +              console.debug('[mic] too many network errors, giving up');
    +    -    +              genRef.current++;
    +    -    +              listeningRef.current = false;
    +    -    +              setListening(false);
    +    -    +              cancelRestart();
    +    -    +              killRec();
    +    -    +              return;
    +    -    +            }
    +    -    +          }
    +    -    +          /* Do NOT restart here Ôö£├ÂÔö£├ºÔö£├é onend always fires after onerror
    +    -    +             and will handle the restart.  Restarting from both causes
    +    -    +             two competing instances Ôö£├ÂÔö£├æÔö£├Ñ more network errors. */
    +    -    +        };
    +    -    +
    +    -    +        r.onend = () => {
    +    -    +          console.debug('[mic] onend, listening=', listeningRef.current, 'gen=', genRef.current === gen);
    +    -    +          if (listeningRef.current && genRef.current === gen) {
    +    -    +            /* Delay restart so Chrome fully tears down the connection.
    +    -    +               Longer delay after network errors to let things settle. */
    +    -    +            const d = netErrCount.current > 0 ? 800 : 300;
    +    -    +            console.debug('[mic] scheduling restart in', d, 'ms');
    +    -    +            scheduleStart(d);
    +    -    +          }
    +    -    +        };
    +    -    +
    +    -    +        try {
    +    -    +          r.start();
    +    -    +          console.debug('[mic] started OK');
    +    -    +        } catch (e) {
    +    -    +          console.debug('[mic] start threw:', e);
    +    -    +          listeningRef.current = false;
    +    -    +          setListening(false);
    +    -    +          cancelRestart();
    +    -    +          killRec();
    +    -    +        }
    +    -    +      }, delay);
    +    -         };
    +    -    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    +    -    -  }, []);
    +    -    +
    +    -    +    listeningRef.current = true;
    +    -    +    setListening(true);
    +    -    +    scheduleStart(50);                     // tiny initial delay
    +    -    +  }, [killRec, makeRec, cancelRestart]);
    +    -     
    +    -       const toggle = useCallback(() => {
    +    -    -    const rec = recognitionRef.current;
    +    -    -    if (!rec) return;
    +    -         if (listening) {
    +    -    -      listeningRef.current = false;
    +    -    -      rec.abort();
    +    -    -      setListening(false);
    +    -    +      stop();
    +    -         } else {
    +    -    -      listeningRef.current = true;
    +    -    -      rec.start();
    +    -    -      setListening(true);
    +    -    +      start();
    +    -         }
    +    -    -  }, [listening]);
    +    -    +  }, [listening, start, stop]);
    +    -    +
    +    -    +  /* Cleanup on unmount */
    +    -    +  useEffect(() => {
    +    -    +    return () => {
    +    -    +      genRef.current++;
    +    -    +      listeningRef.current = false;
    +    -    +      cancelRestart();
    +    -    +      killRec();
    +    -    +    };
    +    -    +  }, [killRec]);
    +    -     
    +    -       return { listening, toggle, supported: !!SpeechRecognition };
    +    -     }
    +    -     
    +    -    -function speak(text: string) {
    +    -    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    +    -    -  window.speechSynthesis.cancel();
    +    -    -  const utter = new SpeechSynthesisUtterance(text);
    +    -    -  utter.rate = 1.05;
    +    -    -  utter.pitch = 1;
    +    -    -  window.speechSynthesis.speak(utter);
    +    -    -}
    +    +    +def test_strip_code_fence_no_fence():
    +    +    +    """No code fence Ôö£├ÂÔö£├ºÔö£├é content passes through."""
    +    +    +    text = "plain content\n"
    +    +    +    result = build_service._strip_code_fence(text)
    +    +    +    assert "plain content" in result
    +         +
    +    -     
    +    -     /* ------------------------------------------------------------------ */
    +    -     /*  Progress bar                                                      */
    +    -    @@ -265,7 +361,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -       const [messages, setMessages] = useState<ChatMessage[]>([]);
    +    -       const [input, setInput] = useState('');
    +    -       const [sending, setSending] = useState(false);
    +    -    -  const [generating, setGenerating] = useState(false);
    +    -       const [qState, setQState] = useState<QuestionnaireState>({
    +    -         current_section: 'product_intent',
    +    -         completed_sections: [],
    +    -    @@ -273,9 +368,12 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -         is_complete: false,
    +    -       });
    +    -       const [error, setError] = useState('');
    +    -    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    +    -    +  const [resetting, setResetting] = useState(false);
    +    -    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    +    -    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    +    -       const messagesEndRef = useRef<HTMLDivElement>(null);
    +    -       const textareaRef = useRef<HTMLTextAreaElement>(null);
    +    -    +  const loadedRef = useRef(false);
    +    -     
    +    -       /* auto-scroll on new messages */
    +    -       useEffect(() => {
    +    -    @@ -294,6 +392,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -     
    +    -       /* ---- Load existing state on mount ---- */
    +    -       useEffect(() => {
    +    -    +    if (loadedRef.current) return;   // StrictMode double-mount guard
    +    -    +    loadedRef.current = true;
    +    -    +
    +    -         const load = async () => {
    +    -           try {
    +    -             const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire/state`, {
    +    -    @@ -307,13 +408,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -                 remaining_sections: state.remaining_sections,
    +    -                 is_complete: state.is_complete,
    +    -               });
    +    -    -          /* Restore prior conversation */
    +    -    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    +    -    -            (m: { role: string; content: string }) => ({
    +    -    -              role: m.role as 'user' | 'assistant',
    +    -    -              content: m.content,
    +    -    -            }),
    +    -    -          );
    +    -    +          /* Restore prior conversation Ôö£├ÂÔö£├ºÔö£├é only messages from the current section */
    +    -    +          const currentSec = state.current_section;
    +    -    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    +    -    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    +    -    +            .map(
    +    -    +              (m: { role: string; content: string; section?: string }) => ({
    +    -    +                role: m.role as 'user' | 'assistant',
    +    -    +                content: m.content,
    +    -    +                section: m.section,
    +    -    +              }),
    +    -    +            );
    +    -    +          /* Restore token usage */
    +    -    +          if (state.token_usage) {
    +    -    +            setTokenUsage(state.token_usage);
    +    -    +          }
    +    -               if (history.length > 0) {
    +    -                 setMessages(history);
    +    -               } else if (!state.is_complete) {
    +    -    @@ -367,18 +476,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -           }
    +    -     
    +    -           const data = await res.json();
    +    -    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    +    -    +
    +    -    +      /* Detect section transition Ôö£├ÂÔö£├ºÔö£├é clear visible messages for a fresh screen */
    +    -    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    +    -    +      const prevSection = qState.current_section;
    +    -    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    +    -    +
    +    -    +      if (sectionChanged) {
    +    -    +        /* Section just completed Ôö£├ÂÔö£├ºÔö£├é start fresh with only the transition reply */
    +    -    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    +    -    +      } else {
    +    -    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    +    -    +      }
    +    -    +
    +    -           setQState({
    +    -    -        current_section: data.remaining_sections[0] ?? null,
    +    -    +        current_section: newCurrentSection,
    +    -             completed_sections: data.completed_sections,
    +    -             remaining_sections: data.remaining_sections,
    +    -             is_complete: data.is_complete,
    +    -           });
    +    -     
    +    -    -      /* auto-read assistant reply with TTS */
    +    -    -      if (voiceEnabled) {
    +    -    -        speak(data.reply);
    +    -    +      /* Update token usage */
    +    -    +      if (data.token_usage) {
    +    -    +        setTokenUsage(data.token_usage);
    +    -           }
    +    -    +
    +    -         } catch {
    +    -           setError('Network error');
    +    -         } finally {
    +    -    @@ -387,25 +509,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -       };
    +    -     
    +    -       /* ---- Generate contracts ---- */
    +    -    -  const handleGenerate = async () => {
    +    -    -    setGenerating(true);
    +    -    -    setError('');
    +    -    -    try {
    +    -    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    +    -    -        method: 'POST',
    +    -    -        headers: { Authorization: `Bearer ${token}` },
    +    -    -      });
    +    -    -      if (res.ok) {
    +    -    -        onContractsGenerated();
    +    -    -      } else {
    +    -    -        const d = await res.json().catch(() => ({}));
    +    -    -        setError(d.detail || 'Failed to generate contracts');
    +    -    -      }
    +    -    -    } catch {
    +    -    -      setError('Network error');
    +    -    -    } finally {
    +    -    -      setGenerating(false);
    +    -    -    }
    +    -    +  const handleStartGenerate = () => {
    +    -    +    setGeneratingContracts(true);
    +    -       };
    +    -     
    +    -       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    +    -    @@ -442,21 +547,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    +    -                       : 'Starting...'}
    +    -                 </p>
    +    -    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    +    -    +              Model: claude-haiku-4-5
    +    -    +            </p>
    +    -    +            {/* Context window meter */}
    +    -    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    +    -    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    +    -    +              const contextWindow = 200_000;
    +    -    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    +    -    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    +    -    +              return (
    +    -    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    +    -    +                  <div style={{
    +    -    +                    flex: 1,
    +    -    +                    height: '4px',
    +    -    +                    background: '#1E293B',
    +    -    +                    borderRadius: '2px',
    +    -    +                    overflow: 'hidden',
    +    -    +                    maxWidth: '120px',
    +    -    +                  }}>
    +    -    +                    <div style={{
    +    -    +                      width: `${pct}%`,
    +    -    +                      height: '100%',
    +    -    +                      background: barColor,
    +    -    +                      borderRadius: '2px',
    +    -    +                      transition: 'width 0.3s',
    +    -    +                    }} />
    +    -    +                  </div>
    +    -    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    +    -    +                    {totalTokens.toLocaleString()} / 200K
    +    -    +                  </span>
    +    -    +                </div>
    +    -    +              );
    +    -    +            })()}
    +    -               </div>
    +    -               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    +    -    -            {/* Voice toggle */}
    +    -    +            {/* Restart questionnaire */}
    +    -                 <button
    +    -    -              onClick={() => setVoiceEnabled((v) => !v)}
    +    -    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    +    -    -              data-testid="voice-toggle"
    +    -    +              onClick={async () => {
    +    -    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    +    -    +                setResetting(true);
    +    -    +                try {
    +    -    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    +    -    +                    method: 'DELETE',
    +    -    +                    headers: { Authorization: `Bearer ${token}` },
    +    -    +                  });
    +    -    +                  if (res.ok) {
    +    -    +                    setMessages([]);
    +    -    +                    setQState({
    +    -    +                      current_section: 'product_intent',
    +    -    +                      completed_sections: [],
    +    -    +                      remaining_sections: [...ALL_SECTIONS],
    +    -    +                      is_complete: false,
    +    -    +                    });
    +    -    +                    setInput('');
    +    -    +                    setError('');
    +    -    +                  }
    +    -    +                } catch { /* ignore */ }
    +    -    +                setResetting(false);
    +    -    +              }}
    +    -    +              disabled={resetting}
    +    -    +              title="Restart questionnaire"
    +    -    +              data-testid="restart-btn"
    +    -                   style={{
    +    -                     ...btnGhost,
    +    -                     padding: '6px 10px',
    +    -    -                fontSize: '1rem',
    +    -    -                opacity: voiceEnabled ? 1 : 0.5,
    +    -    +                fontSize: '0.7rem',
    +    -    +                fontWeight: 600,
    +    -    +                color: '#F59E0B',
    +    -    +                borderColor: '#F59E0B33',
    +    -    +                opacity: resetting ? 0.5 : 1,
    +    -                   }}
    +    -                 >
    +    -    -              {voiceEnabled ? 'Ôö¼┬í├ú├åÔö£├éÔö£┬┐' : 'Ôö¼┬í├ú├åÔö£├éÔö£┬║'}
    +    -    +              Ôö£├ÂÔö£├æ├ö├▓├╣ Restart
    +    -                 </button>
    +    -                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    +    -                   Ôö£├ÂÔö¼├║Ôö£Ôûô
    +    -    @@ -514,8 +677,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -               </div>
    +    -             )}
    +    -     
    +    -    +        {/* Contract generation progress */}
    +    -    +        {generatingContracts && (
    +    -    +          <ContractProgress
    +    -    +            projectId={projectId}
    +    -    +            tokenUsage={tokenUsage}
    +    -    +            model="claude-haiku-4-5"
    +    -    +            onComplete={onContractsGenerated}
    +    -    +          />
    +    -    +        )}
    +    -    +
    +    -             {/* Generate contracts banner */}
    +    -    -        {qState.is_complete && (
    +    -    +        {qState.is_complete && !generatingContracts && (
    +    -               <div
    +    -                 style={{
    +    -                   padding: '12px 20px',
    +    -    @@ -533,17 +706,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    +    -                   Ôö£├ÂÔö¼├║Ôö£Ôöñ All sections complete Ôö£├ÂÔö£├ºÔö£├é ready to generate contracts
    +    -                 </span>
    +    -                 <button
    +    -    -              onClick={handleGenerate}
    +    -    -              disabled={generating}
    +    -    +              onClick={handleStartGenerate}
    +    -                   data-testid="generate-contracts-btn"
    +    -                   style={{
    +    -                     ...btnPrimary,
    +    -                     background: '#16A34A',
    +    -    -                opacity: generating ? 0.6 : 1,
    +    -    -                cursor: generating ? 'wait' : 'pointer',
    +    -    +                cursor: 'pointer',
    +    -                   }}
    +    -                 >
    +    -    -              {generating ? 'Generating...' : 'Generate Contracts'}
    +    -    +              Generate Contracts
    +    -                 </button>
    +    -               </div>
    +    -             )}
    +    -    diff --git a/web/src/context/AuthContext.tsx b/web/src/context/AuthContext.tsx
    +    -    index 3f217e2..0430bc8 100644
    +    -    --- a/web/src/context/AuthContext.tsx
    +    -    +++ b/web/src/context/AuthContext.tsx
    +    -    @@ -4,6 +4,7 @@ interface User {
    +    -       id: string;
    +    -       github_login: string;
    +    -       avatar_url: string | null;
    +    -    +  has_anthropic_key?: boolean;
    +    -     }
    +    -     
    +    -     interface AuthContextValue {
    +    -    @@ -11,6 +12,7 @@ interface AuthContextValue {
    +    -       user: User | null;
    +    -       login: (token: string, user: User) => void;
    +    -       logout: () => void;
    +    -    +  updateUser: (patch: Partial<User>) => void;
    +    -     }
    +    -     
    +    -     const AuthContext = createContext<AuthContextValue | null>(null);
    +    -    @@ -38,6 +40,15 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    +    -         localStorage.removeItem('forgeguard_user');
    +    -       };
    +    -     
    +    -    +  const updateUser = (patch: Partial<User>) => {
    +    -    +    setUser((prev) => {
    +    -    +      if (!prev) return prev;
    +    -    +      const updated = { ...prev, ...patch };
    +    -    +      localStorage.setItem('forgeguard_user', JSON.stringify(updated));
    +    -    +      return updated;
    +    -    +    });
    +    -    +  };
    +         +
    +    -       useEffect(() => {
    +    -         if (!token) return;
    +    -         // Validate token on mount by calling /auth/me
    +    -    @@ -53,7 +64,7 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    +    -       }, []); // eslint-disable-line react-hooks/exhaustive-deps
    +    -     
    +    -       return (
    +    -    -    <AuthContext.Provider value={{ token, user, login, logout }}>
    +    -    +    <AuthContext.Provider value={{ token, user, login, logout, updateUser }}>
    +    -           {children}
    +    -         </AuthContext.Provider>
    +    -       );
    +    -    diff --git a/web/src/pages/BuildComplete.tsx b/web/src/pages/BuildComplete.tsx
    +    -    index e419947..19ece0f 100644
    +    -    --- a/web/src/pages/BuildComplete.tsx
    +    -    +++ b/web/src/pages/BuildComplete.tsx
    +    -    @@ -184,6 +184,7 @@ export default function BuildComplete() {
    +    -               <h3 style={{ color: '#F8FAFC', margin: '0 0 12px' }}>Token Usage by Phase</h3>
    +    -               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', borderBottom: '1px solid #334155', color: '#94A3B8', fontSize: 13 }}>
    +    -                 <span style={{ flex: 2 }}>Phase</span>
    +    -    +            <span style={{ flex: 1 }}>Model</span>
    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>Input</span>
    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>Output</span>
    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>Cost</span>
    +    -    @@ -191,6 +192,7 @@ export default function BuildComplete() {
    +    -               {summary.cost.phases.map((entry, i) => (
    +    -                 <div key={i} style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #1E293B', color: '#F8FAFC', fontSize: 14 }}>
    +    -                   <span style={{ flex: 2 }}>{entry.phase}</span>
    +    -    +              <span style={{ flex: 1, color: '#A78BFA', fontSize: 12 }}>{entry.model.replace('claude-', '')}</span>
    +    -                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.input_tokens)}</span>
    +    -                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.output_tokens)}</span>
    +    -                   <span style={{ flex: 1, textAlign: 'right' }}>${entry.estimated_cost_usd.toFixed(4)}</span>
    +    -    @@ -198,6 +200,7 @@ export default function BuildComplete() {
    +    -               ))}
    +    -               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0 0', color: '#F8FAFC', fontWeight: 600, fontSize: 14 }}>
    +    -                 <span style={{ flex: 2 }}>Total</span>
    +    -    +            <span style={{ flex: 1 }}></span>
    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_input_tokens)}</span>
    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_output_tokens)}</span>
    +    -                 <span style={{ flex: 1, textAlign: 'right' }}>${summary.cost.total_cost_usd.toFixed(4)}</span>
    +    -    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    +    -    index a4f1808..021b634 100644
    +    -    --- a/web/src/pages/BuildProgress.tsx
    +    -    +++ b/web/src/pages/BuildProgress.tsx
    +    -    @@ -1,25 +1,49 @@
    +    -     /**
    +    -      * BuildProgress -- real-time build progress visualization.
    +    -    - * Shows phase progress bar, streaming logs, audit results, and cancel button.
    +    -    + *
    +    -    + * Two-column layout:
    +    -    + *   Left  (40%) Ôö£├ÂÔö£├ºÔö£├é Phase checklist with summaries, status icons, per-phase tokens
    +    -    + *   Right (60%) Ôö£├ÂÔö£├ºÔö£├é Token/cost metrics card, live activity feed, cancel button
    +    -    + *
    +    -    + * All data streamed via WebSocket; initial state fetched from REST.
    +    -      */
    +    -    -import { useState, useEffect, useCallback } from 'react';
    +    -    +import { useState, useEffect, useRef, useCallback } from 'react';
    +    -     import { useParams, useNavigate } from 'react-router-dom';
    +    -     import { useAuth } from '../context/AuthContext';
    +    -     import { useToast } from '../context/ToastContext';
    +    -     import { useWebSocket } from '../hooks/useWebSocket';
    +    -     import AppShell from '../components/AppShell';
    +    -    -import PhaseProgressBar from '../components/PhaseProgressBar';
    +    -    -import type { Phase } from '../components/PhaseProgressBar';
    +    -    -import BuildLogViewer from '../components/BuildLogViewer';
    +    -    -import type { LogEntry } from '../components/BuildLogViewer';
    +    -    -import BuildAuditCard from '../components/BuildAuditCard';
    +    -    -import type { AuditCheck } from '../components/BuildAuditCard';
    +    -     import ConfirmDialog from '../components/ConfirmDialog';
    +    -     import EmptyState from '../components/EmptyState';
    +    -     import Skeleton from '../components/Skeleton';
    +    -     
    +    -     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    -     
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Pricing Ôö£├ÂÔö£├ºÔö£├é matches backend _MODEL_PRICING                          */
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +
    +    -    +const MODEL_PRICING: Record<string, { input: number; output: number }> = {
    +    -    +  'claude-opus-4':     { input: 15 / 1_000_000, output: 75 / 1_000_000 },
    +    -    +  'claude-sonnet-4':   { input: 3 / 1_000_000,  output: 15 / 1_000_000 },
    +    -    +  'claude-haiku-4':    { input: 1 / 1_000_000,  output: 5 / 1_000_000 },
    +    -    +  'claude-3-5-sonnet': { input: 3 / 1_000_000,  output: 15 / 1_000_000 },
    +    -    +};
    +    -    +const DEFAULT_PRICING = { input: 15 / 1_000_000, output: 75 / 1_000_000 };
    +    +    +def test_strip_code_fence_empty():
    +    +    +    """Empty string returns empty."""
    +    +    +    assert build_service._strip_code_fence("") == ""
    +         +
    +    -    +function getTokenCost(model: string, input: number, output: number): number {
    +    -    +  for (const [prefix, rates] of Object.entries(MODEL_PRICING)) {
    +    -    +    if (model.startsWith(prefix)) {
    +    -    +      return input * rates.input + output * rates.output;
    +    -    +    }
    +    -    +  }
    +    -    +  return input * DEFAULT_PRICING.input + output * DEFAULT_PRICING.output;
    +    -    +}
    +         +
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Types                                                             */
    +    -    +/* ------------------------------------------------------------------ */
         +    +# ---------------------------------------------------------------------------
    -    +    +# Tests: API key management (BYOK)
    +    +    +# Tests: _write_file_block
         +    +# ---------------------------------------------------------------------------
    +         +
    +    -     interface BuildStatus {
    +    -       id: string;
    +    -       project_id: string;
    +    -    @@ -32,140 +56,389 @@ interface BuildStatus {
    +    -       created_at: string;
    +    -     }
    +    -     
    +    -    -interface AuditResult {
    +    -    -  phase: string;
    +    -    -  iteration: number;
    +    -    -  overall: string;
    +    -    -  checks: AuditCheck[];
    +    -    +interface PhaseDefinition {
    +    -    +  number: number;
    +    -    +  name: string;
    +    -    +  objective: string;
    +    -    +  deliverables: string[];
    +    -     }
    +    -     
    +    -    +type PhaseStatus = 'pending' | 'active' | 'pass' | 'fail';
    +    -    +
    +    -    +interface PhaseState {
    +    -    +  def: PhaseDefinition;
    +    -    +  status: PhaseStatus;
    +    -    +  input_tokens: number;
    +    -    +  output_tokens: number;
    +    -    +  elapsed_ms: number;
    +    -    +}
    +         +
    +    -    +interface ActivityEntry {
    +    -    +  time: string;
    +    -    +  message: string;
    +    -    +  level: 'info' | 'warn' | 'error' | 'system';
    +    -    +}
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +    +    +@patch("app.services.build_service.build_repo")
    +    +    +async def test_write_file_block_success(mock_build_repo, mock_broadcast, tmp_path):
    +    +    +    """_write_file_block writes a file and emits events."""
    +    +    +    mock_build_repo.append_build_log = AsyncMock()
    +    +    +    files_written: list[dict] = []
         +    +
    -    +    +_USER_DICT = {
    -    +    +    "id": "11111111-1111-1111-1111-111111111111",
    -    +    +    "github_id": 12345,
    -    +    +    "github_login": "octocat",
    -    +    +    "avatar_url": "https://example.com/avatar.png",
    -    +    +    "anthropic_api_key": None,
    -    +    +}
    +    +    +    await build_service._write_file_block(
    +    +    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +    +    +        "src/hello.py", "print('hello')\n", files_written,
    +    +    +    )
    +         +
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Styles                                                            */
    +    -    +/* ------------------------------------------------------------------ */
    +    +    +    # File should exist on disk
    +    +    +    written_file = tmp_path / "src" / "hello.py"
    +    +    +    assert written_file.exists()
    +    +    +    assert written_file.read_text() == "print('hello')\n"
    +         +
    +    -    +const pageStyle: React.CSSProperties = {
    +    -    +  padding: '24px',
    +    -    +  maxWidth: '1280px',
    +    -    +  margin: '0 auto',
    +    -    +};
    +    +    +    # File info should be appended to files_written
    +    +    +    assert len(files_written) == 1
    +    +    +    assert files_written[0]["path"] == "src/hello.py"
    +    +    +    assert files_written[0]["language"] == "python"
    +    +    +    assert files_written[0]["size_bytes"] == len("print('hello')\n".encode())
    +         +
    +    -    +const twoColStyle: React.CSSProperties = {
    +    -    +  display: 'grid',
    +    -    +  gridTemplateColumns: '2fr 3fr',
    +    -    +  gap: '20px',
    +    -    +  alignItems: 'start',
    +    -    +};
    +    +    +    # Build log should be recorded
    +    +    +    mock_build_repo.append_build_log.assert_called_once()
    +         +
    +    -    +const cardStyle: React.CSSProperties = {
    +    -    +  background: '#1E293B',
    +    -    +  borderRadius: '8px',
    +    -    +  padding: '16px 20px',
    +    -    +};
    +    +    +    # WS event should be broadcast
    +    +    +    mock_broadcast.assert_called_once()
    +         +
    +    -    +const phaseRowStyle = (isActive: boolean): React.CSSProperties => ({
    +    -    +  display: 'flex',
    +    -    +  gap: '10px',
    +    -    +  padding: '10px 12px',
    +    -    +  borderRadius: '6px',
    +    -    +  background: isActive ? '#1E3A5F' : 'transparent',
    +    -    +  borderLeft: isActive ? '3px solid #2563EB' : '3px solid transparent',
    +    -    +  transition: 'background 0.2s',
    +    -    +  cursor: 'pointer',
    +    -    +});
    +         +
    +    -    +const metricBoxStyle: React.CSSProperties = {
    +    -    +  display: 'flex',
    +    -    +  flexDirection: 'column',
    +    -    +  gap: '2px',
    +    -    +  flex: 1,
    +    -    +  minWidth: '100px',
    +    -    +};
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +    +    +@patch("app.services.build_service.build_repo")
    +    +    +async def test_write_file_block_traversal_rejected(mock_build_repo, mock_broadcast, tmp_path):
    +    +    +    """_write_file_block rejects paths with directory traversal."""
    +    +    +    files_written: list[dict] = []
    +         +
    +    -    +const feedStyle: React.CSSProperties = {
    +    -    +  background: '#0B1120',
    +    -    +  borderRadius: '8px',
    +    -    +  border: '1px solid #1E293B',
    +    -    +  padding: '12px 16px',
    +    -    +  maxHeight: '420px',
    +    -    +  overflowY: 'auto',
    +    -    +  fontFamily: 'monospace',
    +    -    +  fontSize: '0.72rem',
    +    -    +  lineHeight: 1.7,
    +    -    +};
    +    +    +    await build_service._write_file_block(
    +    +    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +    +    +        "../../../etc/passwd", "bad content", files_written,
    +    +    +    )
    +         +
    +    -    +const LEVEL_COLOR: Record<string, string> = {
    +    -    +  info: '#F8FAFC',
    +    -    +  warn: '#EAB308',
    +    -    +  error: '#EF4444',
    +    -    +  system: '#2563EB',
    +    -    +};
    +    +    +    # No file should be written
    +    +    +    assert len(files_written) == 0
    +    +    +    mock_build_repo.append_build_log.assert_not_called()
    +         +
    +    -    +const STATUS_ICON: Record<PhaseStatus, string> = {
    +    -    +  pending: 'Ôö£├ÂÔö£ÔòúÔö£┬╗',
    +    -    +  active: 'Ôö£├ÂÔö£ÔòúÔö£├½',
    +    -    +  pass: 'Ôö£├ÂÔö£ÔòúÔö£├á',
    +    -    +  fail: 'Ôö£├ÂÔö¼├║Ôö£Ôûô',
    +    -    +};
    +         +
    +    -    +const STATUS_COLOR: Record<PhaseStatus, string> = {
    +    -    +  pending: '#475569',
    +    -    +  active: '#2563EB',
    +    -    +  pass: '#22C55E',
    +    -    +  fail: '#EF4444',
    +    -    +};
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +    +    +@patch("app.services.build_service.build_repo")
    +    +    +async def test_write_file_block_absolute_rejected(mock_build_repo, mock_broadcast, tmp_path):
    +    +    +    """_write_file_block rejects absolute paths."""
    +    +    +    files_written: list[dict] = []
    +         +
    +    -    +/* ------------------------------------------------------------------ */
    +    -    +/*  Component                                                         */
    +    -    +/* ------------------------------------------------------------------ */
    +    +    +    await build_service._write_file_block(
    +    +    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +    +    +        "/etc/passwd", "bad content", files_written,
    +    +    +    )
    +         +
    +    -     function BuildProgress() {
    +    -       const { projectId } = useParams<{ projectId: string }>();
    +    -       const { token } = useAuth();
    +    -       const { addToast } = useToast();
    +    -       const navigate = useNavigate();
    +    -     
    +    -    +  /* State */
    +    -       const [build, setBuild] = useState<BuildStatus | null>(null);
    +    -    -  const [logs, setLogs] = useState<LogEntry[]>([]);
    +    -    -  const [auditResults, setAuditResults] = useState<AuditResult[]>([]);
    +    -    +  const [phaseDefs, setPhaseDefs] = useState<PhaseDefinition[]>([]);
    +    -    +  const [phaseStates, setPhaseStates] = useState<Map<number, PhaseState>>(new Map());
    +    -    +  const [activity, setActivity] = useState<ActivityEntry[]>([]);
    +    -    +  const [totalTokens, setTotalTokens] = useState({ input: 0, output: 0 });
    +    -       const [loading, setLoading] = useState(true);
    +    -       const [noBuild, setNoBuild] = useState(false);
    +    -       const [showCancelConfirm, setShowCancelConfirm] = useState(false);
    +    -    +  const [expandedPhase, setExpandedPhase] = useState<number | null>(null);
    +    -    +  const [startTime] = useState(() => Date.now());
    +    -    +  const [elapsed, setElapsed] = useState(0);
    +    -    +  const feedEndRef = useRef<HTMLDivElement>(null);
    +    -    +  const phaseStartRef = useRef<number>(Date.now());
    +    -    +
    +    -    +  /* ------ helpers ------ */
    +    -    +
    +    -    +  const addActivity = useCallback((msg: string, level: ActivityEntry['level'] = 'info') => {
    +    -    +    const time = new Date().toLocaleTimeString('en-GB', { hour12: false });
    +    -    +    setActivity((prev) => [...prev, { time, message: msg, level }]);
    +    -    +  }, []);
    +    -     
    +    -    -  // Parse phase number from phase string like "Phase 3"
    +    -       const parsePhaseNum = (phaseStr: string): number => {
    +    -    -    const match = phaseStr.match(/\d+/);
    +    -    -    return match ? parseInt(match[0], 10) : 0;
    +    -    +    const m = phaseStr.match(/\d+/);
    +    -    +    return m ? parseInt(m[0], 10) : 0;
    +    -       };
    +    -     
    +    -    -  // Generate phases array for the progress bar
    +    -    -  const generatePhases = useCallback((): Phase[] => {
    +    -    -    if (!build) return [];
    +    -    -    const totalPhases = 12; // Phase 0-11
    +    -    -    const currentPhase = parsePhaseNum(build.phase);
    +    -    -    const phases: Phase[] = [];
    +    -    -    for (let i = 0; i <= totalPhases - 1; i++) {
    +    -    -      let status: Phase['status'] = 'pending';
    +    -    -      if (i < currentPhase) status = 'pass';
    +    -    -      else if (i === currentPhase) {
    +    -    -        if (build.status === 'completed') status = 'pass';
    +    -    -        else if (build.status === 'failed') status = 'fail';
    +    -    -        else status = 'active';
    +    -    -      }
    +    -    -      phases.push({ label: `P${i}`, status });
    +    -    -    }
    +    -    -    return phases;
    +    -    -  }, [build]);
    +    -    +  /* ------ auto-scroll feed ------ */
    +    -    +  useEffect(() => {
    +    -    +    feedEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    +    -    +  }, [activity]);
    +    -    +
    +    -    +  /* ------ elapsed timer ------ */
    +    -    +  useEffect(() => {
    +    -    +    if (!build || !['pending', 'running'].includes(build.status)) return;
    +    -    +    const ref = build.started_at ? new Date(build.started_at).getTime() : startTime;
    +    -    +    const iv = setInterval(() => setElapsed(Math.floor((Date.now() - ref) / 1000)), 1000);
    +    -    +    return () => clearInterval(iv);
    +    -    +  }, [build, startTime]);
    +    -     
    +    -    -  // Fetch initial build status
    +    -    +  /* ------ fetch initial data ------ */
    +    -       useEffect(() => {
    +    -    -    const fetchBuild = async () => {
    +    -    +    const load = async () => {
    +    -           try {
    +    -    -        const res = await fetch(`${API_BASE}/projects/${projectId}/build/status`, {
    +    -    -          headers: { Authorization: `Bearer ${token}` },
    +    -    -        });
    +    -    -        if (res.ok) {
    +    -    -          setBuild(await res.json());
    +    -    -        } else if (res.status === 400) {
    +    -    +        const [statusRes, phasesRes, logsRes] = await Promise.all([
    +    -    +          fetch(`${API_BASE}/projects/${projectId}/build/status`, {
    +    -    +            headers: { Authorization: `Bearer ${token}` },
    +    -    +          }),
    +    -    +          fetch(`${API_BASE}/projects/${projectId}/build/phases`, {
    +    -    +            headers: { Authorization: `Bearer ${token}` },
    +    -    +          }),
    +    -    +          fetch(`${API_BASE}/projects/${projectId}/build/logs?limit=500`, {
    +    -    +            headers: { Authorization: `Bearer ${token}` },
    +    -    +          }),
    +    -    +        ]);
    +    -    +
    +    -    +        if (statusRes.status === 400) {
    +    -               setNoBuild(true);
    +    -    +          setLoading(false);
    +    -    +          return;
    +    -    +        }
    +    +    +    assert len(files_written) == 0
    +    +    +    mock_build_repo.append_build_log.assert_not_called()
    +         +
    +    -    +        if (statusRes.ok) {
    +    -    +          const buildData: BuildStatus = await statusRes.json();
    +    -    +          setBuild(buildData);
    +    -    +
    +    -    +          /* Seed activity from historical logs */
    +    -    +          if (logsRes.ok) {
    +    -    +            const logData = await logsRes.json();
    +    -    +            const items = (logData.items ?? []) as {
    +    -    +              timestamp: string;
    +    -    +              message: string;
    +    -    +              level: string;
    +    -    +            }[];
    +    -    +            setActivity(
    +    -    +              items.map((l) => ({
    +    -    +                time: new Date(l.timestamp).toLocaleTimeString('en-GB', { hour12: false }),
    +    -    +                message: l.message,
    +    -    +                level: (l.level ?? 'info') as ActivityEntry['level'],
    +    -    +              })),
    +    -    +            );
    +    -    +          }
    +         +
    +    -    +          /* Seed token totals from cost summary */
    +    -    +          try {
    +    -    +            const costRes = await fetch(`${API_BASE}/projects/${projectId}/build/summary`, {
    +    -    +              headers: { Authorization: `Bearer ${token}` },
    +    -    +            });
    +    -    +            if (costRes.ok) {
    +    -    +              const costData = await costRes.json();
    +    -    +              setTotalTokens({
    +    -    +                input: costData.cost?.total_input_tokens ?? 0,
    +    -    +                output: costData.cost?.total_output_tokens ?? 0,
    +    -    +              });
    +    -    +            }
    +    -    +          } catch { /* best effort */ }
    +    -             } else {
    +    -    -          addToast('Failed to load build status');
    +    -    +          addToast('Failed to load build');
    +    -    +        }
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: get_build_files
    +    +    +# ---------------------------------------------------------------------------
    +         +
    +    -    +        /* Phase definitions */
    +    -    +        if (phasesRes.ok) {
    +    -    +          const defs: PhaseDefinition[] = await phasesRes.json();
    +    -    +          setPhaseDefs(defs);
    +    -    +
    +    -    +          /* Build initial phase states from current build status */
    +    -    +          const statusData: BuildStatus | null = statusRes.ok ? await statusRes.json().catch(() => null) : null;
    +    -    +          const currentPhaseNum = statusData ? parsePhaseNum(statusData.phase) : 0;
    +    -    +
    +    -    +          const map = new Map<number, PhaseState>();
    +    -    +          for (const def of defs) {
    +    -    +            let status: PhaseStatus = 'pending';
    +    -    +            if (statusData) {
    +    -    +              if (def.number < currentPhaseNum) status = 'pass';
    +    -    +              else if (def.number === currentPhaseNum) {
    +    -    +                if (statusData.status === 'completed') status = 'pass';
    +    -    +                else if (statusData.status === 'failed') status = 'fail';
    +    -    +                else status = 'active';
    +    -    +              }
    +    -    +            }
    +    -    +            map.set(def.number, {
    +    -    +              def,
    +    -    +              status,
    +    -    +              input_tokens: 0,
    +    -    +              output_tokens: 0,
    +    -    +              elapsed_ms: 0,
    +    -    +            });
    +    -    +          }
    +    -    +          setPhaseStates(map);
    +    -             }
    +    -           } catch {
    +    -    -        addToast('Network error loading build status');
    +    -    +        addToast('Network error loading build');
    +    -           } finally {
    +    -             setLoading(false);
    +    -           }
    +    -         };
    +    -    -    fetchBuild();
    +    -    +    load();
    +    -       }, [projectId, token, addToast]);
    +    -     
    +    -    -  // Fetch initial logs
    +    -    -  useEffect(() => {
    +    -    -    if (!build) return;
    +    -    -    const fetchLogs = async () => {
    +    -    -      try {
    +    -    -        const res = await fetch(`${API_BASE}/projects/${projectId}/build/logs?limit=500`, {
    +    -    -          headers: { Authorization: `Bearer ${token}` },
    +    -    -        });
    +    -    -        if (res.ok) {
    +    -    -          const data = await res.json();
    +    -    -          setLogs(data.items ?? []);
    +    -    -        }
    +    -    -      } catch {
    +    -    -        /* best effort */
    +    -    -      }
    +    -    -    };
    +    -    -    fetchLogs();
    +    -    -  }, [build?.id, projectId, token]);
    +    -    -
    +    -    -  // Handle WebSocket events
    +    -    +  /* ------ WebSocket handler ------ */
    +    -       useWebSocket(
    +    -         useCallback(
    +    -           (data) => {
    +    -             const payload = data.payload as Record<string, unknown>;
    +    -    -        const eventProjectId = payload.project_id as string;
    +    -    -        if (eventProjectId !== projectId) return;
    +    -    +        const eventPid = payload.project_id as string;
    +    -    +        if (eventPid && eventPid !== projectId) return;
    +    -     
    +    -             switch (data.type) {
    +    -    -          case 'build_started':
    +    -    -            setBuild(payload.build as BuildStatus);
    +    -    +          case 'build_started': {
    +    -    +            setBuild(payload.build as BuildStatus ?? payload as unknown as BuildStatus);
    +    -                 setNoBuild(false);
    +    -    +            addActivity('Build started', 'system');
    +    -    +
    +    -    +            /* Set all phases to pending, first phase active */
    +    -    +            setPhaseStates((prev) => {
    +    -    +              const next = new Map(prev);
    +    -    +              for (const [num, ps] of next) {
    +    -    +                next.set(num, { ...ps, status: num === 0 ? 'active' : 'pending' });
    +    -    +              }
    +    -    +              return next;
    +    -    +            });
    +    -    +            phaseStartRef.current = Date.now();
    +    -                 break;
    +    -    +          }
    +         +
    +    -               case 'build_log': {
    +    -    -            const log = payload as unknown as LogEntry;
    +    -    -            setLogs((prev) => [...prev, log]);
    +    -    +            const msg = (payload.message ?? payload.msg ?? '') as string;
    +    -    +            const lvl = (payload.level ?? 'info') as ActivityEntry['level'];
    +    -    +            if (msg) addActivity(msg, lvl);
    +    -    +            break;
    +    -    +          }
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service.project_repo")
    +    +    +@patch("app.services.build_service.build_repo")
    +    +    +async def test_get_build_files(mock_build_repo, mock_project_repo):
    +    +    +    """get_build_files returns file list from build logs."""
    +    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +    +    +        return_value=_build(status="completed")
    +    +    +    )
    +    +    +    mock_build_repo.get_build_file_logs = AsyncMock(return_value=[
    +    +    +        {"path": "src/main.py", "size_bytes": 100, "language": "python", "created_at": "2025-01-01T00:00:00Z"},
    +    +    +    ])
    +         +
    +    -    +          case 'phase_complete': {
    +    -    +            const phase = payload.phase as string;
    +    -    +            const phaseNum = parsePhaseNum(phase);
    +    -    +            const inTok = (payload.input_tokens ?? 0) as number;
    +    -    +            const outTok = (payload.output_tokens ?? 0) as number;
    +    -    +            const elapsed_ms = Date.now() - phaseStartRef.current;
    +    -    +
    +    -    +            addActivity(`Ôö£├ÂÔö¼├║Ôö£Ôöñ ${phase} complete (${inTok.toLocaleString()} in / ${outTok.toLocaleString()} out)`, 'system');
    +    -    +
    +    -    +            /* Accumulate total tokens */
    +    -    +            setTotalTokens((prev) => ({
    +    -    +              input: prev.input + inTok,
    +    -    +              output: prev.output + outTok,
    +    -    +            }));
    +    -    +
    +    -    +            /* Update phase states: mark this phase pass, next phase active */
    +    -    +            setPhaseStates((prev) => {
    +    -    +              const next = new Map(prev);
    +    -    +              const current = next.get(phaseNum);
    +    -    +              if (current) {
    +    -    +                next.set(phaseNum, {
    +    -    +                  ...current,
    +    -    +                  status: 'pass',
    +    -    +                  input_tokens: inTok,
    +    -    +                  output_tokens: outTok,
    +    -    +                  elapsed_ms,
    +    -    +                });
    +    -    +              }
    +    -    +              /* Mark next phase active */
    +    -    +              const nextPhase = next.get(phaseNum + 1);
    +    -    +              if (nextPhase && nextPhase.status === 'pending') {
    +    -    +                next.set(phaseNum + 1, { ...nextPhase, status: 'active' });
    +    -    +              }
    +    -    +              return next;
    +    -    +            });
    +    +    +    result = await build_service.get_build_files(_PROJECT_ID, _USER_ID)
    +         +
    +    -    +            setBuild((prev) => prev ? { ...prev, phase: phase } : prev);
    +    -    +            phaseStartRef.current = Date.now();
    +    -                 break;
    +    -               }
    +    -    -          case 'phase_complete':
    +    -    -          case 'build_complete':
    +    -    -          case 'build_error':
    +    -    -          case 'build_cancelled':
    +    -    -            setBuild(payload.build as BuildStatus);
    +    -    -            if (data.type === 'build_complete') {
    +    -    -              addToast('Build completed successfully!', 'success');
    +    -    -              navigate(`/projects/${projectId}/build/complete`);
    +    -    -            } else if (data.type === 'build_error') {
    +    -    -              addToast('Build failed: ' + (payload.error ?? 'Unknown error'));
    +    -    +
    +    -    +          case 'build_complete': {
    +    -    +            setBuild((prev) => prev ? { ...prev, status: 'completed' } : prev);
    +    -    +            const totalIn = (payload.total_input_tokens ?? 0) as number;
    +    -    +            const totalOut = (payload.total_output_tokens ?? 0) as number;
    +    -    +            if (totalIn || totalOut) {
    +    -    +              setTotalTokens({ input: totalIn, output: totalOut });
    +    -                 }
    +    -    +            addActivity('Build completed successfully!', 'system');
    +    -    +
    +    -    +            /* Mark all phases as pass */
    +    -    +            setPhaseStates((prev) => {
    +    -    +              const next = new Map(prev);
    +    -    +              for (const [num, ps] of next) {
    +    -    +                if (ps.status !== 'fail') next.set(num, { ...ps, status: 'pass' });
    +    -    +              }
    +    -    +              return next;
    +    -    +            });
    +    -    +            addToast('Build completed!', 'success');
    +    -    +            break;
    +    -    +          }
    +    +    +    assert len(result) == 1
    +    +    +    assert result[0]["path"] == "src/main.py"
    +         +
    +    -    +          case 'build_error': {
    +    -    +            setBuild((prev) => prev ? { ...prev, status: 'failed', error_detail: (payload.error_detail ?? payload.error ?? '') as string } : prev);
    +    -    +            addActivity(`Build failed: ${payload.error_detail ?? payload.error ?? 'Unknown error'}`, 'error');
    +    -    +
    +    -    +            /* Mark current active phase as fail */
    +    -    +            setPhaseStates((prev) => {
    +    -    +              const next = new Map(prev);
    +    -    +              for (const [num, ps] of next) {
    +    -    +                if (ps.status === 'active') next.set(num, { ...ps, status: 'fail' });
    +    -    +              }
    +    -    +              return next;
    +    -    +            });
    +    -                 break;
    +    -    -          case 'audit_pass':
    +    -    +          }
    +         +
    +    -    +          case 'build_cancelled': {
    +    -    +            setBuild((prev) => prev ? { ...prev, status: 'cancelled' } : prev);
    +    -    +            addActivity('Build cancelled by user', 'warn');
    +    -    +            break;
    +    -    +          }
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service.project_repo")
    +    +    +@patch("app.services.build_service.build_repo")
    +    +    +async def test_get_build_files_no_project(mock_build_repo, mock_project_repo):
    +    +    +    """get_build_files raises ValueError for missing project."""
    +    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=None)
    +         +
    +    -    +          case 'audit_pass': {
    +    -    +            const phase = payload.phase as string;
    +    -    +            addActivity(`Audit PASS for ${phase}`, 'system');
    +    -    +            break;
    +    -    +          }
    +    +    +    with pytest.raises(ValueError, match="not found"):
    +    +    +        await build_service.get_build_files(_PROJECT_ID, _USER_ID)
    +         +
    +    -               case 'audit_fail': {
    +    -    -            const result: AuditResult = {
    +    -    -              phase: (payload.phase as string) ?? '',
    +    -    -              iteration: (payload.iteration as number) ?? 1,
    +    -    -              overall: data.type === 'audit_pass' ? 'PASS' : 'FAIL',
    +    -    -              checks: (payload.checks as AuditCheck[]) ?? [],
    +    -    -            };
    +    -    -            setAuditResults((prev) => [...prev, result]);
    +    -    +            const phase = payload.phase as string;
    +    -    +            const loop = payload.loop_count as number;
    +    -    +            addActivity(`Audit FAIL for ${phase} (loop ${loop})`, 'warn');
    +    -                 break;
    +    -               }
    +    -             }
    +    -           },
    +    -    -      [projectId, addToast],
    +    -    +      [projectId, addActivity, addToast],
    +    -         ),
    +    -       );
    +    -     
    +    -    +  /* ------ actions ------ */
    +         +
    +    -       const handleCancel = async () => {
    +    -         try {
    +    -           const res = await fetch(`${API_BASE}/projects/${projectId}/build/cancel`, {
    +    -    @@ -195,8 +468,8 @@ function BuildProgress() {
    +    -             const newBuild = await res.json();
    +    -             setBuild(newBuild);
    +    -             setNoBuild(false);
    +    -    -        setLogs([]);
    +    -    -        setAuditResults([]);
    +    -    +        setActivity([]);
    +    -    +        setTotalTokens({ input: 0, output: 0 });
    +    -             addToast('Build started', 'success');
    +    -           } else {
    +    -             const data = await res.json().catch(() => ({ detail: 'Failed to start build' }));
    +    -    @@ -207,22 +480,45 @@ function BuildProgress() {
    +    -         }
    +    -       };
    +    -     
    +    -    +  /* ------ derived values ------ */
    +    -    +
    +    -    +  const isActive = build && ['pending', 'running'].includes(build.status);
    +    -    +  const buildModel = 'claude-opus-4-6';
    +    -    +  const contextWindow = 200_000;
    +    -    +  const totalTok = totalTokens.input + totalTokens.output;
    +    -    +  const ctxPercent = Math.min(100, (totalTok / contextWindow) * 100);
    +    -    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    +    -    +  const estimatedCost = getTokenCost(buildModel, totalTokens.input, totalTokens.output);
    +    -    +  const elapsedStr = elapsed > 0 ? `${Math.floor(elapsed / 60)}m ${elapsed % 60}s` : '0s';
    +    -    +
    +    -    +  const doneCount = Array.from(phaseStates.values()).filter((p) => p.status === 'pass').length;
    +    -    +  const totalPhases = phaseStates.size || phaseDefs.length;
    +    -    +
    +    -    +  /* ------ render: loading ------ */
    +    -    +
    +    -       if (loading) {
    +    -         return (
    +    -           <AppShell>
    +    -    -        <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    +    -    +        <div style={pageStyle}>
    +    -               <Skeleton style={{ width: '100%', height: '40px', marginBottom: '24px' }} />
    +    -    -          <Skeleton style={{ width: '100%', height: '300px', marginBottom: '16px' }} />
    +    -    -          <Skeleton style={{ width: '100%', height: '120px' }} />
    +    -    +          <div style={twoColStyle}>
    +    -    +            <Skeleton style={{ width: '100%', height: '400px' }} />
    +    -    +            <div>
    +    -    +              <Skeleton style={{ width: '100%', height: '120px', marginBottom: '16px' }} />
    +    -    +              <Skeleton style={{ width: '100%', height: '300px' }} />
    +    -    +            </div>
    +    -    +          </div>
    +    -             </div>
    +    -           </AppShell>
    +    -         );
    +    -       }
    +    -     
    +    -    +  /* ------ render: no build ------ */
    +    -    +
    +    -       if (noBuild) {
    +    -         return (
    +    -           <AppShell>
    +    -    -        <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    +    -    +        <div style={pageStyle}>
    +    -               <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    +    -                 <button
    +    -                   onClick={() => navigate(`/projects/${projectId}`)}
    +    -    @@ -242,16 +538,12 @@ function BuildProgress() {
    +    -         );
    +    -       }
    +    -     
    +    -    -  const isActive = build && ['pending', 'running'].includes(build.status);
    +    -    -  const elapsed = build?.started_at
    +    -    -    ? Math.round((Date.now() - new Date(build.started_at).getTime()) / 1000)
    +    -    -    : 0;
    +    -    -  const elapsedStr = elapsed > 0 ? `${Math.floor(elapsed / 60)}m ${elapsed % 60}s` : '';
    +    -    +  /* ------ render: main ------ */
    +    -     
    +    -       return (
    +    -         <AppShell>
    +    -    -      <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    +    -    -        {/* Header */}
    +    -    +      <div style={pageStyle}>
    +    -    +        {/* ---- Header ---- */}
    +    -             <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '20px' }}>
    +    -               <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    +    -                 <button
    +    -    @@ -277,77 +569,187 @@ function BuildProgress() {
    +    -                   </span>
    +    -                 )}
    +    -               </div>
    +    -    -          {isActive && (
    +    -    -            <button
    +    -    -              onClick={() => setShowCancelConfirm(true)}
    +    -    -              style={{
    +    -    -                background: 'transparent',
    +    -    -                color: '#EF4444',
    +    -    -                border: '1px solid #EF4444',
    +    -    -                borderRadius: '6px',
    +    -    -                padding: '6px 16px',
    +    -    -                cursor: 'pointer',
    +    -    -                fontSize: '0.8rem',
    +    -    -                fontWeight: 600,
    +    -    -              }}
    +    -    -            >
    +    -    -              Cancel Build
    +    -    -            </button>
    +    -    -          )}
    +    -    +          <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>
    +    -    +            {build?.status === 'completed' && (
    +    -    +              <button
    +    -    +                onClick={() => navigate(`/projects/${projectId}/build/complete`)}
    +    -    +                style={{
    +    -    +                  background: '#16A34A',
    +    -    +                  color: '#fff',
    +    -    +                  border: 'none',
    +    -    +                  borderRadius: '6px',
    +    -    +                  padding: '6px 16px',
    +    -    +                  cursor: 'pointer',
    +    -    +                  fontSize: '0.8rem',
    +    -    +                  fontWeight: 600,
    +    -    +                }}
    +    -    +              >
    +    -    +                View Summary
    +    -    +              </button>
    +    -    +            )}
    +    -    +            {isActive && (
    +    -    +              <button
    +    -    +                onClick={() => setShowCancelConfirm(true)}
    +    -    +                style={{
    +    -    +                  background: 'transparent',
    +    -    +                  color: '#EF4444',
    +    -    +                  border: '1px solid #EF4444',
    +    -    +                  borderRadius: '6px',
    +    -    +                  padding: '6px 16px',
    +    -    +                  cursor: 'pointer',
    +    -    +                  fontSize: '0.8rem',
    +    -    +                  fontWeight: 600,
    +    -    +                }}
    +    -    +              >
    +    -    +                Cancel Build
    +    -    +              </button>
    +    -    +            )}
    +    -    +          </div>
    +    -             </div>
    +    -     
    +    -    -        {/* Build Summary Header */}
    +    -    -        {build && (
    +    -    -          <div style={{ background: '#1E293B', borderRadius: '8px', padding: '14px 20px', marginBottom: '16px', display: 'flex', gap: '24px', fontSize: '0.8rem', flexWrap: 'wrap' }}>
    +    -    -            <div>
    +    -    -              <span style={{ color: '#94A3B8' }}>Phase: </span>
    +    -    -              <span style={{ fontWeight: 600 }}>{build.phase}</span>
    +    -    +        {/* ---- Two-column layout ---- */}
    +    -    +        <div style={twoColStyle}>
    +    -    +
    +    -    +          {/* ======== LEFT: Phase Checklist ======== */}
    +    -    +          <div style={{ ...cardStyle, padding: '12px 16px' }}>
    +    -    +            <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    -    +              Phases ({doneCount}/{totalPhases})
    +    -    +            </h3>
    +    -    +            <div style={{ display: 'flex', flexDirection: 'column', gap: '2px' }}>
    +    -    +              {(phaseStates.size > 0
    +    -    +                ? Array.from(phaseStates.entries()).sort((a, b) => a[0] - b[0]).map(([num, ps]) => ({ num, ps }))
    +    -    +                : phaseDefs.map((d) => ({ num: d.number, ps: { def: d, status: 'pending' as PhaseStatus, input_tokens: 0, output_tokens: 0, elapsed_ms: 0 } }))
    +    -    +              ).map(({ num, ps }) => {
    +    -    +                const isExp = expandedPhase === num;
    +    -    +                const isActivePhase = ps.status === 'active';
    +    -    +                const phaseElapsed = ps.elapsed_ms > 0 ? `${Math.floor(ps.elapsed_ms / 60000)}m ${Math.floor((ps.elapsed_ms % 60000) / 1000)}s` : '';
    +    -    +
    +    -    +                return (
    +    -    +                  <div key={num}>
    +    -    +                    <div
    +    -    +                      style={phaseRowStyle(isActivePhase)}
    +    -    +                      onClick={() => setExpandedPhase(isExp ? null : num)}
    +    -    +                    >
    +    -    +                      {/* Status icon */}
    +    -    +                      <span style={{ color: STATUS_COLOR[ps.status], fontSize: '1rem', width: '20px', textAlign: 'center', flexShrink: 0 }}>
    +    -    +                        {isActivePhase ? (
    +    -    +                          <span style={{ display: 'inline-block', animation: 'spin 1.2s linear infinite' }}>Ôö£├ÂÔö£ÔòúÔö£├½</span>
    +    -    +                        ) : (
    +    -    +                          STATUS_ICON[ps.status]
    +    -    +                        )}
    +    -    +                      </span>
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: get_build_file_content
    +    +    +# ---------------------------------------------------------------------------
    +         +
    +    -    +                      {/* Phase name + objective */}
    +    -    +                      <div style={{ flex: 1, minWidth: 0 }}>
    +    -    +                        <div style={{ fontSize: '0.8rem', fontWeight: 600, color: STATUS_COLOR[ps.status] }}>
    +    -    +                          Phase {num} Ôö£├ÂÔö£├ºÔö£├é {ps.def.name}
    +    -    +                        </div>
    +    -    +                        <div style={{ fontSize: '0.68rem', color: '#94A3B8', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    +    -    +                          {ps.def.objective}
    +    -    +                        </div>
    +    -    +                      </div>
    +    -    +
    +    -    +                      {/* Per-phase tokens (when done) */}
    +    -    +                      {ps.status === 'pass' && (ps.input_tokens > 0 || ps.output_tokens > 0) && (
    +    -    +                        <div style={{ fontSize: '0.6rem', color: '#64748B', textAlign: 'right', flexShrink: 0 }}>
    +    -    +                          <div>{ps.input_tokens.toLocaleString()} in</div>
    +    -    +                          <div>{ps.output_tokens.toLocaleString()} out</div>
    +    -    +                          {phaseElapsed && <div>{phaseElapsed}</div>}
    +    -    +                        </div>
    +    -    +                      )}
    +    -    +
    +    -    +                      {/* Expand chevron */}
    +    -    +                      <span style={{ color: '#475569', fontSize: '0.65rem', flexShrink: 0, transition: 'transform 0.15s', transform: isExp ? 'rotate(180deg)' : 'rotate(0)' }}>Ôö£├ÂÔö£Ôòù├ö├▓├ÿ</span>
    +    -    +                    </div>
    +         +
    +    -    +                    {/* Expanded deliverables */}
    +    -    +                    {isExp && ps.def.deliverables.length > 0 && (
    +    -    +                      <div style={{ paddingLeft: '40px', paddingRight: '12px', paddingBottom: '8px' }}>
    +    -    +                        {ps.def.deliverables.map((d, i) => (
    +    -    +                          <div key={i} style={{ fontSize: '0.68rem', color: '#94A3B8', paddingTop: '3px', display: 'flex', gap: '6px' }}>
    +    -    +                            <span style={{ color: '#475569' }}>Ôö£├ÂÔö£├ºÔö£Ôöé</span>
    +    -    +                            <span>{d}</span>
    +    -    +                          </div>
    +    -    +                        ))}
    +    -    +                      </div>
    +    -    +                    )}
    +    -    +                  </div>
    +    -    +                );
    +    -    +              })}
    +    -                 </div>
    +    -    -            {elapsedStr && (
    +    -    -              <div>
    +    -    -                <span style={{ color: '#94A3B8' }}>Elapsed: </span>
    +    -    -                {elapsedStr}
    +    -    +          </div>
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service.project_repo")
    +    +    +@patch("app.services.build_service.build_repo")
    +    +    +async def test_get_build_file_content(mock_build_repo, mock_project_repo, tmp_path):
    +    +    +    """get_build_file_content reads file from working directory."""
    +    +    +    # Write a file to tmp_path
    +    +    +    (tmp_path / "src").mkdir()
    +    +    +    (tmp_path / "src" / "app.py").write_text("print('hi')\n")
    +         +
    +    -    +          {/* ======== RIGHT: Metrics + Activity Feed ======== */}
    +    -    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
    +    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +    +    +        return_value=_build(status="completed", working_dir=str(tmp_path))
    +    +    +    )
    +         +
    +    -    +            {/* -- Metrics Card -- */}
    +    -    +            <div style={cardStyle}>
    +    -    +              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '16px', marginBottom: '12px' }}>
    +    -    +                <div style={metricBoxStyle}>
    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Input Tokens</span>
    +    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{totalTokens.input.toLocaleString()}</span>
    +    -    +                </div>
    +    -    +                <div style={metricBoxStyle}>
    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Output Tokens</span>
    +    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{totalTokens.output.toLocaleString()}</span>
    +    -    +                </div>
    +    -    +                <div style={metricBoxStyle}>
    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Est. Cost</span>
    +    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#22C55E' }}>${estimatedCost.toFixed(4)}</span>
    +    -    +                </div>
    +    -    +                <div style={metricBoxStyle}>
    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Elapsed</span>
    +    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{elapsedStr}</span>
    +    -    +                </div>
    +    -    +                <div style={metricBoxStyle}>
    +    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Model</span>
    +    -    +                  <span style={{ fontSize: '0.85rem', fontWeight: 600, color: '#A78BFA' }}>{buildModel}</span>
    +    -    +                </div>
    +    -    +                {(build?.loop_count ?? 0) > 0 && (
    +    -    +                  <div style={metricBoxStyle}>
    +    -    +                    <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Loopbacks</span>
    +    -    +                    <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#EAB308' }}>{build?.loop_count}</span>
    +    -    +                  </div>
    +    -    +                )}
    +    -                   </div>
    +    -    -            )}
    +    -    -            {build.loop_count > 0 && (
    +    -    -              <div>
    +    -    -                <span style={{ color: '#EAB308' }}>Loopback:</span>{' '}
    +    -    -                <span style={{ color: '#EAB308', fontWeight: 600 }}>Iteration {build.loop_count}</span>
    +    -    +
    +    -    +              {/* Context window meter */}
    +    -    +              <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    +    -    +                <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#94A3B8' }}>
    +    -    +                  <span>Context Window</span>
    +    -    +                  <span>{totalTok.toLocaleString()} / {contextWindow.toLocaleString()} ({ctxPercent.toFixed(1)}%)</span>
    +    -    +                </div>
    +    -    +                <div style={{ width: '100%', height: '8px', background: '#0F172A', borderRadius: '4px', overflow: 'hidden' }}>
    +    -    +                  <div style={{ width: `${ctxPercent}%`, height: '100%', background: ctxColor, borderRadius: '4px', transition: 'width 0.4s ease' }} />
    +    -    +                </div>
    +    -                   </div>
    +    -    -            )}
    +    -    -            {build.error_detail && (
    +    -    -              <div style={{ color: '#EF4444', flex: '1 1 100%', marginTop: '4px', fontSize: '0.75rem' }}>
    +    -    -                Error: {build.error_detail}
    +    -    +            </div>
    +    +    +    result = await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "src/app.py")
    +         +
    +    -    +            {/* -- Error banner -- */}
    +    -    +            {build?.error_detail && (
    +    -    +              <div style={{ background: '#7F1D1D', borderRadius: '6px', padding: '10px 16px', fontSize: '0.78rem', color: '#FCA5A5' }}>
    +    -    +                <strong>Error:</strong> {build.error_detail}
    +    -                   </div>
    +    -                 )}
    +    -    -          </div>
    +    -    -        )}
    +    -    -
    +    -    -        {/* Phase Progress Bar */}
    +    -    -        <div style={{ marginBottom: '20px' }}>
    +    -    -          <PhaseProgressBar phases={generatePhases()} />
    +    -    -        </div>
    +    -     
    +    -    -        {/* Audit Results */}
    +    -    -        {auditResults.length > 0 && (
    +    -    -          <div style={{ marginBottom: '20px' }}>
    +    -    -            <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#94A3B8' }}>Audit Results</h3>
    +    -    -            {auditResults.map((result, i) => (
    +    -    -              <BuildAuditCard
    +    -    -                key={i}
    +    -    -                phase={result.phase}
    +    -    -                iteration={result.iteration}
    +    -    -                checks={result.checks}
    +    -    -                overall={result.overall}
    +    -    -              />
    +    -    -            ))}
    +    -    +            {/* -- Activity Feed -- */}
    +    -    +            <div>
    +    -    +              <h3 style={{ margin: '0 0 8px', fontSize: '0.85rem', color: '#94A3B8' }}>Activity</h3>
    +    -    +              <div style={feedStyle} data-testid="build-activity-feed">
    +    -    +                {activity.length === 0 ? (
    +    -    +                  <div style={{ color: '#475569' }}>Waiting for build output...</div>
    +    -    +                ) : (
    +    -    +                  activity.map((entry, i) => (
    +    -    +                    <div key={i} style={{ color: LEVEL_COLOR[entry.level] ?? LEVEL_COLOR.info }}>
    +    -    +                      <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    +    -    +                      {entry.message}
    +    -    +                    </div>
    +    -    +                  ))
    +    -    +                )}
    +    -    +                <div ref={feedEndRef} />
    +    -    +              </div>
    +    -    +            </div>
    +    -               </div>
    +    -    -        )}
    +    -    -
    +    -    -        {/* Streaming Logs */}
    +    -    -        <div>
    +    -    -          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#94A3B8' }}>Build Logs</h3>
    +    -    -          <BuildLogViewer logs={logs} maxHeight={500} />
    +    -             </div>
    +    -           </div>
    +    -     
    +    -    diff --git a/web/src/pages/ProjectDetail.tsx b/web/src/pages/ProjectDetail.tsx
    +    -    index bbb2777..78a0f36 100644
    +    -    --- a/web/src/pages/ProjectDetail.tsx
    +    -    +++ b/web/src/pages/ProjectDetail.tsx
    +    -    @@ -13,6 +13,28 @@ import QuestionnaireModal from '../components/QuestionnaireModal';
    +    -     
    +    -     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    +    +    assert result["path"] == "src/app.py"
    +    +    +    assert "print('hi')" in result["content"]
    +    +    +    assert result["language"] == "python"
         +    +
         +    +
    -    +    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    -    +    +def test_save_api_key(mock_get_user, mock_set_key):
    -    +    +    mock_get_user.return_value = _USER_DICT
    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    -    +    +    response = client.put(
    -    +    +        "/auth/api-key",
    -    +    +        json={"api_key": "sk-ant-api03-test"},
    -    +    +        headers={"Authorization": f"Bearer {token}"},
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service.project_repo")
    +    +    +@patch("app.services.build_service.build_repo")
    +    +    +async def test_get_build_file_content_traversal(mock_build_repo, mock_project_repo, tmp_path):
    +    +    +    """get_build_file_content rejects directory traversal paths."""
    +    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +    +    +        return_value=_build(status="completed", working_dir=str(tmp_path))
         +    +    )
    -    +    +    assert response.status_code == 200
    -    +    +    assert response.json()["saved"] is True
    -    +    +    mock_set_key.assert_called_once()
         +    +
    +    +    +    with pytest.raises(ValueError, match="Invalid file path"):
    +    +    +        await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "../../../etc/passwd")
         +    +
    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    -    +    +def test_save_api_key_empty_rejected(mock_get_user):
    -    +    +    mock_get_user.return_value = _USER_DICT
    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    -    +    +    response = client.put(
    -    +    +        "/auth/api-key",
    -    +    +        json={"api_key": "   "},
    -    +    +        headers={"Authorization": f"Bearer {token}"},
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service.project_repo")
    +    +    +@patch("app.services.build_service.build_repo")
    +    +    +async def test_get_build_file_content_not_found(mock_build_repo, mock_project_repo, tmp_path):
    +    +    +    """get_build_file_content raises ValueError for non-existent file."""
    +    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +    +    +        return_value=_build(status="completed", working_dir=str(tmp_path))
         +    +    )
    -    +    +    assert response.status_code == 400
         +    +
    +    +    +    with pytest.raises(ValueError, match="File not found"):
    +    +    +        await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "nonexistent.py")
         +    +
    -    +    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    -    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    -    +    +def test_remove_api_key(mock_get_user, mock_set_key):
    -    +    +    mock_get_user.return_value = _USER_DICT
    -    +    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    -    +    +    response = client.delete(
    -    +    +        "/auth/api-key",
    -    +    +        headers={"Authorization": f"Bearer {token}"},
    -    +    +    )
    -    +    +    assert response.status_code == 200
    -    +    +    assert response.json()["removed"] is True
    -    +    +    mock_set_key.assert_called_once()
    -    +    diff --git a/tests/test_build_service.py b/tests/test_build_service.py
    -    +    index 1c7792e..9861a64 100644
    -    +    --- a/tests/test_build_service.py
    -    +    +++ b/tests/test_build_service.py
    -    +    @@ -63,7 +63,8 @@ def _build(**overrides):
    -    +     @patch("app.services.build_service.asyncio.create_task")
    -    +     @patch("app.services.build_service.project_repo")
    -    +     @patch("app.services.build_service.build_repo")
    -    +    -async def test_start_build_success(mock_build_repo, mock_project_repo, mock_create_task):
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: start_build with target params
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service.asyncio.create_task")
    +    +    +@patch("app.services.build_service.project_repo")
    +    +    +@patch("app.services.build_service.build_repo")
         +    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    -    +    +async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    -    +         """start_build creates a build record and spawns a background task."""
    -    +         mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    -    +         mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    -    +    @@ -71,6 +72,7 @@ async def test_start_build_success(mock_build_repo, mock_project_repo, mock_crea
    -    +         mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    -    +         mock_build_repo.create_build = AsyncMock(return_value=_build())
    -    +         mock_create_task.return_value = MagicMock()
    +    +    +async def test_start_build_invalid_target_type(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    +    +    """start_build rejects invalid target_type."""
    +    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
         +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    -    +     
    -    +         result = await build_service.start_build(_PROJECT_ID, _USER_ID)
    -    +     
    -    +    @@ -133,6 +135,21 @@ async def test_start_build_already_running(mock_build_repo, mock_project_repo):
    -    +             await build_service.start_build(_PROJECT_ID, _USER_ID)
    -    +     
    -    +     
    +    +    +
    +    +    +    with pytest.raises(ValueError, match="Invalid target_type"):
    +    +    +        await build_service.start_build(_PROJECT_ID, _USER_ID, target_type="invalid_type")
    +    +    +
    +    +    +
         +    +@pytest.mark.asyncio
    +    +    +@patch("app.services.build_service.asyncio.create_task")
         +    +@patch("app.services.build_service.project_repo")
         +    +@patch("app.services.build_service.build_repo")
         +    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    -    +    +async def test_start_build_no_api_key(mock_get_user, mock_build_repo, mock_project_repo):
    -    +    +    """start_build raises ValueError when user has no Anthropic API key."""
    +    +    +async def test_start_build_target_type_without_ref(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    +    +    """start_build raises ValueError when target_type given without target_ref."""
         +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
         +    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
         +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    -    +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": None}
    +    +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
         +    +
    -    +    +    with pytest.raises(ValueError, match="API key required"):
    -    +    +        await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    +    +    with pytest.raises(ValueError, match="target_ref is required"):
    +    +    +        await build_service.start_build(_PROJECT_ID, _USER_ID, target_type="local_path")
    +    +    diff --git a/tests/test_builds_router.py b/tests/test_builds_router.py
    +    +    index cea1ab7..42ea0d3 100644
    +    +    --- a/tests/test_builds_router.py
    +    +    +++ b/tests/test_builds_router.py
    +    +    @@ -81,7 +81,10 @@ def test_start_build(mock_get_user, mock_start, client):
    +    +     
    +    +         assert resp.status_code == 200
    +    +         assert resp.json()["status"] == "pending"
    +    +    -    mock_start.assert_called_once_with(_PROJECT_ID, _USER["id"])
    +    +    +    mock_start.assert_called_once_with(
    +    +    +        _PROJECT_ID, _USER["id"],
    +    +    +        target_type=None, target_ref=None,
    +    +    +    )
    +          
    +    -    +const needsKeyBanner = (
    +    -    +  <div style={{
    +    -    +    background: '#1E293B',
    +    -    +    border: '1px solid #92400E',
    +    -    +    borderRadius: '6px',
    +    -    +    padding: '10px 16px',
    +    -    +    marginBottom: '16px',
    +    -    +    fontSize: '0.8rem',
    +    -    +    color: '#FBBF24',
    +    -    +    display: 'flex',
    +    -    +    alignItems: 'center',
    +    -    +    gap: '10px',
    +    -    +  }}>
    +    -    +    <span style={{ fontSize: '1rem' }}>Ôö¼┬í├ú├åÔö£├éÔö£┬¬</span>
    +    -    +    <span>
    +    -    +      Add your Anthropic API key in{' '}
    +    -    +      <Link to="/settings" style={{ color: '#60A5FA', textDecoration: 'underline' }}>Settings</Link>{' '}
    +    -    +      to start a build. Questionnaires and audits are free.
    +    -    +    </span>
    +    -    +  </div>
    +    -    +);
    +    -    +
    +    -     interface ProjectDetailData {
    +    -       id: string;
    +    -       name: string;
    +    -    @@ -34,7 +56,7 @@ interface ProjectDetailData {
    +          
    +    -     function ProjectDetail() {
    +    -       const { projectId } = useParams<{ projectId: string }>();
    +    -    -  const { token } = useAuth();
    +    -    +  const { user, token } = useAuth();
    +    -       const { addToast } = useToast();
    +    -       const navigate = useNavigate();
    +    -       const [project, setProject] = useState<ProjectDetailData | null>(null);
    +    -    @@ -282,6 +304,9 @@ function ProjectDetail() {
    +    -               </div>
    +    -             </div>
    +    +     @patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    +    +    @@ -327,3 +330,127 @@ def test_start_build_rate_limited(mock_get_user, mock_start, mock_limiter, clien
    +          
    +    -    +        {/* BYOK warning */}
    +    -    +        {hasContracts && !buildActive && !(user?.has_anthropic_key) && needsKeyBanner}
    +    +         assert resp.status_code == 429
    +    +         mock_start.assert_not_called()
         +    +
         +    +
    -    +     # ---------------------------------------------------------------------------
    -    +     # Tests: cancel_build
    -    +     # ---------------------------------------------------------------------------
    -    +    @@ -431,3 +448,21 @@ async def test_record_phase_cost(mock_build_repo):
    -    +         mock_build_repo.record_build_cost.assert_called_once()
    -    +         assert usage.input_tokens == 0
    -    +         assert usage.output_tokens == 0
    -    +    +
    -    +    +
    -    +    +def test_get_token_rates_model_aware():
    -    +    +    """_get_token_rates returns correct pricing per model family."""
    -    +    +    from decimal import Decimal
    -    +    +
    -    +    +    opus_in, opus_out = build_service._get_token_rates("claude-opus-4-6")
    -    +    +    assert opus_in == Decimal("0.000015")
    -    +    +    assert opus_out == Decimal("0.000075")
    -    +    +
    -    +    +    haiku_in, haiku_out = build_service._get_token_rates("claude-haiku-4-5-20251001")
    -    +    +    assert haiku_in == Decimal("0.000001")
    -    +    +    assert haiku_out == Decimal("0.000005")
    -    +    +
    -    +    +    # Unknown model falls back to Opus (safest = most expensive)
    -    +    +    unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
    -    +    +    assert unk_in == Decimal("0.000015")
    -    +    +    assert unk_out == Decimal("0.000075")
    -    +    diff --git a/tests/test_llm_client.py b/tests/test_llm_client.py
    -    +    index c7c4f8e..4f323a2 100644
    -    +    --- a/tests/test_llm_client.py
    -    +    +++ b/tests/test_llm_client.py
    -    +    @@ -34,6 +34,7 @@ async def test_chat_success(mock_client_cls):
    -    +             "content": [{"type": "text", "text": "Hello from Haiku!"}],
    -    +             "model": "claude-3-5-haiku-20241022",
    -    +             "role": "assistant",
    -    +    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    -    +         })
    -    +         mock_client_cls.return_value = mock_client
    -    +     
    -    +    @@ -44,7 +45,9 @@ async def test_chat_success(mock_client_cls):
    -    +             messages=[{"role": "user", "content": "Hi"}],
    -    +         )
    -    +     
    -    +    -    assert result == "Hello from Haiku!"
    -    +    +    assert result["text"] == "Hello from Haiku!"
    -    +    +    assert result["usage"]["input_tokens"] == 10
    -    +    +    assert result["usage"]["output_tokens"] == 20
    -    +         mock_client.post.assert_called_once()
    -    +         call_kwargs = mock_client.post.call_args
    -    +         body = call_kwargs.kwargs["json"] if "json" in call_kwargs.kwargs else call_kwargs[1]["json"]
    -    +    @@ -141,6 +144,7 @@ async def test_chat_openai_success(mock_client_cls):
    -    +         """Successful OpenAI chat returns message content."""
    -    +         mock_client = _make_mock_client({
    -    +             "choices": [{"message": {"role": "assistant", "content": "Hello from GPT!"}}],
    -    +    +        "usage": {"prompt_tokens": 5, "completion_tokens": 15},
    -    +         })
    -    +         mock_client_cls.return_value = mock_client
    -    +     
    -    +    @@ -151,7 +155,9 @@ async def test_chat_openai_success(mock_client_cls):
    -    +             messages=[{"role": "user", "content": "Hi"}],
    -    +         )
    -    +     
    -    +    -    assert result == "Hello from GPT!"
    -    +    +    assert result["text"] == "Hello from GPT!"
    -    +    +    assert result["usage"]["input_tokens"] == 5
    -    +    +    assert result["usage"]["output_tokens"] == 15
    -    +         call_kwargs = mock_client.post.call_args
    -    +         body = call_kwargs.kwargs.get("json", call_kwargs[1].get("json", {}))
    -    +         assert body["model"] == "gpt-4o"
    -    +    @@ -226,6 +232,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    -    +         """chat(provider='openai') routes to OpenAI endpoint."""
    -    +         mock_client = _make_mock_client({
    -    +             "choices": [{"message": {"role": "assistant", "content": "dispatched"}}],
    -    +    +        "usage": {"prompt_tokens": 0, "completion_tokens": 0},
    -    +         })
    -    +         mock_client_cls.return_value = mock_client
    -    +     
    -    +    @@ -237,7 +244,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    -    +             provider="openai",
    -    +         )
    -    +     
    -    +    -    assert result == "dispatched"
    -    +    +    assert result["text"] == "dispatched"
    -    +         call_kwargs = mock_client.post.call_args
    -    +         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    -    +         assert "openai.com" in url
    -    +    @@ -249,6 +256,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    -    +         """chat() defaults to Anthropic."""
    -    +         mock_client = _make_mock_client({
    -    +             "content": [{"type": "text", "text": "default"}],
    -    +    +        "usage": {"input_tokens": 0, "output_tokens": 0},
    -    +         })
    -    +         mock_client_cls.return_value = mock_client
    -    +     
    -    +    @@ -259,7 +267,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    -    +             messages=[{"role": "user", "content": "Hi"}],
    -    +         )
    -    +     
    -    +    -    assert result == "default"
    -    +    +    assert result["text"] == "default"
    -    +         call_kwargs = mock_client.post.call_args
    -    +         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    -    +         assert "anthropic.com" in url
    -    +    diff --git a/tests/test_project_service.py b/tests/test_project_service.py
    -    +    index 1957ba3..1b410b3 100644
    -    +    --- a/tests/test_project_service.py
    -    +    +++ b/tests/test_project_service.py
    -    +    @@ -191,17 +191,22 @@ async def test_process_questionnaire_first_message(
    -    +             "status": "draft",
    -    +             "questionnaire_state": {},
    -    +         }
    -    +    -    mock_llm.return_value = json.dumps({
    -    +    -        "reply": "Tell me about your product.",
    -    +    -        "section": "product_intent",
    -    +    -        "section_complete": False,
    -    +    -        "extracted_data": None,
    -    +    -    })
    -    +    +    mock_llm.return_value = {
    -    +    +        "text": json.dumps({
    -    +    +            "reply": "Tell me about your product.",
    -    +    +            "section": "product_intent",
    -    +    +            "section_complete": False,
    -    +    +            "extracted_data": None,
    -    +    +        }),
    -    +    +        "usage": {"input_tokens": 50, "output_tokens": 30},
    -    +    +    }
    -    +     
    -    +         result = await process_questionnaire_message(USER_ID, PROJECT_ID, "Hi")
    -    +     
    -    +         assert result["reply"] == "Tell me about your product."
    -    +         assert result["is_complete"] is False
    -    +    +    assert result["token_usage"]["input_tokens"] == 50
    -    +    +    assert result["token_usage"]["output_tokens"] == 30
    -    +         mock_status.assert_called_once()  # draft -> questionnaire
    -    +     
    -    +     
    -    +    @@ -255,10 +260,11 @@ async def test_process_questionnaire_already_complete(mock_project):
    -    +     
    -    +     
    -    +     @pytest.mark.asyncio
    -    +    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    -    +     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    -    +     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    -    +     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    -    +    -async def test_generate_contracts_success(mock_project, mock_upsert, mock_status):
    -    +    +async def test_generate_contracts_success(mock_project, mock_upsert, mock_status, mock_ws):
    -    +         mock_project.return_value = {
    -    +             "id": PROJECT_ID,
    -    +             "user_id": USER_ID,
    -    +    diff --git a/tests/test_projects_router.py b/tests/test_projects_router.py
    -    +    index 862c16d..dc7c5ff 100644
    -    +    --- a/tests/test_projects_router.py
    -    +    +++ b/tests/test_projects_router.py
    -    +    @@ -21,7 +21,7 @@ def _set_test_config(monkeypatch):
    -    +         monkeypatch.setattr("app.config.settings.APP_URL", "http://localhost:8000")
    -    +         monkeypatch.setattr("app.config.settings.GITHUB_WEBHOOK_SECRET", "whsec_test")
    -    +         monkeypatch.setattr("app.config.settings.ANTHROPIC_API_KEY", "test-api-key")
    -    +    -    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022")
    -    +    +    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5")
    -    +     
    -    +     
    -    +     USER_ID = "22222222-2222-2222-2222-222222222222"
    -    +    @@ -248,7 +248,10 @@ def test_questionnaire_message(
    -    +             "status": "draft",
    -    +             "questionnaire_state": {},
    -    +         }
    -    +    -    mock_llm.return_value = '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}'
    -    +    +    mock_llm.return_value = {
    -    +    +        "text": '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}',
    -    +    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: POST /projects/{id}/build with target params
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@patch("app.api.routers.builds.build_limiter")
    +    +    +@patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    +    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    +def test_start_build_with_target(mock_get_user, mock_start, mock_limiter, client):
    +    +    +    """POST /projects/{id}/build with target_type and target_ref."""
    +    +    +    mock_get_user.return_value = _USER
    +    +    +    mock_start.return_value = _build()
    +    +    +    mock_limiter.is_allowed.return_value = True
    +    +    +
    +    +    +    resp = client.post(
    +    +    +        f"/projects/{_PROJECT_ID}/build",
    +    +    +        headers=_auth_header(),
    +    +    +        json={"target_type": "local_path", "target_ref": "/tmp/test"},
    +    +    +    )
    +    +    +
    +    +    +    assert resp.status_code == 200
    +    +    +    mock_start.assert_called_once()
    +    +    +    call_kwargs = mock_start.call_args
    +    +    +    assert call_kwargs.kwargs.get("target_type") == "local_path"
    +    +    +    assert call_kwargs.kwargs.get("target_ref") == "/tmp/test"
    +    +    +
    +    +    +
    +    +    +@patch("app.api.routers.builds.build_limiter")
    +    +    +@patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    +    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    +def test_start_build_with_github_target(mock_get_user, mock_start, mock_limiter, client):
    +    +    +    """POST /projects/{id}/build with github_new target."""
    +    +    +    mock_get_user.return_value = _USER
    +    +    +    mock_start.return_value = _build()
    +    +    +    mock_limiter.is_allowed.return_value = True
    +    +    +
    +    +    +    resp = client.post(
    +    +    +        f"/projects/{_PROJECT_ID}/build",
    +    +    +        headers=_auth_header(),
    +    +    +        json={"target_type": "github_new", "target_ref": "my-new-repo"},
    +    +    +    )
    +    +    +
    +    +    +    assert resp.status_code == 200
    +    +    +    mock_start.assert_called_once()
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: GET /projects/{id}/build/files
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@patch("app.api.routers.builds.build_service.get_build_files", new_callable=AsyncMock)
    +    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    +def test_get_build_files(mock_get_user, mock_files, client):
    +    +    +    """GET /projects/{id}/build/files returns file list."""
    +    +    +    mock_get_user.return_value = _USER
    +    +    +    mock_files.return_value = [
    +    +    +        {"path": "src/main.py", "size_bytes": 42, "language": "python", "created_at": "2025-01-01T00:00:00Z"},
    +    +    +        {"path": "package.json", "size_bytes": 200, "language": "json", "created_at": "2025-01-01T00:00:01Z"},
    +    +    +    ]
    +    +    +
    +    +    +    resp = client.get(f"/projects/{_PROJECT_ID}/build/files", headers=_auth_header())
    +    +    +
    +    +    +    assert resp.status_code == 200
    +    +    +    data = resp.json()
    +    +    +    assert len(data["items"]) == 2
    +    +    +    assert data["items"][0]["path"] == "src/main.py"
    +    +    +
    +         +
    +    -             {/* Build Actions */}
    +    -             <div style={{ display: 'flex', gap: '12px', marginBottom: '24px' }}>
    +    -               {!buildActive && (
    +    -    diff --git a/web/src/pages/Settings.tsx b/web/src/pages/Settings.tsx
    +    +    +@patch("app.api.routers.builds.build_service.get_build_files", new_callable=AsyncMock)
    +    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    +def test_get_build_files_not_found(mock_get_user, mock_files, client):
    +    +    +    """GET /projects/{id}/build/files returns 404 for missing project."""
    +    +    +    mock_get_user.return_value = _USER
    +    +    +    mock_files.side_effect = ValueError("Project not found")
    +    +    +
    +    +    +    resp = client.get(f"/projects/{_PROJECT_ID}/build/files", headers=_auth_header())
    +    +    +
    +    +    +    assert resp.status_code == 404
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: GET /projects/{id}/build/files/{path}
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@patch("app.api.routers.builds.build_service.get_build_file_content", new_callable=AsyncMock)
    +    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    +def test_get_build_file_content(mock_get_user, mock_content, client):
    +    +    +    """GET /projects/{id}/build/files/{path} returns file content."""
    +    +    +    mock_get_user.return_value = _USER
    +    +    +    mock_content.return_value = {
    +    +    +        "path": "src/main.py",
    +    +    +        "content": "print('hello')\n",
    +    +    +        "size_bytes": 16,
    +    +    +        "language": "python",
         +    +    }
    -    +     
    -    +         resp = client.post(
    -    +             f"/projects/{PROJECT_ID}/questionnaire",
    -    +    @@ -332,8 +335,9 @@ def test_generate_contracts_incomplete(mock_project, mock_get_user):
    -    +     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    -    +     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    -    +     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    -    +    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    -    +     def test_generate_contracts_success(
    -    +    -    mock_status, mock_upsert, mock_project, mock_get_user
    -    +    +    mock_ws, mock_status, mock_upsert, mock_project, mock_get_user
    -    +     ):
    -    +         mock_get_user.return_value = MOCK_USER
    -    +         all_sections = [
    -    +    diff --git a/web/src/App.tsx b/web/src/App.tsx
    -    +    index 7a6f811..8eadcd4 100644
    -    +    --- a/web/src/App.tsx
    -    +    +++ b/web/src/App.tsx
    -    +    @@ -7,6 +7,7 @@ import AuditDetailPage from './pages/AuditDetail';
    -    +     import ProjectDetail from './pages/ProjectDetail';
    -    +     import BuildProgress from './pages/BuildProgress';
    -    +     import BuildComplete from './pages/BuildComplete';
    -    +    +import Settings from './pages/Settings';
    -    +     import { AuthProvider, useAuth } from './context/AuthContext';
    -    +     import { ToastProvider } from './context/ToastContext';
    -    +     
    -    +    @@ -72,6 +73,14 @@ function App() {
    -    +                     </ProtectedRoute>
    -    +                   }
    -    +                 />
    -    +    +            <Route
    -    +    +              path="/settings"
    -    +    +              element={
    -    +    +                <ProtectedRoute>
    -    +    +                  <Settings />
    -    +    +                </ProtectedRoute>
    -    +    +              }
    -    +    +            />
    -    +                 <Route path="*" element={<Navigate to="/" replace />} />
    -    +               </Routes>
    -    +             </BrowserRouter>
    -    +    diff --git a/web/src/__tests__/App.test.tsx b/web/src/__tests__/App.test.tsx
    -    +    index 7678f4e..0d8a335 100644
    -    +    --- a/web/src/__tests__/App.test.tsx
    -    +    +++ b/web/src/__tests__/App.test.tsx
    -    +    @@ -298,7 +298,7 @@ describe('QuestionnaireModal', () => {
    -    +         expect(onClose).toHaveBeenCalled();
    -    +       });
    -    +     
    -    +    -  it('has a voice toggle button', () => {
    -    +    +  it('has a restart button', () => {
    -    +         render(
    -    +           <QuestionnaireModal
    -    +             projectId="test-id"
    -    +    @@ -307,7 +307,7 @@ describe('QuestionnaireModal', () => {
    -    +             onContractsGenerated={() => {}}
    -    +           />,
    -    +         );
    -    +    -    expect(screen.getByTestId('voice-toggle')).toBeInTheDocument();
    -    +    +    expect(screen.getByTestId('restart-btn')).toBeInTheDocument();
    -    +       });
    -    +     
    -    +       it('shows generate banner when questionnaire is complete', async () => {
    -    +    diff --git a/web/src/components/AppShell.tsx b/web/src/components/AppShell.tsx
    -    +    index 47a1098..b8f1f3c 100644
    -    +    --- a/web/src/components/AppShell.tsx
    -    +    +++ b/web/src/components/AppShell.tsx
    -    +    @@ -103,7 +103,6 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    -    +                   style={{ width: 28, height: 28, borderRadius: '50%' }}
    -    +                 />
    -    +               )}
    -    +    -          <span style={{ color: '#94A3B8', fontSize: '0.85rem' }}>{user?.github_login}</span>
    -    +               <button
    -    +                 onClick={logout}
    -    +                 style={{
    -    +    @@ -192,11 +191,50 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    -    +                     marginTop: 'auto',
    -    +                     padding: '12px 16px',
    -    +                     borderTop: '1px solid #1E293B',
    -    +    -                color: '#64748B',
    -    +    -                fontSize: '0.7rem',
    -    +    +                display: 'flex',
    -    +    +                alignItems: 'center',
    -    +    +                justifyContent: 'space-between',
    -    +                   }}
    -    +                 >
    -    +    -              v0.1.0
    -    +    +              <div
    -    +    +                onClick={() => navigate('/settings')}
    -    +    +                style={{
    -    +    +                  display: 'flex',
    -    +    +                  alignItems: 'center',
    -    +    +                  gap: '8px',
    -    +    +                  cursor: 'pointer',
    -    +    +                  flex: 1,
    -    +    +                  minWidth: 0,
    -    +    +                }}
    -    +    +                title={user?.github_login ?? 'Settings'}
    -    +    +              >
    -    +    +                {user?.avatar_url && (
    -    +    +                  <img
    -    +    +                    src={user.avatar_url}
    -    +    +                    alt={user.github_login}
    -    +    +                    style={{ width: 22, height: 22, borderRadius: '50%', flexShrink: 0 }}
    -    +    +                  />
    -    +    +                )}
    -    +    +                <span style={{ color: '#CBD5E1', fontSize: '0.75rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    -    +    +                  {user?.github_login}
    -    +    +                </span>
    -    +    +              </div>
    -    +    +              <button
    -    +    +                onClick={() => navigate('/settings')}
    -    +    +                title="Settings"
    -    +    +                style={{
    -    +    +                  background: 'transparent',
    -    +    +                  border: 'none',
    -    +    +                  color: '#64748B',
    -    +    +                  cursor: 'pointer',
    -    +    +                  fontSize: '0.95rem',
    -    +    +                  padding: '4px',
    -    +    +                  flexShrink: 0,
    -    +    +                  lineHeight: 1,
    -    +    +                }}
    -    +    +              >
    -    +    +                Ôö£├ÂÔö£┬úÔö£├╗
    -    +    +              </button>
    -    +                 </div>
    -    +               </aside>
    -    +             )}
    -    +    diff --git a/web/src/components/ContractProgress.tsx b/web/src/components/ContractProgress.tsx
    +    +    +
    +    +    +    resp = client.get(
    +    +    +        f"/projects/{_PROJECT_ID}/build/files/src/main.py",
    +    +    +        headers=_auth_header(),
    +    +    +    )
    +    +    +
    +    +    +    assert resp.status_code == 200
    +    +    +    data = resp.json()
    +    +    +    assert data["path"] == "src/main.py"
    +    +    +    assert "print('hello')" in data["content"]
    +    +    +
    +    +    +
    +    +    +@patch("app.api.routers.builds.build_service.get_build_file_content", new_callable=AsyncMock)
    +    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +    +def test_get_build_file_content_not_found(mock_get_user, mock_content, client):
    +    +    +    """GET /projects/{id}/build/files/{path} returns 404 for missing file."""
    +    +    +    mock_get_user.return_value = _USER
    +    +    +    mock_content.side_effect = ValueError("File not found: nonexistent.py")
    +    +    +
    +    +    +    resp = client.get(
    +    +    +        f"/projects/{_PROJECT_ID}/build/files/nonexistent.py",
    +    +    +        headers=_auth_header(),
    +    +    +    )
    +    +    +
    +    +    +    assert resp.status_code == 404
    +    +    diff --git a/tests/test_git_client.py b/tests/test_git_client.py
    +         new file mode 100644
    +    -    index 0000000..29c213d
    +    +    index 0000000..ed053e1
    +         --- /dev/null
    +    -    +++ b/web/src/pages/Settings.tsx
    +    -    @@ -0,0 +1,280 @@
    +    +    +++ b/tests/test_git_client.py
    +    +    @@ -0,0 +1,177 @@
    +    +    +"""Tests for app/clients/git_client.py -- thin async git wrapper."""
    +    +    +
    +    +    +import asyncio
    +    +    +from unittest.mock import AsyncMock, patch, MagicMock
    +    +    +
    +    +    +import pytest
    +    +    +
    +    +    +from app.clients import git_client
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Helpers
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +def _mock_process(returncode: int = 0, stdout: str = "", stderr: str = ""):
    +    +    +    proc = AsyncMock()
    +    +    +    proc.returncode = returncode
    +    +    +    proc.communicate = AsyncMock(return_value=(stdout.encode(), stderr.encode()))
    +    +    +    return proc
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: _run_git
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client.asyncio.create_subprocess_exec")
    +    +    +async def test_run_git_success(mock_exec):
    +    +    +    """_run_git runs a command and returns stdout."""
    +    +    +    mock_exec.return_value = _mock_process(0, "ok", "")
    +    +    +
    +    +    +    result = await git_client._run_git(["status"], cwd="/tmp/test")
    +    +    +
    +    +    +    mock_exec.assert_called_once()
    +    +    +    assert result == "ok"
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client.asyncio.create_subprocess_exec")
    +    +    +async def test_run_git_failure(mock_exec):
    +    +    +    """_run_git raises RuntimeError on non-zero exit."""
    +    +    +    mock_exec.return_value = _mock_process(128, "", "fatal: not a git repo")
    +    +    +
    +    +    +    with pytest.raises(RuntimeError, match="not a git repo"):
    +    +    +        await git_client._run_git(["status"], cwd="/tmp/test")
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: init_repo
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +    +async def test_init_repo(mock_run):
    +    +    +    """init_repo runs git init and sets committer identity."""
    +    +    +    await git_client.init_repo("/tmp/test")
    +    +    +
    +    +    +    # Should make multiple calls (init + config)
    +    +    +    assert mock_run.call_count >= 1
    +    +    +    # First call should be 'init'
    +    +    +    first_args = mock_run.call_args_list[0][0][0]
    +    +    +    assert "init" in first_args
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: add_all
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +    +async def test_add_all(mock_run):
    +    +    +    """add_all stages all changes."""
    +    +    +    await git_client.add_all("/tmp/test")
    +    +    +
    +    +    +    mock_run.assert_called_once()
    +    +    +    args = mock_run.call_args[0][0]  # First positional arg is the command list
    +    +    +    assert "add" in args
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: commit
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +    +async def test_commit(mock_run):
    +    +    +    """commit runs git commit with the given message."""
    +    +    +    await git_client.commit("/tmp/test", "test commit")
    +    +    +
    +    +    +    # commit may call _run_git multiple times (status check + commit)
    +    +    +    assert mock_run.call_count >= 1
    +    +    +    # Find the call that includes 'commit'
    +    +    +    commit_calls = [c for c in mock_run.call_args_list if "commit" in c[0][0]]
    +    +    +    assert len(commit_calls) >= 1
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: clone_repo
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +    +async def test_clone_repo(mock_run):
    +    +    +    """clone_repo clones with access token injected into URL."""
    +    +    +    await git_client.clone_repo("https://github.com/owner/repo.git", "/tmp/dest", access_token="ghp_testtoken")
    +    +    +
    +    +    +    mock_run.assert_called_once()
    +    +    +    args = mock_run.call_args[0][0]  # command list
    +    +    +    assert "clone" in args
    +    +    +    # Token should be in the URL arg
    +    +    +    url_arg = [a for a in args if "github.com" in str(a)]
    +    +    +    assert len(url_arg) > 0
    +    +    +    assert "ghp_testtoken" in str(url_arg[0])
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: push
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +    +async def test_push(mock_run):
    +    +    +    """push runs git push."""
    +    +    +    await git_client.push("/tmp/test")
    +    +    +
    +    +    +    mock_run.assert_called_once()
    +    +    +    args = mock_run.call_args[0][0]
    +    +    +    assert "push" in args
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: set_remote
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +    +async def test_set_remote(mock_run):
    +    +    +    """set_remote sets the origin remote."""
    +    +    +    await git_client.set_remote("/tmp/test", "https://github.com/owner/repo.git")
    +    +    +
    +    +    +    mock_run.assert_called_once()
    +    +    +    args = mock_run.call_args[0][0]
    +    +    +    assert "remote" in args
    +    +    +
    +    +    +
    +    +    +# ---------------------------------------------------------------------------
    +    +    +# Tests: get_file_list
    +    +    +# ---------------------------------------------------------------------------
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +    +async def test_get_file_list(mock_run):
    +    +    +    """get_file_list returns list of tracked files."""
    +    +    +    mock_run.return_value = "file1.py\nfile2.ts\n"
    +    +    +
    +    +    +    result = await git_client.get_file_list("/tmp/test")
    +    +    +
    +    +    +    assert result == ["file1.py", "file2.ts"]
    +    +    +
    +    +    +
    +    +    +@pytest.mark.asyncio
    +    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +    +async def test_get_file_list_empty(mock_run):
    +    +    +    """get_file_list returns empty list when no files."""
    +    +    +    mock_run.return_value = ""
    +    +    +
    +    +    +    result = await git_client.get_file_list("/tmp/test")
    +    +    +
    +    +    +    assert result == []
    +    +    diff --git a/web/src/__tests__/BuildTargetModal.test.tsx b/web/src/__tests__/BuildTargetModal.test.tsx
         +    new file mode 100644
    -    +    index 0000000..821fec7
    +    +    index 0000000..432c75d
         +    --- /dev/null
    -    +    +++ b/web/src/components/ContractProgress.tsx
    -    +    @@ -0,0 +1,294 @@
    -    +    +/**
    -    +    + * ContractProgress -- live step-by-step contract generation progress panel.
    -    +    + *
    -    +    + * Shows each contract being generated with status indicators, a running log,
    -    +    + * context window meter, and cumulative token usage from the questionnaire.
    -    +    + */
    -    +    +import { useState, useEffect, useRef, useCallback } from 'react';
    -    +    +import { useAuth } from '../context/AuthContext';
    -    +    +import { useWebSocket } from '../hooks/useWebSocket';
    -    +    +
    -    +    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -    +    +
    -    +    +/* ------------------------------------------------------------------ */
    -    +    +/*  Contract type labels                                              */
    -    +    +/* ------------------------------------------------------------------ */
    -    +    +
    -    +    +const CONTRACT_LABELS: Record<string, string> = {
    -    +    +  blueprint: 'Blueprint',
    -    +    +  manifesto: 'Manifesto',
    -    +    +  stack: 'Stack',
    -    +    +  schema: 'Schema',
    -    +    +  physics: 'Physics',
    -    +    +  boundaries: 'Boundaries',
    -    +    +  phases: 'Phases',
    -    +    +  ui: 'UI',
    -    +    +  builder_contract: 'Builder Contract',
    -    +    +  builder_directive: 'Builder Directive',
    -    +    +};
    +    +    +++ b/web/src/__tests__/BuildTargetModal.test.tsx
    +    +    @@ -0,0 +1,99 @@
    +    +    +import { describe, it, expect, vi, beforeEach } from 'vitest';
    +    +    +import { render, screen, fireEvent } from '@testing-library/react';
    +    +    +import BuildTargetModal from '../components/BuildTargetModal';
         +    +
    -    +    +const ALL_CONTRACTS = Object.keys(CONTRACT_LABELS);
    +    +    +describe('BuildTargetModal', () => {
    +    +    +  const mockConfirm = vi.fn();
    +    +    +  const mockCancel = vi.fn();
         +    +
    -    +    +/* ------------------------------------------------------------------ */
    -    +    +/*  Context window constants                                          */
    -    +    +/* ------------------------------------------------------------------ */
    +    +    +  beforeEach(() => {
    +    +    +    vi.clearAllMocks();
    +    +    +  });
         +    +
    -    +    +const MODEL_CONTEXT_WINDOWS: Record<string, number> = {
    -    +    +  'claude-haiku-4-5': 200_000,
    -    +    +  'claude-sonnet-4-5': 200_000,
    -    +    +  'claude-opus-4-6': 200_000,
    -    +    +  'gpt-4o': 128_000,
    -    +    +};
    -    +    +const DEFAULT_CONTEXT_WINDOW = 200_000;
    +    +    +  it('renders three target options', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    expect(screen.getByText('New GitHub Repo')).toBeInTheDocument();
    +    +    +    expect(screen.getByText('Existing GitHub Repo')).toBeInTheDocument();
    +    +    +    expect(screen.getByText('Local Directory')).toBeInTheDocument();
    +    +    +  });
         +    +
    -    +    +/* ------------------------------------------------------------------ */
    -    +    +/*  Types                                                             */
    -    +    +/* ------------------------------------------------------------------ */
    +    +    +  it('renders the Build Target title', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    expect(screen.getByText('Build Target')).toBeInTheDocument();
    +    +    +  });
         +    +
    -    +    +interface TokenUsage {
    -    +    +  input_tokens: number;
    -    +    +  output_tokens: number;
    -    +    +}
    +    +    +  it('shows correct placeholder for github_new (default)', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    +    expect(input.placeholder).toBe('my-new-project');
    +    +    +  });
    +    +    +
    +    +    +  it('changes placeholder when selecting existing repo', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    fireEvent.click(screen.getByTestId('target-github_existing'));
    +    +    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    +    expect(input.placeholder).toBe('owner/repo-name');
    +    +    +  });
    +    +    +
    +    +    +  it('changes placeholder when selecting local path', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    fireEvent.click(screen.getByTestId('target-local_path'));
    +    +    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    +    expect(input.placeholder).toContain('Projects');
    +    +    +  });
    +    +    +
    +    +    +  it('disables Start Build when input is empty', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    const btn = screen.getByTestId('target-confirm-btn');
    +    +    +    expect(btn).toBeDisabled();
    +    +    +  });
    +    +    +
    +    +    +  it('enables Start Build when input has value', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    const input = screen.getByTestId('target-ref-input');
    +    +    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    +    +    const btn = screen.getByTestId('target-confirm-btn');
    +    +    +    expect(btn).not.toBeDisabled();
    +    +    +  });
    +    +    +
    +    +    +  it('calls onConfirm with target data', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    const input = screen.getByTestId('target-ref-input');
    +    +    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    +    +    fireEvent.click(screen.getByTestId('target-confirm-btn'));
    +    +    +    expect(mockConfirm).toHaveBeenCalledWith({
    +    +    +      target_type: 'github_new',
    +    +    +      target_ref: 'my-repo',
    +    +    +    });
    +    +    +  });
    +    +    +
    +    +    +  it('calls onCancel when cancel button clicked', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    fireEvent.click(screen.getByText('Cancel'));
    +    +    +    expect(mockCancel).toHaveBeenCalledOnce();
    +    +    +  });
         +    +
    -    +    +type ContractStatus = 'pending' | 'generating' | 'done';
    +    +    +  it('calls onCancel when close button (Ôö£├ÂÔö¼├║Ôö£Ôûô) clicked', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    fireEvent.click(screen.getByText('Ôö£├ÂÔö¼├║Ôö£Ôûô'));
    +    +    +    expect(mockCancel).toHaveBeenCalledOnce();
    +    +    +  });
         +    +
    -    +    +interface LogEntry {
    -    +    +  time: string;
    -    +    +  message: string;
    +    +    +  it('shows "Starting..." when starting prop is true', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} starting />);
    +    +    +    const input = screen.getByTestId('target-ref-input');
    +    +    +    fireEvent.change(input, { target: { value: 'blah' } });
    +    +    +    expect(screen.getByText('Starting...')).toBeInTheDocument();
    +    +    +  });
    +    +    +
    +    +    +  it('clears input when switching target types', () => {
    +    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    +    +    expect(input.value).toBe('my-repo');
    +    +    +
    +    +    +    fireEvent.click(screen.getByTestId('target-local_path'));
    +    +    +    const inputAfter = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    +    expect(inputAfter.value).toBe('');
    +    +    +  });
    +    +    +});
    +    +    diff --git a/web/src/components/BuildTargetModal.tsx b/web/src/components/BuildTargetModal.tsx
    +    +    new file mode 100644
    +    +    index 0000000..81304a1
    +    +    --- /dev/null
    +    +    +++ b/web/src/components/BuildTargetModal.tsx
    +    +    @@ -0,0 +1,252 @@
    +         +/**
    +    -    + * Settings -- user settings page with BYOK API key management.
    +    +    + * BuildTargetModal -- lets user choose where the build writes files.
    +    +    + *
    +    +    + * Three target types:
    +    +    + *   - github_new     Ôö£├ÂÔö£├ºÔö£├é create a new GitHub repo and push generated code
    +    +    + *   - github_existing Ôö£├ÂÔö£├ºÔö£├é clone an existing repo, add generated code, push
    +    +    + *   - local_path     Ôö£├ÂÔö£├ºÔö£├é write files to a local directory
    +    +    + *
    +    +    + * Passes { target_type, target_ref } back to the caller.
    +         + */
    +         +import { useState } from 'react';
    +    -    +import { useNavigate } from 'react-router-dom';
    +    -    +import { useAuth } from '../context/AuthContext';
    +    -    +import { useToast } from '../context/ToastContext';
    +    -    +import AppShell from '../components/AppShell';
    +    -    +
    +    -    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    +    -    +
    +    -    +function Settings() {
    +    -    +  const { user, token, updateUser } = useAuth();
    +    -    +  const { addToast } = useToast();
    +    -    +  const navigate = useNavigate();
    +    -    +
    +    -    +  const [apiKey, setApiKey] = useState('');
    +    -    +  const [saving, setSaving] = useState(false);
    +    -    +  const [removing, setRemoving] = useState(false);
    +    -    +
    +    -    +  const hasKey = user?.has_anthropic_key ?? false;
    +    -    +
    +    -    +  const handleSaveKey = async () => {
    +    -    +    const trimmed = apiKey.trim();
    +    -    +    if (!trimmed) return;
    +    -    +    setSaving(true);
    +    -    +    try {
    +    -    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    +    -    +        method: 'PUT',
    +    -    +        headers: {
    +    -    +          Authorization: `Bearer ${token}`,
    +    -    +          'Content-Type': 'application/json',
    +    -    +        },
    +    -    +        body: JSON.stringify({ api_key: trimmed }),
    +    -    +      });
    +    -    +      if (res.ok) {
    +    -    +        addToast('API key saved', 'success');
    +    -    +        setApiKey('');
    +    -    +        updateUser({ has_anthropic_key: true });
    +    -    +      } else {
    +    -    +        const data = await res.json().catch(() => ({ detail: 'Failed to save key' }));
    +    -    +        addToast(data.detail || 'Failed to save key');
    +    -    +      }
    +    -    +    } catch {
    +    -    +      addToast('Network error saving key');
    +    -    +    } finally {
    +    -    +      setSaving(false);
    +    -    +    }
    +    -    +  };
    +         +
    +    -    +  const handleRemoveKey = async () => {
    +    -    +    setRemoving(true);
    +    -    +    try {
    +    -    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    +    -    +        method: 'DELETE',
    +    -    +        headers: { Authorization: `Bearer ${token}` },
    +    -    +      });
    +    -    +      if (res.ok) {
    +    -    +        addToast('API key removed', 'info');
    +    -    +        updateUser({ has_anthropic_key: false });
    +    -    +      } else {
    +    -    +        addToast('Failed to remove key');
    +    -    +      }
    +    -    +    } catch {
    +    -    +      addToast('Network error removing key');
    +    -    +    } finally {
    +    -    +      setRemoving(false);
    +    -    +    }
    +    -    +  };
    +    +    +export interface BuildTarget {
    +    +    +  target_type: string;
    +    +    +  target_ref: string;
         +    +}
         +    +
    -    +    +interface Props {
    -    +    +  projectId: string;
    -    +    +  tokenUsage: TokenUsage;
    -    +    +  model: string;
    -    +    +  onComplete: () => void;
    +    +    +interface BuildTargetModalProps {
    +    +    +  onConfirm: (target: BuildTarget) => void;
    +    +    +  onCancel: () => void;
    +    +    +  starting?: boolean;
         +    +}
         +    +
    -    +    +/* ------------------------------------------------------------------ */
    -    +    +/*  Styles                                                            */
    -    +    +/* ------------------------------------------------------------------ */
    -    +    +
    -    +    +const panelStyle: React.CSSProperties = {
    -    +    +  display: 'flex',
    -    +    +  flexDirection: 'column',
    -    +    +  gap: '12px',
    -    +    +  padding: '16px 20px',
    -    +    +  flex: 1,
    -    +    +  overflowY: 'auto',
    -    +    +};
    +    +    +type TargetOption = 'github_new' | 'github_existing' | 'local_path';
         +    +
    -    +    +const stepRowStyle: React.CSSProperties = {
    -    +    +  display: 'flex',
    -    +    +  alignItems: 'center',
    -    +    +  gap: '10px',
    -    +    +  fontSize: '0.82rem',
    -    +    +  padding: '6px 0',
    -    +    +  borderBottom: '1px solid #1E293B',
    -    +    +};
    +    +    +const TARGET_OPTIONS: { value: TargetOption; label: string; description: string; placeholder: string }[] = [
    +    +    +  {
    +    +    +    value: 'github_new',
    +    +    +    label: 'New GitHub Repo',
    +    +    +    description: 'Create a new repository under your GitHub account and push generated code.',
    +    +    +    placeholder: 'my-new-project',
    +    +    +  },
    +    +    +  {
    +    +    +    value: 'github_existing',
    +    +    +    label: 'Existing GitHub Repo',
    +    +    +    description: 'Clone an existing repo, add generated files, and push.',
    +    +    +    placeholder: 'owner/repo-name',
    +    +    +  },
    +    +    +  {
    +    +    +    value: 'local_path',
    +    +    +    label: 'Local Directory',
    +    +    +    description: 'Write generated files to a directory on the server.',
    +    +    +    placeholder: 'C:\\Projects\\my-app  or  /home/user/projects/my-app',
    +    +    +  },
    +    +    +];
         +    +
    -    +    +const logPanelStyle: React.CSSProperties = {
    +    +    +const cardBase: React.CSSProperties = {
         +    +  background: '#0F172A',
    -    +    +  borderRadius: '6px',
    -    +    +  padding: '10px 12px',
    -    +    +  fontFamily: 'monospace',
    -    +    +  fontSize: '0.72rem',
    -    +    +  color: '#94A3B8',
    -    +    +  maxHeight: '120px',
    -    +    +  overflowY: 'auto',
    -    +    +  lineHeight: '1.6',
    +    +    +  border: '2px solid #334155',
    +    +    +  borderRadius: '8px',
    +    +    +  padding: '14px 16px',
    +    +    +  cursor: 'pointer',
    +    +    +  transition: 'border-color 0.15s, background 0.15s',
         +    +};
         +    +
    -    +    +const meterBarOuter: React.CSSProperties = {
    -    +    +  flex: 1,
    -    +    +  height: '8px',
    +    +    +const cardSelected: React.CSSProperties = {
    +    +    +  ...cardBase,
    +    +    +  borderColor: '#2563EB',
         +    +  background: '#1E293B',
    -    +    +  borderRadius: '4px',
    -    +    +  overflow: 'hidden',
         +    +};
         +    +
    -    +    +/* ------------------------------------------------------------------ */
    -    +    +/*  Component                                                         */
    -    +    +/* ------------------------------------------------------------------ */
    -    +    +
    -    +    +export default function ContractProgress({ projectId, tokenUsage, model, onComplete }: Props) {
    -    +    +  const { token } = useAuth();
    -    +    +  const [statuses, setStatuses] = useState<Record<string, ContractStatus>>(() =>
    -    +    +    Object.fromEntries(ALL_CONTRACTS.map((c) => [c, 'pending' as const])),
    -    +    +  );
    -    +    +  const [log, setLog] = useState<LogEntry[]>([]);
    -    +    +  const [generating, setGenerating] = useState(false);
    -    +    +  const [allDone, setAllDone] = useState(false);
    -    +    +  const logEndRef = useRef<HTMLDivElement>(null);
    -    +    +  const startedRef = useRef(false);
    -    +    +
    -    +    +  const addLog = useCallback((msg: string) => {
    -    +    +    const now = new Date();
    -    +    +    const time = now.toLocaleTimeString('en-GB', { hour12: false });
    -    +    +    setLog((prev) => [...prev, { time, message: msg }]);
    -    +    +  }, []);
    -    +    +
    -    +    +  /* Auto-scroll log */
    -    +    +  useEffect(() => {
    -    +    +    logEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    -    +    +  }, [log]);
    -    +    +
    -    +    +  /* Handle WS progress messages */
    -    +    +  useWebSocket(
    -    +    +    useCallback(
    -    +    +      (data: { type: string; payload: any }) => {
    -    +    +        if (data.type !== 'contract_progress') return;
    -    +    +        const p = data.payload;
    -    +    +        if (p.project_id !== projectId) return;
    -    +    +
    -    +    +        const label = CONTRACT_LABELS[p.contract_type] ?? p.contract_type;
    -    +    +        if (p.status === 'generating') {
    -    +    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'generating' }));
    -    +    +          addLog(`Generating ${label}...`);
    -    +    +        } else if (p.status === 'done') {
    -    +    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'done' }));
    -    +    +          addLog(`Ôö£├ÂÔö¼├║Ôö£Ôöñ ${label} complete`);
    -    +    +
    -    +    +          /* Check if all done */
    -    +    +          setStatuses((prev) => {
    -    +    +            const values = Object.values(prev);
    -    +    +            if (values.every((s) => s === 'done')) {
    -    +    +              setAllDone(true);
    -    +    +              addLog('All contracts generated successfully.');
    -    +    +            }
    -    +    +            return prev;
    -    +    +          });
    -    +    +        }
    -    +    +      },
    -    +    +      [projectId, addLog],
    -    +    +    ),
    -    +    +  );
    -    +    +
    -    +    +  /* Kick off generation on mount */
    -    +    +  useEffect(() => {
    -    +    +    if (startedRef.current) return;
    -    +    +    startedRef.current = true;
    -    +    +    setGenerating(true);
    -    +    +    addLog('Starting contract generation...');
    -    +    +
    -    +    +    fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    -    +    +      method: 'POST',
    -    +    +      headers: { Authorization: `Bearer ${token}` },
    -    +    +    })
    -    +    +      .then((res) => {
    -    +    +        if (!res.ok) throw new Error('Generation failed');
    -    +    +        /* Mark any remaining as done (safety net) */
    -    +    +        setStatuses((prev) => {
    -    +    +          const updated = { ...prev };
    -    +    +          for (const key of ALL_CONTRACTS) {
    -    +    +            if (updated[key] !== 'done') updated[key] = 'done';
    -    +    +          }
    -    +    +          return updated;
    -    +    +        });
    -    +    +        setAllDone(true);
    -    +    +        setGenerating(false);
    -    +    +      })
    -    +    +      .catch(() => {
    -    +    +        addLog('Ôö£├ÂÔö¼├║Ôö£Ôòú Contract generation failed');
    -    +    +        setGenerating(false);
    -    +    +      });
    -    +    +  }, [projectId, token, addLog]);
    -    +    +
    -    +    +  /* Derived values */
    -    +    +  const contextWindow = MODEL_CONTEXT_WINDOWS[model] ?? DEFAULT_CONTEXT_WINDOW;
    -    +    +  const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    -    +    +  const ctxPercent = Math.min(100, (totalTokens / contextWindow) * 100);
    -    +    +  const doneCount = Object.values(statuses).filter((s) => s === 'done').length;
    -    +    +
    -    +    +  /* Color for context bar */
    -    +    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    -    +    +
    -    +    +  return (
    -    +    +    <div style={panelStyle} data-testid="contract-progress">
    -    +    +      {/* Header */}
    -    +    +      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
    -    +    +        <h4 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    -    +    +          {allDone ? 'Ôö£├ÂÔö¼├║Ôö£Ôöñ Contracts Ready' : `Generating ContractsÔö£├ÂÔö£├ºÔö¼┬¼ (${doneCount}/${ALL_CONTRACTS.length})`}
    -    +    +        </h4>
    -    +    +      </div>
    -    +    +
    -    +    +      {/* Context window meter */}
    -    +    +      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    -    +    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.7rem', color: '#94A3B8' }}>
    -    +    +          <span>Context Window ({model})</span>
    -    +    +          <span>
    -    +    +            {totalTokens.toLocaleString()} / {contextWindow.toLocaleString()} tokens ({ctxPercent.toFixed(1)}%)
    -    +    +          </span>
    -    +    +        </div>
    -    +    +        <div style={meterBarOuter}>
    -    +    +          <div
    -    +    +            style={{
    -    +    +              width: `${ctxPercent}%`,
    -    +    +              height: '100%',
    -    +    +              background: ctxColor,
    -    +    +              borderRadius: '4px',
    -    +    +              transition: 'width 0.4s ease',
    -    +    +            }}
    -    +    +          />
    -    +    +        </div>
    -    +    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#64748B' }}>
    -    +    +          <span>Input: {tokenUsage.input_tokens.toLocaleString()}</span>
    -    +    +          <span>Output: {tokenUsage.output_tokens.toLocaleString()}</span>
    -    +    +        </div>
    -    +    +      </div>
    -    +    +
    -    +    +      {/* Step list */}
    -    +    +      <div>
    -    +    +        {ALL_CONTRACTS.map((ct) => {
    -    +    +          const st = statuses[ct];
    -    +    +          const icon = st === 'done' ? 'Ôö£├ÂÔö¼├║Ôö£├í' : st === 'generating' ? 'Ôö£├ÂÔö£├á├ö├Â├®' : 'Ôö£├ÂÔö£ÔòúÔö£┬╗';
    -    +    +          const color = st === 'done' ? '#22C55E' : st === 'generating' ? '#F59E0B' : '#475569';
    -    +    +          return (
    -    +    +            <div key={ct} style={stepRowStyle}>
    -    +    +              <span style={{ width: '20px', textAlign: 'center' }}>{icon}</span>
    -    +    +              <span style={{ flex: 1, color }}>{CONTRACT_LABELS[ct]}</span>
    -    +    +              <span style={{ fontSize: '0.7rem', color: '#64748B', textTransform: 'uppercase' }}>{st}</span>
    -    +    +            </div>
    -    +    +          );
    -    +    +        })}
    -    +    +      </div>
    -    +    +
    -    +    +      {/* Log panel */}
    -    +    +      <div style={logPanelStyle} data-testid="contract-log">
    -    +    +        {log.map((entry, i) => (
    -    +    +          <div key={i}>
    -    +    +            <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    -    +    +            {entry.message}
    -    +    +          </div>
    -    +    +        ))}
    -    +    +        <div ref={logEndRef} />
    -    +    +      </div>
    -    +    +
    -    +    +      {/* Done button */}
    -    +    +      {allDone && (
    -    +    +        <button
    -    +    +          onClick={onComplete}
    -    +    +          data-testid="contracts-done-btn"
    +    +    +export default function BuildTargetModal({ onConfirm, onCancel, starting }: BuildTargetModalProps) {
    +    +    +  const [selected, setSelected] = useState<TargetOption>('github_new');
    +    +    +  const [targetRef, setTargetRef] = useState('');
    +    +    +
    +    +    +  const currentOption = TARGET_OPTIONS.find((o) => o.value === selected)!;
    +    +    +
    +    +    +  const canConfirm = targetRef.trim().length > 0 && !starting;
    +         +
    +         +  return (
    +    -    +    <AppShell>
    +    -    +      <div style={{ padding: '24px', maxWidth: '720px', margin: '0 auto' }}>
    +    -    +        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    +    +    +    <div
    +    +    +      style={{
    +    +    +        position: 'fixed',
    +    +    +        inset: 0,
    +    +    +        backgroundColor: 'rgba(0,0,0,0.65)',
    +    +    +        display: 'flex',
    +    +    +        alignItems: 'center',
    +    +    +        justifyContent: 'center',
    +    +    +        zIndex: 100,
    +    +    +      }}
    +    +    +      onClick={onCancel}
    +    +    +    >
    +    +    +      <div
    +    +    +        style={{
    +    +    +          background: '#1E293B',
    +    +    +          borderRadius: '10px',
    +    +    +          maxWidth: '540px',
    +    +    +          width: '95%',
    +    +    +          overflow: 'hidden',
    +    +    +        }}
    +    +    +        onClick={(e) => e.stopPropagation()}
    +    +    +      >
    +    +    +        {/* Header */}
    +    +    +        <div
         +    +          style={{
    -    +    +            background: '#16A34A',
    -    +    +            color: '#fff',
    -    +    +            border: 'none',
    -    +    +            borderRadius: '8px',
    -    +    +            padding: '10px 20px',
    -    +    +            cursor: 'pointer',
    -    +    +            fontSize: '0.8rem',
    -    +    +            fontWeight: 600,
    -    +    +            alignSelf: 'center',
    +    +    +            padding: '16px 20px',
    +    +    +            borderBottom: '1px solid #334155',
    +    +    +            display: 'flex',
    +    +    +            alignItems: 'center',
    +    +    +            justifyContent: 'space-between',
         +    +          }}
         +    +        >
    -    +    +          Done Ôö£├ÂÔö£├ºÔö£├é View Contracts
    -    +    +        </button>
    -    +    +      )}
    -    +    +
    -    +    +      {generating && !allDone && (
    -    +    +        <p style={{ textAlign: 'center', color: '#64748B', fontSize: '0.75rem', margin: 0 }}>
    -    +    +          GeneratingÔö£├ÂÔö£├ºÔö¼┬¼
    -    +    +        </p>
    -    +    +      )}
    +    +    +          <h3 style={{ margin: 0, fontSize: '1rem', color: '#F8FAFC' }}>Build Target</h3>
    +         +          <button
    +    -    +            onClick={() => navigate('/')}
    +    +    +            onClick={onCancel}
    +         +            style={{
    +         +              background: 'transparent',
    +    +    +              border: 'none',
    +         +              color: '#94A3B8',
    +    -    +              border: '1px solid #334155',
    +    -    +              borderRadius: '6px',
    +    -    +              padding: '6px 12px',
    +    +    +              fontSize: '1.2rem',
    +         +              cursor: 'pointer',
    +    -    +              fontSize: '0.8rem',
    +         +            }}
    +         +          >
    +    -    +            Back
    +    +    +            Ôö£├ÂÔö¼├║Ôö£Ôûô
    +         +          </button>
    +    -    +          <h2 style={{ margin: 0, fontSize: '1.1rem' }}>Settings</h2>
    +         +        </div>
    +         +
    +    -    +        {/* Profile Section */}
    +    -    +        <div
    +    -    +          style={{
    +    -    +            background: '#1E293B',
    +    -    +            borderRadius: '8px',
    +    -    +            padding: '20px',
    +    -    +            marginBottom: '16px',
    +    -    +          }}
    +    -    +        >
    +    -    +          <h3 style={{ margin: '0 0 16px', fontSize: '0.9rem', color: '#F8FAFC' }}>Profile</h3>
    +    -    +          <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
    +    -    +            {user?.avatar_url && (
    +    -    +              <img
    +    -    +                src={user.avatar_url}
    +    -    +                alt={user.github_login}
    +    -    +                style={{ width: 48, height: 48, borderRadius: '50%' }}
    +    -    +              />
    +    -    +            )}
    +    -    +            <div>
    +    -    +              <div style={{ fontWeight: 600, fontSize: '0.95rem' }}>{user?.github_login}</div>
    +    -    +              <div style={{ color: '#64748B', fontSize: '0.8rem', marginTop: '2px' }}>
    +    -    +                Authenticated via GitHub
    +    -    +              </div>
    +    -    +            </div>
    +    -    +          </div>
    +    -    +        </div>
    +    -    +
    +    -    +        {/* BYOK API Key Section */}
    +    -    +        <div
    +    -    +          style={{
    +    -    +            background: '#1E293B',
    +    -    +            borderRadius: '8px',
    +    -    +            padding: '20px',
    +    -    +            marginBottom: '16px',
    +    -    +          }}
    +    -    +          data-testid="byok-section"
    +    -    +        >
    +    -    +          <h3 style={{ margin: '0 0 4px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    -    +            Anthropic API Key
    +    -    +          </h3>
    +    -    +          <p style={{ margin: '0 0 14px', fontSize: '0.75rem', color: '#64748B', lineHeight: 1.5 }}>
    +    -    +            Builds use Claude Opus and run on your own Anthropic API key.
    +    -    +            Planning, questionnaires, and audits are free Ôö£├ÂÔö£├ºÔö£├é powered by Haiku on us.
    +    +    +        {/* Body */}
    +    +    +        <div style={{ padding: '20px', display: 'flex', flexDirection: 'column', gap: '16px' }}>
    +    +    +          <p style={{ margin: 0, fontSize: '0.8rem', color: '#94A3B8' }}>
    +    +    +            Choose where ForgeGuard should write the generated files.
    +         +          </p>
    +         +
    +    -    +          {hasKey ? (
    +    -    +            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    +    -    +              <div style={{
    +    -    +                flex: 1,
    +    -    +                display: 'flex',
    +    -    +                alignItems: 'center',
    +    -    +                gap: '8px',
    +    -    +                padding: '8px 12px',
    +    -    +                background: '#0F172A',
    +    -    +                borderRadius: '6px',
    +    -    +                fontSize: '0.8rem',
    +    -    +              }}>
    +    -    +                <span style={{ color: '#22C55E', fontSize: '0.7rem' }}>Ôö£├ÂÔö£ÔòúÔö£├á</span>
    +    -    +                <span style={{ color: '#94A3B8' }}>Key configured</span>
    +    -    +                <span style={{ color: '#64748B', fontFamily: 'monospace' }}>sk-ant-Ôö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£Ôöé</span>
    +    -    +              </div>
    +    -    +              <button
    +    -    +                onClick={handleRemoveKey}
    +    -    +                disabled={removing}
    +    -    +                data-testid="remove-api-key-btn"
    +    -    +                style={{
    +    -    +                  background: 'transparent',
    +    -    +                  color: '#EF4444',
    +    -    +                  border: '1px solid #7F1D1D',
    +    -    +                  borderRadius: '6px',
    +    -    +                  padding: '6px 14px',
    +    -    +                  cursor: removing ? 'not-allowed' : 'pointer',
    +    -    +                  fontSize: '0.75rem',
    +    -    +                  opacity: removing ? 0.6 : 1,
    +    +    +          {/* Target type cards */}
    +    +    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
    +    +    +            {TARGET_OPTIONS.map((opt) => (
    +    +    +              <div
    +    +    +                key={opt.value}
    +    +    +                style={selected === opt.value ? cardSelected : cardBase}
    +    +    +                onClick={() => {
    +    +    +                  setSelected(opt.value);
    +    +    +                  setTargetRef('');
    +         +                }}
    +    +    +                data-testid={`target-${opt.value}`}
    +         +              >
    +    -    +                {removing ? 'Removing...' : 'Remove'}
    +    -    +              </button>
    +    -    +            </div>
    +    -    +          ) : (
    +    -    +            <div>
    +    -    +              <div style={{ display: 'flex', gap: '8px' }}>
    +    -    +                <input
    +    -    +                  type="password"
    +    -    +                  value={apiKey}
    +    -    +                  onChange={(e) => setApiKey(e.target.value)}
    +    -    +                  placeholder="sk-ant-api03-..."
    +    -    +                  data-testid="api-key-input"
    +    -    +                  style={{
    +    -    +                    flex: 1,
    +    -    +                    background: '#0F172A',
    +    -    +                    border: '1px solid #334155',
    +    -    +                    borderRadius: '6px',
    +    -    +                    padding: '8px 12px',
    +    -    +                    color: '#F8FAFC',
    +    -    +                    fontSize: '0.8rem',
    +    -    +                    fontFamily: 'monospace',
    +    -    +                    outline: 'none',
    +    -    +                  }}
    +    -    +                  onKeyDown={(e) => { if (e.key === 'Enter') handleSaveKey(); }}
    +    -    +                />
    +    -    +                <button
    +    -    +                  onClick={handleSaveKey}
    +    -    +                  disabled={saving || !apiKey.trim()}
    +    -    +                  data-testid="save-api-key-btn"
    +    -    +                  style={{
    +    -    +                    background: saving ? '#1E293B' : '#2563EB',
    +    -    +                    color: '#fff',
    +    -    +                    border: 'none',
    +    -    +                    borderRadius: '6px',
    +    -    +                    padding: '8px 18px',
    +    -    +                    cursor: saving || !apiKey.trim() ? 'not-allowed' : 'pointer',
    +    -    +                    fontSize: '0.8rem',
    +    -    +                    opacity: saving || !apiKey.trim() ? 0.6 : 1,
    +    -    +                  }}
    +    -    +                >
    +    -    +                  {saving ? 'Saving...' : 'Save Key'}
    +    -    +                </button>
    +    +    +                <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '4px' }}>
    +    +    +                  <span
    +    +    +                    style={{
    +    +    +                      width: '16px',
    +    +    +                      height: '16px',
    +    +    +                      borderRadius: '50%',
    +    +    +                      border: `2px solid ${selected === opt.value ? '#2563EB' : '#475569'}`,
    +    +    +                      display: 'flex',
    +    +    +                      alignItems: 'center',
    +    +    +                      justifyContent: 'center',
    +    +    +                      flexShrink: 0,
    +    +    +                    }}
    +    +    +                  >
    +    +    +                    {selected === opt.value && (
    +    +    +                      <span
    +    +    +                        style={{
    +    +    +                          width: '8px',
    +    +    +                          height: '8px',
    +    +    +                          borderRadius: '50%',
    +    +    +                          background: '#2563EB',
    +    +    +                        }}
    +    +    +                      />
    +    +    +                    )}
    +    +    +                  </span>
    +    +    +                  <span style={{ fontWeight: 600, fontSize: '0.85rem', color: '#F8FAFC' }}>{opt.label}</span>
    +    +    +                </div>
    +    +    +                <p style={{ margin: '0 0 0 26px', fontSize: '0.72rem', color: '#94A3B8' }}>{opt.description}</p>
    +         +              </div>
    +    -    +              <p style={{ margin: '8px 0 0', fontSize: '0.7rem', color: '#64748B' }}>
    +    -    +                Your key is stored securely and only used for build operations.
    +    -    +                Get one at{' '}
    +    -    +                <a
    +    -    +                  href="https://console.anthropic.com/settings/keys"
    +    -    +                  target="_blank"
    +    -    +                  rel="noopener noreferrer"
    +    -    +                  style={{ color: '#60A5FA' }}
    +    -    +                >
    +    -    +                  console.anthropic.com
    +    -    +                </a>
    +    -    +              </p>
    +    -    +            </div>
    +    -    +          )}
    +    -    +        </div>
    +    +    +            ))}
    +    +    +          </div>
    +         +
    +    -    +        {/* AI Models info */}
    +    -    +        <div
    +    -    +          style={{
    +    -    +            background: '#1E293B',
    +    -    +            borderRadius: '8px',
    +    -    +            padding: '20px',
    +    -    +            marginBottom: '16px',
    +    -    +          }}
    +    -    +        >
    +    -    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>AI Models</h3>
    +    -    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', fontSize: '0.8rem' }}>
    +    -    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    +    -    +              <span style={{ color: '#94A3B8' }}>Questionnaire</span>
    +    -    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    +    -    +                <span style={{ color: '#22C55E', fontWeight: 600 }}>claude-haiku-4-5</span>
    +    -    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>FREE</span>
    +    -    +              </div>
    +    -    +            </div>
    +    -    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    +    -    +              <span style={{ color: '#94A3B8' }}>Builder</span>
    +    -    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    +    -    +                <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    +    -    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>BYOK</span>
    +    -    +              </div>
    +    -    +            </div>
    +    +    +          {/* Target ref input */}
    +    +    +          <div>
    +    +    +            <label
    +    +    +              style={{ display: 'block', fontSize: '0.75rem', color: '#94A3B8', marginBottom: '6px' }}
    +    +    +            >
    +    +    +              {selected === 'github_new'
    +    +    +                ? 'Repository name'
    +    +    +                : selected === 'github_existing'
    +    +    +                  ? 'Repository (owner/name)'
    +    +    +                  : 'Directory path'}
    +    +    +            </label>
    +    +    +            <input
    +    +    +              type="text"
    +    +    +              value={targetRef}
    +    +    +              onChange={(e) => setTargetRef(e.target.value)}
    +    +    +              placeholder={currentOption.placeholder}
    +    +    +              data-testid="target-ref-input"
    +    +    +              style={{
    +    +    +                width: '100%',
    +    +    +                padding: '10px 12px',
    +    +    +                background: '#0F172A',
    +    +    +                border: '1px solid #334155',
    +    +    +                borderRadius: '6px',
    +    +    +                color: '#F8FAFC',
    +    +    +                fontSize: '0.85rem',
    +    +    +                outline: 'none',
    +    +    +                boxSizing: 'border-box',
    +    +    +              }}
    +    +    +              onFocus={(e) => (e.currentTarget.style.borderColor = '#2563EB')}
    +    +    +              onBlur={(e) => (e.currentTarget.style.borderColor = '#334155')}
    +    +    +              onKeyDown={(e) => {
    +    +    +                if (e.key === 'Enter' && canConfirm) {
    +    +    +                  onConfirm({ target_type: selected, target_ref: targetRef.trim() });
    +    +    +                }
    +    +    +              }}
    +    +    +              autoFocus
    +    +    +            />
    +         +          </div>
    +         +        </div>
    +         +
    +    -    +        {/* About Section */}
    +    +    +        {/* Footer */}
    +         +        <div
    +         +          style={{
    +    -    +            background: '#1E293B',
    +    -    +            borderRadius: '8px',
    +    -    +            padding: '20px',
    +    +    +            padding: '12px 20px',
    +    +    +            borderTop: '1px solid #334155',
    +    +    +            display: 'flex',
    +    +    +            justifyContent: 'flex-end',
    +    +    +            gap: '10px',
    +         +          }}
    +         +        >
    +    -    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>About</h3>
    +    -    +          <div style={{ fontSize: '0.8rem', color: '#94A3B8', display: 'flex', flexDirection: 'column', gap: '6px' }}>
    +    -    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    +    -    +              <span>Version</span>
    +    -    +              <span style={{ color: '#F8FAFC' }}>v0.1.0</span>
    +    -    +            </div>
    +    -    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    +    -    +              <span>Framework</span>
    +    -    +              <span style={{ color: '#F8FAFC' }}>Forge Governance</span>
    +    -    +            </div>
    +    -    +          </div>
    +    +    +          <button
    +    +    +            onClick={onCancel}
    +    +    +            style={{
    +    +    +              background: 'transparent',
    +    +    +              color: '#94A3B8',
    +    +    +              border: '1px solid #334155',
    +    +    +              borderRadius: '6px',
    +    +    +              padding: '8px 16px',
    +    +    +              cursor: 'pointer',
    +    +    +              fontSize: '0.8rem',
    +    +    +            }}
    +    +    +          >
    +    +    +            Cancel
    +    +    +          </button>
    +    +    +          <button
    +    +    +            onClick={() => onConfirm({ target_type: selected, target_ref: targetRef.trim() })}
    +    +    +            disabled={!canConfirm}
    +    +    +            data-testid="target-confirm-btn"
    +    +    +            style={{
    +    +    +              background: canConfirm ? '#2563EB' : '#1E293B',
    +    +    +              color: canConfirm ? '#fff' : '#475569',
    +    +    +              border: 'none',
    +    +    +              borderRadius: '6px',
    +    +    +              padding: '8px 20px',
    +    +    +              cursor: canConfirm ? 'pointer' : 'not-allowed',
    +    +    +              fontSize: '0.8rem',
    +    +    +              fontWeight: 600,
    +    +    +            }}
    +    +    +          >
    +    +    +            {starting ? 'Starting...' : 'Start Build'}
    +    +    +          </button>
    +         +        </div>
    +         +      </div>
    +    -    +    </AppShell>
         +    +    </div>
    -    +    +  );
    -    +    +}
    -    +    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    -    +    index 2b28280..bd8693a 100644
    -    +    --- a/web/src/components/QuestionnaireModal.tsx
    -    +    +++ b/web/src/components/QuestionnaireModal.tsx
    -    +    @@ -7,6 +7,7 @@
    -    +      */
    -    +     import { useState, useEffect, useRef, useCallback } from 'react';
    -    +     import { useAuth } from '../context/AuthContext';
    -    +    +import ContractProgress from './ContractProgress';
    -    +     
    -    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -    +     
    -    +    @@ -34,6 +35,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    -    +     interface ChatMessage {
    -    +       role: 'user' | 'assistant';
    -    +       content: string;
    -    +    +  section?: string;
    +         +  );
    +         +}
    +    -    +
    +    -    +export default Settings;
    +    -    diff --git a/web/vite.config.ts b/web/vite.config.ts
    +    -    index 136369a..43cba1f 100644
    +    -    --- a/web/vite.config.ts
    +    -    +++ b/web/vite.config.ts
    +    -    @@ -1,6 +1,18 @@
    +    -     import { defineConfig } from 'vite';
    +    -     import react from '@vitejs/plugin-react';
    +    +    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    +    +    index 021b634..6e1e2e4 100644
    +    +    --- a/web/src/pages/BuildProgress.tsx
    +    +    +++ b/web/src/pages/BuildProgress.tsx
    +    +    @@ -79,6 +79,13 @@ interface ActivityEntry {
    +    +       level: 'info' | 'warn' | 'error' | 'system';
         +     }
    -    +     
    -    +     interface QuestionnaireState {
    -    +    @@ -150,12 +152,21 @@ const SpeechRecognition =
    -    +         : null;
    -    +     
    -    +     function useSpeechRecognition(onResult: (text: string) => void) {
    -    +    -  const recognitionRef = useRef<any>(null);
    -    +       const [listening, setListening] = useState(false);
    -    +       const listeningRef = useRef(false);
    -    +    +  const recRef = useRef<any>(null);
    -    +    +  const onResultRef = useRef(onResult);
    -    +    +  onResultRef.current = onResult;
    -    +    +
    -    +    +  /* Lazily create a single SpeechRecognition instance and keep it for the
    -    +    +     lifetime of the component.  Browsers throttle or block new instances
    -    +    +     created outside a user-gesture context, which is why creating a fresh
    -    +    +     instance on every start() caused the second activation to silently die
    -    +    +     after a few seconds. */
    -    +    +  const getRec = useCallback(() => {
    -    +    +    if (recRef.current) return recRef.current;
    -    +    +    if (!SpeechRecognition) return null;
    -    +     
    -    +    -  useEffect(() => {
    -    +    -    if (!SpeechRecognition) return;
    -    +         const rec = new SpeechRecognition();
    -    +         rec.continuous = true;
    -    +         rec.interimResults = true;
    -    +    @@ -169,64 +180,93 @@ function useSpeechRecognition(onResult: (text: string) => void) {
    -    +             }
    -    +           }
    -    +           if (finalTranscript) {
    -    +    -        onResult(finalTranscript);
    -    +    +        onResultRef.current(finalTranscript);
    -    +           }
    -    +         };
    -    +     
    -    +         rec.onerror = (e: any) => {
    -    +    -      /* 'no-speech' and 'aborted' are normal during pauses Ôö£├ÂÔö£├ºÔö£├é auto-restart */
    -    +           if (e.error === 'no-speech' || e.error === 'aborted') {
    -    +    +        /* Browser fires these during normal pauses Ôö£├ÂÔö£├ºÔö£├é restart if still active */
    -    +             if (listeningRef.current) {
    -    +    -          try { rec.start(); } catch { /* already running */ }
    -    +    +          setTimeout(() => {
    -    +    +            if (listeningRef.current) {
    -    +    +              try { rec.start(); } catch { /* already running */ }
    +          
    +    -    +/* Bypass proxy for browser page navigations (Accept: text/html) so Vite
    +    -    +   serves index.html and React Router handles the route. API fetch() calls
    +    -    +   (Accept: application/json) still proxy to the backend. */
    +    -    +const apiProxy = {
    +    -    +  target: 'http://localhost:8000',
    +    -    +  bypass(req: { headers: { accept?: string } }) {
    +    -    +    if (req.headers.accept?.includes('text/html')) {
    +    -    +      return '/index.html';
    +    -    +    }
    +    -    +  },
    +    -    +};
    +    +    +interface BuildFile {
    +    +    +  path: string;
    +    +    +  size_bytes: number;
    +    +    +  language: string;
    +    +    +  created_at: string;
    +    +    +}
    +    +    +
    +    +     /* ------------------------------------------------------------------ */
    +    +     /*  Styles                                                            */
    +    +     /* ------------------------------------------------------------------ */
    +    +    @@ -174,6 +181,8 @@ function BuildProgress() {
    +    +       const [noBuild, setNoBuild] = useState(false);
    +    +       const [showCancelConfirm, setShowCancelConfirm] = useState(false);
    +    +       const [expandedPhase, setExpandedPhase] = useState<number | null>(null);
    +    +    +  const [buildFiles, setBuildFiles] = useState<BuildFile[]>([]);
    +    +    +  const [filesExpanded, setFilesExpanded] = useState(true);
    +    +       const [startTime] = useState(() => Date.now());
    +    +       const [elapsed, setElapsed] = useState(0);
    +    +       const feedEndRef = useRef<HTMLDivElement>(null);
    +    +    @@ -260,6 +269,17 @@ function BuildProgress() {
    +    +                   });
    +    +                 }
    +    +               } catch { /* best effort */ }
    +    +    +
    +    +    +          /* Seed build files */
    +    +    +          try {
    +    +    +            const filesRes = await fetch(`${API_BASE}/projects/${projectId}/build/files`, {
    +    +    +              headers: { Authorization: `Bearer ${token}` },
    +    +    +            });
    +    +    +            if (filesRes.ok) {
    +    +    +              const filesData = await filesRes.json();
    +    +    +              setBuildFiles(filesData.items ?? []);
         +    +            }
    -    +    +          }, 300);
    +    +    +          } catch { /* best effort */ }
    +    +             } else {
    +    +               addToast('Failed to load build');
         +             }
    -    +             return;
    -    +           }
    -    +    +      /* Real error Ôö£├ÂÔö£├ºÔö£├é stop */
    -    +           listeningRef.current = false;
    -    +           setListening(false);
    -    +         };
    -    +     
    -    +    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    -    +         rec.onend = () => {
    -    +    +      /* Browser ends recognition after silence; auto-restart if user hasn't toggled off */
    -    +           if (listeningRef.current) {
    -    +    -        try { rec.start(); } catch { /* already running */ }
    -    +    -      } else {
    -    +    -        setListening(false);
    -    +    +        setTimeout(() => {
    -    +    +          if (listeningRef.current) {
    -    +    +            try { rec.start(); } catch { /* already running */ }
    +    +    @@ -431,6 +451,21 @@ function BuildProgress() {
    +    +                 addActivity(`Audit FAIL for ${phase} (loop ${loop})`, 'warn');
    +    +                 break;
    +    +               }
    +         +
    +    -     export default defineConfig({
    +    -       plugins: [react()],
    +    -       server: {
    +    -    @@ -10,11 +22,12 @@ export default defineConfig({
    +    -           '/auth/login': 'http://localhost:8000',
    +    -           '/auth/github': 'http://localhost:8000',
    +    -           '/auth/me': 'http://localhost:8000',
    +    -    -      '/repos': 'http://localhost:8000',
    +    -    -      '/projects': 'http://localhost:8000',
    +    -    +      '/auth/api-key': 'http://localhost:8000',
    +    -    +      '/repos': apiProxy,
    +    -    +      '/projects': apiProxy,
    +    -           '/webhooks': 'http://localhost:8000',
    +    -           '/ws': {
    +    -    -        target: 'ws://localhost:8000',
    +    -    +        target: 'http://localhost:8000',
    +    -             ws: true,
    +    +    +          case 'file_created': {
    +    +    +            const filePath = (payload.path ?? '') as string;
    +    +    +            const sizeBytes = (payload.size_bytes ?? 0) as number;
    +    +    +            const language = (payload.language ?? '') as string;
    +    +    +            if (filePath) {
    +    +    +              setBuildFiles((prev) => {
    +    +    +                // Avoid duplicates (same path)
    +    +    +                if (prev.some((f) => f.path === filePath)) return prev;
    +    +    +                return [...prev, { path: filePath, size_bytes: sizeBytes, language, created_at: new Date().toISOString() }];
    +    +    +              });
    +    +    +              addActivity(`File created: ${filePath} (${sizeBytes} bytes)`, 'info');
    +    +    +            }
    +    +    +            break;
         +    +          }
    -    +    +        }, 300);
    -    +           }
    -    +         };
    -    +     
    -    +    -    recognitionRef.current = rec;
    -    +    -    return () => {
    -    +    -      listeningRef.current = false;
    -    +    -      rec.abort();
    -    +    -    };
    -    +    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    -    +    +    recRef.current = rec;
    -    +    +    return rec;
    -    +       }, []);
    -    +     
    -    +    -  const toggle = useCallback(() => {
    -    +    -    const rec = recognitionRef.current;
    -    +    +  const stop = useCallback(() => {
    -    +    +    listeningRef.current = false;
    -    +    +    setListening(false);
    -    +    +    const rec = recRef.current;
    -    +    +    if (rec) {
    -    +    +      try { rec.stop(); } catch { /* ignore */ }
    -    +    +    }
    -    +    +  }, []);
    -    +    +
    -    +    +  const start = useCallback(() => {
    -    +    +    const rec = getRec();
    -    +         if (!rec) return;
    -    +    +    /* Stop any active session first, then restart */
    -    +    +    try { rec.stop(); } catch { /* not running */ }
    -    +    +    listeningRef.current = true;
    -    +    +    setListening(true);
    -    +    +    /* Small delay to let the previous stop() settle */
    -    +    +    setTimeout(() => {
    -    +    +      if (listeningRef.current) {
    -    +    +        try { rec.start(); } catch { /* already running */ }
    -    +    +      }
    -    +    +    }, 100);
    -    +    +  }, [getRec]);
    -    +    +
    -    +    +  const toggle = useCallback(() => {
    -    +         if (listening) {
    -    +    -      listeningRef.current = false;
    -    +    -      rec.abort();
    -    +    -      setListening(false);
    -    +    +      stop();
    -    +         } else {
    -    +    -      listeningRef.current = true;
    -    +    -      rec.start();
    -    +    -      setListening(true);
    -    +    +      start();
    -    +         }
    -    +    -  }, [listening]);
    -    +    +  }, [listening, start, stop]);
    -    +    +
    -    +    +  /* Cleanup on unmount */
    -    +    +  useEffect(() => {
    -    +    +    return () => {
    -    +    +      listeningRef.current = false;
    -    +    +      const rec = recRef.current;
    -    +    +      recRef.current = null;
    -    +    +      if (rec) {
    -    +    +        rec.onresult = null;
    -    +    +        rec.onerror = null;
    -    +    +        rec.onend = null;
    -    +    +        try { rec.abort(); } catch { /* ignore */ }
    -    +    +      }
    -    +    +    };
    -    +    +  }, []);
    +    +             }
    +                },
    +    -         },
    +    +           [projectId, addActivity, addToast],
    +    +    @@ -610,7 +645,8 @@ function BuildProgress() {
    +    +             {/* ---- Two-column layout ---- */}
    +    +             <div style={twoColStyle}>
         +     
    -    +       return { listening, toggle, supported: !!SpeechRecognition };
    -    +     }
    +    +    -          {/* ======== LEFT: Phase Checklist ======== */}
    +    +    +          {/* ======== LEFT: Phase Checklist + Files ======== */}
    +    +    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
    +    +               <div style={{ ...cardStyle, padding: '12px 16px' }}>
    +    +                 <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    +                   Phases ({doneCount}/{totalPhases})
    +    +    @@ -679,6 +715,47 @@ function BuildProgress() {
    +    +                 </div>
    +    +               </div>
         +     
    -    +    -function speak(text: string) {
    -    +    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    -    +    -  window.speechSynthesis.cancel();
    -    +    -  const utter = new SpeechSynthesisUtterance(text);
    -    +    -  utter.rate = 1.05;
    -    +    -  utter.pitch = 1;
    -    +    -  window.speechSynthesis.speak(utter);
    -    +    -}
    +    +    +          {/* ======== Files Panel ======== */}
    +    +    +          {buildFiles.length > 0 && (
    +    +    +            <div style={{ ...cardStyle, padding: '12px 16px' }}>
    +    +    +              <div
    +    +    +                style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', cursor: 'pointer', marginBottom: filesExpanded ? '10px' : 0 }}
    +    +    +                onClick={() => setFilesExpanded(!filesExpanded)}
    +    +    +              >
    +    +    +                <h3 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    +    +                  Files ({buildFiles.length})
    +    +    +                </h3>
    +    +    +                <span style={{ color: '#64748B', fontSize: '0.7rem', transition: 'transform 0.2s', transform: filesExpanded ? 'rotate(180deg)' : 'rotate(0)' }}>Ôö£├ÂÔö£Ôòù├ö├▓├ÿ</span>
    +    +    +              </div>
    +    +    +              {filesExpanded && (
    +    +    +                <div style={{ display: 'flex', flexDirection: 'column', gap: '2px', maxHeight: '260px', overflowY: 'auto' }} data-testid="build-files-panel">
    +    +    +                  {buildFiles.map((f) => (
    +    +    +                    <div
    +    +    +                      key={f.path}
    +    +    +                      style={{
    +    +    +                        display: 'flex',
    +    +    +                        alignItems: 'center',
    +    +    +                        gap: '8px',
    +    +    +                        padding: '5px 8px',
    +    +    +                        borderRadius: '4px',
    +    +    +                        background: '#0F172A',
    +    +    +                        fontSize: '0.72rem',
    +    +    +                      }}
    +    +    +                    >
    +    +    +                      <span style={{ color: '#64748B', flexShrink: 0 }}>Ôö¼┬í├ú├åÔö£ÔöñÔö£├▒</span>
    +    +    +                      <span style={{ color: '#F8FAFC', flex: 1, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{f.path}</span>
    +    +    +                      <span style={{ color: '#475569', flexShrink: 0, fontSize: '0.65rem' }}>
    +    +    +                        {f.language && <span style={{ marginRight: '6px', color: '#64748B' }}>{f.language}</span>}
    +    +    +                        {f.size_bytes > 0 && `${(f.size_bytes / 1024).toFixed(1)}k`}
    +    +    +                      </span>
    +    +    +                    </div>
    +    +    +                  ))}
    +    +    +                </div>
    +    +    +              )}
    +    +    +            </div>
    +    +    +          )}
    +    +    +          </div>
         +    +
    +    +               {/* ======== RIGHT: Metrics + Activity Feed ======== */}
    +    +               <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
         +     
    -    +     /* ------------------------------------------------------------------ */
    -    +     /*  Progress bar                                                      */
    -    +    @@ -265,7 +305,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +       const [messages, setMessages] = useState<ChatMessage[]>([]);
    -    +       const [input, setInput] = useState('');
    -    +       const [sending, setSending] = useState(false);
    -    +    -  const [generating, setGenerating] = useState(false);
    -    +       const [qState, setQState] = useState<QuestionnaireState>({
    -    +         current_section: 'product_intent',
    -    +         completed_sections: [],
    -    +    @@ -273,7 +312,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +         is_complete: false,
    -    +       });
    -    +       const [error, setError] = useState('');
    -    +    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    -    +    +  const [resetting, setResetting] = useState(false);
    -    +    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    -    +    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    -    +       const messagesEndRef = useRef<HTMLDivElement>(null);
    -    +       const textareaRef = useRef<HTMLTextAreaElement>(null);
    +    +    diff --git a/web/src/pages/ProjectDetail.tsx b/web/src/pages/ProjectDetail.tsx
    +    +    index 873d603..14ae4bc 100644
    +    +    --- a/web/src/pages/ProjectDetail.tsx
    +    +    +++ b/web/src/pages/ProjectDetail.tsx
    +    +    @@ -11,6 +11,7 @@ import Skeleton from '../components/Skeleton';
    +    +     import ConfirmDialog from '../components/ConfirmDialog';
    +    +     import QuestionnaireModal from '../components/QuestionnaireModal';
    +    +     import ContractProgress from '../components/ContractProgress';
    +    +    +import BuildTargetModal, { type BuildTarget } from '../components/BuildTargetModal';
         +     
    -    +    @@ -307,13 +348,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +                 remaining_sections: state.remaining_sections,
    -    +                 is_complete: state.is_complete,
    -    +               });
    -    +    -          /* Restore prior conversation */
    -    +    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    -    +    -            (m: { role: string; content: string }) => ({
    -    +    -              role: m.role as 'user' | 'assistant',
    -    +    -              content: m.content,
    -    +    -            }),
    -    +    -          );
    -    +    +          /* Restore prior conversation Ôö£├ÂÔö£├ºÔö£├é only messages from the current section */
    -    +    +          const currentSec = state.current_section;
    -    +    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    -    +    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    -    +    +            .map(
    -    +    +              (m: { role: string; content: string; section?: string }) => ({
    -    +    +                role: m.role as 'user' | 'assistant',
    -    +    +                content: m.content,
    -    +    +                section: m.section,
    -    +    +              }),
    -    +    +            );
    -    +    +          /* Restore token usage */
    -    +    +          if (state.token_usage) {
    -    +    +            setTokenUsage(state.token_usage);
    -    +    +          }
    -    +               if (history.length > 0) {
    -    +                 setMessages(history);
    -    +               } else if (!state.is_complete) {
    -    +    @@ -367,18 +416,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +           }
    +    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
         +     
    -    +           const data = await res.json();
    -    +    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    -    +    +
    -    +    +      /* Detect section transition Ôö£├ÂÔö£├ºÔö£├é clear visible messages for a fresh screen */
    -    +    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    -    +    +      const prevSection = qState.current_section;
    -    +    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    -    +    +
    -    +    +      if (sectionChanged) {
    -    +    +        /* Section just completed Ôö£├ÂÔö£├ºÔö£├é start fresh with only the transition reply */
    -    +    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    -    +    +      } else {
    -    +    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    -    +    +      }
    -    +    +
    -    +           setQState({
    -    +    -        current_section: data.remaining_sections[0] ?? null,
    -    +    +        current_section: newCurrentSection,
    -    +             completed_sections: data.completed_sections,
    -    +             remaining_sections: data.remaining_sections,
    -    +             is_complete: data.is_complete,
    -    +           });
    +    +    @@ -69,6 +70,7 @@ function ProjectDetail() {
    +    +       const [showQuestionnaire, setShowQuestionnaire] = useState(false);
    +    +       const [contractsExpanded, setContractsExpanded] = useState(false);
    +    +       const [showRegenerate, setShowRegenerate] = useState(false);
    +    +    +  const [showTargetPicker, setShowTargetPicker] = useState(false);
         +     
    -    +    -      /* auto-read assistant reply with TTS */
    -    +    -      if (voiceEnabled) {
    -    +    -        speak(data.reply);
    -    +    +      /* Update token usage */
    -    +    +      if (data.token_usage) {
    -    +    +        setTokenUsage(data.token_usage);
    -    +           }
    -    +    +
    -    +         } catch {
    -    +           setError('Network error');
    -    +         } finally {
    -    +    @@ -387,25 +449,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +       };
    +    +       useEffect(() => {
    +    +         const fetchProject = async () => {
    +    +    @@ -95,14 +97,23 @@ function ProjectDetail() {
    +    +           setShowQuestionnaire(true);
    +    +           return;
    +    +         }
    +    +    +    /* Show target picker modal */
    +    +    +    setShowTargetPicker(true);
    +    +    +  };
         +     
    -    +       /* ---- Generate contracts ---- */
    -    +    -  const handleGenerate = async () => {
    -    +    -    setGenerating(true);
    -    +    -    setError('');
    -    +    -    try {
    -    +    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    -    +    -        method: 'POST',
    +    +    +  const handleTargetConfirm = async (target: BuildTarget) => {
    +    +         setStarting(true);
    +    +         try {
    +    +           const res = await fetch(`${API_BASE}/projects/${projectId}/build`, {
    +    +             method: 'POST',
         +    -        headers: { Authorization: `Bearer ${token}` },
    -    +    -      });
    -    +    -      if (res.ok) {
    -    +    -        onContractsGenerated();
    -    +    -      } else {
    -    +    -        const d = await res.json().catch(() => ({}));
    -    +    -        setError(d.detail || 'Failed to generate contracts');
    -    +    -      }
    -    +    -    } catch {
    -    +    -      setError('Network error');
    -    +    -    } finally {
    -    +    -      setGenerating(false);
    -    +    -    }
    -    +    +  const handleStartGenerate = () => {
    -    +    +    setGeneratingContracts(true);
    -    +       };
    -    +     
    -    +       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    -    +    @@ -442,21 +487,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    -    +                       : 'Starting...'}
    -    +                 </p>
    -    +    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    -    +    +              Model: claude-haiku-4-5
    -    +    +            </p>
    -    +    +            {/* Context window meter */}
    -    +    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    -    +    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    -    +    +              const contextWindow = 200_000;
    -    +    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    -    +    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    -    +    +              return (
    -    +    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    -    +    +                  <div style={{
    -    +    +                    flex: 1,
    -    +    +                    height: '4px',
    -    +    +                    background: '#1E293B',
    -    +    +                    borderRadius: '2px',
    -    +    +                    overflow: 'hidden',
    -    +    +                    maxWidth: '120px',
    -    +    +                  }}>
    -    +    +                    <div style={{
    -    +    +                      width: `${pct}%`,
    -    +    +                      height: '100%',
    -    +    +                      background: barColor,
    -    +    +                      borderRadius: '2px',
    -    +    +                      transition: 'width 0.3s',
    -    +    +                    }} />
    -    +    +                  </div>
    -    +    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    -    +    +                    {totalTokens.toLocaleString()} / 200K
    -    +    +                  </span>
    -    +    +                </div>
    -    +    +              );
    -    +    +            })()}
    -    +               </div>
    -    +               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    -    +    -            {/* Voice toggle */}
    -    +    +            {/* Restart questionnaire */}
    -    +                 <button
    -    +    -              onClick={() => setVoiceEnabled((v) => !v)}
    -    +    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    -    +    -              data-testid="voice-toggle"
    -    +    +              onClick={async () => {
    -    +    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    -    +    +                setResetting(true);
    -    +    +                try {
    -    +    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    -    +    +                    method: 'DELETE',
    -    +    +                    headers: { Authorization: `Bearer ${token}` },
    -    +    +                  });
    -    +    +                  if (res.ok) {
    -    +    +                    setMessages([]);
    -    +    +                    setQState({
    -    +    +                      current_section: 'product_intent',
    -    +    +                      completed_sections: [],
    -    +    +                      remaining_sections: [...ALL_SECTIONS],
    -    +    +                      is_complete: false,
    -    +    +                    });
    -    +    +                    setInput('');
    -    +    +                    setError('');
    -    +    +                  }
    -    +    +                } catch { /* ignore */ }
    -    +    +                setResetting(false);
    -    +    +              }}
    -    +    +              disabled={resetting}
    -    +    +              title="Restart questionnaire"
    -    +    +              data-testid="restart-btn"
    -    +                   style={{
    -    +                     ...btnGhost,
    -    +                     padding: '6px 10px',
    -    +    -                fontSize: '1rem',
    -    +    -                opacity: voiceEnabled ? 1 : 0.5,
    -    +    +                fontSize: '0.7rem',
    -    +    +                fontWeight: 600,
    -    +    +                color: '#F59E0B',
    -    +    +                borderColor: '#F59E0B33',
    -    +    +                opacity: resetting ? 0.5 : 1,
    -    +                   }}
    -    +                 >
    -    +    -              {voiceEnabled ? 'Ôö¼┬í├ú├åÔö£├éÔö£┬┐' : 'Ôö¼┬í├ú├åÔö£├éÔö£┬║'}
    -    +    +              Ôö£├ÂÔö£├æ├ö├▓├╣ Restart
    -    +                 </button>
    -    +                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    -    +                   Ôö£├ÂÔö¼├║Ôö£Ôûô
    -    +    @@ -514,8 +617,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +               </div>
    -    +             )}
    -    +     
    -    +    +        {/* Contract generation progress */}
    -    +    +        {generatingContracts && (
    -    +    +          <ContractProgress
    -    +    +            projectId={projectId}
    -    +    +            tokenUsage={tokenUsage}
    -    +    +            model="claude-haiku-4-5"
    -    +    +            onComplete={onContractsGenerated}
    -    +    +          />
    -    +    +        )}
    -    +    +
    -    +             {/* Generate contracts banner */}
    -    +    -        {qState.is_complete && (
    -    +    +        {qState.is_complete && !generatingContracts && (
    -    +               <div
    -    +                 style={{
    -    +                   padding: '12px 20px',
    -    +    @@ -533,17 +646,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -    +                   Ôö£├ÂÔö¼├║Ôö£Ôöñ All sections complete Ôö£├ÂÔö£├ºÔö£├é ready to generate contracts
    -    +                 </span>
    -    +                 <button
    -    +    -              onClick={handleGenerate}
    -    +    -              disabled={generating}
    -    +    +              onClick={handleStartGenerate}
    -    +                   data-testid="generate-contracts-btn"
    -    +                   style={{
    -    +                     ...btnPrimary,
    -    +                     background: '#16A34A',
    -    +    -                opacity: generating ? 0.6 : 1,
    -    +    -                cursor: generating ? 'wait' : 'pointer',
    -    +    +                cursor: 'pointer',
    -    +                   }}
    -    +                 >
    -    +    -              {generating ? 'Generating...' : 'Generate Contracts'}
    -    +    +              Generate Contracts
    -    +                 </button>
    -    +               </div>
    -    +             )}
    -    +    diff --git a/web/src/context/AuthContext.tsx b/web/src/context/AuthContext.tsx
    -    +    index 3f217e2..0430bc8 100644
    -    +    --- a/web/src/context/AuthContext.tsx
    -    +    +++ b/web/src/context/AuthContext.tsx
    -    +    @@ -4,6 +4,7 @@ interface User {
    -    +       id: string;
    -    +       github_login: string;
    -    +       avatar_url: string | null;
    -    +    +  has_anthropic_key?: boolean;
    -    +     }
    -    +     
    -    +     interface AuthContextValue {
    -    +    @@ -11,6 +12,7 @@ interface AuthContextValue {
    -    +       user: User | null;
    -    +       login: (token: string, user: User) => void;
    -    +       logout: () => void;
    -    +    +  updateUser: (patch: Partial<User>) => void;
    -    +     }
    -    +     
    -    +     const AuthContext = createContext<AuthContextValue | null>(null);
    -    +    @@ -38,6 +40,15 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    -    +         localStorage.removeItem('forgeguard_user');
    -    +       };
    -    +     
    -    +    +  const updateUser = (patch: Partial<User>) => {
    -    +    +    setUser((prev) => {
    -    +    +      if (!prev) return prev;
    -    +    +      const updated = { ...prev, ...patch };
    -    +    +      localStorage.setItem('forgeguard_user', JSON.stringify(updated));
    -    +    +      return updated;
    -    +    +    });
    -    +    +  };
    -    +    +
    -    +       useEffect(() => {
    -    +         if (!token) return;
    -    +         // Validate token on mount by calling /auth/me
    -    +    @@ -53,7 +64,7 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    -    +       }, []); // eslint-disable-line react-hooks/exhaustive-deps
    -    +     
    -    +       return (
    -    +    -    <AuthContext.Provider value={{ token, user, login, logout }}>
    -    +    +    <AuthContext.Provider value={{ token, user, login, logout, updateUser }}>
    -    +           {children}
    -    +         </AuthContext.Provider>
    -    +       );
    -    +    diff --git a/web/src/pages/BuildComplete.tsx b/web/src/pages/BuildComplete.tsx
    -    +    index e419947..19ece0f 100644
    -    +    --- a/web/src/pages/BuildComplete.tsx
    -    +    +++ b/web/src/pages/BuildComplete.tsx
    -    +    @@ -184,6 +184,7 @@ export default function BuildComplete() {
    -    +               <h3 style={{ color: '#F8FAFC', margin: '0 0 12px' }}>Token Usage by Phase</h3>
    -    +               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', borderBottom: '1px solid #334155', color: '#94A3B8', fontSize: 13 }}>
    -    +                 <span style={{ flex: 2 }}>Phase</span>
    -    +    +            <span style={{ flex: 1 }}>Model</span>
    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Input</span>
    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Output</span>
    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>Cost</span>
    -    +    @@ -191,6 +192,7 @@ export default function BuildComplete() {
    -    +               {summary.cost.phases.map((entry, i) => (
    -    +                 <div key={i} style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #1E293B', color: '#F8FAFC', fontSize: 14 }}>
    -    +                   <span style={{ flex: 2 }}>{entry.phase}</span>
    -    +    +              <span style={{ flex: 1, color: '#A78BFA', fontSize: 12 }}>{entry.model.replace('claude-', '')}</span>
    -    +                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.input_tokens)}</span>
    -    +                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.output_tokens)}</span>
    -    +                   <span style={{ flex: 1, textAlign: 'right' }}>${entry.estimated_cost_usd.toFixed(4)}</span>
    -    +    @@ -198,6 +200,7 @@ export default function BuildComplete() {
    -    +               ))}
    -    +               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0 0', color: '#F8FAFC', fontWeight: 600, fontSize: 14 }}>
    -    +                 <span style={{ flex: 2 }}>Total</span>
    -    +    +            <span style={{ flex: 1 }}></span>
    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_input_tokens)}</span>
    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_output_tokens)}</span>
    -    +                 <span style={{ flex: 1, textAlign: 'right' }}>${summary.cost.total_cost_usd.toFixed(4)}</span>
    -    +    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    -    +    index a4f1808..7e97168 100644
    -    +    --- a/web/src/pages/BuildProgress.tsx
    -    +    +++ b/web/src/pages/BuildProgress.tsx
    -    +    @@ -303,6 +303,10 @@ function BuildProgress() {
    -    +                   <span style={{ color: '#94A3B8' }}>Phase: </span>
    -    +                   <span style={{ fontWeight: 600 }}>{build.phase}</span>
    -    +                 </div>
    -    +    +            <div>
    -    +    +              <span style={{ color: '#94A3B8' }}>Model: </span>
    -    +    +              <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    -    +    +            </div>
    -    +                 {elapsedStr && (
    -    +                   <div>
    -    +                     <span style={{ color: '#94A3B8' }}>Elapsed: </span>
    -    +    diff --git a/web/src/pages/ProjectDetail.tsx b/web/src/pages/ProjectDetail.tsx
    -    +    index bbb2777..78a0f36 100644
    -    +    --- a/web/src/pages/ProjectDetail.tsx
    -    +    +++ b/web/src/pages/ProjectDetail.tsx
    -    +    @@ -13,6 +13,28 @@ import QuestionnaireModal from '../components/QuestionnaireModal';
    -    +     
    -    +     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -    +     
    -    +    +const needsKeyBanner = (
    -    +    +  <div style={{
    -    +    +    background: '#1E293B',
    -    +    +    border: '1px solid #92400E',
    -    +    +    borderRadius: '6px',
    -    +    +    padding: '10px 16px',
    -    +    +    marginBottom: '16px',
    -    +    +    fontSize: '0.8rem',
    -    +    +    color: '#FBBF24',
    -    +    +    display: 'flex',
    -    +    +    alignItems: 'center',
    -    +    +    gap: '10px',
    -    +    +  }}>
    -    +    +    <span style={{ fontSize: '1rem' }}>Ôö¼┬í├ú├åÔö£├éÔö£┬¬</span>
    -    +    +    <span>
    -    +    +      Add your Anthropic API key in{' '}
    -    +    +      <Link to="/settings" style={{ color: '#60A5FA', textDecoration: 'underline' }}>Settings</Link>{' '}
    -    +    +      to start a build. Questionnaires and audits are free.
    -    +    +    </span>
    -    +    +  </div>
    -    +    +);
    -    +    +
    -    +     interface ProjectDetailData {
    -    +       id: string;
    -    +       name: string;
    -    +    @@ -34,7 +56,7 @@ interface ProjectDetailData {
    -    +     
    -    +     function ProjectDetail() {
    -    +       const { projectId } = useParams<{ projectId: string }>();
    -    +    -  const { token } = useAuth();
    -    +    +  const { user, token } = useAuth();
    -    +       const { addToast } = useToast();
    -    +       const navigate = useNavigate();
    -    +       const [project, setProject] = useState<ProjectDetailData | null>(null);
    -    +    @@ -282,6 +304,9 @@ function ProjectDetail() {
    -    +               </div>
    -    +             </div>
    -    +     
    -    +    +        {/* BYOK warning */}
    -    +    +        {hasContracts && !buildActive && !(user?.has_anthropic_key) && needsKeyBanner}
    -    +    +
    -    +             {/* Build Actions */}
    -    +             <div style={{ display: 'flex', gap: '12px', marginBottom: '24px' }}>
    -    +               {!buildActive && (
    -    +    diff --git a/web/src/pages/Settings.tsx b/web/src/pages/Settings.tsx
    -    +    new file mode 100644
    -    +    index 0000000..29c213d
    -    +    --- /dev/null
    -    +    +++ b/web/src/pages/Settings.tsx
    -    +    @@ -0,0 +1,280 @@
    -    +    +/**
    -    +    + * Settings -- user settings page with BYOK API key management.
    -    +    + */
    -    +    +import { useState } from 'react';
    -    +    +import { useNavigate } from 'react-router-dom';
    -    +    +import { useAuth } from '../context/AuthContext';
    -    +    +import { useToast } from '../context/ToastContext';
    -    +    +import AppShell from '../components/AppShell';
    -    +    +
    -    +    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -    +    +
    -    +    +function Settings() {
    -    +    +  const { user, token, updateUser } = useAuth();
    -    +    +  const { addToast } = useToast();
    -    +    +  const navigate = useNavigate();
    -    +    +
    -    +    +  const [apiKey, setApiKey] = useState('');
    -    +    +  const [saving, setSaving] = useState(false);
    -    +    +  const [removing, setRemoving] = useState(false);
    -    +    +
    -    +    +  const hasKey = user?.has_anthropic_key ?? false;
    -    +    +
    -    +    +  const handleSaveKey = async () => {
    -    +    +    const trimmed = apiKey.trim();
    -    +    +    if (!trimmed) return;
    -    +    +    setSaving(true);
    -    +    +    try {
    -    +    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    -    +    +        method: 'PUT',
         +    +        headers: {
         +    +          Authorization: `Bearer ${token}`,
         +    +          'Content-Type': 'application/json',
         +    +        },
    -    +    +        body: JSON.stringify({ api_key: trimmed }),
    -    +    +      });
    -    +    +      if (res.ok) {
    -    +    +        addToast('API key saved', 'success');
    -    +    +        setApiKey('');
    -    +    +        updateUser({ has_anthropic_key: true });
    -    +    +      } else {
    -    +    +        const data = await res.json().catch(() => ({ detail: 'Failed to save key' }));
    -    +    +        addToast(data.detail || 'Failed to save key');
    -    +    +      }
    -    +    +    } catch {
    -    +    +      addToast('Network error saving key');
    -    +    +    } finally {
    -    +    +      setSaving(false);
    -    +    +    }
    -    +    +  };
    -    +    +
    -    +    +  const handleRemoveKey = async () => {
    -    +    +    setRemoving(true);
    -    +    +    try {
    -    +    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    -    +    +        method: 'DELETE',
    -    +    +        headers: { Authorization: `Bearer ${token}` },
    -    +    +      });
    -    +    +      if (res.ok) {
    -    +    +        addToast('API key removed', 'info');
    -    +    +        updateUser({ has_anthropic_key: false });
    -    +    +      } else {
    -    +    +        addToast('Failed to remove key');
    -    +    +      }
    -    +    +    } catch {
    -    +    +      addToast('Network error removing key');
    -    +    +    } finally {
    -    +    +      setRemoving(false);
    -    +    +    }
    -    +    +  };
    -    +    +
    -    +    +  return (
    -    +    +    <AppShell>
    -    +    +      <div style={{ padding: '24px', maxWidth: '720px', margin: '0 auto' }}>
    -    +    +        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    -    +    +          <button
    -    +    +            onClick={() => navigate('/')}
    -    +    +            style={{
    -    +    +              background: 'transparent',
    -    +    +              color: '#94A3B8',
    -    +    +              border: '1px solid #334155',
    -    +    +              borderRadius: '6px',
    -    +    +              padding: '6px 12px',
    -    +    +              cursor: 'pointer',
    -    +    +              fontSize: '0.8rem',
    -    +    +            }}
    -    +    +          >
    -    +    +            Back
    -    +    +          </button>
    -    +    +          <h2 style={{ margin: 0, fontSize: '1.1rem' }}>Settings</h2>
    -    +    +        </div>
    -    +    +
    -    +    +        {/* Profile Section */}
    -    +    +        <div
    -    +    +          style={{
    -    +    +            background: '#1E293B',
    -    +    +            borderRadius: '8px',
    -    +    +            padding: '20px',
    -    +    +            marginBottom: '16px',
    -    +    +          }}
    -    +    +        >
    -    +    +          <h3 style={{ margin: '0 0 16px', fontSize: '0.9rem', color: '#F8FAFC' }}>Profile</h3>
    -    +    +          <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
    -    +    +            {user?.avatar_url && (
    -    +    +              <img
    -    +    +                src={user.avatar_url}
    -    +    +                alt={user.github_login}
    -    +    +                style={{ width: 48, height: 48, borderRadius: '50%' }}
    -    +    +              />
    -    +    +            )}
    -    +    +            <div>
    -    +    +              <div style={{ fontWeight: 600, fontSize: '0.95rem' }}>{user?.github_login}</div>
    -    +    +              <div style={{ color: '#64748B', fontSize: '0.8rem', marginTop: '2px' }}>
    -    +    +                Authenticated via GitHub
    -    +    +              </div>
    -    +    +            </div>
    -    +    +          </div>
    -    +    +        </div>
    -    +    +
    -    +    +        {/* BYOK API Key Section */}
    -    +    +        <div
    -    +    +          style={{
    -    +    +            background: '#1E293B',
    -    +    +            borderRadius: '8px',
    -    +    +            padding: '20px',
    -    +    +            marginBottom: '16px',
    -    +    +          }}
    -    +    +          data-testid="byok-section"
    -    +    +        >
    -    +    +          <h3 style={{ margin: '0 0 4px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    -    +    +            Anthropic API Key
    -    +    +          </h3>
    -    +    +          <p style={{ margin: '0 0 14px', fontSize: '0.75rem', color: '#64748B', lineHeight: 1.5 }}>
    -    +    +            Builds use Claude Opus and run on your own Anthropic API key.
    -    +    +            Planning, questionnaires, and audits are free Ôö£├ÂÔö£├ºÔö£├é powered by Haiku on us.
    -    +    +          </p>
    -    +    +
    -    +    +          {hasKey ? (
    -    +    +            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    -    +    +              <div style={{
    -    +    +                flex: 1,
    -    +    +                display: 'flex',
    -    +    +                alignItems: 'center',
    -    +    +                gap: '8px',
    -    +    +                padding: '8px 12px',
    -    +    +                background: '#0F172A',
    -    +    +                borderRadius: '6px',
    -    +    +                fontSize: '0.8rem',
    -    +    +              }}>
    -    +    +                <span style={{ color: '#22C55E', fontSize: '0.7rem' }}>Ôö£├ÂÔö£ÔòúÔö£├á</span>
    -    +    +                <span style={{ color: '#94A3B8' }}>Key configured</span>
    -    +    +                <span style={{ color: '#64748B', fontFamily: 'monospace' }}>sk-ant-Ôö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£ÔöéÔö£├ÂÔö£├ºÔö£Ôöé</span>
    -    +    +              </div>
    -    +    +              <button
    -    +    +                onClick={handleRemoveKey}
    -    +    +                disabled={removing}
    -    +    +                data-testid="remove-api-key-btn"
    -    +    +                style={{
    -    +    +                  background: 'transparent',
    -    +    +                  color: '#EF4444',
    -    +    +                  border: '1px solid #7F1D1D',
    -    +    +                  borderRadius: '6px',
    -    +    +                  padding: '6px 14px',
    -    +    +                  cursor: removing ? 'not-allowed' : 'pointer',
    -    +    +                  fontSize: '0.75rem',
    -    +    +                  opacity: removing ? 0.6 : 1,
    -    +    +                }}
    -    +    +              >
    -    +    +                {removing ? 'Removing...' : 'Remove'}
    -    +    +              </button>
    -    +    +            </div>
    -    +    +          ) : (
    -    +    +            <div>
    -    +    +              <div style={{ display: 'flex', gap: '8px' }}>
    -    +    +                <input
    -    +    +                  type="password"
    -    +    +                  value={apiKey}
    -    +    +                  onChange={(e) => setApiKey(e.target.value)}
    -    +    +                  placeholder="sk-ant-api03-..."
    -    +    +                  data-testid="api-key-input"
    -    +    +                  style={{
    -    +    +                    flex: 1,
    -    +    +                    background: '#0F172A',
    -    +    +                    border: '1px solid #334155',
    -    +    +                    borderRadius: '6px',
    -    +    +                    padding: '8px 12px',
    -    +    +                    color: '#F8FAFC',
    -    +    +                    fontSize: '0.8rem',
    -    +    +                    fontFamily: 'monospace',
    -    +    +                    outline: 'none',
    -    +    +                  }}
    -    +    +                  onKeyDown={(e) => { if (e.key === 'Enter') handleSaveKey(); }}
    -    +    +                />
    -    +    +                <button
    -    +    +                  onClick={handleSaveKey}
    -    +    +                  disabled={saving || !apiKey.trim()}
    -    +    +                  data-testid="save-api-key-btn"
    -    +    +                  style={{
    -    +    +                    background: saving ? '#1E293B' : '#2563EB',
    -    +    +                    color: '#fff',
    -    +    +                    border: 'none',
    -    +    +                    borderRadius: '6px',
    -    +    +                    padding: '8px 18px',
    -    +    +                    cursor: saving || !apiKey.trim() ? 'not-allowed' : 'pointer',
    -    +    +                    fontSize: '0.8rem',
    -    +    +                    opacity: saving || !apiKey.trim() ? 0.6 : 1,
    -    +    +                  }}
    -    +    +                >
    -    +    +                  {saving ? 'Saving...' : 'Save Key'}
    -    +    +                </button>
    -    +    +              </div>
    -    +    +              <p style={{ margin: '8px 0 0', fontSize: '0.7rem', color: '#64748B' }}>
    -    +    +                Your key is stored securely and only used for build operations.
    -    +    +                Get one at{' '}
    -    +    +                <a
    -    +    +                  href="https://console.anthropic.com/settings/keys"
    -    +    +                  target="_blank"
    -    +    +                  rel="noopener noreferrer"
    -    +    +                  style={{ color: '#60A5FA' }}
    -    +    +                >
    -    +    +                  console.anthropic.com
    -    +    +                </a>
    -    +    +              </p>
    -    +    +            </div>
    -    +    +          )}
    -    +    +        </div>
    -    +    +
    -    +    +        {/* AI Models info */}
    -    +    +        <div
    -    +    +          style={{
    -    +    +            background: '#1E293B',
    -    +    +            borderRadius: '8px',
    -    +    +            padding: '20px',
    -    +    +            marginBottom: '16px',
    -    +    +          }}
    -    +    +        >
    -    +    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>AI Models</h3>
    -    +    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', fontSize: '0.8rem' }}>
    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    -    +    +              <span style={{ color: '#94A3B8' }}>Questionnaire</span>
    -    +    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    -    +    +                <span style={{ color: '#22C55E', fontWeight: 600 }}>claude-haiku-4-5</span>
    -    +    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>FREE</span>
    -    +    +              </div>
    -    +    +            </div>
    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    -    +    +              <span style={{ color: '#94A3B8' }}>Builder</span>
    -    +    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    -    +    +                <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    -    +    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>BYOK</span>
    -    +    +              </div>
    -    +    +            </div>
    -    +    +          </div>
    -    +    +        </div>
    -    +    +
    -    +    +        {/* About Section */}
    -    +    +        <div
    -    +    +          style={{
    -    +    +            background: '#1E293B',
    -    +    +            borderRadius: '8px',
    -    +    +            padding: '20px',
    -    +    +          }}
    -    +    +        >
    -    +    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>About</h3>
    -    +    +          <div style={{ fontSize: '0.8rem', color: '#94A3B8', display: 'flex', flexDirection: 'column', gap: '6px' }}>
    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    -    +    +              <span>Version</span>
    -    +    +              <span style={{ color: '#F8FAFC' }}>v0.1.0</span>
    -    +    +            </div>
    -    +    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    -    +    +              <span>Framework</span>
    -    +    +              <span style={{ color: '#F8FAFC' }}>Forge Governance</span>
    -    +    +            </div>
    -    +    +          </div>
    -    +    +        </div>
    -    +    +      </div>
    -    +    +    </AppShell>
    -    +    +  );
    -    +    +}
    -    +    +
    -    +    +export default Settings;
    -    +    diff --git a/web/vite.config.ts b/web/vite.config.ts
    -    +    index 136369a..43cba1f 100644
    -    +    --- a/web/vite.config.ts
    -    +    +++ b/web/vite.config.ts
    -    +    @@ -1,6 +1,18 @@
    -    +     import { defineConfig } from 'vite';
    -    +     import react from '@vitejs/plugin-react';
    +    +    +        body: JSON.stringify(target),
    +    +           });
    +    +           if (res.ok) {
    +    +    +        setShowTargetPicker(false);
    +    +             addToast('Build started', 'success');
    +    +             navigate(`/projects/${projectId}/build`);
    +    +           } else {
    +    +    @@ -482,6 +493,14 @@ function ProjectDetail() {
    +    +             />
    +    +           )}
         +     
    -    +    +/* Bypass proxy for browser page navigations (Accept: text/html) so Vite
    -    +    +   serves index.html and React Router handles the route. API fetch() calls
    -    +    +   (Accept: application/json) still proxy to the backend. */
    -    +    +const apiProxy = {
    -    +    +  target: 'http://localhost:8000',
    -    +    +  bypass(req: { headers: { accept?: string } }) {
    -    +    +    if (req.headers.accept?.includes('text/html')) {
    -    +    +      return '/index.html';
    -    +    +    }
    -    +    +  },
    -    +    +};
    +    +    +      {showTargetPicker && (
    +    +    +        <BuildTargetModal
    +    +    +          onConfirm={handleTargetConfirm}
    +    +    +          onCancel={() => setShowTargetPicker(false)}
    +    +    +          starting={starting}
    +    +    +        />
    +    +    +      )}
         +    +
    -    +     export default defineConfig({
    -    +       plugins: [react()],
    -    +       server: {
    -    +    @@ -10,11 +22,12 @@ export default defineConfig({
    -    +           '/auth/login': 'http://localhost:8000',
    -    +           '/auth/github': 'http://localhost:8000',
    -    +           '/auth/me': 'http://localhost:8000',
    -    +    -      '/repos': 'http://localhost:8000',
    -    +    -      '/projects': 'http://localhost:8000',
    -    +    +      '/auth/api-key': 'http://localhost:8000',
    -    +    +      '/repos': apiProxy,
    -    +    +      '/projects': apiProxy,
    -    +           '/webhooks': 'http://localhost:8000',
    -    +           '/ws': {
    -    +    -        target: 'ws://localhost:8000',
    -    +    +        target: 'http://localhost:8000',
    -    +             ws: true,
    -    +           },
    -    +         },
    -     
    -    diff --git a/Forge/scripts/run_audit.ps1 b/Forge/scripts/run_audit.ps1
    -    index 369350b..d8df0cf 100644
    -    --- a/Forge/scripts/run_audit.ps1
    -    +++ b/Forge/scripts/run_audit.ps1
    -    @@ -1,4 +1,4 @@
    -    -┬┤ÔòùÔöÉ# scripts/run_audit.ps1
    -    +# scripts/run_audit.ps1
    -     # Deterministic audit script for Forge AEM (Autonomous Execution Mode).
    -     # Runs 9 blocking checks (A1-A9) and 3 non-blocking warnings (W1-W3).
    -     # Reads layer boundaries from Contracts/boundaries.json.
    -    @@ -24,7 +24,7 @@ param(
    -     Set-StrictMode -Version Latest
    -     $ErrorActionPreference = "Stop"
    -     
    -    -# ├ö├Â├ç├ö├Â├ç Helpers ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +# -- Helpers ------------------------------------------------------------------
    -     
    -     function Info([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Cyan }
    -     function Warn([string]$m) { Write-Host "[run_audit] $m" -ForegroundColor Yellow }
    -    @@ -41,7 +41,7 @@ function RepoRoot {
    -       return (& git rev-parse --show-toplevel).Trim()
    -     }
    -     
    -    -# ├ö├Â├ç├ö├Â├ç Main ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +# -- Main ---------------------------------------------------------------------
    -     
    -     try {
    -       RequireGit
    -    @@ -54,10 +54,10 @@ try {
    -       $timestamp = (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ")
    -     
    -       # Parse claimed files into a sorted, normalized set
    -    -  $claimed = $ClaimedFiles.Split(",") |
    -    +  $claimed = @($ClaimedFiles.Split(",") |
    -         ForEach-Object { $_.Trim().Replace("\", "/") } |
    -         Where-Object { $_ -ne "" } |
    -    -    Sort-Object -Unique
    -    +    Sort-Object -Unique)
    -     
    -       if ($claimed.Count -eq 0) {
    -         throw "ClaimedFiles is empty."
    -    @@ -79,7 +79,7 @@ try {
    -       $warnings  = [ordered]@{}
    -       $anyFail   = $false
    +    +           {showRegenerate && project && (
    +    +             <div
    +    +               style={{
          
    -    -  # ├ö├Â├ç├ö├Â├ç A1: Scope compliance ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A1: Scope compliance -----------------------------------------------
    -     
    -       try {
    -         $diffStagedRaw   = & git diff --cached --name-only 2>$null
    -    @@ -111,7 +111,7 @@ try {
    -         $anyFail = $true
    -       }
    -     
    -    -  # ├ö├Â├ç├ö├Â├ç A2: Minimal-diff discipline ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A2: Minimal-diff discipline ----------------------------------------
    -     
    -       try {
    -         $summaryRaw = & git diff --cached --summary 2>&1
    -    @@ -133,7 +133,7 @@ try {
    -         $anyFail = $true
    -       }
    +    diff --git a/app/api/routers/builds.py b/app/api/routers/builds.py
    +    index 6ef15b8..6ed7f39 100644
    +    --- a/app/api/routers/builds.py
    +    +++ b/app/api/routers/builds.py
    +    @@ -3,6 +3,7 @@
    +     from uuid import UUID
          
    -    -  # ├ö├Â├ç├ö├Â├ç A3: Evidence completeness ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A3: Evidence completeness ------------------------------------------
    +     from fastapi import APIRouter, Depends, HTTPException, Query
    +    +from pydantic import BaseModel
          
    -       try {
    -         $a3Failures = @()
    -    @@ -164,7 +164,7 @@ try {
    -         $anyFail = $true
    -       }
    +     from app.api.deps import get_current_user
    +     from app.api.rate_limit import build_limiter
    +    @@ -11,19 +12,31 @@ from app.services import build_service
    +     router = APIRouter(prefix="/projects", tags=["builds"])
          
    -    -  # ├ö├Â├ç├ö├Â├ç A4: Boundary compliance (reads Contracts/boundaries.json) ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A4: Boundary compliance (reads Contracts/boundaries.json) ----------
          
    -       try {
    -         $a4Violations = @()
    -    @@ -213,7 +213,7 @@ try {
    -         $anyFail = $true
    -       }
    +    +class StartBuildRequest(BaseModel):
    +    +    """Request body for starting a build."""
    +    +    target_type: str | None = None
    +    +    target_ref: str | None = None
    +    +
    +    +
    +     # ├ö├Â├ç├ö├Â├ç POST /projects/{project_id}/build ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
          
    -    -  # ├ö├Â├ç├ö├Â├ç A5: Diff Log Gate ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A5: Diff Log Gate --------------------------------------------------
          
    -       try {
    -         if (-not (Test-Path $diffLog)) {
    -    @@ -237,7 +237,7 @@ try {
    -         $anyFail = $true
    -       }
    +     @router.post("/{project_id}/build")
    +     async def start_build(
    +         project_id: UUID,
    +    +    body: StartBuildRequest | None = None,
    +         user: dict = Depends(get_current_user),
    +     ):
    +         """Start a build for a project."""
    +         if not build_limiter.is_allowed(str(user["id"])):
    +             raise HTTPException(status_code=429, detail="Build rate limit exceeded")
    +         try:
    +    -        build = await build_service.start_build(project_id, user["id"])
    +    +        build = await build_service.start_build(
    +    +            project_id,
    +    +            user["id"],
    +    +            target_type=body.target_type if body else None,
    +    +            target_ref=body.target_ref if body else None,
    +    +        )
    +             return build
    +         except ValueError as exc:
    +             detail = str(exc)
    +    @@ -51,6 +64,46 @@ async def cancel_build(
    +             raise HTTPException(status_code=400, detail=detail)
          
    -    -  # ├ö├Â├ç├ö├Â├ç A6: Authorization Gate ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A6: Authorization Gate ---------------------------------------------
          
    -       try {
    -         $lastAuthHash = $null
    -    @@ -268,7 +268,7 @@ try {
    -         $anyFail = $true
    -       }
    +    +# ├ö├Â├ç├ö├Â├ç GET /projects/{project_id}/build/files ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    +    +
    +    +
    +    +@router.get("/{project_id}/build/files")
    +    +async def get_build_files(
    +    +    project_id: UUID,
    +    +    user: dict = Depends(get_current_user),
    +    +):
    +    +    """List all files written during the build."""
    +    +    try:
    +    +        files = await build_service.get_build_files(project_id, user["id"])
    +    +        return {"items": files}
    +    +    except ValueError as exc:
    +    +        detail = str(exc)
    +    +        if "not found" in detail.lower():
    +    +            raise HTTPException(status_code=404, detail=detail)
    +    +        raise HTTPException(status_code=400, detail=detail)
    +    +
    +    +
    +    +# ├ö├Â├ç├ö├Â├ç GET /projects/{project_id}/build/files/{path} ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    +    +
    +    +
    +    +@router.get("/{project_id}/build/files/{path:path}")
    +    +async def get_build_file_content(
    +    +    project_id: UUID,
    +    +    path: str,
    +    +    user: dict = Depends(get_current_user),
    +    +):
    +    +    """Retrieve content of a specific file written during the build."""
    +    +    try:
    +    +        return await build_service.get_build_file_content(
    +    +            project_id, user["id"], path
    +    +        )
    +    +    except ValueError as exc:
    +    +        detail = str(exc)
    +    +        if "not found" in detail.lower():
    +    +            raise HTTPException(status_code=404, detail=detail)
    +    +        raise HTTPException(status_code=400, detail=detail)
    +    +
    +    +
    +     # ├ö├Â├ç├ö├Â├ç GET /projects/{project_id}/build/status ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
          
    -    -  # ├ö├Â├ç├ö├Â├ç A7: Verification hierarchy order ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A7: Verification hierarchy order -----------------------------------
          
    -       try {
    -         if (-not (Test-Path $diffLog)) {
    -    @@ -324,7 +324,7 @@ try {
    -         $anyFail = $true
    -       }
    +    diff --git a/app/clients/git_client.py b/app/clients/git_client.py
    +    new file mode 100644
    +    index 0000000..d0b2890
    +    --- /dev/null
    +    +++ b/app/clients/git_client.py
    +    @@ -0,0 +1,165 @@
    +    +"""Git client -- thin wrapper around asyncio.subprocess for git operations.
    +    +
    +    +Handles clone, add, commit, push for build targets. No database access,
    +    +no business logic, no HTTP framework imports.
    +    +"""
    +    +
    +    +import asyncio
    +    +import logging
    +    +import os
    +    +from pathlib import Path
    +    +
    +    +logger = logging.getLogger(__name__)
    +    +
    +    +
    +    +async def _run_git(args: list[str], cwd: str | Path, env: dict | None = None) -> str:
    +    +    """Run a git command and return stdout. Raises on non-zero exit."""
    +    +    merged_env = {**os.environ, **(env or {})}
    +    +    proc = await asyncio.create_subprocess_exec(
    +    +        "git", *args,
    +    +        cwd=str(cwd),
    +    +        stdout=asyncio.subprocess.PIPE,
    +    +        stderr=asyncio.subprocess.PIPE,
    +    +        env=merged_env,
    +    +    )
    +    +    stdout, stderr = await proc.communicate()
    +    +    out = stdout.decode("utf-8", errors="replace").strip()
    +    +    err = stderr.decode("utf-8", errors="replace").strip()
    +    +
    +    +    if proc.returncode != 0:
    +    +        logger.error("git %s failed (rc=%d): %s", " ".join(args), proc.returncode, err)
    +    +        raise RuntimeError(f"git {args[0]} failed: {err}")
    +    +
    +    +    return out
    +    +
    +    +
    +    +async def clone_repo(
    +    +    clone_url: str,
    +    +    dest: str | Path,
    +    +    *,
    +    +    branch: str | None = None,
    +    +    shallow: bool = True,
    +    +    access_token: str | None = None,
    +    +) -> str:
    +    +    """Clone a git repository to dest. Returns the dest path.
    +    +
    +    +    For GitHub repos, inject the access token into the URL for auth.
    +    +    """
    +    +    url = clone_url
    +    +    if access_token and "github.com" in clone_url:
    +    +        # Inject token for HTTPS auth: https://TOKEN@github.com/owner/repo.git
    +    +        url = clone_url.replace("https://", f"https://{access_token}@")
    +    +
    +    +    args = ["clone"]
    +    +    if shallow:
    +    +        args.extend(["--depth", "1"])
    +    +    if branch:
    +    +        args.extend(["--branch", branch])
    +    +    args.extend([url, str(dest)])
    +    +
    +    +    parent = Path(dest).parent
    +    +    parent.mkdir(parents=True, exist_ok=True)
    +    +    await _run_git(args, cwd=str(parent))
    +    +    return str(dest)
    +    +
    +    +
    +    +async def init_repo(dest: str | Path) -> str:
    +    +    """Initialize a new git repo at dest. Returns the dest path."""
    +    +    path = Path(dest)
    +    +    path.mkdir(parents=True, exist_ok=True)
    +    +    await _run_git(["init"], cwd=path)
    +    +    # Set default branch to main
    +    +    await _run_git(["checkout", "-b", "main"], cwd=path)
    +    +    return str(path)
    +    +
    +    +
    +    +async def add_all(repo_path: str | Path) -> None:
    +    +    """Stage all changes in the repo."""
    +    +    await _run_git(["add", "-A"], cwd=repo_path)
    +    +
    +    +
    +    +async def commit(repo_path: str | Path, message: str) -> str | None:
    +    +    """Commit staged changes. Returns commit hash or None if nothing to commit."""
    +    +    # Check if there are staged changes
    +    +    try:
    +    +        status = await _run_git(["status", "--porcelain"], cwd=repo_path)
    +    +        if not status.strip():
    +    +            logger.info("Nothing to commit in %s", repo_path)
    +    +            return None
    +    +    except RuntimeError:
    +    +        return None
    +    +
    +    +    # Configure committer identity for the repo
    +    +    try:
    +    +        await _run_git(["config", "user.email", "forge@forgeguard.dev"], cwd=repo_path)
    +    +        await _run_git(["config", "user.name", "ForgeGuard Builder"], cwd=repo_path)
    +    +    except RuntimeError:
    +    +        pass  # May already be configured
    +    +
    +    +    await _run_git(["add", "-A"], cwd=repo_path)
    +    +    await _run_git(["commit", "-m", message], cwd=repo_path)
    +    +    sha = await _run_git(["rev-parse", "HEAD"], cwd=repo_path)
    +    +    return sha
    +    +
    +    +
    +    +async def push(
    +    +    repo_path: str | Path,
    +    +    *,
    +    +    remote: str = "origin",
    +    +    branch: str = "main",
    +    +    access_token: str | None = None,
    +    +) -> None:
    +    +    """Push all commits to the remote."""
    +    +    env = {}
    +    +    if access_token:
    +    +        # Use credential helper to inject token
    +    +        env["GIT_ASKPASS"] = "echo"
    +    +        # Set the remote URL with token for auth
    +    +        try:
    +    +            remote_url = await _run_git(["remote", "get-url", remote], cwd=repo_path)
    +    +            if "github.com" in remote_url and "@" not in remote_url:
    +    +                authed_url = remote_url.replace(
    +    +                    "https://", f"https://{access_token}@"
    +    +                )
    +    +                await _run_git(
    +    +                    ["remote", "set-url", remote, authed_url], cwd=repo_path
    +    +                )
    +    +        except RuntimeError:
    +    +            pass
    +    +
    +    +    await _run_git(["push", "-u", remote, branch], cwd=repo_path, env=env if env else None)
    +    +
    +    +
    +    +async def set_remote(
    +    +    repo_path: str | Path,
    +    +    remote_url: str,
    +    +    *,
    +    +    remote_name: str = "origin",
    +    +) -> None:
    +    +    """Set or update the remote URL for a repo."""
    +    +    try:
    +    +        await _run_git(["remote", "add", remote_name, remote_url], cwd=repo_path)
    +    +    except RuntimeError:
    +    +        # Remote already exists, update it
    +    +        await _run_git(["remote", "set-url", remote_name, remote_url], cwd=repo_path)
    +    +
    +    +
    +    +async def get_file_list(repo_path: str | Path) -> list[str]:
    +    +    """List all tracked + untracked files in the repo (relative paths)."""
    +    +    try:
    +    +        # Get tracked files
    +    +        tracked = await _run_git(["ls-files"], cwd=repo_path)
    +    +        # Get untracked files
    +    +        untracked = await _run_git(
    +    +            ["ls-files", "--others", "--exclude-standard"], cwd=repo_path
    +    +        )
    +    +        files = set()
    +    +        for line in tracked.splitlines():
    +    +            if line.strip():
    +    +                files.add(line.strip())
    +    +        for line in untracked.splitlines():
    +    +            if line.strip():
    +    +                files.add(line.strip())
    +    +        return sorted(files)
    +    +    except RuntimeError:
    +    +        return []
    +    diff --git a/app/repos/build_repo.py b/app/repos/build_repo.py
    +    index b1d4781..44442e5 100644
    +    --- a/app/repos/build_repo.py
    +    +++ b/app/repos/build_repo.py
    +    @@ -13,17 +13,27 @@ from app.repos.db import get_pool
    +     # ---------------------------------------------------------------------------
          
    -    -  # ├ö├Â├ç├ö├Â├ç A8: Test gate ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A8: Test gate ------------------------------------------------------
          
    -       try {
    -         if (-not (Test-Path $testRunsLatest)) {
    -    @@ -344,7 +344,7 @@ try {
    -         $anyFail = $true
    -       }
    +    -async def create_build(project_id: UUID) -> dict:
    +    +async def create_build(
    +    +    project_id: UUID,
    +    +    *,
    +    +    target_type: str | None = None,
    +    +    target_ref: str | None = None,
    +    +    working_dir: str | None = None,
    +    +) -> dict:
    +         """Create a new build record in pending status."""
    +         pool = await get_pool()
    +         row = await pool.fetchrow(
    +             """
    +    -        INSERT INTO builds (project_id, phase, status)
    +    -        VALUES ($1, 'Phase 0', 'pending')
    +    -        RETURNING id, project_id, phase, status, started_at, completed_at,
    +    +        INSERT INTO builds (project_id, phase, status, target_type, target_ref, working_dir)
    +    +        VALUES ($1, 'Phase 0', 'pending', $2, $3, $4)
    +    +        RETURNING id, project_id, phase, status, target_type, target_ref,
    +    +                  working_dir, started_at, completed_at,
    +                       loop_count, error_detail, created_at
    +             """,
    +             project_id,
    +    +        target_type,
    +    +        target_ref,
    +    +        working_dir,
    +         )
    +         return dict(row)
          
    -    -  # ├ö├Â├ç├ö├Â├ç A9: Dependency gate ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- A9: Dependency gate ------------------------------------------------
    +    @@ -33,7 +43,8 @@ async def get_build_by_id(build_id: UUID) -> dict | None:
    +         pool = await get_pool()
    +         row = await pool.fetchrow(
    +             """
    +    -        SELECT id, project_id, phase, status, started_at, completed_at,
    +    +        SELECT id, project_id, phase, status, target_type, target_ref,
    +    +               working_dir, started_at, completed_at,
    +                    loop_count, error_detail, created_at
    +             FROM builds WHERE id = $1
    +             """,
    +    @@ -47,7 +58,8 @@ async def get_latest_build_for_project(project_id: UUID) -> dict | None:
    +         pool = await get_pool()
    +         row = await pool.fetchrow(
    +             """
    +    -        SELECT id, project_id, phase, status, started_at, completed_at,
    +    +        SELECT id, project_id, phase, status, target_type, target_ref,
    +    +               working_dir, started_at, completed_at,
    +                    loop_count, error_detail, created_at
    +             FROM builds WHERE project_id = $1
    +             ORDER BY created_at DESC LIMIT 1
    +    @@ -240,3 +252,34 @@ async def get_build_cost_summary(build_id: UUID) -> dict:
    +             "total_cost_usd": Decimal("0"),
    +             "phase_count": 0,
    +         }
    +    +
    +    +
    +    +async def get_build_file_logs(build_id: UUID) -> list[dict]:
    +    +    """Fetch all file_created log entries for a build.
    +    +
    +    +    Returns list of dicts with path, size_bytes, language, created_at
    +    +    parsed from build_log messages where source='file'.
    +    +    """
    +    +    pool = await get_pool()
    +    +    rows = await pool.fetch(
    +    +        """
    +    +        SELECT message, created_at
    +    +        FROM build_logs
    +    +        WHERE build_id = $1 AND source = 'file'
    +    +        ORDER BY created_at ASC
    +    +        """,
    +    +        build_id,
    +    +    )
    +    +    files = []
    +    +    for r in rows:
    +    +        try:
    +    +            data = json.loads(r["message"])
    +    +            files.append({
    +    +                "path": data.get("path", ""),
    +    +                "size_bytes": data.get("size_bytes", 0),
    +    +                "language": data.get("language", ""),
    +    +                "created_at": r["created_at"],
    +    +            })
    +    +        except (ValueError, KeyError):
    +    +            continue
    +    +    return files
    +    diff --git a/app/services/build_service.py b/app/services/build_service.py
    +    index f49a2e8..e4a33e5 100644
    +    --- a/app/services/build_service.py
    +    +++ b/app/services/build_service.py
    +    @@ -8,14 +8,20 @@ No SQL, no HTTP framework, no direct GitHub API calls.
    +     """
          
    -       try {
    -         $a9Failures = @()
    -    @@ -508,7 +508,7 @@ try {
    -         $anyFail = $true
    -       }
    +     import asyncio
    +    +import json
    +     import logging
    +    +import os
    +     import re
    +    +import shutil
    +    +import tempfile
    +     from decimal import Decimal
    +     from datetime import datetime, timezone
    +     from pathlib import Path
    +     from uuid import UUID
          
    -    -  # ├ö├Â├ç├ö├Â├ç W1: No secrets in diff ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- W1: No secrets in diff --------------------------------------------
    +     from app.clients.agent_client import StreamUsage, stream_agent
    +    +from app.clients import git_client
    +    +from app.clients import github_client
    +     from app.config import settings
    +     from app.repos import build_repo
    +     from app.repos import project_repo
    +    @@ -36,6 +42,82 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
    +     # Universal governance contract (not per-project ├ö├ç├Â loaded from disk)
    +     FORGE_CONTRACTS_DIR = Path(__file__).resolve().parent.parent.parent / "Forge" / "Contracts"
          
    -       try {
    -         $diffContent = & git diff --cached 2>&1
    -    @@ -534,7 +534,7 @@ try {
    -         $warnings["W1"] = "WARN -- Error scanning for secrets: $_"
    -       }
    +    +# File block delimiters for parsing builder output
    +    +FILE_START_PATTERN = re.compile(r"^=== FILE:\s*(.+?)\s*===$", re.MULTILINE)
    +    +FILE_END_PATTERN = re.compile(r"^=== END FILE ===$", re.MULTILINE)
    +    +
    +    +# Valid build target types
    +    +VALID_TARGET_TYPES = {"github_new", "github_existing", "local_path"}
    +    +
    +    +# Language detection by file extension
    +    +_EXT_TO_LANG: dict[str, str] = {
    +    +    ".py": "python", ".js": "javascript", ".ts": "typescript",
    +    +    ".tsx": "typescriptreact", ".jsx": "javascriptreact",
    +    +    ".json": "json", ".yaml": "yaml", ".yml": "yaml",
    +    +    ".md": "markdown", ".html": "html", ".css": "css",
    +    +    ".sql": "sql", ".sh": "shell", ".ps1": "powershell",
    +    +    ".toml": "toml", ".txt": "plaintext", ".env": "dotenv",
    +    +    ".gitignore": "ignore",
    +    +}
    +    +
    +    +
    +    +def _detect_language(file_path: str) -> str:
    +    +    """Detect language from file extension."""
    +    +    ext = Path(file_path).suffix.lower()
    +    +    name = Path(file_path).name.lower()
    +    +    if name in _EXT_TO_LANG:
    +    +        return _EXT_TO_LANG[name]
    +    +    return _EXT_TO_LANG.get(ext, "plaintext")
    +    +
    +    +
    +    +def _parse_file_blocks(text: str) -> list[dict]:
    +    +    """Parse file blocks from builder output.
    +    +
    +    +    Expected format:
    +    +        === FILE: path/to/file.py ===
    +    +        <file contents>
    +    +        === END FILE ===
    +    +
    +    +    Returns list of {path, content} dicts.
    +    +    """
    +    +    blocks: list[dict] = []
    +    +    pos = 0
    +    +    while pos < len(text):
    +    +        start_match = FILE_START_PATTERN.search(text, pos)
    +    +        if not start_match:
    +    +            break
    +    +        file_path = start_match.group(1).strip()
    +    +        content_start = start_match.end()
    +    +
    +    +        end_match = FILE_END_PATTERN.search(text, content_start)
    +    +        if not end_match:
    +    +            # No closing delimiter -- skip this block
    +    +            pos = content_start
    +    +            break
    +    +
    +    +        raw_content = text[content_start:end_match.start()]
    +    +        # Strip optional code fence wrapping (```lang ... ```)
    +    +        content = _strip_code_fence(raw_content)
    +    +
    +    +        blocks.append({"path": file_path, "content": content})
    +    +        pos = end_match.end()
    +    +
    +    +    return blocks
    +    +
    +    +
    +    +def _strip_code_fence(text: str) -> str:
    +    +    """Strip optional markdown code fence wrapper from file content."""
    +    +    stripped = text.strip()
    +    +    if stripped.startswith("```"):
    +    +        # Remove opening fence (```lang or just ```)
    +    +        first_nl = stripped.find("\n")
    +    +        if first_nl >= 0:
    +    +            stripped = stripped[first_nl + 1:]
    +    +    if stripped.rstrip().endswith("```"):
    +    +        stripped = stripped.rstrip()[:-3]
    +    +    return stripped.rstrip("\n") + "\n" if stripped.strip() else ""
    +    +
    +    +
    +     # Active build tasks keyed by build_id
    +     _active_tasks: dict[str, asyncio.Task] = {}
          
    -    -  # ├ö├Â├ç├ö├Â├ç W2: Audit ledger integrity ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- W2: Audit ledger integrity ----------------------------------------
    +    @@ -65,7 +147,13 @@ def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
    +     # ---------------------------------------------------------------------------
          
    -       try {
    -         if (-not (Test-Path $auditLedger)) {
    -    @@ -548,7 +548,7 @@ try {
    -         $warnings["W2"] = "WARN -- Error checking audit ledger: $_"
    -       }
          
    -    -  # ├ö├Â├ç├ö├Â├ç W3: Physics route coverage ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- W3: Physics route coverage ----------------------------------------
    +    -async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +    +async def start_build(
    +    +    project_id: UUID,
    +    +    user_id: UUID,
    +    +    *,
    +    +    target_type: str | None = None,
    +    +    target_ref: str | None = None,
    +    +) -> dict:
    +         """Start a build for a project.
          
    -       try {
    -         if (-not (Test-Path $physicsYaml)) {
    -    @@ -613,7 +613,7 @@ try {
    -         $warnings["W3"] = "WARN -- Error checking physics coverage: $_"
    -       }
    +         Validates that contracts exist, creates a build record, and spawns
    +    @@ -74,6 +162,8 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +         Args:
    +             project_id: The project to build.
    +             user_id: The authenticated user (for ownership check).
    +    +        target_type: Build target -- 'github_new', 'github_existing', or 'local_path'.
    +    +        target_ref: Target reference -- repo name, full_name, or absolute path.
          
    -    -  # ├ö├Â├ç├ö├Â├ç Build output ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- Build output ------------------------------------------------------
    +         Returns:
    +             The created build record.
    +    @@ -106,15 +196,43 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
          
    -       $overall = if ($anyFail) { "FAIL" } else { "PASS" }
    +         audit_llm_enabled = (user or {}).get("audit_llm_enabled", True)
          
    -    @@ -643,7 +643,7 @@ Overall: $overall
    +    +    # Validate target
    +    +    if target_type and target_type not in VALID_TARGET_TYPES:
    +    +        raise ValueError(f"Invalid target_type: {target_type}. Must be one of: {', '.join(VALID_TARGET_TYPES)}")
    +    +    if target_type and not target_ref:
    +    +        raise ValueError("target_ref is required when target_type is specified")
    +    +
    +    +    # Resolve working directory based on target type
    +    +    working_dir: str | None = None
    +    +    if target_type == "local_path":
    +    +        working_dir = str(Path(target_ref).resolve()) if target_ref else None
    +    +        if working_dir:
    +    +            Path(working_dir).mkdir(parents=True, exist_ok=True)
    +    +    elif target_type in ("github_new", "github_existing"):
    +    +        # Use a temp directory; clone/init happens in _run_build
    +    +        working_dir = tempfile.mkdtemp(prefix="forgeguard_build_")
    +    +
    +         # Create build record
    +    -    build = await build_repo.create_build(project_id)
    +    +    build = await build_repo.create_build(
    +    +        project_id,
    +    +        target_type=target_type,
    +    +        target_ref=target_ref,
    +    +        working_dir=working_dir,
    +    +    )
          
    -       Write-Output $output
    +         # Update project status
    +         await project_repo.update_project_status(project_id, "building")
          
    -    -  # ├ö├Â├ç├ö├Â├ç Append to audit ledger ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- Append to audit ledger ---------------------------------------------
    +         # Spawn background task
    +         task = asyncio.create_task(
    +    -        _run_build(build["id"], project_id, user_id, contracts, user_api_key, audit_llm_enabled)
    +    +        _run_build(
    +    +            build["id"], project_id, user_id, contracts,
    +    +            user_api_key, audit_llm_enabled,
    +    +            target_type=target_type,
    +    +            target_ref=target_ref,
    +    +            working_dir=working_dir,
    +    +            access_token=(user or {}).get("access_token", ""),
    +    +        )
    +         )
    +         _active_tasks[str(build["id"])] = task
          
    -       $iteration = 1
    -       if (Test-Path $auditLedger) {
    -    @@ -713,7 +713,7 @@ Do not overwrite or truncate this file.
    -       Add-Content -Path $auditLedger -Value $ledgerEntry -Encoding UTF8
    -       Info "Appended audit entry (Iteration $iteration, Outcome: $outcome)."
    +    @@ -232,11 +350,18 @@ async def _run_build(
    +         contracts: list[dict],
    +         api_key: str,
    +         audit_llm_enabled: bool = True,
    +    +    *,
    +    +    target_type: str | None = None,
    +    +    target_ref: str | None = None,
    +    +    working_dir: str | None = None,
    +    +    access_token: str = "",
    +     ) -> None:
    +         """Background task that orchestrates the full build lifecycle.
          
    -    -  # ├ö├Â├ç├ö├Â├ç Exit ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -    +  # -- Exit ---------------------------------------------------------------
    +         Streams agent output, detects phase completion signals, runs inline
    +         audits, handles loopback, and advances through phases.
    +    +    When a build target is configured, parses file blocks from the
    +    +    builder output and writes them to the working directory.
    +         """
    +         try:
    +             now = datetime.now(timezone.utc)
    +    @@ -255,6 +380,66 @@ async def _run_build(
    +             # Build the directive from contracts
    +             directive = _build_directive(contracts)
          
    -       if ($anyFail) {
    -         exit 1
    -    diff --git a/USER_INSTRUCTIONS.md b/USER_INSTRUCTIONS.md
    -    index c76b33a..ad50c71 100644
    -    --- a/USER_INSTRUCTIONS.md
    -    +++ b/USER_INSTRUCTIONS.md
    -    @@ -87,7 +87,7 @@ APP_URL=http://localhost:8000
    -     - `APP_URL` ├ö├ç├Â `http://localhost:8000`
    -     - `ANTHROPIC_API_KEY` ├ö├ç├Â required for AI-powered builds (get one at [console.anthropic.com](https://console.anthropic.com))
    -     - `LLM_BUILDER_MODEL` ├ö├ç├Â model for builds (default: `claude-opus-4-6`)
    -    -- `LLM_QUESTIONNAIRE_MODEL` ├ö├ç├Â model for questionnaire (default: `claude-3-5-haiku-20241022`)
    -    +- `LLM_QUESTIONNAIRE_MODEL` ├ö├ç├Â model for questionnaire (default: `claude-haiku-4-5`)
    +    +        # Set up working directory for file writing
    +    +        if target_type == "github_new" and target_ref and working_dir:
    +    +            try:
    +    +                # Create a new GitHub repo
    +    +                repo_data = await github_client.create_github_repo(
    +    +                    access_token, target_ref,
    +    +                    description=f"Built by ForgeGuard",
    +    +                    private=False,
    +    +                )
    +    +                clone_url = f"https://github.com/{repo_data['full_name']}.git"
    +    +                await git_client.clone_repo(
    +    +                    clone_url, working_dir,
    +    +                    access_token=access_token, shallow=False,
    +    +                )
    +    +                await build_repo.append_build_log(
    +    +                    build_id,
    +    +                    f"Created GitHub repo: {repo_data['full_name']}",
    +    +                    source="system", level="info",
    +    +                )
    +    +                await _broadcast_build_event(user_id, build_id, "build_log", {
    +    +                    "message": f"Created GitHub repo: {repo_data['full_name']}",
    +    +                    "source": "system", "level": "info",
    +    +                })
    +    +            except Exception as exc:
    +    +                await _fail_build(build_id, user_id, f"Failed to create GitHub repo: {exc}")
    +    +                return
    +    +        elif target_type == "github_existing" and target_ref and working_dir:
    +    +            try:
    +    +                clone_url = f"https://github.com/{target_ref}.git"
    +    +                await git_client.clone_repo(
    +    +                    clone_url, working_dir,
    +    +                    access_token=access_token, shallow=False,
    +    +                )
    +    +                await build_repo.append_build_log(
    +    +                    build_id,
    +    +                    f"Cloned existing repo: {target_ref}",
    +    +                    source="system", level="info",
    +    +                )
    +    +            except Exception as exc:
    +    +                await _fail_build(build_id, user_id, f"Failed to clone repo: {exc}")
    +    +                return
    +    +        elif target_type == "local_path" and working_dir:
    +    +            try:
    +    +                Path(working_dir).mkdir(parents=True, exist_ok=True)
    +    +                # Initialize git repo if not already one
    +    +                git_dir = Path(working_dir) / ".git"
    +    +                if not git_dir.exists():
    +    +                    await git_client.init_repo(working_dir)
    +    +                await build_repo.append_build_log(
    +    +                    build_id,
    +    +                    f"Using local path: {working_dir}",
    +    +                    source="system", level="info",
    +    +                )
    +    +            except Exception as exc:
    +    +                await _fail_build(build_id, user_id, f"Failed to initialize local path: {exc}")
    +    +                return
    +    +
    +    +        # Track files written during this build
    +    +        files_written: list[dict] = []
    +    +
    +             # Conversation history for the agent
    +             messages: list[dict] = [
    +                 {"role": "user", "content": directive},
    +    @@ -289,6 +474,17 @@ async def _run_build(
    +                         }
    +                     )
          
    -     ---
    +    +            # Detect and write file blocks
    +    +            new_blocks = _parse_file_blocks(accumulated_text)
    +    +            already_written_count = len(files_written)
    +    +            if len(new_blocks) > already_written_count and working_dir:
    +    +                for block in new_blocks[already_written_count:]:
    +    +                    await _write_file_block(
    +    +                        build_id, user_id, working_dir,
    +    +                        block["path"], block["content"],
    +    +                        files_written,
    +    +                    )
    +    +
    +                 # Detect phase completion
    +                 if PHASE_COMPLETE_SIGNAL in accumulated_text:
    +                     phase_match = re.search(
    +    @@ -337,6 +533,22 @@ async def _run_build(
    +                                 "phase": current_phase,
    +                             }
    +                         )
    +    +
    +    +                    # Git commit after phase audit passes
    +    +                    if working_dir and files_written:
    +    +                        try:
    +    +                            sha = await git_client.commit(
    +    +                                working_dir,
    +    +                                f"forge: {current_phase} complete",
    +    +                            )
    +    +                            if sha:
    +    +                                await build_repo.append_build_log(
    +    +                                    build_id,
    +    +                                    f"Committed {current_phase}: {sha[:8]}",
    +    +                                    source="system", level="info",
    +    +                                )
    +    +                        except Exception as exc:
    +    +                            logger.warning("Git commit failed for %s: %s", current_phase, exc)
    +                     else:
    +                         loop_count = await build_repo.increment_loop_count(build_id)
    +                         await build_repo.append_build_log(
    +    @@ -383,6 +595,35 @@ async def _run_build(
    +                 build_id, "Build completed successfully", source="system", level="info"
    +             )
          
    -    diff --git a/app/api/routers/auth.py b/app/api/routers/auth.py
    -    index dffd10d..cf3df44 100644
    -    --- a/app/api/routers/auth.py
    -    +++ b/app/api/routers/auth.py
    -    @@ -1,13 +1,15 @@
    -    -"""Authentication router -- GitHub OAuth flow and user info."""
    -    +"""Authentication router -- GitHub OAuth flow, user info, and BYOK API key management."""
    +    +        # Final commit + push for GitHub targets
    +    +        if working_dir and files_written:
    +    +            try:
    +    +                sha = await git_client.commit(working_dir, "forge: build complete")
    +    +                if sha:
    +    +                    await build_repo.append_build_log(
    +    +                        build_id, f"Final commit: {sha[:8]}", source="system", level="info",
    +    +                    )
    +    +            except Exception as exc:
    +    +                logger.warning("Final git commit failed: %s", exc)
    +    +
    +    +            if target_type in ("github_new", "github_existing") and access_token:
    +    +                try:
    +    +                    await git_client.push(
    +    +                        working_dir, access_token=access_token,
    +    +                    )
    +    +                    await build_repo.append_build_log(
    +    +                        build_id, "Pushed to GitHub", source="system", level="info",
    +    +                    )
    +    +                    await _broadcast_build_event(user_id, build_id, "build_log", {
    +    +                        "message": "Pushed all commits to GitHub",
    +    +                        "source": "system", "level": "info",
    +    +                    })
    +    +                except Exception as exc:
    +    +                    logger.error("Git push failed: %s", exc)
    +    +                    await build_repo.append_build_log(
    +    +                        build_id, f"Git push failed: {exc}", source="system", level="error",
    +    +                    )
    +    +
    +             # Gather total cost summary for the final event
    +             cost_summary = await build_repo.get_build_cost_summary(build_id)
    +             await _broadcast_build_event(user_id, build_id, "build_complete", {
    +    @@ -401,6 +642,120 @@ async def _run_build(
    +             await _fail_build(build_id, user_id, str(exc))
    +         finally:
    +             _active_tasks.pop(str(build_id), None)
    +    +        # Cleanup temp working dir for GitHub targets on failure/cancel
    +    +        # (keep on success so user can inspect; they'll be cleaned up later)
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# File Writing Helpers
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +async def _write_file_block(
    +    +    build_id: UUID,
    +    +    user_id: UUID,
    +    +    working_dir: str,
    +    +    file_path: str,
    +    +    content: str,
    +    +    files_written: list[dict],
    +    +) -> None:
    +    +    """Write a file block to the working directory and emit events."""
    +    +    try:
    +    +        # Sanitize path -- prevent directory traversal
    +    +        clean_path = Path(file_path).as_posix()
    +    +        if clean_path.startswith("/") or ".." in clean_path:
    +    +            logger.warning("Skipping suspicious file path: %s", file_path)
    +    +            return
    +    +
    +    +        full_path = Path(working_dir) / clean_path
    +    +        full_path.parent.mkdir(parents=True, exist_ok=True)
    +    +        full_path.write_text(content, encoding="utf-8")
    +    +
    +    +        size_bytes = len(content.encode("utf-8"))
    +    +        language = _detect_language(clean_path)
    +    +
    +    +        file_info = {
    +    +            "path": clean_path,
    +    +            "size_bytes": size_bytes,
    +    +            "language": language,
    +    +        }
    +    +        files_written.append(file_info)
    +    +
    +    +        # Log as structured file entry (source='file' for querying)
    +    +        await build_repo.append_build_log(
    +    +            build_id,
    +    +            json.dumps(file_info),
    +    +            source="file",
    +    +            level="info",
    +    +        )
    +    +
    +    +        # Broadcast file_created event
    +    +        await _broadcast_build_event(user_id, build_id, "file_created", file_info)
    +    +
    +    +        logger.info("Wrote file: %s (%d bytes)", clean_path, size_bytes)
    +    +
    +    +    except Exception as exc:
    +    +        logger.error("Failed to write file %s: %s", file_path, exc)
    +    +        await build_repo.append_build_log(
    +    +            build_id,
    +    +            f"Failed to write file {file_path}: {exc}",
    +    +            source="system",
    +    +            level="error",
    +    +        )
    +    +
    +    +
    +    +async def get_build_files(
    +    +    project_id: UUID, user_id: UUID
    +    +) -> list[dict]:
    +    +    """Get list of files written during the latest build.
    +    +
    +    +    Returns list of {path, size_bytes, language, created_at}.
    +    +    """
    +    +    project = await project_repo.get_project_by_id(project_id)
    +    +    if not project or str(project["user_id"]) != str(user_id):
    +    +        raise ValueError("Project not found")
    +    +
    +    +    latest = await build_repo.get_latest_build_for_project(project_id)
    +    +    if not latest:
    +    +        raise ValueError("No builds found for this project")
    +    +
    +    +    return await build_repo.get_build_file_logs(latest["id"])
    +    +
    +    +
    +    +async def get_build_file_content(
    +    +    project_id: UUID, user_id: UUID, file_path: str
    +    +) -> dict:
    +    +    """Get content of a specific file from the build working directory.
    +    +
    +    +    Returns {path, content, size_bytes, language}.
    +    +    """
    +    +    project = await project_repo.get_project_by_id(project_id)
    +    +    if not project or str(project["user_id"]) != str(user_id):
    +    +        raise ValueError("Project not found")
    +    +
    +    +    latest = await build_repo.get_latest_build_for_project(project_id)
    +    +    if not latest:
    +    +        raise ValueError("No builds found for this project")
    +    +
    +    +    working_dir = latest.get("working_dir")
    +    +    if not working_dir:
    +    +        raise ValueError("Build has no working directory")
    +    +
    +    +    clean_path = Path(file_path).as_posix()
    +    +    if ".." in clean_path:
    +    +        raise ValueError("Invalid file path")
    +    +
    +    +    full_path = Path(working_dir) / clean_path
    +    +    if not full_path.exists():
    +    +        raise ValueError(f"File not found: {clean_path}")
    +    +
    +    +    content = full_path.read_text(encoding="utf-8")
    +    +    return {
    +    +        "path": clean_path,
    +    +        "content": content,
    +    +        "size_bytes": len(content.encode("utf-8")),
    +    +        "language": _detect_language(clean_path),
    +    +    }
          
    -     import secrets
    -     from urllib.parse import urlencode
          
    -     from fastapi import APIRouter, Depends, HTTPException, Query, status
    -    +from pydantic import BaseModel
    +     # ---------------------------------------------------------------------------
    +    diff --git a/db/migrations/008_build_targets.sql b/db/migrations/008_build_targets.sql
    +    new file mode 100644
    +    index 0000000..eb29b44
    +    --- /dev/null
    +    +++ b/db/migrations/008_build_targets.sql
    +    @@ -0,0 +1,7 @@
    +    +-- Phase 12: Build Target & File Writing
    +    +-- Adds target columns to builds table so builds can write files
    +    +-- to a GitHub repo (new or existing) or a local directory.
    +    +
    +    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS target_type VARCHAR(20);
    +    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS target_ref TEXT;
    +    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS working_dir TEXT;
    +    diff --git a/tests/test_build_repo.py b/tests/test_build_repo.py
    +    index 218e2b3..efcff9d 100644
    +    --- a/tests/test_build_repo.py
    +    +++ b/tests/test_build_repo.py
    +    @@ -264,3 +264,90 @@ async def test_get_build_cost_summary(mock_get_pool):
          
    -     from app.api.deps import get_current_user
    -     from app.clients.github_client import GITHUB_OAUTH_URL
    -     from app.config import settings
    -    +from app.repos.user_repo import set_anthropic_api_key
    -     from app.services.auth_service import handle_github_callback
    +         assert summary["total_input_tokens"] == 5000
    +         assert summary["phase_count"] == 3
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: get_build_file_logs
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +@pytest.mark.asyncio
    +    +@patch("app.repos.build_repo.get_pool")
    +    +async def test_get_build_file_logs(mock_get_pool):
    +    +    """get_build_file_logs returns parsed file entries."""
    +    +    import json
    +    +    pool = _fake_pool()
    +    +    pool.fetch.return_value = [
    +    +        {
    +    +            "message": json.dumps({"path": "src/main.py", "size_bytes": 42, "language": "python"}),
    +    +            "created_at": datetime.now(timezone.utc),
    +    +        },
    +    +        {
    +    +            "message": json.dumps({"path": "package.json", "size_bytes": 200, "language": "json"}),
    +    +            "created_at": datetime.now(timezone.utc),
    +    +        },
    +    +    ]
    +    +    mock_get_pool.return_value = pool
    +    +
    +    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +    +
    +    +    assert len(files) == 2
    +    +    assert files[0]["path"] == "src/main.py"
    +    +    assert files[0]["language"] == "python"
    +    +    assert files[1]["path"] == "package.json"
    +    +
    +    +
    +    +@pytest.mark.asyncio
    +    +@patch("app.repos.build_repo.get_pool")
    +    +async def test_get_build_file_logs_invalid_json(mock_get_pool):
    +    +    """get_build_file_logs skips invalid JSON messages."""
    +    +    pool = _fake_pool()
    +    +    pool.fetch.return_value = [
    +    +        {
    +    +            "message": "not valid json",
    +    +            "created_at": datetime.now(timezone.utc),
    +    +        },
    +    +    ]
    +    +    mock_get_pool.return_value = pool
    +    +
    +    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +    +
    +    +    assert len(files) == 0
    +    +
    +    +
    +    +@pytest.mark.asyncio
    +    +@patch("app.repos.build_repo.get_pool")
    +    +async def test_get_build_file_logs_empty(mock_get_pool):
    +    +    """get_build_file_logs returns empty list when no file logs."""
    +    +    pool = _fake_pool()
    +    +    pool.fetch.return_value = []
    +    +    mock_get_pool.return_value = pool
    +    +
    +    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +    +
    +    +    assert files == []
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: create_build with target params
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +@pytest.mark.asyncio
    +    +@patch("app.repos.build_repo.get_pool")
    +    +async def test_create_build_with_target(mock_get_pool):
    +    +    """create_build passes target params to the query."""
    +    +    pool = _fake_pool()
    +    +    row = _build_row()
    +    +    pool.fetchrow.return_value = row
    +    +    mock_get_pool.return_value = pool
    +    +
    +    +    result = await build_repo.create_build(
    +    +        row["project_id"],
    +    +        target_type="local_path",
    +    +        target_ref="/tmp/test",
    +    +        working_dir="/tmp/test",
    +    +    )
    +    +
    +    +    pool.fetchrow.assert_called_once()
    +    +    assert result["project_id"] == row["project_id"]
    +    diff --git a/tests/test_build_service.py b/tests/test_build_service.py
    +    index 2ea1cc9..61ebf81 100644
    +    --- a/tests/test_build_service.py
    +    +++ b/tests/test_build_service.py
    +    @@ -77,7 +77,12 @@ async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_
    +         result = await build_service.start_build(_PROJECT_ID, _USER_ID)
          
    -     router = APIRouter(prefix="/auth", tags=["auth"])
    -    @@ -66,8 +68,36 @@ async def get_current_user_info(
    -         current_user: dict = Depends(get_current_user),
    -     ) -> dict:
    -         """Return the current authenticated user info."""
    -    +    has_api_key = bool(current_user.get("anthropic_api_key"))
    -         return {
    -             "id": str(current_user["id"]),
    -             "github_login": current_user["github_login"],
    -             "avatar_url": current_user.get("avatar_url"),
    -    +        "has_anthropic_key": has_api_key,
    -         }
    +         assert result["status"] == "pending"
    +    -    mock_build_repo.create_build.assert_called_once_with(_PROJECT_ID)
    +    +    mock_build_repo.create_build.assert_called_once_with(
    +    +        _PROJECT_ID,
    +    +        target_type=None,
    +    +        target_ref=None,
    +    +        working_dir=None,
    +    +    )
    +         mock_project_repo.update_project_status.assert_called_once_with(
    +             _PROJECT_ID, "building"
    +         )
    +    @@ -484,3 +489,318 @@ def test_get_token_rates_model_aware():
    +         unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
    +         assert unk_in == Decimal("0.000015")
    +         assert unk_out == Decimal("0.000075")
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: _detect_language
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +def test_detect_language_python():
    +    +    assert build_service._detect_language("src/main.py") == "python"
    +    +
    +    +
    +    +def test_detect_language_typescript():
    +    +    assert build_service._detect_language("src/App.tsx") == "typescriptreact"
    +    +
    +    +
    +    +def test_detect_language_json():
    +    +    assert build_service._detect_language("package.json") == "json"
    +    +
    +    +
    +    +def test_detect_language_unknown():
    +    +    assert build_service._detect_language("data.xyz") == "plaintext"
    +    +
    +    +
    +    +def test_detect_language_dotenv():
    +    +    assert build_service._detect_language(".env") == "dotenv"
    +    +
    +    +
    +    +def test_detect_language_gitignore():
    +    +    assert build_service._detect_language(".gitignore") == "ignore"
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: _parse_file_blocks
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +def test_parse_file_blocks_single():
    +    +    """Single file block parsed correctly."""
    +    +    text = """Some preamble text
    +    +=== FILE: src/main.py ===
    +    +print("hello")
    +    +=== END FILE ===
    +    +Some trailing text"""
    +    +
    +    +    blocks = build_service._parse_file_blocks(text)
    +    +    assert len(blocks) == 1
    +    +    assert blocks[0]["path"] == "src/main.py"
    +    +    assert 'print("hello")' in blocks[0]["content"]
    +    +
    +    +
    +    +def test_parse_file_blocks_multiple():
    +    +    """Multiple consecutive file blocks parsed."""
    +    +    text = """
    +    +=== FILE: file1.py ===
    +    +content1
    +    +=== END FILE ===
    +    +=== FILE: file2.ts ===
    +    +content2
    +    +=== END FILE ===
    +    +"""
    +    +    blocks = build_service._parse_file_blocks(text)
    +    +    assert len(blocks) == 2
    +    +    assert blocks[0]["path"] == "file1.py"
    +    +    assert blocks[1]["path"] == "file2.ts"
    +    +    assert "content1" in blocks[0]["content"]
    +    +    assert "content2" in blocks[1]["content"]
    +    +
    +    +
    +    +def test_parse_file_blocks_with_code_fence():
    +    +    """File block wrapped in code fence gets fence stripped."""
    +    +    text = """=== FILE: test.py ===
    +    +```python
    +    +def hello():
    +    +    pass
    +    +```
    +    +=== END FILE ==="""
    +    +
    +    +    blocks = build_service._parse_file_blocks(text)
    +    +    assert len(blocks) == 1
    +    +    assert "def hello" in blocks[0]["content"]
    +    +    assert "```" not in blocks[0]["content"]
    +    +
    +    +
    +    +def test_parse_file_blocks_no_end_marker():
    +    +    """Missing END FILE marker ├ö├ç├Â block is skipped."""
    +    +    text = """=== FILE: orphan.py ===
    +    +some content without end marker
    +    +"""
    +    +    blocks = build_service._parse_file_blocks(text)
    +    +    assert len(blocks) == 0
    +    +
    +    +
    +    +def test_parse_file_blocks_empty_input():
    +    +    """Empty string returns empty list."""
    +    +    assert build_service._parse_file_blocks("") == []
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: _strip_code_fence
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +def test_strip_code_fence_basic():
    +    +    """Strip a basic code fence wrapper."""
    +    +    text = "```python\nprint('hi')\n```"
    +    +    result = build_service._strip_code_fence(text)
    +    +    assert "print('hi')" in result
    +    +    assert "```" not in result
    +    +
    +    +
    +    +def test_strip_code_fence_no_fence():
    +    +    """No code fence ├ö├ç├Â content passes through."""
    +    +    text = "plain content\n"
    +    +    result = build_service._strip_code_fence(text)
    +    +    assert "plain content" in result
    +    +
    +    +
    +    +def test_strip_code_fence_empty():
    +    +    """Empty string returns empty."""
    +    +    assert build_service._strip_code_fence("") == ""
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: _write_file_block
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +    +@patch("app.services.build_service.build_repo")
    +    +async def test_write_file_block_success(mock_build_repo, mock_broadcast, tmp_path):
    +    +    """_write_file_block writes a file and emits events."""
    +    +    mock_build_repo.append_build_log = AsyncMock()
    +    +    files_written: list[dict] = []
    +    +
    +    +    await build_service._write_file_block(
    +    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +    +        "src/hello.py", "print('hello')\n", files_written,
    +    +    )
    +    +
    +    +    # File should exist on disk
    +    +    written_file = tmp_path / "src" / "hello.py"
    +    +    assert written_file.exists()
    +    +    assert written_file.read_text() == "print('hello')\n"
    +    +
    +    +    # File info should be appended to files_written
    +    +    assert len(files_written) == 1
    +    +    assert files_written[0]["path"] == "src/hello.py"
    +    +    assert files_written[0]["language"] == "python"
    +    +    assert files_written[0]["size_bytes"] == len("print('hello')\n".encode())
    +    +
    +    +    # Build log should be recorded
    +    +    mock_build_repo.append_build_log.assert_called_once()
    +    +
    +    +    # WS event should be broadcast
    +    +    mock_broadcast.assert_called_once()
    +    +
    +    +
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +    +@patch("app.services.build_service.build_repo")
    +    +async def test_write_file_block_traversal_rejected(mock_build_repo, mock_broadcast, tmp_path):
    +    +    """_write_file_block rejects paths with directory traversal."""
    +    +    files_written: list[dict] = []
    +    +
    +    +    await build_service._write_file_block(
    +    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +    +        "../../../etc/passwd", "bad content", files_written,
    +    +    )
         +
    +    +    # No file should be written
    +    +    assert len(files_written) == 0
    +    +    mock_build_repo.append_build_log.assert_not_called()
         +
    -    +class ApiKeyBody(BaseModel):
    -    +    api_key: str
         +
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +    +@patch("app.services.build_service.build_repo")
    +    +async def test_write_file_block_absolute_rejected(mock_build_repo, mock_broadcast, tmp_path):
    +    +    """_write_file_block rejects absolute paths."""
    +    +    files_written: list[dict] = []
         +
    -    +@router.put("/api-key")
    -    +async def save_api_key(
    -    +    body: ApiKeyBody,
    -    +    current_user: dict = Depends(get_current_user),
    -    +) -> dict:
    -    +    """Save the user's Anthropic API key for BYOK builds."""
    -    +    key = body.api_key.strip()
    -    +    if not key:
    -    +        raise HTTPException(status_code=400, detail="API key cannot be empty")
    -    +    await set_anthropic_api_key(current_user["id"], key)
    -    +    return {"saved": True}
    +    +    await build_service._write_file_block(
    +    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +    +        "/etc/passwd", "bad content", files_written,
    +    +    )
         +
    +    +    assert len(files_written) == 0
    +    +    mock_build_repo.append_build_log.assert_not_called()
         +
    -    +@router.delete("/api-key")
    -    +async def remove_api_key(
    -    +    current_user: dict = Depends(get_current_user),
    -    +) -> dict:
    -    +    """Remove the user's stored Anthropic API key."""
    -    +    await set_anthropic_api_key(current_user["id"], None)
    -    +    return {"removed": True}
    -    diff --git a/app/api/routers/builds.py b/app/api/routers/builds.py
    -    index 9f0a5e0..6ef15b8 100644
    -    --- a/app/api/routers/builds.py
    -    +++ b/app/api/routers/builds.py
    -    @@ -92,6 +92,24 @@ async def get_build_logs(
    -             raise HTTPException(status_code=400, detail=detail)
    -     
    -     
    -    +# ├ö├Â├ç├ö├Â├ç GET /projects/{project_id}/build/phases ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
         +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: get_build_files
    +    +# ---------------------------------------------------------------------------
         +
    -    +@router.get("/{project_id}/build/phases")
    -    +async def get_build_phases(
    -    +    project_id: UUID,
    -    +    user: dict = Depends(get_current_user),
    -    +):
    -    +    """Phase definitions parsed from the project's phases contract."""
    -    +    try:
    -    +        return await build_service.get_build_phases(project_id, user["id"])
    -    +    except ValueError as exc:
    -    +        detail = str(exc)
    -    +        if "not found" in detail.lower():
    -    +            raise HTTPException(status_code=404, detail=detail)
    -    +        raise HTTPException(status_code=400, detail=detail)
         +
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service.project_repo")
    +    +@patch("app.services.build_service.build_repo")
    +    +async def test_get_build_files(mock_build_repo, mock_project_repo):
    +    +    """get_build_files returns file list from build logs."""
    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +    +        return_value=_build(status="completed")
    +    +    )
    +    +    mock_build_repo.get_build_file_logs = AsyncMock(return_value=[
    +    +        {"path": "src/main.py", "size_bytes": 100, "language": "python", "created_at": "2025-01-01T00:00:00Z"},
    +    +    ])
         +
    -     # ├ö├Â├ç├ö├Â├ç GET /projects/{project_id}/build/summary ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -     
    -     
    -    diff --git a/app/api/routers/projects.py b/app/api/routers/projects.py
    -    index 0e72551..cc00763 100644
    -    --- a/app/api/routers/projects.py
    -    +++ b/app/api/routers/projects.py
    -    @@ -17,6 +17,7 @@ from app.services.project_service import (
    -         list_contracts,
    -         list_user_projects,
    -         process_questionnaire_message,
    -    +    reset_questionnaire,
    -         update_contract,
    -     )
    -     
    -    @@ -177,6 +178,20 @@ async def questionnaire_progress(
    -             )
    -     
    -     
    -    +@router.delete("/{project_id}/questionnaire")
    -    +async def questionnaire_reset(
    -    +    project_id: UUID,
    -    +    current_user: dict = Depends(get_current_user),
    -    +) -> dict:
    -    +    """Reset questionnaire to start over."""
    -    +    try:
    -    +        return await reset_questionnaire(current_user["id"], project_id)
    -    +    except ValueError as exc:
    -    +        raise HTTPException(
    -    +            status_code=status.HTTP_404_NOT_FOUND, detail=str(exc)
    -    +        )
    +    +    result = await build_service.get_build_files(_PROJECT_ID, _USER_ID)
         +
    +    +    assert len(result) == 1
    +    +    assert result[0]["path"] == "src/main.py"
         +
    -     # ---------------------------------------------------------------------------
    -     # Contracts
    -     # ---------------------------------------------------------------------------
    -    diff --git a/app/clients/llm_client.py b/app/clients/llm_client.py
    -    index 60b0218..19622bd 100644
    -    --- a/app/clients/llm_client.py
    -    +++ b/app/clients/llm_client.py
    -    @@ -47,13 +47,20 @@ async def chat_anthropic(
    -                 raise ValueError(f"Anthropic API {response.status_code}: {err_msg}")
    -     
    -         data = response.json()
    -    +    usage = data.get("usage", {})
    -         content_blocks = data.get("content", [])
    -         if not content_blocks:
    -             raise ValueError("Empty response from Anthropic API")
    -     
    -         for block in content_blocks:
    -             if block.get("type") == "text":
    -    -            return block["text"]
    -    +            return {
    -    +                "text": block["text"],
    -    +                "usage": {
    -    +                    "input_tokens": usage.get("input_tokens", 0),
    -    +                    "output_tokens": usage.get("output_tokens", 0),
    -    +                },
    -    +            }
    -     
    -         raise ValueError("No text block in Anthropic API response")
    -     
    -    @@ -112,7 +119,14 @@ async def chat_openai(
    -         if not content:
    -             raise ValueError("No content in OpenAI API response")
    -     
    -    -    return content
    -    +    usage = data.get("usage", {})
    -    +    return {
    -    +        "text": content,
    -    +        "usage": {
    -    +            "input_tokens": usage.get("prompt_tokens", 0),
    -    +            "output_tokens": usage.get("completion_tokens", 0),
    -    +        },
    -    +    }
    -     
    -     
    -     # ---------------------------------------------------------------------------
    -    @@ -147,8 +161,8 @@ async def chat(
    -     
    -         Returns
    -         -------
    -    -    str
    -    -        The assistant's text reply.
    -    +    dict
    -    +        ``{"text": str, "usage": {"input_tokens": int, "output_tokens": int}}``
    -         """
    -         if provider == "openai":
    -             return await chat_openai(api_key, model, system_prompt, messages, max_tokens)
    -    diff --git a/app/config.py b/app/config.py
    -    index dcff943..0845923 100644
    -    --- a/app/config.py
    -    +++ b/app/config.py
    -    @@ -44,7 +44,7 @@ class Settings:
    -         FRONTEND_URL: str = os.getenv("FRONTEND_URL", "http://localhost:5173")
    -         APP_URL: str = os.getenv("APP_URL", "http://localhost:8000")
    -         LLM_QUESTIONNAIRE_MODEL: str = os.getenv(
    -    -        "LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022"
    -    +        "LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5"
    -         )
    -         ANTHROPIC_API_KEY: str = os.getenv("ANTHROPIC_API_KEY", "")
    -         OPENAI_API_KEY: str = os.getenv("OPENAI_API_KEY", "")
    -    diff --git a/app/repos/audit_repo.py b/app/repos/audit_repo.py
    -    index 2bc2568..f30784b 100644
    -    --- a/app/repos/audit_repo.py
    -    +++ b/app/repos/audit_repo.py
    -    @@ -63,6 +63,26 @@ async def update_audit_run(
    -         )
    -     
    -     
    -    +async def mark_stale_audit_runs(repo_id: UUID, stale_minutes: int = 5) -> int:
    -    +    """Mark audit runs stuck in 'pending' or 'running' for longer than
    -    +    *stale_minutes* as 'error'. Returns the number of rows updated."""
    -    +    pool = await get_pool()
    -    +    result = await pool.execute(
    -    +        """
    -    +        UPDATE audit_runs
    -    +        SET status = 'error', overall_result = 'ERROR',
    -    +            completed_at = now()
    -    +        WHERE repo_id = $1
    -    +          AND status IN ('pending', 'running')
    -    +          AND created_at < now() - ($2 || ' minutes')::interval
    -    +        """,
    -    +        repo_id,
    -    +        str(stale_minutes),
    -    +    )
    -    +    # asyncpg returns 'UPDATE N'
    -    +    return int(result.split()[-1])
    -    +
    -    +
    -     async def insert_audit_checks(
    -         audit_run_id: UUID,
    -         checks: list[dict],
    -    diff --git a/app/repos/user_repo.py b/app/repos/user_repo.py
    -    index f8a2386..689f7a9 100644
    -    --- a/app/repos/user_repo.py
    -    +++ b/app/repos/user_repo.py
    -    @@ -38,7 +38,17 @@ async def get_user_by_id(user_id: UUID) -> dict | None:
    -         """Fetch a user by primary key. Returns None if not found."""
    -         pool = await get_pool()
    -         row = await pool.fetchrow(
    -    -        "SELECT id, github_id, github_login, avatar_url, access_token, created_at, updated_at FROM users WHERE id = $1",
    -    +        "SELECT id, github_id, github_login, avatar_url, access_token, anthropic_api_key, created_at, updated_at FROM users WHERE id = $1",
    -             user_id,
    -         )
    -         return dict(row) if row else None
         +
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service.project_repo")
    +    +@patch("app.services.build_service.build_repo")
    +    +async def test_get_build_files_no_project(mock_build_repo, mock_project_repo):
    +    +    """get_build_files raises ValueError for missing project."""
    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=None)
    +    +
    +    +    with pytest.raises(ValueError, match="not found"):
    +    +        await build_service.get_build_files(_PROJECT_ID, _USER_ID)
         +
    -    +async def set_anthropic_api_key(user_id: UUID, api_key: str | None) -> None:
    -    +    """Store (or clear) the user's Anthropic API key."""
    -    +    pool = await get_pool()
    -    +    await pool.execute(
    -    +        "UPDATE users SET anthropic_api_key = $2, updated_at = now() WHERE id = $1",
    -    +        user_id,
    -    +        api_key,
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: get_build_file_content
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service.project_repo")
    +    +@patch("app.services.build_service.build_repo")
    +    +async def test_get_build_file_content(mock_build_repo, mock_project_repo, tmp_path):
    +    +    """get_build_file_content reads file from working directory."""
    +    +    # Write a file to tmp_path
    +    +    (tmp_path / "src").mkdir()
    +    +    (tmp_path / "src" / "app.py").write_text("print('hi')\n")
    +    +
    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +    +        return_value=_build(status="completed", working_dir=str(tmp_path))
         +    )
    -    diff --git a/app/services/audit_service.py b/app/services/audit_service.py
    -    index ab835fe..1bf0d18 100644
    -    --- a/app/services/audit_service.py
    -    +++ b/app/services/audit_service.py
    -    @@ -1,5 +1,6 @@
    -     """Audit service -- orchestrates audit execution triggered by webhooks."""
    -     
    -    +import asyncio
    -     import json
    -     import logging
    -     import os
    -    @@ -12,6 +13,7 @@ from app.repos.audit_repo import (
    -         create_audit_run,
    -         get_existing_commit_shas,
    -         insert_audit_checks,
    -    +    mark_stale_audit_runs,
    -         update_audit_run,
    -     )
    -     from app.repos.repo_repo import get_repo_by_github_id, get_repo_by_id
    -    @@ -288,6 +290,11 @@ async def backfill_repo_commits(
    -         full_name = repo["full_name"]
    -         branch = repo.get("default_branch", "main")
    -     
    -    +    # Clean up any audit runs left stuck from a prior interrupted sync
    -    +    cleaned = await mark_stale_audit_runs(repo_id)
    -    +    if cleaned:
    -    +        logger.info("Cleaned %d stale audit runs for repo %s", cleaned, repo_id)
         +
    -         # Find the latest audit we already have so we only pull newer commits
    -         existing_shas = await get_existing_commit_shas(repo_id)
    -     
    -    @@ -365,6 +372,16 @@ async def backfill_repo_commits(
    -                 )
    -                 synced += 1
    -     
    -    +        except asyncio.CancelledError:
    -    +            logger.warning("Backfill cancelled for commit %s", sha)
    -    +            await update_audit_run(
    -    +                audit_run_id=audit_run["id"],
    -    +                status="error",
    -    +                overall_result="ERROR",
    -    +                files_checked=0,
    -    +            )
    -    +            raise  # re-raise so the request terminates properly
    -    +
    -             except Exception:
    -                 logger.exception("Backfill failed for commit %s", sha)
    -                 await update_audit_run(
    -    diff --git a/app/services/build_service.py b/app/services/build_service.py
    -    index e98f439..56edbd8 100644
    -    --- a/app/services/build_service.py
    -    +++ b/app/services/build_service.py
    -    @@ -17,6 +17,7 @@ from app.clients.agent_client import StreamUsage, stream_agent
    -     from app.config import settings
    -     from app.repos import build_repo
    -     from app.repos import project_repo
    -    +from app.repos.user_repo import get_user_by_id
    -     from app.ws_manager import manager
    -     
    -     # Maximum consecutive loopback failures before stopping
    -    @@ -31,9 +32,25 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
    -     # Active build tasks keyed by build_id
    -     _active_tasks: dict[str, asyncio.Task] = {}
    -     
    -    -# Cost-per-token estimates (USD) -- updated as pricing changes
    -    -_COST_PER_INPUT_TOKEN: Decimal = Decimal("0.000015")   # $15 / 1M input tokens
    -    -_COST_PER_OUTPUT_TOKEN: Decimal = Decimal("0.000075")  # $75 / 1M output tokens
    -    +# Cost-per-token estimates (USD) keyed by model prefix -- updated as pricing changes
    -    +_MODEL_PRICING: dict[str, tuple[Decimal, Decimal]] = {
    -    +    # (input $/token, output $/token)
    -    +    "claude-opus-4":       (Decimal("0.000015"),  Decimal("0.000075")),   # $15 / $75 per 1M
    -    +    "claude-sonnet-4":     (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    -    +    "claude-haiku-4":      (Decimal("0.000001"),  Decimal("0.000005")),   # $1 / $5 per 1M
    -    +    "claude-3-5-sonnet":   (Decimal("0.000003"),  Decimal("0.000015")),   # $3 / $15 per 1M
    -    +}
    -    +# Fallback: Opus pricing (most expensive = safest default)
    -    +_DEFAULT_INPUT_RATE = Decimal("0.000015")
    -    +_DEFAULT_OUTPUT_RATE = Decimal("0.000075")
    +    +    result = await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "src/app.py")
         +
    +    +    assert result["path"] == "src/app.py"
    +    +    assert "print('hi')" in result["content"]
    +    +    assert result["language"] == "python"
         +
    -    +def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
    -    +    """Return (input_rate, output_rate) per token for the given model."""
    -    +    for prefix, rates in _MODEL_PRICING.items():
    -    +        if model.startswith(prefix):
    -    +            return rates
    -    +    return (_DEFAULT_INPUT_RATE, _DEFAULT_OUTPUT_RATE)
    -     
    -     
    -     # ---------------------------------------------------------------------------
    -    @@ -72,6 +89,14 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    -         if latest and latest["status"] in ("pending", "running"):
    -             raise ValueError("A build is already in progress for this project")
    -     
    -    +    # BYOK: user must supply their own Anthropic API key for builds
    -    +    user = await get_user_by_id(user_id)
    -    +    user_api_key = (user or {}).get("anthropic_api_key") or ""
    -    +    if not user_api_key.strip():
    -    +        raise ValueError(
    -    +            "Anthropic API key required. Add your key in Settings to start a build."
    -    +        )
         +
    -         # Create build record
    -         build = await build_repo.create_build(project_id)
    -     
    -    @@ -80,7 +105,7 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
    -     
    -         # Spawn background task
    -         task = asyncio.create_task(
    -    -        _run_build(build["id"], project_id, user_id, contracts)
    -    +        _run_build(build["id"], project_id, user_id, contracts, user_api_key)
    -         )
    -         _active_tasks[str(build["id"])] = task
    -     
    -    @@ -196,6 +221,7 @@ async def _run_build(
    -         project_id: UUID,
    -         user_id: UUID,
    -         contracts: list[dict],
    -    +    api_key: str,
    -     ) -> None:
    -         """Background task that orchestrates the full build lifecycle.
    -     
    -    @@ -232,7 +258,7 @@ async def _run_build(
    -     
    -             # Stream agent output
    -             async for chunk in stream_agent(
    -    -            api_key=settings.ANTHROPIC_API_KEY,
    -    +            api_key=api_key,
    -                 model=settings.LLM_BUILDER_MODEL,
    -                 system_prompt="You are an autonomous software builder operating under the Forge governance framework.",
    -                 messages=messages,
    -    @@ -270,10 +296,16 @@ async def _run_build(
    -                         source="system",
    -                         level="info",
    -                     )
    -    +                # Capture token usage BEFORE recording (which resets)
    -    +                phase_input_tokens = usage.input_tokens
    -    +                phase_output_tokens = usage.output_tokens
    -    +
    -                     await _broadcast_build_event(
    -                         user_id, build_id, "phase_complete", {
    -                             "phase": current_phase,
    -                             "status": "pass",
    -    +                        "input_tokens": phase_input_tokens,
    -    +                        "output_tokens": phase_output_tokens,
    -                         }
    -                     )
    -     
    -    @@ -337,9 +369,15 @@ async def _run_build(
    -             await build_repo.append_build_log(
    -                 build_id, "Build completed successfully", source="system", level="info"
    -             )
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service.project_repo")
    +    +@patch("app.services.build_service.build_repo")
    +    +async def test_get_build_file_content_traversal(mock_build_repo, mock_project_repo, tmp_path):
    +    +    """get_build_file_content rejects directory traversal paths."""
    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +    +        return_value=_build(status="completed", working_dir=str(tmp_path))
    +    +    )
         +
    -    +        # Gather total cost summary for the final event
    -    +        cost_summary = await build_repo.get_build_cost_summary(build_id)
    -             await _broadcast_build_event(user_id, build_id, "build_complete", {
    -                 "id": str(build_id),
    -                 "status": "completed",
    -    +            "total_input_tokens": cost_summary["total_input_tokens"],
    -    +            "total_output_tokens": cost_summary["total_output_tokens"],
    -    +            "total_cost_usd": float(cost_summary["total_cost_usd"]),
    -             })
    -     
    -         except asyncio.CancelledError:
    -    @@ -446,8 +484,9 @@ async def _record_phase_cost(
    -         input_t = usage.input_tokens
    -         output_t = usage.output_tokens
    -         model = usage.model or settings.LLM_BUILDER_MODEL
    -    -    cost = (Decimal(input_t) * _COST_PER_INPUT_TOKEN
    -    -            + Decimal(output_t) * _COST_PER_OUTPUT_TOKEN)
    -    +    input_rate, output_rate = _get_token_rates(model)
    -    +    cost = (Decimal(input_t) * input_rate
    -    +            + Decimal(output_t) * output_rate)
    -         await build_repo.record_build_cost(
    -             build_id, phase, input_t, output_t, model, cost
    -         )
    -    @@ -538,6 +577,77 @@ async def get_build_instructions(project_id: UUID, user_id: UUID) -> dict:
    -         }
    -     
    -     
    -    +async def get_build_phases(project_id: UUID, user_id: UUID) -> list[dict]:
    -    +    """Parse the phases contract into a structured list of phase definitions.
    +    +    with pytest.raises(ValueError, match="Invalid file path"):
    +    +        await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "../../../etc/passwd")
         +
    -    +    Each entry contains: number, name, objective, deliverables (list of strings).
         +
    -    +    Raises:
    -    +        ValueError: If project not found, not owned, or no phases contract.
    -    +    """
    -    +    project = await project_repo.get_project_by_id(project_id)
    -    +    if not project or str(project["user_id"]) != str(user_id):
    -    +        raise ValueError("Project not found")
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service.project_repo")
    +    +@patch("app.services.build_service.build_repo")
    +    +async def test_get_build_file_content_not_found(mock_build_repo, mock_project_repo, tmp_path):
    +    +    """get_build_file_content raises ValueError for non-existent file."""
    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +    +        return_value=_build(status="completed", working_dir=str(tmp_path))
    +    +    )
         +
    -    +    phases_contract = await project_repo.get_contract_by_type(project_id, "phases")
    -    +    if not phases_contract:
    -    +        raise ValueError("No phases contract found")
    +    +    with pytest.raises(ValueError, match="File not found"):
    +    +        await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "nonexistent.py")
         +
    -    +    return _parse_phases_contract(phases_contract["content"])
         +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: start_build with target params
    +    +# ---------------------------------------------------------------------------
         +
    -    +def _parse_phases_contract(content: str) -> list[dict]:
    -    +    """Parse a phases contract markdown into structured phase definitions.
         +
    -    +    Expects sections like:
    -    +        ## Phase 0 -- Genesis
    -    +        **Objective:** ...
    -    +        **Deliverables:**
    -    +        - item 1
    -    +        - item 2
    -    +    """
    -    +    phases: list[dict] = []
    -    +    # Split on ## Phase headers
    -    +    phase_blocks = re.split(r"(?=^## Phase )", content, flags=re.MULTILINE)
    -    +
    -    +    for block in phase_blocks:
    -    +        # Match "## Phase N -- Name" or "## Phase N ├ö├ç├Â Name"
    -    +        header = re.match(
    -    +            r"^## Phase\s+(\d+)\s*[-├ö├ç├Â├ö├ç├┤]+\s*(.+?)\s*$", block, re.MULTILINE
    -    +        )
    -    +        if not header:
    -    +            continue
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service.asyncio.create_task")
    +    +@patch("app.services.build_service.project_repo")
    +    +@patch("app.services.build_service.build_repo")
    +    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    +async def test_start_build_invalid_target_type(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    +    """start_build rejects invalid target_type."""
    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
         +
    -    +        phase_num = int(header.group(1))
    -    +        phase_name = header.group(2).strip()
    +    +    with pytest.raises(ValueError, match="Invalid target_type"):
    +    +        await build_service.start_build(_PROJECT_ID, _USER_ID, target_type="invalid_type")
         +
    -    +        # Extract objective
    -    +        obj_match = re.search(
    -    +            r"\*\*Objective:\*\*\s*(.+?)(?=\n\n|\n\*\*|$)", block, re.DOTALL
    -    +        )
    -    +        objective = obj_match.group(1).strip() if obj_match else ""
         +
    -    +        # Extract deliverables (bullet list after **Deliverables:**)
    -    +        deliverables: list[str] = []
    -    +        deliv_match = re.search(
    -    +            r"\*\*Deliverables:\*\*\s*\n((?:[-*]\s+.+\n?)+)", block
    -    +        )
    -    +        if deliv_match:
    -    +            for line in deliv_match.group(1).strip().splitlines():
    -    +                item = re.sub(r"^[-*]\s+", "", line).strip()
    -    +                if item:
    -    +                    deliverables.append(item)
    -    +
    -    +        phases.append({
    -    +            "number": phase_num,
    -    +            "name": phase_name,
    -    +            "objective": objective,
    -    +            "deliverables": deliverables,
    -    +        })
    -    +
    -    +    return phases
    -    +
    -    +
    -     def _generate_deploy_instructions(
    -         project_name: str, stack_content: str, blueprint_content: str
    -     ) -> str:
    -    diff --git a/app/services/project_service.py b/app/services/project_service.py
    -    index 46ab7de..6994dd6 100644
    -    --- a/app/services/project_service.py
    -    +++ b/app/services/project_service.py
    -    @@ -7,6 +7,7 @@ from uuid import UUID
    -     
    -     from app.clients.llm_client import chat as llm_chat
    -     from app.config import settings
    -    +from app.ws_manager import manager
    -     from app.repos.project_repo import (
    -         create_project as repo_create_project,
    -         delete_project as repo_delete_project,
    -    @@ -34,7 +35,6 @@ QUESTIONNAIRE_SECTIONS = [
    -         "ui_requirements",
    -         "architectural_boundaries",
    -         "deployment_target",
    -    -    "phase_breakdown",
    -     ]
    -     
    -     CONTRACT_TYPES = [
    -    @@ -46,11 +46,11 @@ CONTRACT_TYPES = [
    -         "boundaries",
    -         "phases",
    -         "ui",
    -    -    "builder_contract",
    -         "builder_directive",
    -     ]
    -     
    -     TEMPLATES_DIR = Path(__file__).resolve().parent.parent / "templates" / "contracts"
    -    +FORGE_CONTRACTS_DIR = Path(__file__).resolve().parent.parent.parent / "Forge" / "Contracts"
    -     
    -     _SYSTEM_PROMPT = """\
    -     You are a project intake specialist for Forge, an autonomous build system.
    -    @@ -65,31 +65,28 @@ The questionnaire has these sections (in order):
    -     5. ui_requirements ├ö├ç├Â Pages, components, design system, responsive needs
    -     6. architectural_boundaries ├ö├ç├Â Layer rules, forbidden imports, separation concerns
    -     7. deployment_target ├ö├ç├Â Where it runs, CI/CD, infrastructure
    -    -8. phase_breakdown ├ö├ç├Â Implementation phases with deliverables and exit criteria
    -    +
    -    +NOTE: Do NOT ask the user about implementation phases. Phases are auto-derived
    -    +architecturally during contract generation based on all gathered information.
    -     
    -     CRITICAL RULES:
    -    -- Ask AT MOST 2-3 focused questions per section, then COMPLETE IT.
    -    -- Do NOT over-ask. If the user gives a reasonable answer, mark the section
    -    -  complete and move on. You can infer sensible defaults for anything unclear.
    -    -- One section at a time. After completing one, immediately ask about the next.
    -    -- If the user's single answer covers multiple sections, mark ALL covered
    -    -  sections as complete in one response.
    -    +- Ask AT MOST 1-2 focused questions per section, then set section_complete=true.
    -    +- After the user answers, ALWAYS set section_complete to true and move on.
    -    +  Do NOT ask follow-ups within the same section. One answer per section is enough.
    -    +- Infer sensible defaults for anything unclear ├ö├ç├Â DO NOT ask for clarification.
    -    +- ALWAYS include extracted_data with at least a summary of what you captured.
    -     - Your response MUST be ONLY valid JSON ├ö├ç├Â no markdown fences, no extra text:
    -       {
    -    -    "reply": "<your conversational message to the user>",
    -    -    "section": "<current section name>",
    -    +    "reply": "<your message ├ö├ç├Â summarise what you captured, then ask about the NEXT section>",
    -    +    "section": "<the section you just completed or are asking about>",
    -         "section_complete": true|false,
    -         "extracted_data": { <key-value pairs of captured information> }
    -       }
    -    -- When section_complete is true, extracted_data MUST contain the collected data.
    -    -- When section_complete is false, extracted_data should be {} or partial data.
    -    -- ALWAYS set section_complete to true after AT MOST 2 exchanges per section.
    -    -  Don't let any section drag on ├ö├ç├Â keep momentum. The user sees a progress bar;
    -    -  it must visibly advance.
    -    -- Be conversational but FAST. Prefer completing a section and moving on over
    -    -  asking the perfect follow-up question.
    -    -- When all sections are done, set section to "complete" and section_complete
    -    -  to true.
    -    +- When section_complete is true, extracted_data MUST contain the captured data.
    -    +  extracted_data must NEVER be empty or null when section_complete is true.
    -    +- The user sees a progress bar. Every response MUST advance it. If the user
    -    +  answered your question, section_complete MUST be true.
    -    +- When all 7 sections are done, set section to "complete".
    -     """
    -     
    -     
    -    @@ -202,7 +199,10 @@ async def process_questionnaire_message(
    -             f"Project description: {project.get('description', 'N/A')}\n"
    -             f"Current section: {current_section}\n"
    -             f"Completed sections: {', '.join(completed) if completed else 'none'}\n"
    -    -        f"Previously collected data: {json.dumps(answers, indent=2)}"
    -    +        f"Previously collected data: {json.dumps(answers, indent=2)}\n"
    -    +        f"IMPORTANT: The user has been on '{current_section}' for "
    -    +        f"{sum(1 for m in history if m['role'] == 'user' and m.get('section') == current_section)} "
    -    +        f"messages already. Set section_complete=true NOW and move to the next section."
    -         )
    -     
    -         # Anthropic requires strictly alternating user/assistant roles.
    -    @@ -244,7 +244,7 @@ async def process_questionnaire_message(
    -         )
    +    +@pytest.mark.asyncio
    +    +@patch("app.services.build_service.asyncio.create_task")
    +    +@patch("app.services.build_service.project_repo")
    +    +@patch("app.services.build_service.build_repo")
    +    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +    +async def test_start_build_target_type_without_ref(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    +    """start_build raises ValueError when target_type given without target_ref."""
    +    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    +    +
    +    +    with pytest.raises(ValueError, match="target_ref is required"):
    +    +        await build_service.start_build(_PROJECT_ID, _USER_ID, target_type="local_path")
    +    diff --git a/tests/test_builds_router.py b/tests/test_builds_router.py
    +    index cea1ab7..42ea0d3 100644
    +    --- a/tests/test_builds_router.py
    +    +++ b/tests/test_builds_router.py
    +    @@ -81,7 +81,10 @@ def test_start_build(mock_get_user, mock_start, client):
          
    -         try:
    -    -        raw_reply = await llm_chat(
    -    +        llm_result = await llm_chat(
    -                 api_key=llm_api_key,
    -                 model=llm_model,
    -                 system_prompt=dynamic_system,
    -    @@ -255,6 +255,8 @@ async def process_questionnaire_message(
    -             logger.exception("LLM chat failed for project %s", project_id)
    -             raise ValueError(f"LLM service error: {exc}") from exc
    +         assert resp.status_code == 200
    +         assert resp.json()["status"] == "pending"
    +    -    mock_start.assert_called_once_with(_PROJECT_ID, _USER["id"])
    +    +    mock_start.assert_called_once_with(
    +    +        _PROJECT_ID, _USER["id"],
    +    +        target_type=None, target_ref=None,
    +    +    )
          
    -    +    raw_reply = llm_result["text"]
    -    +    usage = llm_result.get("usage", {})
    -         logger.info("LLM raw response (first 500 chars): %s", raw_reply[:500])
          
    -         # Parse the structured JSON response from the LLM
    -    @@ -263,19 +265,73 @@ async def process_questionnaire_message(
    -                     parsed.get("section_complete"), parsed.get("section"))
    +     @patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    +    @@ -327,3 +330,127 @@ def test_start_build_rate_limited(mock_get_user, mock_start, mock_limiter, clien
          
    -         # Update state based on LLM response
    -    -    history.append({"role": "user", "content": message})
    -    -    history.append({"role": "assistant", "content": parsed["reply"]})
    -    -
    -    -    if parsed.get("section_complete") and parsed.get("extracted_data"):
    -    -        section_name = parsed.get("section", current_section)
    -    -        answers[section_name] = parsed["extracted_data"]
    -    +    history.append({"role": "user", "content": message, "section": current_section})
    -    +
    -    +    # --- Section-completion logic (3 independent triggers) ---
    -    +    llm_section = parsed.get("section") or current_section
    -    +    llm_says_complete = bool(parsed.get("section_complete"))
    -    +    extracted = parsed.get("extracted_data")
    -    +
    -    +    # Trigger 1: LLM explicitly says section_complete=true
    -    +    if llm_says_complete:
    -    +        section_name = llm_section if llm_section in QUESTIONNAIRE_SECTIONS else current_section
    -    +        if extracted and isinstance(extracted, dict):
    -    +            answers[section_name] = extracted
    -    +        elif section_name not in answers:
    -    +            answers[section_name] = {"auto": "completed by LLM"}
    -             if section_name not in completed:
    -                 completed.append(section_name)
    -    +        logger.info("Section completed (LLM explicit): %s", section_name)
    -    +
    -    +    # Trigger 2: LLM jumped ahead ├ö├ç├Â mentions a later section, implying
    -    +    #            the current one is done.  Complete all sections up to
    -    +    #            (but not including) the one the LLM is now asking about.
    -    +    if llm_section in QUESTIONNAIRE_SECTIONS and llm_section != current_section:
    -    +        llm_idx = QUESTIONNAIRE_SECTIONS.index(llm_section)
    -    +        cur_idx = QUESTIONNAIRE_SECTIONS.index(current_section)
    -    +        if llm_idx > cur_idx:
    -    +            for i in range(cur_idx, llm_idx):
    -    +                s = QUESTIONNAIRE_SECTIONS[i]
    -    +                if s not in completed:
    -    +                    completed.append(s)
    -    +                    if s not in answers:
    -    +                        answers[s] = {"auto": "inferred from conversation"}
    -    +                    logger.info("Section auto-completed (LLM jumped ahead): %s", s)
    -    +
    -    +    # Trigger 3: Exchange-count safety net ├ö├ç├Â if we've had >= 3 user
    -    +    #            messages in the same section, force-complete it so
    -    +    #            the user always sees progress.
    -    +    section_user_msgs = sum(
    -    +        1 for m in history if m["role"] == "user" and m.get("section") == current_section
    +         assert resp.status_code == 429
    +         mock_start.assert_not_called()
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: POST /projects/{id}/build with target params
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +@patch("app.api.routers.builds.build_limiter")
    +    +@patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +def test_start_build_with_target(mock_get_user, mock_start, mock_limiter, client):
    +    +    """POST /projects/{id}/build with target_type and target_ref."""
    +    +    mock_get_user.return_value = _USER
    +    +    mock_start.return_value = _build()
    +    +    mock_limiter.is_allowed.return_value = True
    +    +
    +    +    resp = client.post(
    +    +        f"/projects/{_PROJECT_ID}/build",
    +    +        headers=_auth_header(),
    +    +        json={"target_type": "local_path", "target_ref": "/tmp/test"},
         +    )
    -    +    if section_user_msgs >= 3 and current_section not in completed:
    -    +        completed.append(current_section)
    -    +        if current_section not in answers:
    -    +            answers[current_section] = {"auto": "force-completed after 3 exchanges"}
    -    +        logger.info("Section force-completed (3 exchanges): %s", current_section)
    -    +
    -    +    # Determine the next section for tagging the assistant reply
    -    +    next_section = None
    -    +    for s in QUESTIONNAIRE_SECTIONS:
    -    +        if s not in completed:
    -    +            next_section = s
    -    +            break
    -    +    reply_section = next_section or current_section
         +
    -    +    history.append({"role": "assistant", "content": parsed["reply"], "section": reply_section})
    +    +    assert resp.status_code == 200
    +    +    mock_start.assert_called_once()
    +    +    call_kwargs = mock_start.call_args
    +    +    assert call_kwargs.kwargs.get("target_type") == "local_path"
    +    +    assert call_kwargs.kwargs.get("target_ref") == "/tmp/test"
         +
    -    +    # Accumulate token usage
    -    +    prev_usage = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    -    +    total_usage = {
    -    +        "input_tokens": prev_usage.get("input_tokens", 0) + usage.get("input_tokens", 0),
    -    +        "output_tokens": prev_usage.get("output_tokens", 0) + usage.get("output_tokens", 0),
    -    +    }
    -     
    -         new_state = {
    -             "completed_sections": completed,
    -             "answers": answers,
    -             "conversation_history": history,
    -    +        "token_usage": total_usage,
    -         }
    -         await update_questionnaire_state(project_id, new_state)
    -     
    -    @@ -292,6 +348,7 @@ async def process_questionnaire_message(
    -             "completed_sections": completed,
    -             "remaining_sections": remaining,
    -             "is_complete": is_complete,
    -    +        "token_usage": total_usage,
    -         }
    -     
    -     
    -    @@ -309,9 +366,26 @@ async def get_questionnaire_state(
    -         qs = project.get("questionnaire_state") or {}
    -         progress = _questionnaire_progress(qs)
    -         progress["conversation_history"] = qs.get("conversation_history", [])
    -    +    progress["token_usage"] = qs.get("token_usage", {"input_tokens": 0, "output_tokens": 0})
    -         return progress
    -     
    -     
    -    +async def reset_questionnaire(
    -    +    user_id: UUID,
    -    +    project_id: UUID,
    -    +) -> dict:
    -    +    """Clear all questionnaire state and reset the project to draft."""
    -    +    project = await get_project_by_id(project_id)
    -    +    if not project:
    -    +        raise ValueError("Project not found")
    -    +    if str(project["user_id"]) != str(user_id):
    -    +        raise ValueError("Project not found")
         +
    -    +    await update_questionnaire_state(project_id, {})
    -    +    await update_project_status(project_id, "draft")
    -    +    return {"status": "reset"}
    +    +@patch("app.api.routers.builds.build_limiter")
    +    +@patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +def test_start_build_with_github_target(mock_get_user, mock_start, mock_limiter, client):
    +    +    """POST /projects/{id}/build with github_new target."""
    +    +    mock_get_user.return_value = _USER
    +    +    mock_start.return_value = _build()
    +    +    mock_limiter.is_allowed.return_value = True
         +
    +    +    resp = client.post(
    +    +        f"/projects/{_PROJECT_ID}/build",
    +    +        headers=_auth_header(),
    +    +        json={"target_type": "github_new", "target_ref": "my-new-repo"},
    +    +    )
         +
    -     # ---------------------------------------------------------------------------
    -     # Contract generation
    -     # ---------------------------------------------------------------------------
    -    @@ -321,8 +395,10 @@ async def generate_contracts(
    -         user_id: UUID,
    -         project_id: UUID,
    -     ) -> list[dict]:
    -    -    """Generate all contract files from questionnaire answers.
    -    +    """Generate all contract files from questionnaire answers using the LLM.
    -     
    -    +    Each contract is generated individually with a contract-specific system
    -    +    prompt that references the Forge example contract as a structural blueprint.
    -         Raises ValueError if questionnaire is not complete.
    -         """
    -         project = await get_project_by_id(project_id)
    -    @@ -341,11 +417,37 @@ async def generate_contracts(
    -             )
    -     
    -         answers = qs.get("answers", {})
    -    -    template_vars = _build_template_vars(project, answers)
    -    +    answers_text = _format_answers_for_prompt(project, answers)
    -    +
    -    +    # Pick LLM provider
    -    +    provider = settings.LLM_PROVIDER.strip().lower() if settings.LLM_PROVIDER else ""
    -    +    if not provider:
    -    +        provider = "anthropic" if settings.ANTHROPIC_API_KEY else "openai"
    -    +    if provider == "openai":
    -    +        llm_api_key = settings.OPENAI_API_KEY
    -    +        llm_model = settings.OPENAI_MODEL
    -    +    else:
    -    +        llm_api_key = settings.ANTHROPIC_API_KEY
    -    +        llm_model = settings.LLM_QUESTIONNAIRE_MODEL
    -     
    -         generated = []
    -    -    for contract_type in CONTRACT_TYPES:
    -    -        content = _render_template(contract_type, template_vars)
    -    +    total = len(CONTRACT_TYPES)
    -    +    for idx, contract_type in enumerate(CONTRACT_TYPES):
    -    +        # Notify client that generation of this contract has started
    -    +        await manager.send_to_user(str(user_id), {
    -    +            "type": "contract_progress",
    -    +            "payload": {
    -    +                "project_id": str(project_id),
    -    +                "contract_type": contract_type,
    -    +                "status": "generating",
    -    +                "index": idx,
    -    +                "total": total,
    -    +            },
    -    +        })
    -    +
    -    +        content, usage = await _generate_contract_content(
    -    +            contract_type, project, answers_text, llm_api_key, llm_model, provider
    -    +        )
    -             row = await upsert_contract(project_id, contract_type, content)
    -             generated.append({
    -                 "id": str(row["id"]),
    -    @@ -356,6 +458,20 @@ async def generate_contracts(
    -                 "updated_at": row["updated_at"],
    -             })
    -     
    -    +        # Notify client that this contract is done
    -    +        await manager.send_to_user(str(user_id), {
    -    +            "type": "contract_progress",
    -    +            "payload": {
    -    +                "project_id": str(project_id),
    -    +                "contract_type": contract_type,
    -    +                "status": "done",
    -    +                "index": idx,
    -    +                "total": total,
    -    +                "input_tokens": usage.get("input_tokens", 0),
    -    +                "output_tokens": usage.get("output_tokens", 0),
    -    +            },
    -    +        })
    -    +
    -         await update_project_status(project_id, "contracts_ready")
    -         return generated
    -     
    -    @@ -481,48 +597,252 @@ def _parse_llm_response(raw: str) -> dict:
    -         }
    -     
    -     
    -    -def _build_template_vars(project: dict, answers: dict) -> dict:
    -    -    """Flatten questionnaire answers into template variables."""
    -    -    variables = {
    -    -        "project_name": project["name"],
    -    -        "project_description": project.get("description", ""),
    -    +def _format_answers_for_prompt(project: dict, answers: dict) -> str:
    -    +    """Format all questionnaire answers into a readable text block for prompts."""
    -    +    lines = [
    -    +        f"Project name: {project['name']}",
    -    +        f"Description: {project.get('description', 'N/A')}",
    -    +        "",
    -    +    ]
    -    +    for section in QUESTIONNAIRE_SECTIONS:
    -    +        section_data = answers.get(section)
    -    +        lines.append(f"### {section}")
    -    +        if not section_data:
    -    +            lines.append("(no data collected)")
    -    +        elif isinstance(section_data, dict):
    -    +            for k, v in section_data.items():
    -    +                if isinstance(v, list):
    -    +                    lines.append(f"- {k}:")
    -    +                    for item in v:
    -    +                        lines.append(f"  - {item}")
    -    +                elif isinstance(v, dict):
    -    +                    lines.append(f"- {k}: {json.dumps(v, indent=2)}")
    -    +                else:
    -    +                    lines.append(f"- {k}: {v}")
    -    +        else:
    -    +            lines.append(str(section_data))
    -    +        lines.append("")
    -    +    return "\n".join(lines)
    -    +
    -    +
    -    +def _load_forge_example(contract_type: str) -> str | None:
    -    +    """Load the Forge example contract as a structural reference, if it exists."""
    -    +    ext_map = {
    -    +        "physics": "physics.yaml",
    -    +        "boundaries": "boundaries.json",
    -         }
    -    +    filename = ext_map.get(contract_type, f"{contract_type}.md")
    -    +    path = FORGE_CONTRACTS_DIR / filename
    -    +    if path.exists():
    -    +        try:
    -    +            return path.read_text(encoding="utf-8")
    -    +        except Exception:
    -    +            return None
    -    +    return None
    -    +
    -    +
    -    +# Per-contract generation instructions
    -    +_CONTRACT_INSTRUCTIONS: dict[str, str] = {
    -    +    "blueprint": """\
    -    +Generate a comprehensive project blueprint. Include:
    -    +1) Product intent ├ö├ç├Â what it does, who it's for, why it exists (2-3 paragraphs)
    -    +2) Core interaction invariants ├ö├ç├Â 5-7 MUST-hold rules (bullet list)
    -    +3) MVP scope ├ö├ç├Â Must-ship features (numbered, with sub-details) AND explicitly-not-MVP list
    -    +4) Hard boundaries ├ö├ç├Â anti-godfile rules per architectural layer (Routers, Services, Repos, Clients, etc.)
    -    +5) Deployment target ├ö├ç├Â where it runs, scale expectations
    -    +
    -    +Use specific, concrete language. No vagueness. Every feature must be described precisely enough
    -    +that a developer could implement it without asking questions.""",
    -    +
    -    +    "manifesto": """\
    -    +Generate a project manifesto defining 5-7 non-negotiable principles.
    -    +Each principle should have:
    -    +- A descriptive title (e.g. "Contract-first, schema-first")
    -    +- 3-5 bullet points elaborating the rule
    -    +- Project-specific details (not generic platitudes)
    -    +
    -    +Include a "Confirm-before-write" section listing what requires user confirmation
    -    +and what is exempt. Include any privacy or security principles relevant to this project.""",
    -    +
    -    +    "stack": """\
    -    +Generate a technology stack document. Include sections for:
    -    +- Backend (language, framework, version, key libraries)
    -    +- Database (engine, version, connection method)
    -    +- Auth (method, provider, flow)
    -    +- Frontend (framework, bundler, key libraries)
    -    +- Testing (framework, coverage requirements)
    -    +- Deployment (platform, expected scale)
    -    +- Environment Variables table (name, description, required/optional)
    -    +- forge.json schema (JSON block showing project metadata structure)
    -    +
    -    +For each technology choice, briefly explain WHY it was chosen.""",
    -    +
    -    +    "schema": """\
    -    +Generate a complete database schema document. Include:
    -    +- Schema version header
    -    +- Conventions section (naming patterns, common columns like id/created_at/updated_at)
    -    +- Full CREATE TABLE SQL for EVERY table, including:
    -    +  - Column definitions with types and constraints
    -    +  - PRIMARY KEY, FOREIGN KEY, UNIQUE constraints
    -    +  - Indexes
    -    +  - ENUM descriptions where applicable
    -    +- Schema-to-Phase traceability matrix (which table is built in which phase)
    -    +
    -    +Use PostgreSQL syntax. Be thorough ├ö├ç├Â every column the app needs must be defined.""",
    -    +
    -    +    "phases": """\
    -    +Generate a detailed phase breakdown document with 6-12 phases.
    -    +Each phase MUST include:
    -    +- Phase number and name (e.g. "Phase 0 ├ö├ç├Â Genesis")
    -    +- Objective (1-2 sentences)
    -    +- Deliverables (detailed bullet list of what gets built)
    -    +- Schema coverage (which tables/columns are created or modified)
    -    +- Exit criteria (bullet list of concrete, testable conditions)
    -    +
    -    +Phase 0 is always Genesis (project scaffold, config, tooling).
    -    +The final phase should be Ship & Deploy.
    -    +Phases should be ordered by dependency ├ö├ç├Â earlier phases provide foundations for later ones.""",
    -    +
    -    +    "ui": """\
    -    +Generate a UI/UX blueprint document. Include:
    -    +1) App Shell & Layout ├ö├ç├Â device priority, shell structure, navigation model
    -    +2) Screens/Views ├ö├ç├Â detailed spec for each page (what it shows, key interactions, empty states)
    -    +3) Component Inventory ├ö├ç├Â table of reusable components
    -    +4) Visual Style ├ö├ç├Â color palette, typography, visual density, tone
    -    +5) Interaction Patterns ├ö├ç├Â data loading, empty states, error states, confirmation dialogs, responsive behavior
    -    +6) User Flows ├ö├ç├Â 3-4 key user journeys described step by step
    -    +7) What This Is NOT ├ö├ç├Â explicit list of out-of-scope UI features
    -    +
    -    +Be specific about layout, data displayed, and interaction triggers.""",
    -    +
    -    +    "physics": """\
    -    +Generate an API physics specification in YAML format. Structure:
    -    +- info: title, version, description
    -    +- paths: every API endpoint with:
    -    +  - HTTP method (get/post/put/delete)
    -    +  - summary
    -    +  - auth requirement (none, token, github-token)
    -    +  - request body shape (if applicable)
    -    +  - response shape
    -    +  - query parameters (if applicable)
    -    +- schemas: Pydantic/data model definitions
    -    +
    -    +Use the custom Forge physics YAML format (NOT OpenAPI).
    -    +Group endpoints by resource with comments.
    -    +Every endpoint the app needs MUST be listed.""",
    -    +
    -    +    "boundaries": """\
    -    +Generate an architectural boundaries specification in JSON format. Structure:
    -    +{
    -    +  "description": "Layer boundary rules for <project_name>...",
    -    +  "layers": [
    -    +    {
    -    +      "name": "<layer_name>",
    -    +      "glob": "<file_glob_pattern>",
    -    +      "forbidden": [
    -    +        { "pattern": "<regex_or_import>", "reason": "<why forbidden>" }
    -    +      ]
    -    +    }
    -    +  ],
    -    +  "known_violations": []
    -    +}
    -     
    -    -    # Flatten all answer sections into the variables dict
    -    -    for section_name, section_data in answers.items():
    -    -        if isinstance(section_data, dict):
    -    -            for key, value in section_data.items():
    -    -                if isinstance(value, list):
    -    -                    variables[key] = "\n".join(f"- {v}" for v in value)
    -    -                else:
    -    -                    variables[key] = str(value)
    -    -        elif isinstance(section_data, str):
    -    -            variables[section_name] = section_data
    -    +Define 4-6 layers (e.g. routers, services, repos, clients, audit/engine).
    -    +Each layer has forbidden imports/patterns that enforce separation of concerns.
    -    +Output MUST be valid JSON.""",
    -     
    -    -    return variables
    -    +    "builder_directive": """\
    -    +Generate a builder directive ├ö├ç├Â the operational instructions for an AI builder.
    -    +Include:
    -    +- AEM status (enabled/disabled) and auto-authorize setting
    -    +- Step-by-step instructions (read contracts ├ö├Ñ├å execute phases ├ö├Ñ├å run audit ├ö├Ñ├å commit)
    -    +- Autonomy rules (when to auto-commit, when to stop and ask)
    -    +- Phase list with phase numbers and names
    -    +- Project summary (one paragraph)
    -    +- boot_script flag
    -     
    -    +Keep it concise but complete ├ö├ç├Â this is the builder's startup instructions.""",
    -    +}
    -     
    -    -def _render_template(contract_type: str, variables: dict) -> str:
    -    -    """Render a contract template with the given variables.
    -     
    -    -    Uses safe substitution -- missing variables become empty strings.
    -    +async def _generate_contract_content(
    -    +    contract_type: str,
    -    +    project: dict,
    -    +    answers_text: str,
    -    +    api_key: str,
    -    +    model: str,
    -    +    provider: str,
    -    +) -> tuple[str, dict]:
    -    +    """Generate a single contract using the LLM.
    -    +
    -    +    Returns (content, usage) where usage has input_tokens / output_tokens.
    -         """
    -    -    template_file = TEMPLATES_DIR / f"{contract_type}.md"
    -    -    if contract_type == "physics":
    -    -        template_file = TEMPLATES_DIR / "physics.yaml"
    -    -    elif contract_type == "boundaries":
    -    -        template_file = TEMPLATES_DIR / "boundaries.json"
    -    -
    -    -    if not template_file.exists():
    -    -        return f"# {variables.get('project_name', 'Project')} ├ö├ç├Â {contract_type}\n\nTemplate not found."
    -    +    # Load the Forge example as a structural reference (if available)
    -    +    example = _load_forge_example(contract_type)
    -    +
    -    +    instructions = _CONTRACT_INSTRUCTIONS.get(contract_type, f"Generate a {contract_type} contract document.")
    -    +
    -    +    system_parts = [
    -    +        f"You are a Forge contract generator. You produce detailed, production-quality "
    -    +        f"project specification documents for the Forge autonomous build system.\n\n"
    -    +        f"You are generating the **{contract_type}** contract for the project "
    -    +        f'"{project["name"]}".\n\n'
    -    +        f"INSTRUCTIONS:\n{instructions}\n\n"
    -    +        f"RULES:\n"
    -    +        f"- Output ONLY the contract content. No preamble, no 'Here is...', no explanations.\n"
    -    +        f"- Be thorough and detailed. Each contract should be comprehensive enough that a "
    -    +        f"developer can build from it without asking questions.\n"
    -    +        f"- Use the project information provided to fill in ALL sections with real, "
    -    +        f"project-specific content.\n"
    -    +        f"- Do NOT leave any section empty or with placeholder text.\n"
    -    +        f"- Match the structural depth and detail level of the reference example.\n"
    +    +    assert resp.status_code == 200
    +    +    mock_start.assert_called_once()
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: GET /projects/{id}/build/files
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +@patch("app.api.routers.builds.build_service.get_build_files", new_callable=AsyncMock)
    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +def test_get_build_files(mock_get_user, mock_files, client):
    +    +    """GET /projects/{id}/build/files returns file list."""
    +    +    mock_get_user.return_value = _USER
    +    +    mock_files.return_value = [
    +    +        {"path": "src/main.py", "size_bytes": 42, "language": "python", "created_at": "2025-01-01T00:00:00Z"},
    +    +        {"path": "package.json", "size_bytes": 200, "language": "json", "created_at": "2025-01-01T00:00:01Z"},
         +    ]
    -     
    -    -    raw = template_file.read_text(encoding="utf-8")
    -    +    if example:
    -    +        # Truncate very long examples to avoid hitting context limits
    -    +        if len(example) > 6000:
    -    +            example = example[:6000] + "\n\n... (truncated for brevity) ..."
    -    +        system_parts.append(
    -    +            f"\n--- STRUCTURAL REFERENCE (match this level of detail and format) ---\n"
    -    +            f"{example}\n"
    -    +            f"--- END REFERENCE ---\n"
    -    +        )
    -     
    -    -    # Safe substitution: replace {key} with value, leave unknown keys empty
    -    -    import re
    -    +    system_prompt = "\n".join(system_parts)
    -     
    -    -    def _replacer(match: re.Match) -> str:
    -    -        key = match.group(1)
    -    -        return variables.get(key, "")
    -    +    user_msg = (
    -    +        f"Generate the {contract_type} contract for this project.\n\n"
    -    +        f"--- PROJECT INFORMATION (from questionnaire) ---\n"
    -    +        f"{answers_text}\n"
    -    +        f"--- END PROJECT INFORMATION ---"
    +    +
    +    +    resp = client.get(f"/projects/{_PROJECT_ID}/build/files", headers=_auth_header())
    +    +
    +    +    assert resp.status_code == 200
    +    +    data = resp.json()
    +    +    assert len(data["items"]) == 2
    +    +    assert data["items"][0]["path"] == "src/main.py"
    +    +
    +    +
    +    +@patch("app.api.routers.builds.build_service.get_build_files", new_callable=AsyncMock)
    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +def test_get_build_files_not_found(mock_get_user, mock_files, client):
    +    +    """GET /projects/{id}/build/files returns 404 for missing project."""
    +    +    mock_get_user.return_value = _USER
    +    +    mock_files.side_effect = ValueError("Project not found")
    +    +
    +    +    resp = client.get(f"/projects/{_PROJECT_ID}/build/files", headers=_auth_header())
    +    +
    +    +    assert resp.status_code == 404
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: GET /projects/{id}/build/files/{path}
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +@patch("app.api.routers.builds.build_service.get_build_file_content", new_callable=AsyncMock)
    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +def test_get_build_file_content(mock_get_user, mock_content, client):
    +    +    """GET /projects/{id}/build/files/{path} returns file content."""
    +    +    mock_get_user.return_value = _USER
    +    +    mock_content.return_value = {
    +    +        "path": "src/main.py",
    +    +        "content": "print('hello')\n",
    +    +        "size_bytes": 16,
    +    +        "language": "python",
    +    +    }
    +    +
    +    +    resp = client.get(
    +    +        f"/projects/{_PROJECT_ID}/build/files/src/main.py",
    +    +        headers=_auth_header(),
         +    )
    -     
    -    -    return re.sub(r"\{(\w+)\}", _replacer, raw)
    -    +    try:
    -    +        result = await llm_chat(
    -    +            api_key=api_key,
    -    +            model=model,
    -    +            system_prompt=system_prompt,
    -    +            messages=[{"role": "user", "content": user_msg}],
    -    +            provider=provider,
    -    +            max_tokens=16384,
    -    +        )
    -    +        usage = result.get("usage", {"input_tokens": 0, "output_tokens": 0})
    -    +        content = result["text"].strip()
    -    +        # Strip markdown code fences if the LLM wrapped the output
    -    +        if content.startswith("```"):
    -    +            lines = content.split("\n")
    -    +            # Remove first and last ``` lines
    -    +            if lines[0].startswith("```"):
    -    +                lines = lines[1:]
    -    +            if lines and lines[-1].strip() == "```":
    -    +                lines = lines[:-1]
    -    +            content = "\n".join(lines).strip()
    -    +        return content, usage
    -    +    except Exception as exc:
    -    +        logger.exception("LLM contract generation failed for %s: %s", contract_type, exc)
    -    +        # Fall back to a minimal template so the user at least gets something
    -    +        return (
    -    +            f"# {project['name']} ├ö├ç├Â {contract_type}\n\n"
    -    +            f"**Generation failed:** {exc}\n\n"
    -    +            f"Please regenerate this contract or edit it manually."
    -    +        ), {"input_tokens": 0, "output_tokens": 0}
    -    diff --git a/db/migrations/006_user_api_key.sql b/db/migrations/006_user_api_key.sql
    +    +
    +    +    assert resp.status_code == 200
    +    +    data = resp.json()
    +    +    assert data["path"] == "src/main.py"
    +    +    assert "print('hello')" in data["content"]
    +    +
    +    +
    +    +@patch("app.api.routers.builds.build_service.get_build_file_content", new_callable=AsyncMock)
    +    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +    +def test_get_build_file_content_not_found(mock_get_user, mock_content, client):
    +    +    """GET /projects/{id}/build/files/{path} returns 404 for missing file."""
    +    +    mock_get_user.return_value = _USER
    +    +    mock_content.side_effect = ValueError("File not found: nonexistent.py")
    +    +
    +    +    resp = client.get(
    +    +        f"/projects/{_PROJECT_ID}/build/files/nonexistent.py",
    +    +        headers=_auth_header(),
    +    +    )
    +    +
    +    +    assert resp.status_code == 404
    +    diff --git a/tests/test_git_client.py b/tests/test_git_client.py
         new file mode 100644
    -    index 0000000..13156c9
    +    index 0000000..ed053e1
         --- /dev/null
    -    +++ b/db/migrations/006_user_api_key.sql
    -    @@ -0,0 +1,4 @@
    -    +-- Phase 12: BYOK ├ö├ç├┤ user-supplied Anthropic API key for builds
    -    +-- Adds an encrypted API key column to the users table.
    -    +
    -    +ALTER TABLE users ADD COLUMN IF NOT EXISTS anthropic_api_key TEXT;
    -    diff --git a/tests/test_audit_service.py b/tests/test_audit_service.py
    -    index 0f0451e..94d6f01 100644
    -    --- a/tests/test_audit_service.py
    -    +++ b/tests/test_audit_service.py
    -    @@ -32,6 +32,7 @@ def _make_patches():
    -             "get_user_by_id": AsyncMock(return_value=MOCK_USER),
    -             "list_commits": AsyncMock(return_value=[]),
    -             "get_existing_commit_shas": AsyncMock(return_value=set()),
    -    +        "mark_stale_audit_runs": AsyncMock(return_value=0),
    -             "create_audit_run": AsyncMock(return_value={"id": UUID("aaaa1111-1111-1111-1111-111111111111")}),
    -             "update_audit_run": AsyncMock(),
    -             "get_commit_files": AsyncMock(return_value=["README.md"]),
    -    @@ -156,3 +157,54 @@ async def test_backfill_handles_commit_error_gracefully():
    -         # Both count as "synced" (processed) even if one errored
    -         assert result["synced"] == 2
    -         assert result["skipped"] == 0
    +    +++ b/tests/test_git_client.py
    +    @@ -0,0 +1,177 @@
    +    +"""Tests for app/clients/git_client.py -- thin async git wrapper."""
    +    +
    +    +import asyncio
    +    +from unittest.mock import AsyncMock, patch, MagicMock
    +    +
    +    +import pytest
    +    +
    +    +from app.clients import git_client
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Helpers
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +def _mock_process(returncode: int = 0, stdout: str = "", stderr: str = ""):
    +    +    proc = AsyncMock()
    +    +    proc.returncode = returncode
    +    +    proc.communicate = AsyncMock(return_value=(stdout.encode(), stderr.encode()))
    +    +    return proc
    +    +
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: _run_git
    +    +# ---------------------------------------------------------------------------
         +
         +
         +@pytest.mark.asyncio
    -    +async def test_backfill_cleans_stale_runs():
    -    +    """backfill_repo_commits calls mark_stale_audit_runs before processing."""
    -    +    mocks = _make_patches()
    -    +    mocks["list_commits"].return_value = []
    -    +    mocks["mark_stale_audit_runs"].return_value = 3
    -    +
    -    +    patches = _apply_patches(mocks)
    -    +    for p in patches:
    -    +        p.start()
    -    +    try:
    -    +        result = await backfill_repo_commits(REPO_ID, USER_ID)
    -    +    finally:
    -    +        for p in patches:
    -    +            p.stop()
    +    +@patch("app.clients.git_client.asyncio.create_subprocess_exec")
    +    +async def test_run_git_success(mock_exec):
    +    +    """_run_git runs a command and returns stdout."""
    +    +    mock_exec.return_value = _mock_process(0, "ok", "")
         +
    -    +    mocks["mark_stale_audit_runs"].assert_called_once_with(REPO_ID)
    -    +    assert result["synced"] == 0
    -    +    assert result["skipped"] == 0
    +    +    result = await git_client._run_git(["status"], cwd="/tmp/test")
    +    +
    +    +    mock_exec.assert_called_once()
    +    +    assert result == "ok"
         +
         +
         +@pytest.mark.asyncio
    -    +async def test_backfill_marks_error_on_cancel():
    -    +    """If backfill is cancelled mid-commit, the in-progress row is marked error."""
    -    +    import asyncio
    +    +@patch("app.clients.git_client.asyncio.create_subprocess_exec")
    +    +async def test_run_git_failure(mock_exec):
    +    +    """_run_git raises RuntimeError on non-zero exit."""
    +    +    mock_exec.return_value = _mock_process(128, "", "fatal: not a git repo")
         +
    -    +    mocks = _make_patches()
    -    +    mocks["list_commits"].return_value = [
    -    +        {"sha": "aaa111", "message": "first", "author": "Alice"},
    -    +    ]
    -    +    mocks["get_existing_commit_shas"].return_value = set()
    -    +    mocks["get_commit_files"].side_effect = asyncio.CancelledError()
    +    +    with pytest.raises(RuntimeError, match="not a git repo"):
    +    +        await git_client._run_git(["status"], cwd="/tmp/test")
         +
    -    +    patches = _apply_patches(mocks)
    -    +    for p in patches:
    -    +        p.start()
    -    +    try:
    -    +        with pytest.raises(asyncio.CancelledError):
    -    +            await backfill_repo_commits(REPO_ID, USER_ID)
    -    +    finally:
    -    +        for p in patches:
    -    +            p.stop()
    -    +
    -    +    # The audit run should have been marked as error before re-raising
    -    +    error_calls = [
    -    +        c for c in mocks["update_audit_run"].call_args_list
    -    +        if c.kwargs.get("status") == "error" or (c.args and len(c.args) > 1 and c.args[1] == "error")
    -    +    ]
    -    +    assert len(error_calls) >= 1
    -    diff --git a/tests/test_auth_router.py b/tests/test_auth_router.py
    -    index 4cd5836..9dc3526 100644
    -    --- a/tests/test_auth_router.py
    -    +++ b/tests/test_auth_router.py
    -    @@ -57,6 +57,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    -             "github_id": 12345,
    -             "github_login": "octocat",
    -             "avatar_url": "https://example.com/avatar.png",
    -    +        "anthropic_api_key": "sk-ant-test",
    -         }
    -     
    -         token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    -    @@ -68,6 +69,7 @@ def test_auth_me_returns_user_with_valid_token(mock_get_user):
    -         data = response.json()
    -         assert data["github_login"] == "octocat"
    -         assert data["id"] == "11111111-1111-1111-1111-111111111111"
    -    +    assert data["has_anthropic_key"] is True
    -     
    -     
    -     @patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    -    @@ -80,3 +82,57 @@ def test_auth_me_returns_401_when_user_not_found(mock_get_user):
    -             headers={"Authorization": f"Bearer {token}"},
    -         )
    -         assert response.status_code == 401
    +    +
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: init_repo
    +    +# ---------------------------------------------------------------------------
    +    +
    +    +
    +    +@pytest.mark.asyncio
    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +async def test_init_repo(mock_run):
    +    +    """init_repo runs git init and sets committer identity."""
    +    +    await git_client.init_repo("/tmp/test")
    +    +
    +    +    # Should make multiple calls (init + config)
    +    +    assert mock_run.call_count >= 1
    +    +    # First call should be 'init'
    +    +    first_args = mock_run.call_args_list[0][0][0]
    +    +    assert "init" in first_args
         +
         +
         +# ---------------------------------------------------------------------------
    -    +# Tests: API key management (BYOK)
    +    +# Tests: add_all
         +# ---------------------------------------------------------------------------
         +
    -    +_USER_DICT = {
    -    +    "id": "11111111-1111-1111-1111-111111111111",
    -    +    "github_id": 12345,
    -    +    "github_login": "octocat",
    -    +    "avatar_url": "https://example.com/avatar.png",
    -    +    "anthropic_api_key": None,
    -    +}
         +
    +    +@pytest.mark.asyncio
    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +async def test_add_all(mock_run):
    +    +    """add_all stages all changes."""
    +    +    await git_client.add_all("/tmp/test")
         +
    -    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    -    +def test_save_api_key(mock_get_user, mock_set_key):
    -    +    mock_get_user.return_value = _USER_DICT
    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    -    +    response = client.put(
    -    +        "/auth/api-key",
    -    +        json={"api_key": "sk-ant-api03-test"},
    -    +        headers={"Authorization": f"Bearer {token}"},
    -    +    )
    -    +    assert response.status_code == 200
    -    +    assert response.json()["saved"] is True
    -    +    mock_set_key.assert_called_once()
    +    +    mock_run.assert_called_once()
    +    +    args = mock_run.call_args[0][0]  # First positional arg is the command list
    +    +    assert "add" in args
         +
         +
    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    -    +def test_save_api_key_empty_rejected(mock_get_user):
    -    +    mock_get_user.return_value = _USER_DICT
    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    -    +    response = client.put(
    -    +        "/auth/api-key",
    -    +        json={"api_key": "   "},
    -    +        headers={"Authorization": f"Bearer {token}"},
    -    +    )
    -    +    assert response.status_code == 400
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: commit
    +    +# ---------------------------------------------------------------------------
         +
         +
    -    +@patch("app.api.routers.auth.set_anthropic_api_key", new_callable=AsyncMock)
    -    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    -    +def test_remove_api_key(mock_get_user, mock_set_key):
    -    +    mock_get_user.return_value = _USER_DICT
    -    +    token = create_token("11111111-1111-1111-1111-111111111111", "octocat")
    -    +    response = client.delete(
    -    +        "/auth/api-key",
    -    +        headers={"Authorization": f"Bearer {token}"},
    -    +    )
    -    +    assert response.status_code == 200
    -    +    assert response.json()["removed"] is True
    -    +    mock_set_key.assert_called_once()
    -    diff --git a/tests/test_build_service.py b/tests/test_build_service.py
    -    index 1c7792e..9861a64 100644
    -    --- a/tests/test_build_service.py
    -    +++ b/tests/test_build_service.py
    -    @@ -63,7 +63,8 @@ def _build(**overrides):
    -     @patch("app.services.build_service.asyncio.create_task")
    -     @patch("app.services.build_service.project_repo")
    -     @patch("app.services.build_service.build_repo")
    -    -async def test_start_build_success(mock_build_repo, mock_project_repo, mock_create_task):
    -    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    -    +async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    -         """start_build creates a build record and spawns a background task."""
    -         mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    -         mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    -    @@ -71,6 +72,7 @@ async def test_start_build_success(mock_build_repo, mock_project_repo, mock_crea
    -         mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    -         mock_build_repo.create_build = AsyncMock(return_value=_build())
    -         mock_create_task.return_value = MagicMock()
    -    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    -     
    -         result = await build_service.start_build(_PROJECT_ID, _USER_ID)
    -     
    -    @@ -133,6 +135,21 @@ async def test_start_build_already_running(mock_build_repo, mock_project_repo):
    -             await build_service.start_build(_PROJECT_ID, _USER_ID)
    -     
    -     
         +@pytest.mark.asyncio
    -    +@patch("app.services.build_service.project_repo")
    -    +@patch("app.services.build_service.build_repo")
    -    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    -    +async def test_start_build_no_api_key(mock_get_user, mock_build_repo, mock_project_repo):
    -    +    """start_build raises ValueError when user has no Anthropic API key."""
    -    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    -    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    -    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    -    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": None}
    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +async def test_commit(mock_run):
    +    +    """commit runs git commit with the given message."""
    +    +    await git_client.commit("/tmp/test", "test commit")
         +
    -    +    with pytest.raises(ValueError, match="API key required"):
    -    +        await build_service.start_build(_PROJECT_ID, _USER_ID)
    +    +    # commit may call _run_git multiple times (status check + commit)
    +    +    assert mock_run.call_count >= 1
    +    +    # Find the call that includes 'commit'
    +    +    commit_calls = [c for c in mock_run.call_args_list if "commit" in c[0][0]]
    +    +    assert len(commit_calls) >= 1
         +
         +
    -     # ---------------------------------------------------------------------------
    -     # Tests: cancel_build
    -     # ---------------------------------------------------------------------------
    -    @@ -431,3 +448,21 @@ async def test_record_phase_cost(mock_build_repo):
    -         mock_build_repo.record_build_cost.assert_called_once()
    -         assert usage.input_tokens == 0
    -         assert usage.output_tokens == 0
    -    +
    -    +
    -    +def test_get_token_rates_model_aware():
    -    +    """_get_token_rates returns correct pricing per model family."""
    -    +    from decimal import Decimal
    -    +
    -    +    opus_in, opus_out = build_service._get_token_rates("claude-opus-4-6")
    -    +    assert opus_in == Decimal("0.000015")
    -    +    assert opus_out == Decimal("0.000075")
    -    +
    -    +    haiku_in, haiku_out = build_service._get_token_rates("claude-haiku-4-5-20251001")
    -    +    assert haiku_in == Decimal("0.000001")
    -    +    assert haiku_out == Decimal("0.000005")
    -    +
    -    +    # Unknown model falls back to Opus (safest = most expensive)
    -    +    unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
    -    +    assert unk_in == Decimal("0.000015")
    -    +    assert unk_out == Decimal("0.000075")
    -    diff --git a/tests/test_llm_client.py b/tests/test_llm_client.py
    -    index c7c4f8e..4f323a2 100644
    -    --- a/tests/test_llm_client.py
    -    +++ b/tests/test_llm_client.py
    -    @@ -34,6 +34,7 @@ async def test_chat_success(mock_client_cls):
    -             "content": [{"type": "text", "text": "Hello from Haiku!"}],
    -             "model": "claude-3-5-haiku-20241022",
    -             "role": "assistant",
    -    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    -         })
    -         mock_client_cls.return_value = mock_client
    -     
    -    @@ -44,7 +45,9 @@ async def test_chat_success(mock_client_cls):
    -             messages=[{"role": "user", "content": "Hi"}],
    -         )
    -     
    -    -    assert result == "Hello from Haiku!"
    -    +    assert result["text"] == "Hello from Haiku!"
    -    +    assert result["usage"]["input_tokens"] == 10
    -    +    assert result["usage"]["output_tokens"] == 20
    -         mock_client.post.assert_called_once()
    -         call_kwargs = mock_client.post.call_args
    -         body = call_kwargs.kwargs["json"] if "json" in call_kwargs.kwargs else call_kwargs[1]["json"]
    -    @@ -141,6 +144,7 @@ async def test_chat_openai_success(mock_client_cls):
    -         """Successful OpenAI chat returns message content."""
    -         mock_client = _make_mock_client({
    -             "choices": [{"message": {"role": "assistant", "content": "Hello from GPT!"}}],
    -    +        "usage": {"prompt_tokens": 5, "completion_tokens": 15},
    -         })
    -         mock_client_cls.return_value = mock_client
    -     
    -    @@ -151,7 +155,9 @@ async def test_chat_openai_success(mock_client_cls):
    -             messages=[{"role": "user", "content": "Hi"}],
    -         )
    -     
    -    -    assert result == "Hello from GPT!"
    -    +    assert result["text"] == "Hello from GPT!"
    -    +    assert result["usage"]["input_tokens"] == 5
    -    +    assert result["usage"]["output_tokens"] == 15
    -         call_kwargs = mock_client.post.call_args
    -         body = call_kwargs.kwargs.get("json", call_kwargs[1].get("json", {}))
    -         assert body["model"] == "gpt-4o"
    -    @@ -226,6 +232,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    -         """chat(provider='openai') routes to OpenAI endpoint."""
    -         mock_client = _make_mock_client({
    -             "choices": [{"message": {"role": "assistant", "content": "dispatched"}}],
    -    +        "usage": {"prompt_tokens": 0, "completion_tokens": 0},
    -         })
    -         mock_client_cls.return_value = mock_client
    -     
    -    @@ -237,7 +244,7 @@ async def test_chat_dispatches_to_openai(mock_client_cls):
    -             provider="openai",
    -         )
    -     
    -    -    assert result == "dispatched"
    -    +    assert result["text"] == "dispatched"
    -         call_kwargs = mock_client.post.call_args
    -         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    -         assert "openai.com" in url
    -    @@ -249,6 +256,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    -         """chat() defaults to Anthropic."""
    -         mock_client = _make_mock_client({
    -             "content": [{"type": "text", "text": "default"}],
    -    +        "usage": {"input_tokens": 0, "output_tokens": 0},
    -         })
    -         mock_client_cls.return_value = mock_client
    -     
    -    @@ -259,7 +267,7 @@ async def test_chat_defaults_to_anthropic(mock_client_cls):
    -             messages=[{"role": "user", "content": "Hi"}],
    -         )
    -     
    -    -    assert result == "default"
    -    +    assert result["text"] == "default"
    -         call_kwargs = mock_client.post.call_args
    -         url = call_kwargs.args[0] if call_kwargs.args else call_kwargs[0][0]
    -         assert "anthropic.com" in url
    -    diff --git a/tests/test_project_service.py b/tests/test_project_service.py
    -    index 1957ba3..1b410b3 100644
    -    --- a/tests/test_project_service.py
    -    +++ b/tests/test_project_service.py
    -    @@ -191,17 +191,22 @@ async def test_process_questionnaire_first_message(
    -             "status": "draft",
    -             "questionnaire_state": {},
    -         }
    -    -    mock_llm.return_value = json.dumps({
    -    -        "reply": "Tell me about your product.",
    -    -        "section": "product_intent",
    -    -        "section_complete": False,
    -    -        "extracted_data": None,
    -    -    })
    -    +    mock_llm.return_value = {
    -    +        "text": json.dumps({
    -    +            "reply": "Tell me about your product.",
    -    +            "section": "product_intent",
    -    +            "section_complete": False,
    -    +            "extracted_data": None,
    -    +        }),
    -    +        "usage": {"input_tokens": 50, "output_tokens": 30},
    -    +    }
    -     
    -         result = await process_questionnaire_message(USER_ID, PROJECT_ID, "Hi")
    -     
    -         assert result["reply"] == "Tell me about your product."
    -         assert result["is_complete"] is False
    -    +    assert result["token_usage"]["input_tokens"] == 50
    -    +    assert result["token_usage"]["output_tokens"] == 30
    -         mock_status.assert_called_once()  # draft -> questionnaire
    -     
    -     
    -    @@ -255,10 +260,11 @@ async def test_process_questionnaire_already_complete(mock_project):
    -     
    -     
    -     @pytest.mark.asyncio
    -    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    -     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    -     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    -     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    -    -async def test_generate_contracts_success(mock_project, mock_upsert, mock_status):
    -    +async def test_generate_contracts_success(mock_project, mock_upsert, mock_status, mock_ws):
    -         mock_project.return_value = {
    -             "id": PROJECT_ID,
    -             "user_id": USER_ID,
    -    diff --git a/tests/test_projects_router.py b/tests/test_projects_router.py
    -    index 862c16d..dc7c5ff 100644
    -    --- a/tests/test_projects_router.py
    -    +++ b/tests/test_projects_router.py
    -    @@ -21,7 +21,7 @@ def _set_test_config(monkeypatch):
    -         monkeypatch.setattr("app.config.settings.APP_URL", "http://localhost:8000")
    -         monkeypatch.setattr("app.config.settings.GITHUB_WEBHOOK_SECRET", "whsec_test")
    -         monkeypatch.setattr("app.config.settings.ANTHROPIC_API_KEY", "test-api-key")
    -    -    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-3-5-haiku-20241022")
    -    +    monkeypatch.setattr("app.config.settings.LLM_QUESTIONNAIRE_MODEL", "claude-haiku-4-5")
    -     
    -     
    -     USER_ID = "22222222-2222-2222-2222-222222222222"
    -    @@ -248,7 +248,10 @@ def test_questionnaire_message(
    -             "status": "draft",
    -             "questionnaire_state": {},
    -         }
    -    -    mock_llm.return_value = '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}'
    -    +    mock_llm.return_value = {
    -    +        "text": '{"reply": "What does your product do?", "section": "product_intent", "section_complete": false, "extracted_data": null}',
    -    +        "usage": {"input_tokens": 10, "output_tokens": 20},
    -    +    }
    -     
    -         resp = client.post(
    -             f"/projects/{PROJECT_ID}/questionnaire",
    -    @@ -332,8 +335,9 @@ def test_generate_contracts_incomplete(mock_project, mock_get_user):
    -     @patch("app.services.project_service.get_project_by_id", new_callable=AsyncMock)
    -     @patch("app.services.project_service.upsert_contract", new_callable=AsyncMock)
    -     @patch("app.services.project_service.update_project_status", new_callable=AsyncMock)
    -    +@patch("app.services.project_service.manager.send_to_user", new_callable=AsyncMock)
    -     def test_generate_contracts_success(
    -    -    mock_status, mock_upsert, mock_project, mock_get_user
    -    +    mock_ws, mock_status, mock_upsert, mock_project, mock_get_user
    -     ):
    -         mock_get_user.return_value = MOCK_USER
    -         all_sections = [
    -    diff --git a/web/src/App.tsx b/web/src/App.tsx
    -    index 7a6f811..8eadcd4 100644
    -    --- a/web/src/App.tsx
    -    +++ b/web/src/App.tsx
    -    @@ -7,6 +7,7 @@ import AuditDetailPage from './pages/AuditDetail';
    -     import ProjectDetail from './pages/ProjectDetail';
    -     import BuildProgress from './pages/BuildProgress';
    -     import BuildComplete from './pages/BuildComplete';
    -    +import Settings from './pages/Settings';
    -     import { AuthProvider, useAuth } from './context/AuthContext';
    -     import { ToastProvider } from './context/ToastContext';
    -     
    -    @@ -72,6 +73,14 @@ function App() {
    -                     </ProtectedRoute>
    -                   }
    -                 />
    -    +            <Route
    -    +              path="/settings"
    -    +              element={
    -    +                <ProtectedRoute>
    -    +                  <Settings />
    -    +                </ProtectedRoute>
    -    +              }
    -    +            />
    -                 <Route path="*" element={<Navigate to="/" replace />} />
    -               </Routes>
    -             </BrowserRouter>
    -    diff --git a/web/src/__tests__/App.test.tsx b/web/src/__tests__/App.test.tsx
    -    index 7678f4e..0d8a335 100644
    -    --- a/web/src/__tests__/App.test.tsx
    -    +++ b/web/src/__tests__/App.test.tsx
    -    @@ -298,7 +298,7 @@ describe('QuestionnaireModal', () => {
    -         expect(onClose).toHaveBeenCalled();
    -       });
    -     
    -    -  it('has a voice toggle button', () => {
    -    +  it('has a restart button', () => {
    -         render(
    -           <QuestionnaireModal
    -             projectId="test-id"
    -    @@ -307,7 +307,7 @@ describe('QuestionnaireModal', () => {
    -             onContractsGenerated={() => {}}
    -           />,
    -         );
    -    -    expect(screen.getByTestId('voice-toggle')).toBeInTheDocument();
    -    +    expect(screen.getByTestId('restart-btn')).toBeInTheDocument();
    -       });
    -     
    -       it('shows generate banner when questionnaire is complete', async () => {
    -    diff --git a/web/src/__tests__/Build.test.tsx b/web/src/__tests__/Build.test.tsx
    -    index daae829..ecfc67f 100644
    -    --- a/web/src/__tests__/Build.test.tsx
    -    +++ b/web/src/__tests__/Build.test.tsx
    -    @@ -162,7 +162,7 @@ describe('ProjectCard', () => {
    -     // ├ö├Â├ç├ö├Â├ç BuildComplete ├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç├ö├Â├ç
    -     
    -     vi.mock('../context/AuthContext', () => ({
    -    -  useAuth: () => ({ token: 'test-token' }),
    -    +  useAuth: () => ({ token: 'test-token', loading: false, authFetch: globalThis.fetch }),
    -       AuthProvider: ({ children }: { children: unknown }) => children,
    -     }));
    -     
    -    diff --git a/web/src/components/AppShell.tsx b/web/src/components/AppShell.tsx
    -    index 47a1098..b8f1f3c 100644
    -    --- a/web/src/components/AppShell.tsx
    -    +++ b/web/src/components/AppShell.tsx
    -    @@ -103,7 +103,6 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    -                   style={{ width: 28, height: 28, borderRadius: '50%' }}
    -                 />
    -               )}
    -    -          <span style={{ color: '#94A3B8', fontSize: '0.85rem' }}>{user?.github_login}</span>
    -               <button
    -                 onClick={logout}
    -                 style={{
    -    @@ -192,11 +191,50 @@ function AppShell({ children, sidebarRepos, onReposChange }: AppShellProps) {
    -                     marginTop: 'auto',
    -                     padding: '12px 16px',
    -                     borderTop: '1px solid #1E293B',
    -    -                color: '#64748B',
    -    -                fontSize: '0.7rem',
    -    +                display: 'flex',
    -    +                alignItems: 'center',
    -    +                justifyContent: 'space-between',
    -                   }}
    -                 >
    -    -              v0.1.0
    -    +              <div
    -    +                onClick={() => navigate('/settings')}
    -    +                style={{
    -    +                  display: 'flex',
    -    +                  alignItems: 'center',
    -    +                  gap: '8px',
    -    +                  cursor: 'pointer',
    -    +                  flex: 1,
    -    +                  minWidth: 0,
    -    +                }}
    -    +                title={user?.github_login ?? 'Settings'}
    -    +              >
    -    +                {user?.avatar_url && (
    -    +                  <img
    -    +                    src={user.avatar_url}
    -    +                    alt={user.github_login}
    -    +                    style={{ width: 22, height: 22, borderRadius: '50%', flexShrink: 0 }}
    -    +                  />
    -    +                )}
    -    +                <span style={{ color: '#CBD5E1', fontSize: '0.75rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    -    +                  {user?.github_login}
    -    +                </span>
    -    +              </div>
    -    +              <button
    -    +                onClick={() => navigate('/settings')}
    -    +                title="Settings"
    -    +                style={{
    -    +                  background: 'transparent',
    -    +                  border: 'none',
    -    +                  color: '#64748B',
    -    +                  cursor: 'pointer',
    -    +                  fontSize: '0.95rem',
    -    +                  padding: '4px',
    -    +                  flexShrink: 0,
    -    +                  lineHeight: 1,
    -    +                }}
    -    +              >
    -    +                ├ö├£├û
    -    +              </button>
    -                 </div>
    -               </aside>
    -             )}
    -    diff --git a/web/src/components/ContractProgress.tsx b/web/src/components/ContractProgress.tsx
    -    new file mode 100644
    -    index 0000000..821fec7
    -    --- /dev/null
    -    +++ b/web/src/components/ContractProgress.tsx
    -    @@ -0,0 +1,294 @@
    -    +/**
    -    + * ContractProgress -- live step-by-step contract generation progress panel.
    -    + *
    -    + * Shows each contract being generated with status indicators, a running log,
    -    + * context window meter, and cumulative token usage from the questionnaire.
    -    + */
    -    +import { useState, useEffect, useRef, useCallback } from 'react';
    -    +import { useAuth } from '../context/AuthContext';
    -    +import { useWebSocket } from '../hooks/useWebSocket';
    -    +
    -    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -    +
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Contract type labels                                              */
    -    +/* ------------------------------------------------------------------ */
    -    +
    -    +const CONTRACT_LABELS: Record<string, string> = {
    -    +  blueprint: 'Blueprint',
    -    +  manifesto: 'Manifesto',
    -    +  stack: 'Stack',
    -    +  schema: 'Schema',
    -    +  physics: 'Physics',
    -    +  boundaries: 'Boundaries',
    -    +  phases: 'Phases',
    -    +  ui: 'UI',
    -    +  builder_contract: 'Builder Contract',
    -    +  builder_directive: 'Builder Directive',
    -    +};
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: clone_repo
    +    +# ---------------------------------------------------------------------------
         +
    -    +const ALL_CONTRACTS = Object.keys(CONTRACT_LABELS);
         +
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Context window constants                                          */
    -    +/* ------------------------------------------------------------------ */
    +    +@pytest.mark.asyncio
    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +async def test_clone_repo(mock_run):
    +    +    """clone_repo clones with access token injected into URL."""
    +    +    await git_client.clone_repo("https://github.com/owner/repo.git", "/tmp/dest", access_token="ghp_testtoken")
         +
    -    +const MODEL_CONTEXT_WINDOWS: Record<string, number> = {
    -    +  'claude-haiku-4-5': 200_000,
    -    +  'claude-sonnet-4-5': 200_000,
    -    +  'claude-opus-4-6': 200_000,
    -    +  'gpt-4o': 128_000,
    -    +};
    -    +const DEFAULT_CONTEXT_WINDOW = 200_000;
    +    +    mock_run.assert_called_once()
    +    +    args = mock_run.call_args[0][0]  # command list
    +    +    assert "clone" in args
    +    +    # Token should be in the URL arg
    +    +    url_arg = [a for a in args if "github.com" in str(a)]
    +    +    assert len(url_arg) > 0
    +    +    assert "ghp_testtoken" in str(url_arg[0])
         +
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Types                                                             */
    -    +/* ------------------------------------------------------------------ */
         +
    -    +interface TokenUsage {
    -    +  input_tokens: number;
    -    +  output_tokens: number;
    -    +}
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: push
    +    +# ---------------------------------------------------------------------------
         +
    -    +type ContractStatus = 'pending' | 'generating' | 'done';
         +
    -    +interface LogEntry {
    -    +  time: string;
    -    +  message: string;
    -    +}
    +    +@pytest.mark.asyncio
    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +async def test_push(mock_run):
    +    +    """push runs git push."""
    +    +    await git_client.push("/tmp/test")
         +
    -    +interface Props {
    -    +  projectId: string;
    -    +  tokenUsage: TokenUsage;
    -    +  model: string;
    -    +  onComplete: () => void;
    -    +}
    +    +    mock_run.assert_called_once()
    +    +    args = mock_run.call_args[0][0]
    +    +    assert "push" in args
         +
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Styles                                                            */
    -    +/* ------------------------------------------------------------------ */
    -    +
    -    +const panelStyle: React.CSSProperties = {
    -    +  display: 'flex',
    -    +  flexDirection: 'column',
    -    +  gap: '12px',
    -    +  padding: '16px 20px',
    -    +  flex: 1,
    -    +  overflowY: 'auto',
    -    +};
         +
    -    +const stepRowStyle: React.CSSProperties = {
    -    +  display: 'flex',
    -    +  alignItems: 'center',
    -    +  gap: '10px',
    -    +  fontSize: '0.82rem',
    -    +  padding: '6px 0',
    -    +  borderBottom: '1px solid #1E293B',
    -    +};
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: set_remote
    +    +# ---------------------------------------------------------------------------
         +
    -    +const logPanelStyle: React.CSSProperties = {
    -    +  background: '#0F172A',
    -    +  borderRadius: '6px',
    -    +  padding: '10px 12px',
    -    +  fontFamily: 'monospace',
    -    +  fontSize: '0.72rem',
    -    +  color: '#94A3B8',
    -    +  maxHeight: '120px',
    -    +  overflowY: 'auto',
    -    +  lineHeight: '1.6',
    -    +};
         +
    -    +const meterBarOuter: React.CSSProperties = {
    -    +  flex: 1,
    -    +  height: '8px',
    -    +  background: '#1E293B',
    -    +  borderRadius: '4px',
    -    +  overflow: 'hidden',
    -    +};
    +    +@pytest.mark.asyncio
    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +async def test_set_remote(mock_run):
    +    +    """set_remote sets the origin remote."""
    +    +    await git_client.set_remote("/tmp/test", "https://github.com/owner/repo.git")
         +
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Component                                                         */
    -    +/* ------------------------------------------------------------------ */
    +    +    mock_run.assert_called_once()
    +    +    args = mock_run.call_args[0][0]
    +    +    assert "remote" in args
         +
    -    +export default function ContractProgress({ projectId, tokenUsage, model, onComplete }: Props) {
    -    +  const { token } = useAuth();
    -    +  const [statuses, setStatuses] = useState<Record<string, ContractStatus>>(() =>
    -    +    Object.fromEntries(ALL_CONTRACTS.map((c) => [c, 'pending' as const])),
    -    +  );
    -    +  const [log, setLog] = useState<LogEntry[]>([]);
    -    +  const [generating, setGenerating] = useState(false);
    -    +  const [allDone, setAllDone] = useState(false);
    -    +  const logEndRef = useRef<HTMLDivElement>(null);
    -    +  const startedRef = useRef(false);
    -    +
    -    +  const addLog = useCallback((msg: string) => {
    -    +    const now = new Date();
    -    +    const time = now.toLocaleTimeString('en-GB', { hour12: false });
    -    +    setLog((prev) => [...prev, { time, message: msg }]);
    -    +  }, []);
    -    +
    -    +  /* Auto-scroll log */
    -    +  useEffect(() => {
    -    +    logEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    -    +  }, [log]);
    -    +
    -    +  /* Handle WS progress messages */
    -    +  useWebSocket(
    -    +    useCallback(
    -    +      (data: { type: string; payload: any }) => {
    -    +        if (data.type !== 'contract_progress') return;
    -    +        const p = data.payload;
    -    +        if (p.project_id !== projectId) return;
    -    +
    -    +        const label = CONTRACT_LABELS[p.contract_type] ?? p.contract_type;
    -    +        if (p.status === 'generating') {
    -    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'generating' }));
    -    +          addLog(`Generating ${label}...`);
    -    +        } else if (p.status === 'done') {
    -    +          setStatuses((prev) => ({ ...prev, [p.contract_type]: 'done' }));
    -    +          addLog(`├ö┬ú├┤ ${label} complete`);
    -    +
    -    +          /* Check if all done */
    -    +          setStatuses((prev) => {
    -    +            const values = Object.values(prev);
    -    +            if (values.every((s) => s === 'done')) {
    -    +              setAllDone(true);
    -    +              addLog('All contracts generated successfully.');
    -    +            }
    -    +            return prev;
    -    +          });
    -    +        }
    -    +      },
    -    +      [projectId, addLog],
    -    +    ),
    -    +  );
         +
    -    +  /* Kick off generation on mount */
    -    +  useEffect(() => {
    -    +    if (startedRef.current) return;
    -    +    startedRef.current = true;
    -    +    setGenerating(true);
    -    +    addLog('Starting contract generation...');
    -    +
    -    +    fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    -    +      method: 'POST',
    -    +      headers: { Authorization: `Bearer ${token}` },
    -    +    })
    -    +      .then((res) => {
    -    +        if (!res.ok) throw new Error('Generation failed');
    -    +        /* Mark any remaining as done (safety net) */
    -    +        setStatuses((prev) => {
    -    +          const updated = { ...prev };
    -    +          for (const key of ALL_CONTRACTS) {
    -    +            if (updated[key] !== 'done') updated[key] = 'done';
    -    +          }
    -    +          return updated;
    -    +        });
    -    +        setAllDone(true);
    -    +        setGenerating(false);
    -    +      })
    -    +      .catch(() => {
    -    +        addLog('├ö┬ú├╣ Contract generation failed');
    -    +        setGenerating(false);
    -    +      });
    -    +  }, [projectId, token, addLog]);
    -    +
    -    +  /* Derived values */
    -    +  const contextWindow = MODEL_CONTEXT_WINDOWS[model] ?? DEFAULT_CONTEXT_WINDOW;
    -    +  const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    -    +  const ctxPercent = Math.min(100, (totalTokens / contextWindow) * 100);
    -    +  const doneCount = Object.values(statuses).filter((s) => s === 'done').length;
    -    +
    -    +  /* Color for context bar */
    -    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    +    +# ---------------------------------------------------------------------------
    +    +# Tests: get_file_list
    +    +# ---------------------------------------------------------------------------
         +
    -    +  return (
    -    +    <div style={panelStyle} data-testid="contract-progress">
    -    +      {/* Header */}
    -    +      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
    -    +        <h4 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    -    +          {allDone ? '├ö┬ú├┤ Contracts Ready' : `Generating Contracts├ö├ç┬¬ (${doneCount}/${ALL_CONTRACTS.length})`}
    -    +        </h4>
    -    +      </div>
         +
    -    +      {/* Context window meter */}
    -    +      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    -    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.7rem', color: '#94A3B8' }}>
    -    +          <span>Context Window ({model})</span>
    -    +          <span>
    -    +            {totalTokens.toLocaleString()} / {contextWindow.toLocaleString()} tokens ({ctxPercent.toFixed(1)}%)
    -    +          </span>
    -    +        </div>
    -    +        <div style={meterBarOuter}>
    -    +          <div
    -    +            style={{
    -    +              width: `${ctxPercent}%`,
    -    +              height: '100%',
    -    +              background: ctxColor,
    -    +              borderRadius: '4px',
    -    +              transition: 'width 0.4s ease',
    -    +            }}
    -    +          />
    -    +        </div>
    -    +        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#64748B' }}>
    -    +          <span>Input: {tokenUsage.input_tokens.toLocaleString()}</span>
    -    +          <span>Output: {tokenUsage.output_tokens.toLocaleString()}</span>
    -    +        </div>
    -    +      </div>
    +    +@pytest.mark.asyncio
    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +async def test_get_file_list(mock_run):
    +    +    """get_file_list returns list of tracked files."""
    +    +    mock_run.return_value = "file1.py\nfile2.ts\n"
         +
    -    +      {/* Step list */}
    -    +      <div>
    -    +        {ALL_CONTRACTS.map((ct) => {
    -    +          const st = statuses[ct];
    -    +          const icon = st === 'done' ? '├ö┬ú├á' : st === 'generating' ? '├ö├àÔöé' : '├ö├╣├»';
    -    +          const color = st === 'done' ? '#22C55E' : st === 'generating' ? '#F59E0B' : '#475569';
    -    +          return (
    -    +            <div key={ct} style={stepRowStyle}>
    -    +              <span style={{ width: '20px', textAlign: 'center' }}>{icon}</span>
    -    +              <span style={{ flex: 1, color }}>{CONTRACT_LABELS[ct]}</span>
    -    +              <span style={{ fontSize: '0.7rem', color: '#64748B', textTransform: 'uppercase' }}>{st}</span>
    -    +            </div>
    -    +          );
    -    +        })}
    -    +      </div>
    +    +    result = await git_client.get_file_list("/tmp/test")
         +
    -    +      {/* Log panel */}
    -    +      <div style={logPanelStyle} data-testid="contract-log">
    -    +        {log.map((entry, i) => (
    -    +          <div key={i}>
    -    +            <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    -    +            {entry.message}
    -    +          </div>
    -    +        ))}
    -    +        <div ref={logEndRef} />
    -    +      </div>
    +    +    assert result == ["file1.py", "file2.ts"]
         +
    -    +      {/* Done button */}
    -    +      {allDone && (
    -    +        <button
    -    +          onClick={onComplete}
    -    +          data-testid="contracts-done-btn"
    -    +          style={{
    -    +            background: '#16A34A',
    -    +            color: '#fff',
    -    +            border: 'none',
    -    +            borderRadius: '8px',
    -    +            padding: '10px 20px',
    -    +            cursor: 'pointer',
    -    +            fontSize: '0.8rem',
    -    +            fontWeight: 600,
    -    +            alignSelf: 'center',
    -    +          }}
    -    +        >
    -    +          Done ├ö├ç├Â View Contracts
    -    +        </button>
    -    +      )}
         +
    -    +      {generating && !allDone && (
    -    +        <p style={{ textAlign: 'center', color: '#64748B', fontSize: '0.75rem', margin: 0 }}>
    -    +          Generating├ö├ç┬¬
    -    +        </p>
    -    +      )}
    -    +    </div>
    -    +  );
    -    +}
    -    diff --git a/web/src/components/QuestionnaireModal.tsx b/web/src/components/QuestionnaireModal.tsx
    -    index 2b28280..5aa4c71 100644
    -    --- a/web/src/components/QuestionnaireModal.tsx
    -    +++ b/web/src/components/QuestionnaireModal.tsx
    -    @@ -7,6 +7,7 @@
    -      */
    -     import { useState, useEffect, useRef, useCallback } from 'react';
    -     import { useAuth } from '../context/AuthContext';
    -    +import ContractProgress from './ContractProgress';
    -     
    -     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -     
    -    @@ -22,7 +23,6 @@ const SECTION_LABELS: Record<string, string> = {
    -       ui_requirements: 'UI Requirements',
    -       architectural_boundaries: 'Boundaries',
    -       deployment_target: 'Deployment',
    -    -  phase_breakdown: 'Phase Breakdown',
    -     };
    -     
    -     const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    -    @@ -34,6 +34,7 @@ const ALL_SECTIONS = Object.keys(SECTION_LABELS);
    -     interface ChatMessage {
    -       role: 'user' | 'assistant';
    -       content: string;
    -    +  section?: string;
    -     }
    -     
    -     interface QuestionnaireState {
    -    @@ -150,83 +151,178 @@ const SpeechRecognition =
    -         : null;
    -     
    -     function useSpeechRecognition(onResult: (text: string) => void) {
    -    -  const recognitionRef = useRef<any>(null);
    -       const [listening, setListening] = useState(false);
    -       const listeningRef = useRef(false);
    -    +  const recRef = useRef<any>(null);
    -    +  const onResultRef = useRef(onResult);
    -    +  onResultRef.current = onResult;
    -    +  /* Generation counter ├ö├ç├Â bumped on every stop/start so stale restarts are ignored */
    -    +  const genRef = useRef(0);
    -    +  /* Restart timer ├ö├ç├Â ensures only ONE pending restart at a time */
    -    +  const restartTimer = useRef<ReturnType<typeof setTimeout> | null>(null);
    -    +  /* Consecutive network-error counter ├ö├ç├Â give up after too many */
    -    +  const netErrCount = useRef(0);
    -    +
    -    +  /* Tear down the current instance completely */
    -    +  const killRec = useCallback(() => {
    -    +    const old = recRef.current;
    -    +    recRef.current = null;
    -    +    if (old) {
    -    +      old.onresult = null;
    -    +      old.onerror = null;
    -    +      old.onend = null;
    -    +      old.onaudiostart = null;
    -    +      old.onaudioend = null;
    -    +      try { old.abort(); } catch { /* ignore */ }
    -    +    }
    -    +  }, []);
    -     
    -    -  useEffect(() => {
    -    -    if (!SpeechRecognition) return;
    -    -    const rec = new SpeechRecognition();
    -    -    rec.continuous = true;
    -    -    rec.interimResults = true;
    -    -    rec.lang = 'en-US';
    -    -
    -    -    rec.onresult = (e: any) => {
    -    -      let finalTranscript = '';
    -    -      for (let i = e.resultIndex; i < e.results.length; i++) {
    -    -        if (e.results[i].isFinal) {
    -    -          finalTranscript += e.results[i][0].transcript;
    -    -        }
    -    -      }
    -    -      if (finalTranscript) {
    -    -        onResult(finalTranscript);
    -    -      }
    -    -    };
    -    +  /* Cancel any pending restart */
    -    +  const cancelRestart = useCallback(() => {
    -    +    if (restartTimer.current) {
    -    +      clearTimeout(restartTimer.current);
    -    +      restartTimer.current = null;
    -    +    }
    -    +  }, []);
    -     
    -    -    rec.onerror = (e: any) => {
    -    -      /* 'no-speech' and 'aborted' are normal during pauses ├ö├ç├Â auto-restart */
    -    -      if (e.error === 'no-speech' || e.error === 'aborted') {
    -    -        if (listeningRef.current) {
    -    -          try { rec.start(); } catch { /* already running */ }
    -    -        }
    -    -        return;
    -    -      }
    -    -      listeningRef.current = false;
    -    -      setListening(false);
    -    -    };
    -    +  /* Build a fresh SpeechRecognition (never reused) */
    -    +  const makeRec = useCallback(() => {
    -    +    if (!SpeechRecognition) return null;
    -    +    const r = new SpeechRecognition();
    -    +    r.continuous = true;
    -    +    r.interimResults = true;
    -    +    r.lang = 'en-US';
    -    +    return r;
    -    +  }, []);
    -     
    -    -    /* Browser fires onend after silence; auto-restart if user hasn't toggled off */
    -    -    rec.onend = () => {
    -    -      if (listeningRef.current) {
    -    -        try { rec.start(); } catch { /* already running */ }
    -    -      } else {
    -    -        setListening(false);
    -    -      }
    -    -    };
    -    +  const stop = useCallback(() => {
    -    +    console.debug('[mic] stop()');
    -    +    genRef.current++;
    -    +    listeningRef.current = false;
    -    +    setListening(false);
    -    +    cancelRestart();
    -    +    killRec();
    -    +  }, [killRec, cancelRestart]);
    -     
    -    -    recognitionRef.current = rec;
    -    -    return () => {
    -    -      listeningRef.current = false;
    -    -      rec.abort();
    -    +  const start = useCallback(() => {
    -    +    if (!SpeechRecognition) return;
    -    +    console.debug('[mic] start()');
    -    +
    -    +    /* Tear down any previous instance */
    -    +    cancelRestart();
    -    +    killRec();
    -    +    netErrCount.current = 0;
    -    +
    -    +    const gen = ++genRef.current;
    -    +
    -    +    /**
    -    +     * Schedule a (re)start with a fresh SpeechRecognition instance.
    -    +     * Uses a delay to let Chrome fully release the network connection
    -    +     * from the previous instance.  Only ONE restart can be pending.
    -    +     */
    -    +    const scheduleStart = (delay: number) => {
    -    +      cancelRestart();
    -    +      restartTimer.current = setTimeout(() => {
    -    +        restartTimer.current = null;
    -    +        if (!listeningRef.current || genRef.current !== gen) return;
    -    +
    -    +        killRec();                        // ensure nothing lingering
    -    +        const r = makeRec();
    -    +        if (!r) return;
    -    +        recRef.current = r;
    -    +
    -    +        r.onresult = (e: any) => {
    -    +          netErrCount.current = 0;        // got results ├ö├ç├Â connection is healthy
    -    +          let finalText = '';
    -    +          for (let i = e.resultIndex; i < e.results.length; i++) {
    -    +            if (e.results[i].isFinal) {
    -    +              finalText += e.results[i][0].transcript;
    -    +            }
    -    +          }
    -    +          if (finalText) {
    -    +            console.debug('[mic] transcript:', finalText.slice(0, 60));
    -    +            onResultRef.current(finalText);
    -    +          }
    -    +        };
    -    +
    -    +        r.onerror = (e: any) => {
    -    +          console.debug('[mic] error:', e.error);
    -    +          if (e.error === 'not-allowed') {
    -    +            genRef.current++;
    -    +            listeningRef.current = false;
    -    +            setListening(false);
    -    +            cancelRestart();
    -    +            killRec();
    -    +            return;
    -    +          }
    -    +          if (e.error === 'network') {
    -    +            netErrCount.current++;
    -    +            if (netErrCount.current > 3) {
    -    +              console.debug('[mic] too many network errors, giving up');
    -    +              genRef.current++;
    -    +              listeningRef.current = false;
    -    +              setListening(false);
    -    +              cancelRestart();
    -    +              killRec();
    -    +              return;
    -    +            }
    -    +          }
    -    +          /* Do NOT restart here ├ö├ç├Â onend always fires after onerror
    -    +             and will handle the restart.  Restarting from both causes
    -    +             two competing instances ├ö├Ñ├å more network errors. */
    -    +        };
    -    +
    -    +        r.onend = () => {
    -    +          console.debug('[mic] onend, listening=', listeningRef.current, 'gen=', genRef.current === gen);
    -    +          if (listeningRef.current && genRef.current === gen) {
    -    +            /* Delay restart so Chrome fully tears down the connection.
    -    +               Longer delay after network errors to let things settle. */
    -    +            const d = netErrCount.current > 0 ? 800 : 300;
    -    +            console.debug('[mic] scheduling restart in', d, 'ms');
    -    +            scheduleStart(d);
    -    +          }
    -    +        };
    -    +
    -    +        try {
    -    +          r.start();
    -    +          console.debug('[mic] started OK');
    -    +        } catch (e) {
    -    +          console.debug('[mic] start threw:', e);
    -    +          listeningRef.current = false;
    -    +          setListening(false);
    -    +          cancelRestart();
    -    +          killRec();
    -    +        }
    -    +      }, delay);
    -         };
    -    -    // eslint-disable-next-line react-hooks/exhaustive-deps
    -    -  }, []);
    -    +
    -    +    listeningRef.current = true;
    -    +    setListening(true);
    -    +    scheduleStart(50);                     // tiny initial delay
    -    +  }, [killRec, makeRec, cancelRestart]);
    -     
    -       const toggle = useCallback(() => {
    -    -    const rec = recognitionRef.current;
    -    -    if (!rec) return;
    -         if (listening) {
    -    -      listeningRef.current = false;
    -    -      rec.abort();
    -    -      setListening(false);
    -    +      stop();
    -         } else {
    -    -      listeningRef.current = true;
    -    -      rec.start();
    -    -      setListening(true);
    -    +      start();
    -         }
    -    -  }, [listening]);
    -    +  }, [listening, start, stop]);
    -    +
    -    +  /* Cleanup on unmount */
    -    +  useEffect(() => {
    -    +    return () => {
    -    +      genRef.current++;
    -    +      listeningRef.current = false;
    -    +      cancelRestart();
    -    +      killRec();
    -    +    };
    -    +  }, [killRec]);
    -     
    -       return { listening, toggle, supported: !!SpeechRecognition };
    -     }
    -     
    -    -function speak(text: string) {
    -    -  if (typeof window === 'undefined' || !window.speechSynthesis) return;
    -    -  window.speechSynthesis.cancel();
    -    -  const utter = new SpeechSynthesisUtterance(text);
    -    -  utter.rate = 1.05;
    -    -  utter.pitch = 1;
    -    -  window.speechSynthesis.speak(utter);
    -    -}
    +    +@pytest.mark.asyncio
    +    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +    +async def test_get_file_list_empty(mock_run):
    +    +    """get_file_list returns empty list when no files."""
    +    +    mock_run.return_value = ""
         +
    -     
    -     /* ------------------------------------------------------------------ */
    -     /*  Progress bar                                                      */
    -    @@ -265,7 +361,6 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -       const [messages, setMessages] = useState<ChatMessage[]>([]);
    -       const [input, setInput] = useState('');
    -       const [sending, setSending] = useState(false);
    -    -  const [generating, setGenerating] = useState(false);
    -       const [qState, setQState] = useState<QuestionnaireState>({
    -         current_section: 'product_intent',
    -         completed_sections: [],
    -    @@ -273,9 +368,12 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -         is_complete: false,
    -       });
    -       const [error, setError] = useState('');
    -    -  const [voiceEnabled, setVoiceEnabled] = useState(true);
    -    +  const [resetting, setResetting] = useState(false);
    -    +  const [tokenUsage, setTokenUsage] = useState({ input_tokens: 0, output_tokens: 0 });
    -    +  const [generatingContracts, setGeneratingContracts] = useState(false);
    -       const messagesEndRef = useRef<HTMLDivElement>(null);
    -       const textareaRef = useRef<HTMLTextAreaElement>(null);
    -    +  const loadedRef = useRef(false);
    -     
    -       /* auto-scroll on new messages */
    -       useEffect(() => {
    -    @@ -294,6 +392,9 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -     
    -       /* ---- Load existing state on mount ---- */
    -       useEffect(() => {
    -    +    if (loadedRef.current) return;   // StrictMode double-mount guard
    -    +    loadedRef.current = true;
    -    +
    -         const load = async () => {
    -           try {
    -             const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire/state`, {
    -    @@ -307,13 +408,21 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -                 remaining_sections: state.remaining_sections,
    -                 is_complete: state.is_complete,
    -               });
    -    -          /* Restore prior conversation */
    -    -          const history: ChatMessage[] = (state.conversation_history ?? []).map(
    -    -            (m: { role: string; content: string }) => ({
    -    -              role: m.role as 'user' | 'assistant',
    -    -              content: m.content,
    -    -            }),
    -    -          );
    -    +          /* Restore prior conversation ├ö├ç├Â only messages from the current section */
    -    +          const currentSec = state.current_section;
    -    +          const history: ChatMessage[] = (state.conversation_history ?? [])
    -    +            .filter((m: { section?: string }) => !currentSec || m.section === currentSec)
    -    +            .map(
    -    +              (m: { role: string; content: string; section?: string }) => ({
    -    +                role: m.role as 'user' | 'assistant',
    -    +                content: m.content,
    -    +                section: m.section,
    -    +              }),
    -    +            );
    -    +          /* Restore token usage */
    -    +          if (state.token_usage) {
    -    +            setTokenUsage(state.token_usage);
    -    +          }
    -               if (history.length > 0) {
    -                 setMessages(history);
    -               } else if (!state.is_complete) {
    -    @@ -367,18 +476,31 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -           }
    -     
    -           const data = await res.json();
    -    -      setMessages((prev) => [...prev, { role: 'assistant', content: data.reply }]);
    -    +
    -    +      /* Detect section transition ├ö├ç├Â clear visible messages for a fresh screen */
    -    +      const newCurrentSection = data.remaining_sections[0] ?? null;
    -    +      const prevSection = qState.current_section;
    -    +      const sectionChanged = prevSection && newCurrentSection && prevSection !== newCurrentSection;
    -    +
    -    +      if (sectionChanged) {
    -    +        /* Section just completed ├ö├ç├Â start fresh with only the transition reply */
    -    +        setMessages([{ role: 'assistant', content: data.reply, section: newCurrentSection }]);
    -    +      } else {
    -    +        setMessages((prev) => [...prev, { role: 'assistant', content: data.reply, section: newCurrentSection ?? prevSection ?? undefined }]);
    -    +      }
    -    +
    -           setQState({
    -    -        current_section: data.remaining_sections[0] ?? null,
    -    +        current_section: newCurrentSection,
    -             completed_sections: data.completed_sections,
    -             remaining_sections: data.remaining_sections,
    -             is_complete: data.is_complete,
    -           });
    -     
    -    -      /* auto-read assistant reply with TTS */
    -    -      if (voiceEnabled) {
    -    -        speak(data.reply);
    -    +      /* Update token usage */
    -    +      if (data.token_usage) {
    -    +        setTokenUsage(data.token_usage);
    -           }
    -    +
    -         } catch {
    -           setError('Network error');
    -         } finally {
    -    @@ -387,25 +509,8 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -       };
    -     
    -       /* ---- Generate contracts ---- */
    -    -  const handleGenerate = async () => {
    -    -    setGenerating(true);
    -    -    setError('');
    -    -    try {
    -    -      const res = await fetch(`${API_BASE}/projects/${projectId}/contracts/generate`, {
    -    -        method: 'POST',
    -    -        headers: { Authorization: `Bearer ${token}` },
    -    -      });
    -    -      if (res.ok) {
    -    -        onContractsGenerated();
    -    -      } else {
    -    -        const d = await res.json().catch(() => ({}));
    -    -        setError(d.detail || 'Failed to generate contracts');
    -    -      }
    -    -    } catch {
    -    -      setError('Network error');
    -    -    } finally {
    -    -      setGenerating(false);
    -    -    }
    -    +  const handleStartGenerate = () => {
    -    +    setGeneratingContracts(true);
    -       };
    -     
    -       /* ---- Textarea auto-grow + Ctrl/Cmd+Enter submit ---- */
    -    @@ -442,21 +547,79 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -                       ? `Section: ${SECTION_LABELS[qState.current_section] ?? qState.current_section}`
    -                       : 'Starting...'}
    -                 </p>
    -    +            <p style={{ margin: '2px 0 0', fontSize: '0.6rem', color: '#475569', letterSpacing: '0.3px' }}>
    -    +              Model: claude-haiku-4-5
    -    +            </p>
    -    +            {/* Context window meter */}
    -    +            {(tokenUsage.input_tokens > 0 || tokenUsage.output_tokens > 0) && (() => {
    -    +              const totalTokens = tokenUsage.input_tokens + tokenUsage.output_tokens;
    -    +              const contextWindow = 200_000;
    -    +              const pct = Math.min((totalTokens / contextWindow) * 100, 100);
    -    +              const barColor = pct < 50 ? '#22C55E' : pct < 80 ? '#F59E0B' : '#EF4444';
    -    +              return (
    -    +                <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginTop: '4px' }}>
    -    +                  <div style={{
    -    +                    flex: 1,
    -    +                    height: '4px',
    -    +                    background: '#1E293B',
    -    +                    borderRadius: '2px',
    -    +                    overflow: 'hidden',
    -    +                    maxWidth: '120px',
    -    +                  }}>
    -    +                    <div style={{
    -    +                      width: `${pct}%`,
    -    +                      height: '100%',
    -    +                      background: barColor,
    -    +                      borderRadius: '2px',
    -    +                      transition: 'width 0.3s',
    -    +                    }} />
    -    +                  </div>
    -    +                  <span style={{ fontSize: '0.55rem', color: '#64748B', whiteSpace: 'nowrap' }}>
    -    +                    {totalTokens.toLocaleString()} / 200K
    -    +                  </span>
    -    +                </div>
    -    +              );
    -    +            })()}
    -               </div>
    -               <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
    -    -            {/* Voice toggle */}
    -    +            {/* Restart questionnaire */}
    -                 <button
    -    -              onClick={() => setVoiceEnabled((v) => !v)}
    -    -              title={voiceEnabled ? 'Mute assistant voice' : 'Enable assistant voice'}
    -    -              data-testid="voice-toggle"
    -    +              onClick={async () => {
    -    +                if (!confirm('Restart the questionnaire? All answers will be cleared.')) return;
    -    +                setResetting(true);
    -    +                try {
    -    +                  const res = await fetch(`${API_BASE}/projects/${projectId}/questionnaire`, {
    -    +                    method: 'DELETE',
    -    +                    headers: { Authorization: `Bearer ${token}` },
    -    +                  });
    -    +                  if (res.ok) {
    -    +                    setMessages([]);
    -    +                    setQState({
    -    +                      current_section: 'product_intent',
    -    +                      completed_sections: [],
    -    +                      remaining_sections: [...ALL_SECTIONS],
    -    +                      is_complete: false,
    -    +                    });
    -    +                    setInput('');
    -    +                    setError('');
    -    +                  }
    -    +                } catch { /* ignore */ }
    -    +                setResetting(false);
    -    +              }}
    -    +              disabled={resetting}
    -    +              title="Restart questionnaire"
    -    +              data-testid="restart-btn"
    -                   style={{
    -                     ...btnGhost,
    -                     padding: '6px 10px',
    -    -                fontSize: '1rem',
    -    -                opacity: voiceEnabled ? 1 : 0.5,
    -    +                fontSize: '0.7rem',
    -    +                fontWeight: 600,
    -    +                color: '#F59E0B',
    -    +                borderColor: '#F59E0B33',
    -    +                opacity: resetting ? 0.5 : 1,
    -                   }}
    -                 >
    -    -              {voiceEnabled ? '┬¡ãÆ├Â├¿' : '┬¡ãÆ├Â├º'}
    -    +              ├ö├ÑÔòù Restart
    -                 </button>
    -                 <button onClick={onClose} style={{ ...btnGhost, padding: '6px 10px' }} data-testid="questionnaire-close">
    -                   ├ö┬ú├▓
    -    @@ -514,8 +677,18 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -               </div>
    -             )}
    -     
    -    +        {/* Contract generation progress */}
    -    +        {generatingContracts && (
    -    +          <ContractProgress
    -    +            projectId={projectId}
    -    +            tokenUsage={tokenUsage}
    -    +            model="claude-haiku-4-5"
    -    +            onComplete={onContractsGenerated}
    -    +          />
    -    +        )}
    -    +
    -             {/* Generate contracts banner */}
    -    -        {qState.is_complete && (
    -    +        {qState.is_complete && !generatingContracts && (
    -               <div
    -                 style={{
    -                   padding: '12px 20px',
    -    @@ -533,17 +706,15 @@ function QuestionnaireModal({ projectId, projectName, onClose, onContractsGenera
    -                   ├ö┬ú├┤ All sections complete ├ö├ç├Â ready to generate contracts
    -                 </span>
    -                 <button
    -    -              onClick={handleGenerate}
    -    -              disabled={generating}
    -    +              onClick={handleStartGenerate}
    -                   data-testid="generate-contracts-btn"
    -                   style={{
    -                     ...btnPrimary,
    -                     background: '#16A34A',
    -    -                opacity: generating ? 0.6 : 1,
    -    -                cursor: generating ? 'wait' : 'pointer',
    -    +                cursor: 'pointer',
    -                   }}
    -                 >
    -    -              {generating ? 'Generating...' : 'Generate Contracts'}
    -    +              Generate Contracts
    -                 </button>
    -               </div>
    -             )}
    -    diff --git a/web/src/context/AuthContext.tsx b/web/src/context/AuthContext.tsx
    -    index 3f217e2..0430bc8 100644
    -    --- a/web/src/context/AuthContext.tsx
    -    +++ b/web/src/context/AuthContext.tsx
    -    @@ -4,6 +4,7 @@ interface User {
    -       id: string;
    -       github_login: string;
    -       avatar_url: string | null;
    -    +  has_anthropic_key?: boolean;
    -     }
    -     
    -     interface AuthContextValue {
    -    @@ -11,6 +12,7 @@ interface AuthContextValue {
    -       user: User | null;
    -       login: (token: string, user: User) => void;
    -       logout: () => void;
    -    +  updateUser: (patch: Partial<User>) => void;
    -     }
    -     
    -     const AuthContext = createContext<AuthContextValue | null>(null);
    -    @@ -38,6 +40,15 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    -         localStorage.removeItem('forgeguard_user');
    -       };
    -     
    -    +  const updateUser = (patch: Partial<User>) => {
    -    +    setUser((prev) => {
    -    +      if (!prev) return prev;
    -    +      const updated = { ...prev, ...patch };
    -    +      localStorage.setItem('forgeguard_user', JSON.stringify(updated));
    -    +      return updated;
    +    +    result = await git_client.get_file_list("/tmp/test")
    +    +
    +    +    assert result == []
    +    diff --git a/web/src/__tests__/BuildTargetModal.test.tsx b/web/src/__tests__/BuildTargetModal.test.tsx
    +    new file mode 100644
    +    index 0000000..432c75d
    +    --- /dev/null
    +    +++ b/web/src/__tests__/BuildTargetModal.test.tsx
    +    @@ -0,0 +1,99 @@
    +    +import { describe, it, expect, vi, beforeEach } from 'vitest';
    +    +import { render, screen, fireEvent } from '@testing-library/react';
    +    +import BuildTargetModal from '../components/BuildTargetModal';
    +    +
    +    +describe('BuildTargetModal', () => {
    +    +  const mockConfirm = vi.fn();
    +    +  const mockCancel = vi.fn();
    +    +
    +    +  beforeEach(() => {
    +    +    vi.clearAllMocks();
    +    +  });
    +    +
    +    +  it('renders three target options', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    expect(screen.getByText('New GitHub Repo')).toBeInTheDocument();
    +    +    expect(screen.getByText('Existing GitHub Repo')).toBeInTheDocument();
    +    +    expect(screen.getByText('Local Directory')).toBeInTheDocument();
    +    +  });
    +    +
    +    +  it('renders the Build Target title', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    expect(screen.getByText('Build Target')).toBeInTheDocument();
    +    +  });
    +    +
    +    +  it('shows correct placeholder for github_new (default)', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    expect(input.placeholder).toBe('my-new-project');
    +    +  });
    +    +
    +    +  it('changes placeholder when selecting existing repo', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    fireEvent.click(screen.getByTestId('target-github_existing'));
    +    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    expect(input.placeholder).toBe('owner/repo-name');
    +    +  });
    +    +
    +    +  it('changes placeholder when selecting local path', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    fireEvent.click(screen.getByTestId('target-local_path'));
    +    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    expect(input.placeholder).toContain('Projects');
    +    +  });
    +    +
    +    +  it('disables Start Build when input is empty', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    const btn = screen.getByTestId('target-confirm-btn');
    +    +    expect(btn).toBeDisabled();
    +    +  });
    +    +
    +    +  it('enables Start Build when input has value', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    const input = screen.getByTestId('target-ref-input');
    +    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    +    const btn = screen.getByTestId('target-confirm-btn');
    +    +    expect(btn).not.toBeDisabled();
    +    +  });
    +    +
    +    +  it('calls onConfirm with target data', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    const input = screen.getByTestId('target-ref-input');
    +    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    +    fireEvent.click(screen.getByTestId('target-confirm-btn'));
    +    +    expect(mockConfirm).toHaveBeenCalledWith({
    +    +      target_type: 'github_new',
    +    +      target_ref: 'my-repo',
         +    });
    -    +  };
    +    +  });
         +
    -       useEffect(() => {
    -         if (!token) return;
    -         // Validate token on mount by calling /auth/me
    -    @@ -53,7 +64,7 @@ export function AuthProvider({ children }: { children: ReactNode }) {
    -       }, []); // eslint-disable-line react-hooks/exhaustive-deps
    -     
    -       return (
    -    -    <AuthContext.Provider value={{ token, user, login, logout }}>
    -    +    <AuthContext.Provider value={{ token, user, login, logout, updateUser }}>
    -           {children}
    -         </AuthContext.Provider>
    -       );
    -    diff --git a/web/src/pages/BuildComplete.tsx b/web/src/pages/BuildComplete.tsx
    -    index e419947..19ece0f 100644
    -    --- a/web/src/pages/BuildComplete.tsx
    -    +++ b/web/src/pages/BuildComplete.tsx
    -    @@ -184,6 +184,7 @@ export default function BuildComplete() {
    -               <h3 style={{ color: '#F8FAFC', margin: '0 0 12px' }}>Token Usage by Phase</h3>
    -               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', borderBottom: '1px solid #334155', color: '#94A3B8', fontSize: 13 }}>
    -                 <span style={{ flex: 2 }}>Phase</span>
    -    +            <span style={{ flex: 1 }}>Model</span>
    -                 <span style={{ flex: 1, textAlign: 'right' }}>Input</span>
    -                 <span style={{ flex: 1, textAlign: 'right' }}>Output</span>
    -                 <span style={{ flex: 1, textAlign: 'right' }}>Cost</span>
    -    @@ -191,6 +192,7 @@ export default function BuildComplete() {
    -               {summary.cost.phases.map((entry, i) => (
    -                 <div key={i} style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #1E293B', color: '#F8FAFC', fontSize: 14 }}>
    -                   <span style={{ flex: 2 }}>{entry.phase}</span>
    -    +              <span style={{ flex: 1, color: '#A78BFA', fontSize: 12 }}>{entry.model.replace('claude-', '')}</span>
    -                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.input_tokens)}</span>
    -                   <span style={{ flex: 1, textAlign: 'right', color: '#94A3B8' }}>{formatTokens(entry.output_tokens)}</span>
    -                   <span style={{ flex: 1, textAlign: 'right' }}>${entry.estimated_cost_usd.toFixed(4)}</span>
    -    @@ -198,6 +200,7 @@ export default function BuildComplete() {
    -               ))}
    -               <div style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0 0', color: '#F8FAFC', fontWeight: 600, fontSize: 14 }}>
    -                 <span style={{ flex: 2 }}>Total</span>
    -    +            <span style={{ flex: 1 }}></span>
    -                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_input_tokens)}</span>
    -                 <span style={{ flex: 1, textAlign: 'right' }}>{formatTokens(summary.cost.total_output_tokens)}</span>
    -                 <span style={{ flex: 1, textAlign: 'right' }}>${summary.cost.total_cost_usd.toFixed(4)}</span>
    -    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    -    index a4f1808..021b634 100644
    -    --- a/web/src/pages/BuildProgress.tsx
    -    +++ b/web/src/pages/BuildProgress.tsx
    -    @@ -1,25 +1,49 @@
    -     /**
    -      * BuildProgress -- real-time build progress visualization.
    -    - * Shows phase progress bar, streaming logs, audit results, and cancel button.
    -    + *
    -    + * Two-column layout:
    -    + *   Left  (40%) ├ö├ç├Â Phase checklist with summaries, status icons, per-phase tokens
    -    + *   Right (60%) ├ö├ç├Â Token/cost metrics card, live activity feed, cancel button
    -    + *
    -    + * All data streamed via WebSocket; initial state fetched from REST.
    -      */
    -    -import { useState, useEffect, useCallback } from 'react';
    -    +import { useState, useEffect, useRef, useCallback } from 'react';
    -     import { useParams, useNavigate } from 'react-router-dom';
    -     import { useAuth } from '../context/AuthContext';
    -     import { useToast } from '../context/ToastContext';
    -     import { useWebSocket } from '../hooks/useWebSocket';
    -     import AppShell from '../components/AppShell';
    -    -import PhaseProgressBar from '../components/PhaseProgressBar';
    -    -import type { Phase } from '../components/PhaseProgressBar';
    -    -import BuildLogViewer from '../components/BuildLogViewer';
    -    -import type { LogEntry } from '../components/BuildLogViewer';
    -    -import BuildAuditCard from '../components/BuildAuditCard';
    -    -import type { AuditCheck } from '../components/BuildAuditCard';
    -     import ConfirmDialog from '../components/ConfirmDialog';
    -     import EmptyState from '../components/EmptyState';
    -     import Skeleton from '../components/Skeleton';
    -     
    -     const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -     
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Pricing ├ö├ç├Â matches backend _MODEL_PRICING                          */
    -    +/* ------------------------------------------------------------------ */
    -    +
    -    +const MODEL_PRICING: Record<string, { input: number; output: number }> = {
    -    +  'claude-opus-4':     { input: 15 / 1_000_000, output: 75 / 1_000_000 },
    -    +  'claude-sonnet-4':   { input: 3 / 1_000_000,  output: 15 / 1_000_000 },
    -    +  'claude-haiku-4':    { input: 1 / 1_000_000,  output: 5 / 1_000_000 },
    -    +  'claude-3-5-sonnet': { input: 3 / 1_000_000,  output: 15 / 1_000_000 },
    -    +};
    -    +const DEFAULT_PRICING = { input: 15 / 1_000_000, output: 75 / 1_000_000 };
    +    +  it('calls onCancel when cancel button clicked', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    fireEvent.click(screen.getByText('Cancel'));
    +    +    expect(mockCancel).toHaveBeenCalledOnce();
    +    +  });
         +
    -    +function getTokenCost(model: string, input: number, output: number): number {
    -    +  for (const [prefix, rates] of Object.entries(MODEL_PRICING)) {
    -    +    if (model.startsWith(prefix)) {
    -    +      return input * rates.input + output * rates.output;
    -    +    }
    -    +  }
    -    +  return input * DEFAULT_PRICING.input + output * DEFAULT_PRICING.output;
    -    +}
    +    +  it('calls onCancel when close button (├ö┬ú├▓) clicked', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    fireEvent.click(screen.getByText('├ö┬ú├▓'));
    +    +    expect(mockCancel).toHaveBeenCalledOnce();
    +    +  });
         +
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Types                                                             */
    -    +/* ------------------------------------------------------------------ */
    +    +  it('shows "Starting..." when starting prop is true', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} starting />);
    +    +    const input = screen.getByTestId('target-ref-input');
    +    +    fireEvent.change(input, { target: { value: 'blah' } });
    +    +    expect(screen.getByText('Starting...')).toBeInTheDocument();
    +    +  });
         +
    -     interface BuildStatus {
    -       id: string;
    -       project_id: string;
    -    @@ -32,140 +56,389 @@ interface BuildStatus {
    -       created_at: string;
    -     }
    -     
    -    -interface AuditResult {
    -    -  phase: string;
    -    -  iteration: number;
    -    -  overall: string;
    -    -  checks: AuditCheck[];
    -    +interface PhaseDefinition {
    -    +  number: number;
    -    +  name: string;
    -    +  objective: string;
    -    +  deliverables: string[];
    -     }
    -     
    -    +type PhaseStatus = 'pending' | 'active' | 'pass' | 'fail';
    -    +
    -    +interface PhaseState {
    -    +  def: PhaseDefinition;
    -    +  status: PhaseStatus;
    -    +  input_tokens: number;
    -    +  output_tokens: number;
    -    +  elapsed_ms: number;
    +    +  it('clears input when switching target types', () => {
    +    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    +    expect(input.value).toBe('my-repo');
    +    +
    +    +    fireEvent.click(screen.getByTestId('target-local_path'));
    +    +    const inputAfter = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    +    expect(inputAfter.value).toBe('');
    +    +  });
    +    +});
    +    diff --git a/web/src/components/BuildTargetModal.tsx b/web/src/components/BuildTargetModal.tsx
    +    new file mode 100644
    +    index 0000000..81304a1
    +    --- /dev/null
    +    +++ b/web/src/components/BuildTargetModal.tsx
    +    @@ -0,0 +1,252 @@
    +    +/**
    +    + * BuildTargetModal -- lets user choose where the build writes files.
    +    + *
    +    + * Three target types:
    +    + *   - github_new     ├ö├ç├Â create a new GitHub repo and push generated code
    +    + *   - github_existing ├ö├ç├Â clone an existing repo, add generated code, push
    +    + *   - local_path     ├ö├ç├Â write files to a local directory
    +    + *
    +    + * Passes { target_type, target_ref } back to the caller.
    +    + */
    +    +import { useState } from 'react';
    +    +
    +    +export interface BuildTarget {
    +    +  target_type: string;
    +    +  target_ref: string;
         +}
         +
    -    +interface ActivityEntry {
    -    +  time: string;
    -    +  message: string;
    -    +  level: 'info' | 'warn' | 'error' | 'system';
    +    +interface BuildTargetModalProps {
    +    +  onConfirm: (target: BuildTarget) => void;
    +    +  onCancel: () => void;
    +    +  starting?: boolean;
         +}
         +
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Styles                                                            */
    -    +/* ------------------------------------------------------------------ */
    +    +type TargetOption = 'github_new' | 'github_existing' | 'local_path';
         +
    -    +const pageStyle: React.CSSProperties = {
    -    +  padding: '24px',
    -    +  maxWidth: '1280px',
    -    +  margin: '0 auto',
    -    +};
    +    +const TARGET_OPTIONS: { value: TargetOption; label: string; description: string; placeholder: string }[] = [
    +    +  {
    +    +    value: 'github_new',
    +    +    label: 'New GitHub Repo',
    +    +    description: 'Create a new repository under your GitHub account and push generated code.',
    +    +    placeholder: 'my-new-project',
    +    +  },
    +    +  {
    +    +    value: 'github_existing',
    +    +    label: 'Existing GitHub Repo',
    +    +    description: 'Clone an existing repo, add generated files, and push.',
    +    +    placeholder: 'owner/repo-name',
    +    +  },
    +    +  {
    +    +    value: 'local_path',
    +    +    label: 'Local Directory',
    +    +    description: 'Write generated files to a directory on the server.',
    +    +    placeholder: 'C:\\Projects\\my-app  or  /home/user/projects/my-app',
    +    +  },
    +    +];
         +
    -    +const twoColStyle: React.CSSProperties = {
    -    +  display: 'grid',
    -    +  gridTemplateColumns: '2fr 3fr',
    -    +  gap: '20px',
    -    +  alignItems: 'start',
    +    +const cardBase: React.CSSProperties = {
    +    +  background: '#0F172A',
    +    +  border: '2px solid #334155',
    +    +  borderRadius: '8px',
    +    +  padding: '14px 16px',
    +    +  cursor: 'pointer',
    +    +  transition: 'border-color 0.15s, background 0.15s',
         +};
         +
    -    +const cardStyle: React.CSSProperties = {
    +    +const cardSelected: React.CSSProperties = {
    +    +  ...cardBase,
    +    +  borderColor: '#2563EB',
         +  background: '#1E293B',
    -    +  borderRadius: '8px',
    -    +  padding: '16px 20px',
         +};
         +
    -    +const phaseRowStyle = (isActive: boolean): React.CSSProperties => ({
    -    +  display: 'flex',
    -    +  gap: '10px',
    -    +  padding: '10px 12px',
    -    +  borderRadius: '6px',
    -    +  background: isActive ? '#1E3A5F' : 'transparent',
    -    +  borderLeft: isActive ? '3px solid #2563EB' : '3px solid transparent',
    -    +  transition: 'background 0.2s',
    -    +  cursor: 'pointer',
    -    +});
    +    +export default function BuildTargetModal({ onConfirm, onCancel, starting }: BuildTargetModalProps) {
    +    +  const [selected, setSelected] = useState<TargetOption>('github_new');
    +    +  const [targetRef, setTargetRef] = useState('');
         +
    -    +const metricBoxStyle: React.CSSProperties = {
    -    +  display: 'flex',
    -    +  flexDirection: 'column',
    -    +  gap: '2px',
    -    +  flex: 1,
    -    +  minWidth: '100px',
    -    +};
    +    +  const currentOption = TARGET_OPTIONS.find((o) => o.value === selected)!;
         +
    -    +const feedStyle: React.CSSProperties = {
    -    +  background: '#0B1120',
    -    +  borderRadius: '8px',
    -    +  border: '1px solid #1E293B',
    -    +  padding: '12px 16px',
    -    +  maxHeight: '420px',
    -    +  overflowY: 'auto',
    -    +  fontFamily: 'monospace',
    -    +  fontSize: '0.72rem',
    -    +  lineHeight: 1.7,
    -    +};
    +    +  const canConfirm = targetRef.trim().length > 0 && !starting;
         +
    -    +const LEVEL_COLOR: Record<string, string> = {
    -    +  info: '#F8FAFC',
    -    +  warn: '#EAB308',
    -    +  error: '#EF4444',
    -    +  system: '#2563EB',
    -    +};
    +    +  return (
    +    +    <div
    +    +      style={{
    +    +        position: 'fixed',
    +    +        inset: 0,
    +    +        backgroundColor: 'rgba(0,0,0,0.65)',
    +    +        display: 'flex',
    +    +        alignItems: 'center',
    +    +        justifyContent: 'center',
    +    +        zIndex: 100,
    +    +      }}
    +    +      onClick={onCancel}
    +    +    >
    +    +      <div
    +    +        style={{
    +    +          background: '#1E293B',
    +    +          borderRadius: '10px',
    +    +          maxWidth: '540px',
    +    +          width: '95%',
    +    +          overflow: 'hidden',
    +    +        }}
    +    +        onClick={(e) => e.stopPropagation()}
    +    +      >
    +    +        {/* Header */}
    +    +        <div
    +    +          style={{
    +    +            padding: '16px 20px',
    +    +            borderBottom: '1px solid #334155',
    +    +            display: 'flex',
    +    +            alignItems: 'center',
    +    +            justifyContent: 'space-between',
    +    +          }}
    +    +        >
    +    +          <h3 style={{ margin: 0, fontSize: '1rem', color: '#F8FAFC' }}>Build Target</h3>
    +    +          <button
    +    +            onClick={onCancel}
    +    +            style={{
    +    +              background: 'transparent',
    +    +              border: 'none',
    +    +              color: '#94A3B8',
    +    +              fontSize: '1.2rem',
    +    +              cursor: 'pointer',
    +    +            }}
    +    +          >
    +    +            ├ö┬ú├▓
    +    +          </button>
    +    +        </div>
         +
    -    +const STATUS_ICON: Record<PhaseStatus, string> = {
    -    +  pending: '├ö├╣├»',
    -    +  active: '├ö├╣├ë',
    -    +  pass: '├ö├╣├à',
    -    +  fail: '├ö┬ú├▓',
    -    +};
    +    +        {/* Body */}
    +    +        <div style={{ padding: '20px', display: 'flex', flexDirection: 'column', gap: '16px' }}>
    +    +          <p style={{ margin: 0, fontSize: '0.8rem', color: '#94A3B8' }}>
    +    +            Choose where ForgeGuard should write the generated files.
    +    +          </p>
         +
    -    +const STATUS_COLOR: Record<PhaseStatus, string> = {
    -    +  pending: '#475569',
    -    +  active: '#2563EB',
    -    +  pass: '#22C55E',
    -    +  fail: '#EF4444',
    -    +};
    +    +          {/* Target type cards */}
    +    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
    +    +            {TARGET_OPTIONS.map((opt) => (
    +    +              <div
    +    +                key={opt.value}
    +    +                style={selected === opt.value ? cardSelected : cardBase}
    +    +                onClick={() => {
    +    +                  setSelected(opt.value);
    +    +                  setTargetRef('');
    +    +                }}
    +    +                data-testid={`target-${opt.value}`}
    +    +              >
    +    +                <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '4px' }}>
    +    +                  <span
    +    +                    style={{
    +    +                      width: '16px',
    +    +                      height: '16px',
    +    +                      borderRadius: '50%',
    +    +                      border: `2px solid ${selected === opt.value ? '#2563EB' : '#475569'}`,
    +    +                      display: 'flex',
    +    +                      alignItems: 'center',
    +    +                      justifyContent: 'center',
    +    +                      flexShrink: 0,
    +    +                    }}
    +    +                  >
    +    +                    {selected === opt.value && (
    +    +                      <span
    +    +                        style={{
    +    +                          width: '8px',
    +    +                          height: '8px',
    +    +                          borderRadius: '50%',
    +    +                          background: '#2563EB',
    +    +                        }}
    +    +                      />
    +    +                    )}
    +    +                  </span>
    +    +                  <span style={{ fontWeight: 600, fontSize: '0.85rem', color: '#F8FAFC' }}>{opt.label}</span>
    +    +                </div>
    +    +                <p style={{ margin: '0 0 0 26px', fontSize: '0.72rem', color: '#94A3B8' }}>{opt.description}</p>
    +    +              </div>
    +    +            ))}
    +    +          </div>
         +
    -    +/* ------------------------------------------------------------------ */
    -    +/*  Component                                                         */
    -    +/* ------------------------------------------------------------------ */
    +    +          {/* Target ref input */}
    +    +          <div>
    +    +            <label
    +    +              style={{ display: 'block', fontSize: '0.75rem', color: '#94A3B8', marginBottom: '6px' }}
    +    +            >
    +    +              {selected === 'github_new'
    +    +                ? 'Repository name'
    +    +                : selected === 'github_existing'
    +    +                  ? 'Repository (owner/name)'
    +    +                  : 'Directory path'}
    +    +            </label>
    +    +            <input
    +    +              type="text"
    +    +              value={targetRef}
    +    +              onChange={(e) => setTargetRef(e.target.value)}
    +    +              placeholder={currentOption.placeholder}
    +    +              data-testid="target-ref-input"
    +    +              style={{
    +    +                width: '100%',
    +    +                padding: '10px 12px',
    +    +                background: '#0F172A',
    +    +                border: '1px solid #334155',
    +    +                borderRadius: '6px',
    +    +                color: '#F8FAFC',
    +    +                fontSize: '0.85rem',
    +    +                outline: 'none',
    +    +                boxSizing: 'border-box',
    +    +              }}
    +    +              onFocus={(e) => (e.currentTarget.style.borderColor = '#2563EB')}
    +    +              onBlur={(e) => (e.currentTarget.style.borderColor = '#334155')}
    +    +              onKeyDown={(e) => {
    +    +                if (e.key === 'Enter' && canConfirm) {
    +    +                  onConfirm({ target_type: selected, target_ref: targetRef.trim() });
    +    +                }
    +    +              }}
    +    +              autoFocus
    +    +            />
    +    +          </div>
    +    +        </div>
         +
    -     function BuildProgress() {
    -       const { projectId } = useParams<{ projectId: string }>();
    -       const { token } = useAuth();
    -       const { addToast } = useToast();
    -       const navigate = useNavigate();
    +    +        {/* Footer */}
    +    +        <div
    +    +          style={{
    +    +            padding: '12px 20px',
    +    +            borderTop: '1px solid #334155',
    +    +            display: 'flex',
    +    +            justifyContent: 'flex-end',
    +    +            gap: '10px',
    +    +          }}
    +    +        >
    +    +          <button
    +    +            onClick={onCancel}
    +    +            style={{
    +    +              background: 'transparent',
    +    +              color: '#94A3B8',
    +    +              border: '1px solid #334155',
    +    +              borderRadius: '6px',
    +    +              padding: '8px 16px',
    +    +              cursor: 'pointer',
    +    +              fontSize: '0.8rem',
    +    +            }}
    +    +          >
    +    +            Cancel
    +    +          </button>
    +    +          <button
    +    +            onClick={() => onConfirm({ target_type: selected, target_ref: targetRef.trim() })}
    +    +            disabled={!canConfirm}
    +    +            data-testid="target-confirm-btn"
    +    +            style={{
    +    +              background: canConfirm ? '#2563EB' : '#1E293B',
    +    +              color: canConfirm ? '#fff' : '#475569',
    +    +              border: 'none',
    +    +              borderRadius: '6px',
    +    +              padding: '8px 20px',
    +    +              cursor: canConfirm ? 'pointer' : 'not-allowed',
    +    +              fontSize: '0.8rem',
    +    +              fontWeight: 600,
    +    +            }}
    +    +          >
    +    +            {starting ? 'Starting...' : 'Start Build'}
    +    +          </button>
    +    +        </div>
    +    +      </div>
    +    +    </div>
    +    +  );
    +    +}
    +    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    +    index 021b634..6e1e2e4 100644
    +    --- a/web/src/pages/BuildProgress.tsx
    +    +++ b/web/src/pages/BuildProgress.tsx
    +    @@ -79,6 +79,13 @@ interface ActivityEntry {
    +       level: 'info' | 'warn' | 'error' | 'system';
    +     }
          
    -    +  /* State */
    -       const [build, setBuild] = useState<BuildStatus | null>(null);
    -    -  const [logs, setLogs] = useState<LogEntry[]>([]);
    -    -  const [auditResults, setAuditResults] = useState<AuditResult[]>([]);
    -    +  const [phaseDefs, setPhaseDefs] = useState<PhaseDefinition[]>([]);
    -    +  const [phaseStates, setPhaseStates] = useState<Map<number, PhaseState>>(new Map());
    -    +  const [activity, setActivity] = useState<ActivityEntry[]>([]);
    -    +  const [totalTokens, setTotalTokens] = useState({ input: 0, output: 0 });
    -       const [loading, setLoading] = useState(true);
    +    +interface BuildFile {
    +    +  path: string;
    +    +  size_bytes: number;
    +    +  language: string;
    +    +  created_at: string;
    +    +}
    +    +
    +     /* ------------------------------------------------------------------ */
    +     /*  Styles                                                            */
    +     /* ------------------------------------------------------------------ */
    +    @@ -174,6 +181,8 @@ function BuildProgress() {
            const [noBuild, setNoBuild] = useState(false);
            const [showCancelConfirm, setShowCancelConfirm] = useState(false);
    -    +  const [expandedPhase, setExpandedPhase] = useState<number | null>(null);
    -    +  const [startTime] = useState(() => Date.now());
    -    +  const [elapsed, setElapsed] = useState(0);
    -    +  const feedEndRef = useRef<HTMLDivElement>(null);
    -    +  const phaseStartRef = useRef<number>(Date.now());
    -    +
    -    +  /* ------ helpers ------ */
    -    +
    -    +  const addActivity = useCallback((msg: string, level: ActivityEntry['level'] = 'info') => {
    -    +    const time = new Date().toLocaleTimeString('en-GB', { hour12: false });
    -    +    setActivity((prev) => [...prev, { time, message: msg, level }]);
    -    +  }, []);
    -     
    -    -  // Parse phase number from phase string like "Phase 3"
    -       const parsePhaseNum = (phaseStr: string): number => {
    -    -    const match = phaseStr.match(/\d+/);
    -    -    return match ? parseInt(match[0], 10) : 0;
    -    +    const m = phaseStr.match(/\d+/);
    -    +    return m ? parseInt(m[0], 10) : 0;
    -       };
    -     
    -    -  // Generate phases array for the progress bar
    -    -  const generatePhases = useCallback((): Phase[] => {
    -    -    if (!build) return [];
    -    -    const totalPhases = 12; // Phase 0-11
    -    -    const currentPhase = parsePhaseNum(build.phase);
    -    -    const phases: Phase[] = [];
    -    -    for (let i = 0; i <= totalPhases - 1; i++) {
    -    -      let status: Phase['status'] = 'pending';
    -    -      if (i < currentPhase) status = 'pass';
    -    -      else if (i === currentPhase) {
    -    -        if (build.status === 'completed') status = 'pass';
    -    -        else if (build.status === 'failed') status = 'fail';
    -    -        else status = 'active';
    -    -      }
    -    -      phases.push({ label: `P${i}`, status });
    -    -    }
    -    -    return phases;
    -    -  }, [build]);
    -    +  /* ------ auto-scroll feed ------ */
    -    +  useEffect(() => {
    -    +    feedEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    -    +  }, [activity]);
    -    +
    -    +  /* ------ elapsed timer ------ */
    -    +  useEffect(() => {
    -    +    if (!build || !['pending', 'running'].includes(build.status)) return;
    -    +    const ref = build.started_at ? new Date(build.started_at).getTime() : startTime;
    -    +    const iv = setInterval(() => setElapsed(Math.floor((Date.now() - ref) / 1000)), 1000);
    -    +    return () => clearInterval(iv);
    -    +  }, [build, startTime]);
    -     
    -    -  // Fetch initial build status
    -    +  /* ------ fetch initial data ------ */
    -       useEffect(() => {
    -    -    const fetchBuild = async () => {
    -    +    const load = async () => {
    -           try {
    -    -        const res = await fetch(`${API_BASE}/projects/${projectId}/build/status`, {
    -    -          headers: { Authorization: `Bearer ${token}` },
    -    -        });
    -    -        if (res.ok) {
    -    -          setBuild(await res.json());
    -    -        } else if (res.status === 400) {
    -    +        const [statusRes, phasesRes, logsRes] = await Promise.all([
    -    +          fetch(`${API_BASE}/projects/${projectId}/build/status`, {
    -    +            headers: { Authorization: `Bearer ${token}` },
    -    +          }),
    -    +          fetch(`${API_BASE}/projects/${projectId}/build/phases`, {
    -    +            headers: { Authorization: `Bearer ${token}` },
    -    +          }),
    -    +          fetch(`${API_BASE}/projects/${projectId}/build/logs?limit=500`, {
    -    +            headers: { Authorization: `Bearer ${token}` },
    -    +          }),
    -    +        ]);
    -    +
    -    +        if (statusRes.status === 400) {
    -               setNoBuild(true);
    -    +          setLoading(false);
    -    +          return;
    -    +        }
    -    +
    -    +        if (statusRes.ok) {
    -    +          const buildData: BuildStatus = await statusRes.json();
    -    +          setBuild(buildData);
    -    +
    -    +          /* Seed activity from historical logs */
    -    +          if (logsRes.ok) {
    -    +            const logData = await logsRes.json();
    -    +            const items = (logData.items ?? []) as {
    -    +              timestamp: string;
    -    +              message: string;
    -    +              level: string;
    -    +            }[];
    -    +            setActivity(
    -    +              items.map((l) => ({
    -    +                time: new Date(l.timestamp).toLocaleTimeString('en-GB', { hour12: false }),
    -    +                message: l.message,
    -    +                level: (l.level ?? 'info') as ActivityEntry['level'],
    -    +              })),
    -    +            );
    -    +          }
    +       const [expandedPhase, setExpandedPhase] = useState<number | null>(null);
    +    +  const [buildFiles, setBuildFiles] = useState<BuildFile[]>([]);
    +    +  const [filesExpanded, setFilesExpanded] = useState(true);
    +       const [startTime] = useState(() => Date.now());
    +       const [elapsed, setElapsed] = useState(0);
    +       const feedEndRef = useRef<HTMLDivElement>(null);
    +    @@ -260,6 +269,17 @@ function BuildProgress() {
    +                   });
    +                 }
    +               } catch { /* best effort */ }
         +
    -    +          /* Seed token totals from cost summary */
    +    +          /* Seed build files */
         +          try {
    -    +            const costRes = await fetch(`${API_BASE}/projects/${projectId}/build/summary`, {
    +    +            const filesRes = await fetch(`${API_BASE}/projects/${projectId}/build/files`, {
         +              headers: { Authorization: `Bearer ${token}` },
         +            });
    -    +            if (costRes.ok) {
    -    +              const costData = await costRes.json();
    -    +              setTotalTokens({
    -    +                input: costData.cost?.total_input_tokens ?? 0,
    -    +                output: costData.cost?.total_output_tokens ?? 0,
    -    +              });
    +    +            if (filesRes.ok) {
    +    +              const filesData = await filesRes.json();
    +    +              setBuildFiles(filesData.items ?? []);
         +            }
         +          } catch { /* best effort */ }
                  } else {
    -    -          addToast('Failed to load build status');
    -    +          addToast('Failed to load build');
    -    +        }
    -    +
    -    +        /* Phase definitions */
    -    +        if (phasesRes.ok) {
    -    +          const defs: PhaseDefinition[] = await phasesRes.json();
    -    +          setPhaseDefs(defs);
    -    +
    -    +          /* Build initial phase states from current build status */
    -    +          const statusData: BuildStatus | null = statusRes.ok ? await statusRes.json().catch(() => null) : null;
    -    +          const currentPhaseNum = statusData ? parsePhaseNum(statusData.phase) : 0;
    -    +
    -    +          const map = new Map<number, PhaseState>();
    -    +          for (const def of defs) {
    -    +            let status: PhaseStatus = 'pending';
    -    +            if (statusData) {
    -    +              if (def.number < currentPhaseNum) status = 'pass';
    -    +              else if (def.number === currentPhaseNum) {
    -    +                if (statusData.status === 'completed') status = 'pass';
    -    +                else if (statusData.status === 'failed') status = 'fail';
    -    +                else status = 'active';
    -    +              }
    -    +            }
    -    +            map.set(def.number, {
    -    +              def,
    -    +              status,
    -    +              input_tokens: 0,
    -    +              output_tokens: 0,
    -    +              elapsed_ms: 0,
    -    +            });
    -    +          }
    -    +          setPhaseStates(map);
    +               addToast('Failed to load build');
                  }
    -           } catch {
    -    -        addToast('Network error loading build status');
    -    +        addToast('Network error loading build');
    -           } finally {
    -             setLoading(false);
    -           }
    -         };
    -    -    fetchBuild();
    -    +    load();
    -       }, [projectId, token, addToast]);
    -     
    -    -  // Fetch initial logs
    -    -  useEffect(() => {
    -    -    if (!build) return;
    -    -    const fetchLogs = async () => {
    -    -      try {
    -    -        const res = await fetch(`${API_BASE}/projects/${projectId}/build/logs?limit=500`, {
    -    -          headers: { Authorization: `Bearer ${token}` },
    -    -        });
    -    -        if (res.ok) {
    -    -          const data = await res.json();
    -    -          setLogs(data.items ?? []);
    -    -        }
    -    -      } catch {
    -    -        /* best effort */
    -    -      }
    -    -    };
    -    -    fetchLogs();
    -    -  }, [build?.id, projectId, token]);
    -    -
    -    -  // Handle WebSocket events
    -    +  /* ------ WebSocket handler ------ */
    -       useWebSocket(
    -         useCallback(
    -           (data) => {
    -             const payload = data.payload as Record<string, unknown>;
    -    -        const eventProjectId = payload.project_id as string;
    -    -        if (eventProjectId !== projectId) return;
    -    +        const eventPid = payload.project_id as string;
    -    +        if (eventPid && eventPid !== projectId) return;
    -     
    -             switch (data.type) {
    -    -          case 'build_started':
    -    -            setBuild(payload.build as BuildStatus);
    -    +          case 'build_started': {
    -    +            setBuild(payload.build as BuildStatus ?? payload as unknown as BuildStatus);
    -                 setNoBuild(false);
    -    +            addActivity('Build started', 'system');
    -    +
    -    +            /* Set all phases to pending, first phase active */
    -    +            setPhaseStates((prev) => {
    -    +              const next = new Map(prev);
    -    +              for (const [num, ps] of next) {
    -    +                next.set(num, { ...ps, status: num === 0 ? 'active' : 'pending' });
    -    +              }
    -    +              return next;
    -    +            });
    -    +            phaseStartRef.current = Date.now();
    -                 break;
    -    +          }
    -    +
    -               case 'build_log': {
    -    -            const log = payload as unknown as LogEntry;
    -    -            setLogs((prev) => [...prev, log]);
    -    +            const msg = (payload.message ?? payload.msg ?? '') as string;
    -    +            const lvl = (payload.level ?? 'info') as ActivityEntry['level'];
    -    +            if (msg) addActivity(msg, lvl);
    -    +            break;
    -    +          }
    -    +
    -    +          case 'phase_complete': {
    -    +            const phase = payload.phase as string;
    -    +            const phaseNum = parsePhaseNum(phase);
    -    +            const inTok = (payload.input_tokens ?? 0) as number;
    -    +            const outTok = (payload.output_tokens ?? 0) as number;
    -    +            const elapsed_ms = Date.now() - phaseStartRef.current;
    -    +
    -    +            addActivity(`├ö┬ú├┤ ${phase} complete (${inTok.toLocaleString()} in / ${outTok.toLocaleString()} out)`, 'system');
    -    +
    -    +            /* Accumulate total tokens */
    -    +            setTotalTokens((prev) => ({
    -    +              input: prev.input + inTok,
    -    +              output: prev.output + outTok,
    -    +            }));
    -    +
    -    +            /* Update phase states: mark this phase pass, next phase active */
    -    +            setPhaseStates((prev) => {
    -    +              const next = new Map(prev);
    -    +              const current = next.get(phaseNum);
    -    +              if (current) {
    -    +                next.set(phaseNum, {
    -    +                  ...current,
    -    +                  status: 'pass',
    -    +                  input_tokens: inTok,
    -    +                  output_tokens: outTok,
    -    +                  elapsed_ms,
    -    +                });
    -    +              }
    -    +              /* Mark next phase active */
    -    +              const nextPhase = next.get(phaseNum + 1);
    -    +              if (nextPhase && nextPhase.status === 'pending') {
    -    +                next.set(phaseNum + 1, { ...nextPhase, status: 'active' });
    -    +              }
    -    +              return next;
    -    +            });
    -    +
    -    +            setBuild((prev) => prev ? { ...prev, phase: phase } : prev);
    -    +            phaseStartRef.current = Date.now();
    +    @@ -431,6 +451,21 @@ function BuildProgress() {
    +                 addActivity(`Audit FAIL for ${phase} (loop ${loop})`, 'warn');
                      break;
                    }
    -    -          case 'phase_complete':
    -    -          case 'build_complete':
    -    -          case 'build_error':
    -    -          case 'build_cancelled':
    -    -            setBuild(payload.build as BuildStatus);
    -    -            if (data.type === 'build_complete') {
    -    -              addToast('Build completed successfully!', 'success');
    -    -              navigate(`/projects/${projectId}/build/complete`);
    -    -            } else if (data.type === 'build_error') {
    -    -              addToast('Build failed: ' + (payload.error ?? 'Unknown error'));
    -    +
    -    +          case 'build_complete': {
    -    +            setBuild((prev) => prev ? { ...prev, status: 'completed' } : prev);
    -    +            const totalIn = (payload.total_input_tokens ?? 0) as number;
    -    +            const totalOut = (payload.total_output_tokens ?? 0) as number;
    -    +            if (totalIn || totalOut) {
    -    +              setTotalTokens({ input: totalIn, output: totalOut });
    -                 }
    -    +            addActivity('Build completed successfully!', 'system');
    -    +
    -    +            /* Mark all phases as pass */
    -    +            setPhaseStates((prev) => {
    -    +              const next = new Map(prev);
    -    +              for (const [num, ps] of next) {
    -    +                if (ps.status !== 'fail') next.set(num, { ...ps, status: 'pass' });
    -    +              }
    -    +              return next;
    -    +            });
    -    +            addToast('Build completed!', 'success');
    -    +            break;
    -    +          }
         +
    -    +          case 'build_error': {
    -    +            setBuild((prev) => prev ? { ...prev, status: 'failed', error_detail: (payload.error_detail ?? payload.error ?? '') as string } : prev);
    -    +            addActivity(`Build failed: ${payload.error_detail ?? payload.error ?? 'Unknown error'}`, 'error');
    -    +
    -    +            /* Mark current active phase as fail */
    -    +            setPhaseStates((prev) => {
    -    +              const next = new Map(prev);
    -    +              for (const [num, ps] of next) {
    -    +                if (ps.status === 'active') next.set(num, { ...ps, status: 'fail' });
    -    +              }
    -    +              return next;
    -    +            });
    -                 break;
    -    -          case 'audit_pass':
    -    +          }
    -    +
    -    +          case 'build_cancelled': {
    -    +            setBuild((prev) => prev ? { ...prev, status: 'cancelled' } : prev);
    -    +            addActivity('Build cancelled by user', 'warn');
    -    +            break;
    -    +          }
    -    +
    -    +          case 'audit_pass': {
    -    +            const phase = payload.phase as string;
    -    +            addActivity(`Audit PASS for ${phase}`, 'system');
    +    +          case 'file_created': {
    +    +            const filePath = (payload.path ?? '') as string;
    +    +            const sizeBytes = (payload.size_bytes ?? 0) as number;
    +    +            const language = (payload.language ?? '') as string;
    +    +            if (filePath) {
    +    +              setBuildFiles((prev) => {
    +    +                // Avoid duplicates (same path)
    +    +                if (prev.some((f) => f.path === filePath)) return prev;
    +    +                return [...prev, { path: filePath, size_bytes: sizeBytes, language, created_at: new Date().toISOString() }];
    +    +              });
    +    +              addActivity(`File created: ${filePath} (${sizeBytes} bytes)`, 'info');
    +    +            }
         +            break;
         +          }
    -    +
    -               case 'audit_fail': {
    -    -            const result: AuditResult = {
    -    -              phase: (payload.phase as string) ?? '',
    -    -              iteration: (payload.iteration as number) ?? 1,
    -    -              overall: data.type === 'audit_pass' ? 'PASS' : 'FAIL',
    -    -              checks: (payload.checks as AuditCheck[]) ?? [],
    -    -            };
    -    -            setAuditResults((prev) => [...prev, result]);
    -    +            const phase = payload.phase as string;
    -    +            const loop = payload.loop_count as number;
    -    +            addActivity(`Audit FAIL for ${phase} (loop ${loop})`, 'warn');
    -                 break;
    -               }
                  }
                },
    -    -      [projectId, addToast],
    -    +      [projectId, addActivity, addToast],
    -         ),
    -       );
    -     
    -    +  /* ------ actions ------ */
    -    +
    -       const handleCancel = async () => {
    -         try {
    -           const res = await fetch(`${API_BASE}/projects/${projectId}/build/cancel`, {
    -    @@ -195,8 +468,8 @@ function BuildProgress() {
    -             const newBuild = await res.json();
    -             setBuild(newBuild);
    -             setNoBuild(false);
    -    -        setLogs([]);
    -    -        setAuditResults([]);
    -    +        setActivity([]);
    -    +        setTotalTokens({ input: 0, output: 0 });
    -             addToast('Build started', 'success');
    -           } else {
    -             const data = await res.json().catch(() => ({ detail: 'Failed to start build' }));
    -    @@ -207,22 +480,45 @@ function BuildProgress() {
    -         }
    -       };
    -     
    -    +  /* ------ derived values ------ */
    -    +
    -    +  const isActive = build && ['pending', 'running'].includes(build.status);
    -    +  const buildModel = 'claude-opus-4-6';
    -    +  const contextWindow = 200_000;
    -    +  const totalTok = totalTokens.input + totalTokens.output;
    -    +  const ctxPercent = Math.min(100, (totalTok / contextWindow) * 100);
    -    +  const ctxColor = ctxPercent > 80 ? '#EF4444' : ctxPercent > 50 ? '#F59E0B' : '#22C55E';
    -    +  const estimatedCost = getTokenCost(buildModel, totalTokens.input, totalTokens.output);
    -    +  const elapsedStr = elapsed > 0 ? `${Math.floor(elapsed / 60)}m ${elapsed % 60}s` : '0s';
    -    +
    -    +  const doneCount = Array.from(phaseStates.values()).filter((p) => p.status === 'pass').length;
    -    +  const totalPhases = phaseStates.size || phaseDefs.length;
    -    +
    -    +  /* ------ render: loading ------ */
    -    +
    -       if (loading) {
    -         return (
    -           <AppShell>
    -    -        <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    -    +        <div style={pageStyle}>
    -               <Skeleton style={{ width: '100%', height: '40px', marginBottom: '24px' }} />
    -    -          <Skeleton style={{ width: '100%', height: '300px', marginBottom: '16px' }} />
    -    -          <Skeleton style={{ width: '100%', height: '120px' }} />
    -    +          <div style={twoColStyle}>
    -    +            <Skeleton style={{ width: '100%', height: '400px' }} />
    -    +            <div>
    -    +              <Skeleton style={{ width: '100%', height: '120px', marginBottom: '16px' }} />
    -    +              <Skeleton style={{ width: '100%', height: '300px' }} />
    -    +            </div>
    -    +          </div>
    -             </div>
    -           </AppShell>
    -         );
    -       }
    -     
    -    +  /* ------ render: no build ------ */
    -    +
    -       if (noBuild) {
    -         return (
    -           <AppShell>
    -    -        <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    -    +        <div style={pageStyle}>
    -               <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    -                 <button
    -                   onClick={() => navigate(`/projects/${projectId}`)}
    -    @@ -242,16 +538,12 @@ function BuildProgress() {
    -         );
    -       }
    +           [projectId, addActivity, addToast],
    +    @@ -610,7 +645,8 @@ function BuildProgress() {
    +             {/* ---- Two-column layout ---- */}
    +             <div style={twoColStyle}>
          
    -    -  const isActive = build && ['pending', 'running'].includes(build.status);
    -    -  const elapsed = build?.started_at
    -    -    ? Math.round((Date.now() - new Date(build.started_at).getTime()) / 1000)
    -    -    : 0;
    -    -  const elapsedStr = elapsed > 0 ? `${Math.floor(elapsed / 60)}m ${elapsed % 60}s` : '';
    -    +  /* ------ render: main ------ */
    -     
    -       return (
    -         <AppShell>
    -    -      <div style={{ padding: '24px', maxWidth: '960px', margin: '0 auto' }}>
    -    -        {/* Header */}
    -    +      <div style={pageStyle}>
    -    +        {/* ---- Header ---- */}
    -             <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '20px' }}>
    -               <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    -                 <button
    -    @@ -277,77 +569,187 @@ function BuildProgress() {
    -                   </span>
    -                 )}
    +    -          {/* ======== LEFT: Phase Checklist ======== */}
    +    +          {/* ======== LEFT: Phase Checklist + Files ======== */}
    +    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
    +               <div style={{ ...cardStyle, padding: '12px 16px' }}>
    +                 <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    +                   Phases ({doneCount}/{totalPhases})
    +    @@ -679,6 +715,47 @@ function BuildProgress() {
    +                 </div>
                    </div>
    -    -          {isActive && (
    -    -            <button
    -    -              onClick={() => setShowCancelConfirm(true)}
    -    -              style={{
    -    -                background: 'transparent',
    -    -                color: '#EF4444',
    -    -                border: '1px solid #EF4444',
    -    -                borderRadius: '6px',
    -    -                padding: '6px 16px',
    -    -                cursor: 'pointer',
    -    -                fontSize: '0.8rem',
    -    -                fontWeight: 600,
    -    -              }}
    -    -            >
    -    -              Cancel Build
    -    -            </button>
    -    -          )}
    -    +          <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>
    -    +            {build?.status === 'completed' && (
    -    +              <button
    -    +                onClick={() => navigate(`/projects/${projectId}/build/complete`)}
    -    +                style={{
    -    +                  background: '#16A34A',
    -    +                  color: '#fff',
    -    +                  border: 'none',
    -    +                  borderRadius: '6px',
    -    +                  padding: '6px 16px',
    -    +                  cursor: 'pointer',
    -    +                  fontSize: '0.8rem',
    -    +                  fontWeight: 600,
    -    +                }}
    -    +              >
    -    +                View Summary
    -    +              </button>
    -    +            )}
    -    +            {isActive && (
    -    +              <button
    -    +                onClick={() => setShowCancelConfirm(true)}
    -    +                style={{
    -    +                  background: 'transparent',
    -    +                  color: '#EF4444',
    -    +                  border: '1px solid #EF4444',
    -    +                  borderRadius: '6px',
    -    +                  padding: '6px 16px',
    -    +                  cursor: 'pointer',
    -    +                  fontSize: '0.8rem',
    -    +                  fontWeight: 600,
    -    +                }}
    -    +              >
    -    +                Cancel Build
    -    +              </button>
    -    +            )}
    -    +          </div>
    -             </div>
          
    -    -        {/* Build Summary Header */}
    -    -        {build && (
    -    -          <div style={{ background: '#1E293B', borderRadius: '8px', padding: '14px 20px', marginBottom: '16px', display: 'flex', gap: '24px', fontSize: '0.8rem', flexWrap: 'wrap' }}>
    -    -            <div>
    -    -              <span style={{ color: '#94A3B8' }}>Phase: </span>
    -    -              <span style={{ fontWeight: 600 }}>{build.phase}</span>
    -    +        {/* ---- Two-column layout ---- */}
    -    +        <div style={twoColStyle}>
    -    +
    -    +          {/* ======== LEFT: Phase Checklist ======== */}
    -    +          <div style={{ ...cardStyle, padding: '12px 16px' }}>
    -    +            <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    -    +              Phases ({doneCount}/{totalPhases})
    -    +            </h3>
    -    +            <div style={{ display: 'flex', flexDirection: 'column', gap: '2px' }}>
    -    +              {(phaseStates.size > 0
    -    +                ? Array.from(phaseStates.entries()).sort((a, b) => a[0] - b[0]).map(([num, ps]) => ({ num, ps }))
    -    +                : phaseDefs.map((d) => ({ num: d.number, ps: { def: d, status: 'pending' as PhaseStatus, input_tokens: 0, output_tokens: 0, elapsed_ms: 0 } }))
    -    +              ).map(({ num, ps }) => {
    -    +                const isExp = expandedPhase === num;
    -    +                const isActivePhase = ps.status === 'active';
    -    +                const phaseElapsed = ps.elapsed_ms > 0 ? `${Math.floor(ps.elapsed_ms / 60000)}m ${Math.floor((ps.elapsed_ms % 60000) / 1000)}s` : '';
    -    +
    -    +                return (
    -    +                  <div key={num}>
    +    +          {/* ======== Files Panel ======== */}
    +    +          {buildFiles.length > 0 && (
    +    +            <div style={{ ...cardStyle, padding: '12px 16px' }}>
    +    +              <div
    +    +                style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', cursor: 'pointer', marginBottom: filesExpanded ? '10px' : 0 }}
    +    +                onClick={() => setFilesExpanded(!filesExpanded)}
    +    +              >
    +    +                <h3 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    +    +                  Files ({buildFiles.length})
    +    +                </h3>
    +    +                <span style={{ color: '#64748B', fontSize: '0.7rem', transition: 'transform 0.2s', transform: filesExpanded ? 'rotate(180deg)' : 'rotate(0)' }}>├ö├╗ÔòØ</span>
    +    +              </div>
    +    +              {filesExpanded && (
    +    +                <div style={{ display: 'flex', flexDirection: 'column', gap: '2px', maxHeight: '260px', overflowY: 'auto' }} data-testid="build-files-panel">
    +    +                  {buildFiles.map((f) => (
         +                    <div
    -    +                      style={phaseRowStyle(isActivePhase)}
    -    +                      onClick={() => setExpandedPhase(isExp ? null : num)}
    +    +                      key={f.path}
    +    +                      style={{
    +    +                        display: 'flex',
    +    +                        alignItems: 'center',
    +    +                        gap: '8px',
    +    +                        padding: '5px 8px',
    +    +                        borderRadius: '4px',
    +    +                        background: '#0F172A',
    +    +                        fontSize: '0.72rem',
    +    +                      }}
         +                    >
    -    +                      {/* Status icon */}
    -    +                      <span style={{ color: STATUS_COLOR[ps.status], fontSize: '1rem', width: '20px', textAlign: 'center', flexShrink: 0 }}>
    -    +                        {isActivePhase ? (
    -    +                          <span style={{ display: 'inline-block', animation: 'spin 1.2s linear infinite' }}>├ö├╣├ë</span>
    -    +                        ) : (
    -    +                          STATUS_ICON[ps.status]
    -    +                        )}
    +    +                      <span style={{ color: '#64748B', flexShrink: 0 }}>┬¡ãÆ├┤├ñ</span>
    +    +                      <span style={{ color: '#F8FAFC', flex: 1, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{f.path}</span>
    +    +                      <span style={{ color: '#475569', flexShrink: 0, fontSize: '0.65rem' }}>
    +    +                        {f.language && <span style={{ marginRight: '6px', color: '#64748B' }}>{f.language}</span>}
    +    +                        {f.size_bytes > 0 && `${(f.size_bytes / 1024).toFixed(1)}k`}
         +                      </span>
    -    +
    -    +                      {/* Phase name + objective */}
    -    +                      <div style={{ flex: 1, minWidth: 0 }}>
    -    +                        <div style={{ fontSize: '0.8rem', fontWeight: 600, color: STATUS_COLOR[ps.status] }}>
    -    +                          Phase {num} ├ö├ç├Â {ps.def.name}
    -    +                        </div>
    -    +                        <div style={{ fontSize: '0.68rem', color: '#94A3B8', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
    -    +                          {ps.def.objective}
    -    +                        </div>
    -    +                      </div>
    -    +
    -    +                      {/* Per-phase tokens (when done) */}
    -    +                      {ps.status === 'pass' && (ps.input_tokens > 0 || ps.output_tokens > 0) && (
    -    +                        <div style={{ fontSize: '0.6rem', color: '#64748B', textAlign: 'right', flexShrink: 0 }}>
    -    +                          <div>{ps.input_tokens.toLocaleString()} in</div>
    -    +                          <div>{ps.output_tokens.toLocaleString()} out</div>
    -    +                          {phaseElapsed && <div>{phaseElapsed}</div>}
    -    +                        </div>
    -    +                      )}
    -    +
    -    +                      {/* Expand chevron */}
    -    +                      <span style={{ color: '#475569', fontSize: '0.65rem', flexShrink: 0, transition: 'transform 0.15s', transform: isExp ? 'rotate(180deg)' : 'rotate(0)' }}>├ö├╗ÔòØ</span>
         +                    </div>
    -    +
    -    +                    {/* Expanded deliverables */}
    -    +                    {isExp && ps.def.deliverables.length > 0 && (
    -    +                      <div style={{ paddingLeft: '40px', paddingRight: '12px', paddingBottom: '8px' }}>
    -    +                        {ps.def.deliverables.map((d, i) => (
    -    +                          <div key={i} style={{ fontSize: '0.68rem', color: '#94A3B8', paddingTop: '3px', display: 'flex', gap: '6px' }}>
    -    +                            <span style={{ color: '#475569' }}>├ö├ç├│</span>
    -    +                            <span>{d}</span>
    -    +                          </div>
    -    +                        ))}
    -    +                      </div>
    -    +                    )}
    -    +                  </div>
    -    +                );
    -    +              })}
    -                 </div>
    -    -            {elapsedStr && (
    -    -              <div>
    -    -                <span style={{ color: '#94A3B8' }}>Elapsed: </span>
    -    -                {elapsedStr}
    -    +          </div>
    -    +
    -    +          {/* ======== RIGHT: Metrics + Activity Feed ======== */}
    -    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
    -    +
    -    +            {/* -- Metrics Card -- */}
    -    +            <div style={cardStyle}>
    -    +              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '16px', marginBottom: '12px' }}>
    -    +                <div style={metricBoxStyle}>
    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Input Tokens</span>
    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{totalTokens.input.toLocaleString()}</span>
    -    +                </div>
    -    +                <div style={metricBoxStyle}>
    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Output Tokens</span>
    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{totalTokens.output.toLocaleString()}</span>
    -    +                </div>
    -    +                <div style={metricBoxStyle}>
    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Est. Cost</span>
    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#22C55E' }}>${estimatedCost.toFixed(4)}</span>
    -    +                </div>
    -    +                <div style={metricBoxStyle}>
    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Elapsed</span>
    -    +                  <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#F8FAFC' }}>{elapsedStr}</span>
    +    +                  ))}
         +                </div>
    -    +                <div style={metricBoxStyle}>
    -    +                  <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Model</span>
    -    +                  <span style={{ fontSize: '0.85rem', fontWeight: 600, color: '#A78BFA' }}>{buildModel}</span>
    -    +                </div>
    -    +                {(build?.loop_count ?? 0) > 0 && (
    -    +                  <div style={metricBoxStyle}>
    -    +                    <span style={{ fontSize: '0.65rem', color: '#64748B', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Loopbacks</span>
    -    +                    <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#EAB308' }}>{build?.loop_count}</span>
    -    +                  </div>
    -    +                )}
    -                   </div>
    -    -            )}
    -    -            {build.loop_count > 0 && (
    -    -              <div>
    -    -                <span style={{ color: '#EAB308' }}>Loopback:</span>{' '}
    -    -                <span style={{ color: '#EAB308', fontWeight: 600 }}>Iteration {build.loop_count}</span>
    -    +
    -    +              {/* Context window meter */}
    -    +              <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
    -    +                <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.65rem', color: '#94A3B8' }}>
    -    +                  <span>Context Window</span>
    -    +                  <span>{totalTok.toLocaleString()} / {contextWindow.toLocaleString()} ({ctxPercent.toFixed(1)}%)</span>
    -    +                </div>
    -    +                <div style={{ width: '100%', height: '8px', background: '#0F172A', borderRadius: '4px', overflow: 'hidden' }}>
    -    +                  <div style={{ width: `${ctxPercent}%`, height: '100%', background: ctxColor, borderRadius: '4px', transition: 'width 0.4s ease' }} />
    -    +                </div>
    -                   </div>
    -    -            )}
    -    -            {build.error_detail && (
    -    -              <div style={{ color: '#EF4444', flex: '1 1 100%', marginTop: '4px', fontSize: '0.75rem' }}>
    -    -                Error: {build.error_detail}
    +    +              )}
         +            </div>
    +    +          )}
    +    +          </div>
         +
    -    +            {/* -- Error banner -- */}
    -    +            {build?.error_detail && (
    -    +              <div style={{ background: '#7F1D1D', borderRadius: '6px', padding: '10px 16px', fontSize: '0.78rem', color: '#FCA5A5' }}>
    -    +                <strong>Error:</strong> {build.error_detail}
    -                   </div>
    -                 )}
    -    -          </div>
    -    -        )}
    -    -
    -    -        {/* Phase Progress Bar */}
    -    -        <div style={{ marginBottom: '20px' }}>
    -    -          <PhaseProgressBar phases={generatePhases()} />
    -    -        </div>
    -     
    -    -        {/* Audit Results */}
    -    -        {auditResults.length > 0 && (
    -    -          <div style={{ marginBottom: '20px' }}>
    -    -            <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#94A3B8' }}>Audit Results</h3>
    -    -            {auditResults.map((result, i) => (
    -    -              <BuildAuditCard
    -    -                key={i}
    -    -                phase={result.phase}
    -    -                iteration={result.iteration}
    -    -                checks={result.checks}
    -    -                overall={result.overall}
    -    -              />
    -    -            ))}
    -    +            {/* -- Activity Feed -- */}
    -    +            <div>
    -    +              <h3 style={{ margin: '0 0 8px', fontSize: '0.85rem', color: '#94A3B8' }}>Activity</h3>
    -    +              <div style={feedStyle} data-testid="build-activity-feed">
    -    +                {activity.length === 0 ? (
    -    +                  <div style={{ color: '#475569' }}>Waiting for build output...</div>
    -    +                ) : (
    -    +                  activity.map((entry, i) => (
    -    +                    <div key={i} style={{ color: LEVEL_COLOR[entry.level] ?? LEVEL_COLOR.info }}>
    -    +                      <span style={{ color: '#475569' }}>{entry.time}</span>{' '}
    -    +                      {entry.message}
    -    +                    </div>
    -    +                  ))
    -    +                )}
    -    +                <div ref={feedEndRef} />
    -    +              </div>
    -    +            </div>
    -               </div>
    -    -        )}
    -    -
    -    -        {/* Streaming Logs */}
    -    -        <div>
    -    -          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#94A3B8' }}>Build Logs</h3>
    -    -          <BuildLogViewer logs={logs} maxHeight={500} />
    -             </div>
    -           </div>
    +               {/* ======== RIGHT: Metrics + Activity Feed ======== */}
    +               <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
          
         diff --git a/web/src/pages/ProjectDetail.tsx b/web/src/pages/ProjectDetail.tsx
    -    index bbb2777..78a0f36 100644
    +    index 873d603..14ae4bc 100644
         --- a/web/src/pages/ProjectDetail.tsx
         +++ b/web/src/pages/ProjectDetail.tsx
    -    @@ -13,6 +13,28 @@ import QuestionnaireModal from '../components/QuestionnaireModal';
    +    @@ -11,6 +11,7 @@ import Skeleton from '../components/Skeleton';
    +     import ConfirmDialog from '../components/ConfirmDialog';
    +     import QuestionnaireModal from '../components/QuestionnaireModal';
    +     import ContractProgress from '../components/ContractProgress';
    +    +import BuildTargetModal, { type BuildTarget } from '../components/BuildTargetModal';
          
          const API_BASE = import.meta.env.VITE_API_URL ?? '';
          
    -    +const needsKeyBanner = (
    -    +  <div style={{
    -    +    background: '#1E293B',
    -    +    border: '1px solid #92400E',
    -    +    borderRadius: '6px',
    -    +    padding: '10px 16px',
    -    +    marginBottom: '16px',
    -    +    fontSize: '0.8rem',
    -    +    color: '#FBBF24',
    -    +    display: 'flex',
    -    +    alignItems: 'center',
    -    +    gap: '10px',
    -    +  }}>
    -    +    <span style={{ fontSize: '1rem' }}>┬¡ãÆ├Â├ª</span>
    -    +    <span>
    -    +      Add your Anthropic API key in{' '}
    -    +      <Link to="/settings" style={{ color: '#60A5FA', textDecoration: 'underline' }}>Settings</Link>{' '}
    -    +      to start a build. Questionnaires and audits are free.
    -    +    </span>
    -    +  </div>
    -    +);
    -    +
    -     interface ProjectDetailData {
    -       id: string;
    -       name: string;
    -    @@ -34,7 +56,7 @@ interface ProjectDetailData {
    +    @@ -69,6 +70,7 @@ function ProjectDetail() {
    +       const [showQuestionnaire, setShowQuestionnaire] = useState(false);
    +       const [contractsExpanded, setContractsExpanded] = useState(false);
    +       const [showRegenerate, setShowRegenerate] = useState(false);
    +    +  const [showTargetPicker, setShowTargetPicker] = useState(false);
          
    -     function ProjectDetail() {
    -       const { projectId } = useParams<{ projectId: string }>();
    -    -  const { token } = useAuth();
    -    +  const { user, token } = useAuth();
    -       const { addToast } = useToast();
    -       const navigate = useNavigate();
    -       const [project, setProject] = useState<ProjectDetailData | null>(null);
    -    @@ -282,6 +304,9 @@ function ProjectDetail() {
    -               </div>
    -             </div>
    +       useEffect(() => {
    +         const fetchProject = async () => {
    +    @@ -95,14 +97,23 @@ function ProjectDetail() {
    +           setShowQuestionnaire(true);
    +           return;
    +         }
    +    +    /* Show target picker modal */
    +    +    setShowTargetPicker(true);
    +    +  };
          
    -    +        {/* BYOK warning */}
    -    +        {hasContracts && !buildActive && !(user?.has_anthropic_key) && needsKeyBanner}
    -    +
    -             {/* Build Actions */}
    -             <div style={{ display: 'flex', gap: '12px', marginBottom: '24px' }}>
    -               {!buildActive && (
    -    diff --git a/web/src/pages/Settings.tsx b/web/src/pages/Settings.tsx
    -    new file mode 100644
    -    index 0000000..29c213d
    -    --- /dev/null
    -    +++ b/web/src/pages/Settings.tsx
    -    @@ -0,0 +1,280 @@
    -    +/**
    -    + * Settings -- user settings page with BYOK API key management.
    -    + */
    -    +import { useState } from 'react';
    -    +import { useNavigate } from 'react-router-dom';
    -    +import { useAuth } from '../context/AuthContext';
    -    +import { useToast } from '../context/ToastContext';
    -    +import AppShell from '../components/AppShell';
    -    +
    -    +const API_BASE = import.meta.env.VITE_API_URL ?? '';
    -    +
    -    +function Settings() {
    -    +  const { user, token, updateUser } = useAuth();
    -    +  const { addToast } = useToast();
    -    +  const navigate = useNavigate();
    -    +
    -    +  const [apiKey, setApiKey] = useState('');
    -    +  const [saving, setSaving] = useState(false);
    -    +  const [removing, setRemoving] = useState(false);
    -    +
    -    +  const hasKey = user?.has_anthropic_key ?? false;
    -    +
    -    +  const handleSaveKey = async () => {
    -    +    const trimmed = apiKey.trim();
    -    +    if (!trimmed) return;
    -    +    setSaving(true);
    -    +    try {
    -    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    -    +        method: 'PUT',
    +    +  const handleTargetConfirm = async (target: BuildTarget) => {
    +         setStarting(true);
    +         try {
    +           const res = await fetch(`${API_BASE}/projects/${projectId}/build`, {
    +             method: 'POST',
    +    -        headers: { Authorization: `Bearer ${token}` },
         +        headers: {
         +          Authorization: `Bearer ${token}`,
         +          'Content-Type': 'application/json',
         +        },
    -    +        body: JSON.stringify({ api_key: trimmed }),
    -    +      });
    -    +      if (res.ok) {
    -    +        addToast('API key saved', 'success');
    -    +        setApiKey('');
    -    +        updateUser({ has_anthropic_key: true });
    -    +      } else {
    -    +        const data = await res.json().catch(() => ({ detail: 'Failed to save key' }));
    -    +        addToast(data.detail || 'Failed to save key');
    -    +      }
    -    +    } catch {
    -    +      addToast('Network error saving key');
    -    +    } finally {
    -    +      setSaving(false);
    -    +    }
    -    +  };
    -    +
    -    +  const handleRemoveKey = async () => {
    -    +    setRemoving(true);
    -    +    try {
    -    +      const res = await fetch(`${API_BASE}/auth/api-key`, {
    -    +        method: 'DELETE',
    -    +        headers: { Authorization: `Bearer ${token}` },
    -    +      });
    -    +      if (res.ok) {
    -    +        addToast('API key removed', 'info');
    -    +        updateUser({ has_anthropic_key: false });
    -    +      } else {
    -    +        addToast('Failed to remove key');
    -    +      }
    -    +    } catch {
    -    +      addToast('Network error removing key');
    -    +    } finally {
    -    +      setRemoving(false);
    -    +    }
    -    +  };
    -    +
    -    +  return (
    -    +    <AppShell>
    -    +      <div style={{ padding: '24px', maxWidth: '720px', margin: '0 auto' }}>
    -    +        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '24px' }}>
    -    +          <button
    -    +            onClick={() => navigate('/')}
    -    +            style={{
    -    +              background: 'transparent',
    -    +              color: '#94A3B8',
    -    +              border: '1px solid #334155',
    -    +              borderRadius: '6px',
    -    +              padding: '6px 12px',
    -    +              cursor: 'pointer',
    -    +              fontSize: '0.8rem',
    -    +            }}
    -    +          >
    -    +            Back
    -    +          </button>
    -    +          <h2 style={{ margin: 0, fontSize: '1.1rem' }}>Settings</h2>
    -    +        </div>
    -    +
    -    +        {/* Profile Section */}
    -    +        <div
    -    +          style={{
    -    +            background: '#1E293B',
    -    +            borderRadius: '8px',
    -    +            padding: '20px',
    -    +            marginBottom: '16px',
    -    +          }}
    -    +        >
    -    +          <h3 style={{ margin: '0 0 16px', fontSize: '0.9rem', color: '#F8FAFC' }}>Profile</h3>
    -    +          <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
    -    +            {user?.avatar_url && (
    -    +              <img
    -    +                src={user.avatar_url}
    -    +                alt={user.github_login}
    -    +                style={{ width: 48, height: 48, borderRadius: '50%' }}
    -    +              />
    -    +            )}
    -    +            <div>
    -    +              <div style={{ fontWeight: 600, fontSize: '0.95rem' }}>{user?.github_login}</div>
    -    +              <div style={{ color: '#64748B', fontSize: '0.8rem', marginTop: '2px' }}>
    -    +                Authenticated via GitHub
    -    +              </div>
    -    +            </div>
    -    +          </div>
    -    +        </div>
    -    +
    -    +        {/* BYOK API Key Section */}
    -    +        <div
    -    +          style={{
    -    +            background: '#1E293B',
    -    +            borderRadius: '8px',
    -    +            padding: '20px',
    -    +            marginBottom: '16px',
    -    +          }}
    -    +          data-testid="byok-section"
    -    +        >
    -    +          <h3 style={{ margin: '0 0 4px', fontSize: '0.9rem', color: '#F8FAFC' }}>
    -    +            Anthropic API Key
    -    +          </h3>
    -    +          <p style={{ margin: '0 0 14px', fontSize: '0.75rem', color: '#64748B', lineHeight: 1.5 }}>
    -    +            Builds use Claude Opus and run on your own Anthropic API key.
    -    +            Planning, questionnaires, and audits are free ├ö├ç├Â powered by Haiku on us.
    -    +          </p>
    -    +
    -    +          {hasKey ? (
    -    +            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
    -    +              <div style={{
    -    +                flex: 1,
    -    +                display: 'flex',
    -    +                alignItems: 'center',
    -    +                gap: '8px',
    -    +                padding: '8px 12px',
    -    +                background: '#0F172A',
    -    +                borderRadius: '6px',
    -    +                fontSize: '0.8rem',
    -    +              }}>
    -    +                <span style={{ color: '#22C55E', fontSize: '0.7rem' }}>├ö├╣├à</span>
    -    +                <span style={{ color: '#94A3B8' }}>Key configured</span>
    -    +                <span style={{ color: '#64748B', fontFamily: 'monospace' }}>sk-ant-├ö├ç├│├ö├ç├│├ö├ç├│├ö├ç├│├ö├ç├│├ö├ç├│├ö├ç├│</span>
    -    +              </div>
    -    +              <button
    -    +                onClick={handleRemoveKey}
    -    +                disabled={removing}
    -    +                data-testid="remove-api-key-btn"
    -    +                style={{
    -    +                  background: 'transparent',
    -    +                  color: '#EF4444',
    -    +                  border: '1px solid #7F1D1D',
    -    +                  borderRadius: '6px',
    -    +                  padding: '6px 14px',
    -    +                  cursor: removing ? 'not-allowed' : 'pointer',
    -    +                  fontSize: '0.75rem',
    -    +                  opacity: removing ? 0.6 : 1,
    -    +                }}
    -    +              >
    -    +                {removing ? 'Removing...' : 'Remove'}
    -    +              </button>
    -    +            </div>
    -    +          ) : (
    -    +            <div>
    -    +              <div style={{ display: 'flex', gap: '8px' }}>
    -    +                <input
    -    +                  type="password"
    -    +                  value={apiKey}
    -    +                  onChange={(e) => setApiKey(e.target.value)}
    -    +                  placeholder="sk-ant-api03-..."
    -    +                  data-testid="api-key-input"
    -    +                  style={{
    -    +                    flex: 1,
    -    +                    background: '#0F172A',
    -    +                    border: '1px solid #334155',
    -    +                    borderRadius: '6px',
    -    +                    padding: '8px 12px',
    -    +                    color: '#F8FAFC',
    -    +                    fontSize: '0.8rem',
    -    +                    fontFamily: 'monospace',
    -    +                    outline: 'none',
    -    +                  }}
    -    +                  onKeyDown={(e) => { if (e.key === 'Enter') handleSaveKey(); }}
    -    +                />
    -    +                <button
    -    +                  onClick={handleSaveKey}
    -    +                  disabled={saving || !apiKey.trim()}
    -    +                  data-testid="save-api-key-btn"
    -    +                  style={{
    -    +                    background: saving ? '#1E293B' : '#2563EB',
    -    +                    color: '#fff',
    -    +                    border: 'none',
    -    +                    borderRadius: '6px',
    -    +                    padding: '8px 18px',
    -    +                    cursor: saving || !apiKey.trim() ? 'not-allowed' : 'pointer',
    -    +                    fontSize: '0.8rem',
    -    +                    opacity: saving || !apiKey.trim() ? 0.6 : 1,
    -    +                  }}
    -    +                >
    -    +                  {saving ? 'Saving...' : 'Save Key'}
    -    +                </button>
    -    +              </div>
    -    +              <p style={{ margin: '8px 0 0', fontSize: '0.7rem', color: '#64748B' }}>
    -    +                Your key is stored securely and only used for build operations.
    -    +                Get one at{' '}
    -    +                <a
    -    +                  href="https://console.anthropic.com/settings/keys"
    -    +                  target="_blank"
    -    +                  rel="noopener noreferrer"
    -    +                  style={{ color: '#60A5FA' }}
    -    +                >
    -    +                  console.anthropic.com
    -    +                </a>
    -    +              </p>
    -    +            </div>
    -    +          )}
    -    +        </div>
    -    +
    -    +        {/* AI Models info */}
    -    +        <div
    -    +          style={{
    -    +            background: '#1E293B',
    -    +            borderRadius: '8px',
    -    +            padding: '20px',
    -    +            marginBottom: '16px',
    -    +          }}
    -    +        >
    -    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>AI Models</h3>
    -    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', fontSize: '0.8rem' }}>
    -    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    -    +              <span style={{ color: '#94A3B8' }}>Questionnaire</span>
    -    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    -    +                <span style={{ color: '#22C55E', fontWeight: 600 }}>claude-haiku-4-5</span>
    -    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>FREE</span>
    -    +              </div>
    -    +            </div>
    -    +            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 12px', background: '#0F172A', borderRadius: '6px' }}>
    -    +              <span style={{ color: '#94A3B8' }}>Builder</span>
    -    +              <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
    -    +                <span style={{ color: '#A78BFA', fontWeight: 600 }}>claude-opus-4-6</span>
    -    +                <span style={{ color: '#64748B', fontSize: '0.65rem' }}>BYOK</span>
    -    +              </div>
    -    +            </div>
    -    +          </div>
    -    +        </div>
    -    +
    -    +        {/* About Section */}
    -    +        <div
    -    +          style={{
    -    +            background: '#1E293B',
    -    +            borderRadius: '8px',
    -    +            padding: '20px',
    -    +          }}
    -    +        >
    -    +          <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>About</h3>
    -    +          <div style={{ fontSize: '0.8rem', color: '#94A3B8', display: 'flex', flexDirection: 'column', gap: '6px' }}>
    -    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    -    +              <span>Version</span>
    -    +              <span style={{ color: '#F8FAFC' }}>v0.1.0</span>
    -    +            </div>
    -    +            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
    -    +              <span>Framework</span>
    -    +              <span style={{ color: '#F8FAFC' }}>Forge Governance</span>
    -    +            </div>
    -    +          </div>
    -    +        </div>
    -    +      </div>
    -    +    </AppShell>
    -    +  );
    -    +}
    -    +
    -    +export default Settings;
    -    diff --git a/web/vite.config.ts b/web/vite.config.ts
    -    index 136369a..43cba1f 100644
    -    --- a/web/vite.config.ts
    -    +++ b/web/vite.config.ts
    -    @@ -1,6 +1,18 @@
    -     import { defineConfig } from 'vite';
    -     import react from '@vitejs/plugin-react';
    +    +        body: JSON.stringify(target),
    +           });
    +           if (res.ok) {
    +    +        setShowTargetPicker(false);
    +             addToast('Build started', 'success');
    +             navigate(`/projects/${projectId}/build`);
    +           } else {
    +    @@ -482,6 +493,14 @@ function ProjectDetail() {
    +             />
    +           )}
          
    -    +/* Bypass proxy for browser page navigations (Accept: text/html) so Vite
    -    +   serves index.html and React Router handles the route. API fetch() calls
    -    +   (Accept: application/json) still proxy to the backend. */
    -    +const apiProxy = {
    -    +  target: 'http://localhost:8000',
    -    +  bypass(req: { headers: { accept?: string } }) {
    -    +    if (req.headers.accept?.includes('text/html')) {
    -    +      return '/index.html';
    -    +    }
    -    +  },
    -    +};
    +    +      {showTargetPicker && (
    +    +        <BuildTargetModal
    +    +          onConfirm={handleTargetConfirm}
    +    +          onCancel={() => setShowTargetPicker(false)}
    +    +          starting={starting}
    +    +        />
    +    +      )}
         +
    -     export default defineConfig({
    -       plugins: [react()],
    -       server: {
    -    @@ -10,11 +22,12 @@ export default defineConfig({
    -           '/auth/login': 'http://localhost:8000',
    -           '/auth/github': 'http://localhost:8000',
    -           '/auth/me': 'http://localhost:8000',
    -    -      '/repos': 'http://localhost:8000',
    -    -      '/projects': 'http://localhost:8000',
    -    +      '/auth/api-key': 'http://localhost:8000',
    -    +      '/repos': apiProxy,
    -    +      '/projects': apiProxy,
    -           '/webhooks': 'http://localhost:8000',
    -           '/ws': {
    -    -        target: 'ws://localhost:8000',
    -    +        target: 'http://localhost:8000',
    -             ws: true,
    -           },
    -         },
    +           {showRegenerate && project && (
    +             <div
    +               style={{
     
    diff --git a/app/api/routers/builds.py b/app/api/routers/builds.py
    index 6ef15b8..6ed7f39 100644
    --- a/app/api/routers/builds.py
    +++ b/app/api/routers/builds.py
    @@ -3,6 +3,7 @@
     from uuid import UUID
     
     from fastapi import APIRouter, Depends, HTTPException, Query
    +from pydantic import BaseModel
     
     from app.api.deps import get_current_user
     from app.api.rate_limit import build_limiter
    @@ -11,19 +12,31 @@ from app.services import build_service
     router = APIRouter(prefix="/projects", tags=["builds"])
     
     
    +class StartBuildRequest(BaseModel):
    +    """Request body for starting a build."""
    +    target_type: str | None = None
    +    target_ref: str | None = None
    +
    +
     # ÔöÇÔöÇ POST /projects/{project_id}/build ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇ
     
     
     @router.post("/{project_id}/build")
     async def start_build(
         project_id: UUID,
    +    body: StartBuildRequest | None = None,
         user: dict = Depends(get_current_user),
     ):
         """Start a build for a project."""
         if not build_limiter.is_allowed(str(user["id"])):
             raise HTTPException(status_code=429, detail="Build rate limit exceeded")
         try:
    -        build = await build_service.start_build(project_id, user["id"])
    +        build = await build_service.start_build(
    +            project_id,
    +            user["id"],
    +            target_type=body.target_type if body else None,
    +            target_ref=body.target_ref if body else None,
    +        )
             return build
         except ValueError as exc:
             detail = str(exc)
    @@ -51,6 +64,46 @@ async def cancel_build(
             raise HTTPException(status_code=400, detail=detail)
     
     
    +# ÔöÇÔöÇ GET /projects/{project_id}/build/files ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇ
    +
    +
    +@router.get("/{project_id}/build/files")
    +async def get_build_files(
    +    project_id: UUID,
    +    user: dict = Depends(get_current_user),
    +):
    +    """List all files written during the build."""
    +    try:
    +        files = await build_service.get_build_files(project_id, user["id"])
    +        return {"items": files}
    +    except ValueError as exc:
    +        detail = str(exc)
    +        if "not found" in detail.lower():
    +            raise HTTPException(status_code=404, detail=detail)
    +        raise HTTPException(status_code=400, detail=detail)
    +
    +
    +# ÔöÇÔöÇ GET /projects/{project_id}/build/files/{path} ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇ
    +
    +
    +@router.get("/{project_id}/build/files/{path:path}")
    +async def get_build_file_content(
    +    project_id: UUID,
    +    path: str,
    +    user: dict = Depends(get_current_user),
    +):
    +    """Retrieve content of a specific file written during the build."""
    +    try:
    +        return await build_service.get_build_file_content(
    +            project_id, user["id"], path
    +        )
    +    except ValueError as exc:
    +        detail = str(exc)
    +        if "not found" in detail.lower():
    +            raise HTTPException(status_code=404, detail=detail)
    +        raise HTTPException(status_code=400, detail=detail)
    +
    +
     # ÔöÇÔöÇ GET /projects/{project_id}/build/status ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇ
     
     
    diff --git a/app/clients/git_client.py b/app/clients/git_client.py
    new file mode 100644
    index 0000000..d0b2890
    --- /dev/null
    +++ b/app/clients/git_client.py
    @@ -0,0 +1,165 @@
    +"""Git client -- thin wrapper around asyncio.subprocess for git operations.
    +
    +Handles clone, add, commit, push for build targets. No database access,
    +no business logic, no HTTP framework imports.
    +"""
    +
    +import asyncio
    +import logging
    +import os
    +from pathlib import Path
    +
    +logger = logging.getLogger(__name__)
    +
    +
    +async def _run_git(args: list[str], cwd: str | Path, env: dict | None = None) -> str:
    +    """Run a git command and return stdout. Raises on non-zero exit."""
    +    merged_env = {**os.environ, **(env or {})}
    +    proc = await asyncio.create_subprocess_exec(
    +        "git", *args,
    +        cwd=str(cwd),
    +        stdout=asyncio.subprocess.PIPE,
    +        stderr=asyncio.subprocess.PIPE,
    +        env=merged_env,
    +    )
    +    stdout, stderr = await proc.communicate()
    +    out = stdout.decode("utf-8", errors="replace").strip()
    +    err = stderr.decode("utf-8", errors="replace").strip()
    +
    +    if proc.returncode != 0:
    +        logger.error("git %s failed (rc=%d): %s", " ".join(args), proc.returncode, err)
    +        raise RuntimeError(f"git {args[0]} failed: {err}")
    +
    +    return out
    +
    +
    +async def clone_repo(
    +    clone_url: str,
    +    dest: str | Path,
    +    *,
    +    branch: str | None = None,
    +    shallow: bool = True,
    +    access_token: str | None = None,
    +) -> str:
    +    """Clone a git repository to dest. Returns the dest path.
    +
    +    For GitHub repos, inject the access token into the URL for auth.
    +    """
    +    url = clone_url
    +    if access_token and "github.com" in clone_url:
    +        # Inject token for HTTPS auth: https://TOKEN@github.com/owner/repo.git
    +        url = clone_url.replace("https://", f"https://{access_token}@")
    +
    +    args = ["clone"]
    +    if shallow:
    +        args.extend(["--depth", "1"])
    +    if branch:
    +        args.extend(["--branch", branch])
    +    args.extend([url, str(dest)])
    +
    +    parent = Path(dest).parent
    +    parent.mkdir(parents=True, exist_ok=True)
    +    await _run_git(args, cwd=str(parent))
    +    return str(dest)
    +
    +
    +async def init_repo(dest: str | Path) -> str:
    +    """Initialize a new git repo at dest. Returns the dest path."""
    +    path = Path(dest)
    +    path.mkdir(parents=True, exist_ok=True)
    +    await _run_git(["init"], cwd=path)
    +    # Set default branch to main
    +    await _run_git(["checkout", "-b", "main"], cwd=path)
    +    return str(path)
    +
    +
    +async def add_all(repo_path: str | Path) -> None:
    +    """Stage all changes in the repo."""
    +    await _run_git(["add", "-A"], cwd=repo_path)
    +
    +
    +async def commit(repo_path: str | Path, message: str) -> str | None:
    +    """Commit staged changes. Returns commit hash or None if nothing to commit."""
    +    # Check if there are staged changes
    +    try:
    +        status = await _run_git(["status", "--porcelain"], cwd=repo_path)
    +        if not status.strip():
    +            logger.info("Nothing to commit in %s", repo_path)
    +            return None
    +    except RuntimeError:
    +        return None
    +
    +    # Configure committer identity for the repo
    +    try:
    +        await _run_git(["config", "user.email", "forge@forgeguard.dev"], cwd=repo_path)
    +        await _run_git(["config", "user.name", "ForgeGuard Builder"], cwd=repo_path)
    +    except RuntimeError:
    +        pass  # May already be configured
    +
    +    await _run_git(["add", "-A"], cwd=repo_path)
    +    await _run_git(["commit", "-m", message], cwd=repo_path)
    +    sha = await _run_git(["rev-parse", "HEAD"], cwd=repo_path)
    +    return sha
    +
    +
    +async def push(
    +    repo_path: str | Path,
    +    *,
    +    remote: str = "origin",
    +    branch: str = "main",
    +    access_token: str | None = None,
    +) -> None:
    +    """Push all commits to the remote."""
    +    env = {}
    +    if access_token:
    +        # Use credential helper to inject token
    +        env["GIT_ASKPASS"] = "echo"
    +        # Set the remote URL with token for auth
    +        try:
    +            remote_url = await _run_git(["remote", "get-url", remote], cwd=repo_path)
    +            if "github.com" in remote_url and "@" not in remote_url:
    +                authed_url = remote_url.replace(
    +                    "https://", f"https://{access_token}@"
    +                )
    +                await _run_git(
    +                    ["remote", "set-url", remote, authed_url], cwd=repo_path
    +                )
    +        except RuntimeError:
    +            pass
    +
    +    await _run_git(["push", "-u", remote, branch], cwd=repo_path, env=env if env else None)
    +
    +
    +async def set_remote(
    +    repo_path: str | Path,
    +    remote_url: str,
    +    *,
    +    remote_name: str = "origin",
    +) -> None:
    +    """Set or update the remote URL for a repo."""
    +    try:
    +        await _run_git(["remote", "add", remote_name, remote_url], cwd=repo_path)
    +    except RuntimeError:
    +        # Remote already exists, update it
    +        await _run_git(["remote", "set-url", remote_name, remote_url], cwd=repo_path)
    +
    +
    +async def get_file_list(repo_path: str | Path) -> list[str]:
    +    """List all tracked + untracked files in the repo (relative paths)."""
    +    try:
    +        # Get tracked files
    +        tracked = await _run_git(["ls-files"], cwd=repo_path)
    +        # Get untracked files
    +        untracked = await _run_git(
    +            ["ls-files", "--others", "--exclude-standard"], cwd=repo_path
    +        )
    +        files = set()
    +        for line in tracked.splitlines():
    +            if line.strip():
    +                files.add(line.strip())
    +        for line in untracked.splitlines():
    +            if line.strip():
    +                files.add(line.strip())
    +        return sorted(files)
    +    except RuntimeError:
    +        return []
    diff --git a/app/repos/build_repo.py b/app/repos/build_repo.py
    index b1d4781..44442e5 100644
    --- a/app/repos/build_repo.py
    +++ b/app/repos/build_repo.py
    @@ -13,17 +13,27 @@ from app.repos.db import get_pool
     # ---------------------------------------------------------------------------
     
     
    -async def create_build(project_id: UUID) -> dict:
    +async def create_build(
    +    project_id: UUID,
    +    *,
    +    target_type: str | None = None,
    +    target_ref: str | None = None,
    +    working_dir: str | None = None,
    +) -> dict:
         """Create a new build record in pending status."""
         pool = await get_pool()
         row = await pool.fetchrow(
             """
    -        INSERT INTO builds (project_id, phase, status)
    -        VALUES ($1, 'Phase 0', 'pending')
    -        RETURNING id, project_id, phase, status, started_at, completed_at,
    +        INSERT INTO builds (project_id, phase, status, target_type, target_ref, working_dir)
    +        VALUES ($1, 'Phase 0', 'pending', $2, $3, $4)
    +        RETURNING id, project_id, phase, status, target_type, target_ref,
    +                  working_dir, started_at, completed_at,
                       loop_count, error_detail, created_at
             """,
             project_id,
    +        target_type,
    +        target_ref,
    +        working_dir,
         )
         return dict(row)
     
    @@ -33,7 +43,8 @@ async def get_build_by_id(build_id: UUID) -> dict | None:
         pool = await get_pool()
         row = await pool.fetchrow(
             """
    -        SELECT id, project_id, phase, status, started_at, completed_at,
    +        SELECT id, project_id, phase, status, target_type, target_ref,
    +               working_dir, started_at, completed_at,
                    loop_count, error_detail, created_at
             FROM builds WHERE id = $1
             """,
    @@ -47,7 +58,8 @@ async def get_latest_build_for_project(project_id: UUID) -> dict | None:
         pool = await get_pool()
         row = await pool.fetchrow(
             """
    -        SELECT id, project_id, phase, status, started_at, completed_at,
    +        SELECT id, project_id, phase, status, target_type, target_ref,
    +               working_dir, started_at, completed_at,
                    loop_count, error_detail, created_at
             FROM builds WHERE project_id = $1
             ORDER BY created_at DESC LIMIT 1
    @@ -240,3 +252,34 @@ async def get_build_cost_summary(build_id: UUID) -> dict:
             "total_cost_usd": Decimal("0"),
             "phase_count": 0,
         }
    +
    +
    +async def get_build_file_logs(build_id: UUID) -> list[dict]:
    +    """Fetch all file_created log entries for a build.
    +
    +    Returns list of dicts with path, size_bytes, language, created_at
    +    parsed from build_log messages where source='file'.
    +    """
    +    pool = await get_pool()
    +    rows = await pool.fetch(
    +        """
    +        SELECT message, created_at
    +        FROM build_logs
    +        WHERE build_id = $1 AND source = 'file'
    +        ORDER BY created_at ASC
    +        """,
    +        build_id,
    +    )
    +    files = []
    +    for r in rows:
    +        try:
    +            data = json.loads(r["message"])
    +            files.append({
    +                "path": data.get("path", ""),
    +                "size_bytes": data.get("size_bytes", 0),
    +                "language": data.get("language", ""),
    +                "created_at": r["created_at"],
    +            })
    +        except (ValueError, KeyError):
    +            continue
    +    return files
    diff --git a/app/services/build_service.py b/app/services/build_service.py
    index f49a2e8..e4a33e5 100644
    --- a/app/services/build_service.py
    +++ b/app/services/build_service.py
    @@ -8,14 +8,20 @@ No SQL, no HTTP framework, no direct GitHub API calls.
     """
     
     import asyncio
    +import json
     import logging
    +import os
     import re
    +import shutil
    +import tempfile
     from decimal import Decimal
     from datetime import datetime, timezone
     from pathlib import Path
     from uuid import UUID
     
     from app.clients.agent_client import StreamUsage, stream_agent
    +from app.clients import git_client
    +from app.clients import github_client
     from app.config import settings
     from app.repos import build_repo
     from app.repos import project_repo
    @@ -36,6 +42,82 @@ BUILD_ERROR_SIGNAL = "RISK_EXCEEDS_SCOPE"
     # Universal governance contract (not per-project ÔÇö loaded from disk)
     FORGE_CONTRACTS_DIR = Path(__file__).resolve().parent.parent.parent / "Forge" / "Contracts"
     
    +# File block delimiters for parsing builder output
    +FILE_START_PATTERN = re.compile(r"^=== FILE:\s*(.+?)\s*===$", re.MULTILINE)
    +FILE_END_PATTERN = re.compile(r"^=== END FILE ===$", re.MULTILINE)
    +
    +# Valid build target types
    +VALID_TARGET_TYPES = {"github_new", "github_existing", "local_path"}
    +
    +# Language detection by file extension
    +_EXT_TO_LANG: dict[str, str] = {
    +    ".py": "python", ".js": "javascript", ".ts": "typescript",
    +    ".tsx": "typescriptreact", ".jsx": "javascriptreact",
    +    ".json": "json", ".yaml": "yaml", ".yml": "yaml",
    +    ".md": "markdown", ".html": "html", ".css": "css",
    +    ".sql": "sql", ".sh": "shell", ".ps1": "powershell",
    +    ".toml": "toml", ".txt": "plaintext", ".env": "dotenv",
    +    ".gitignore": "ignore",
    +}
    +
    +
    +def _detect_language(file_path: str) -> str:
    +    """Detect language from file extension."""
    +    ext = Path(file_path).suffix.lower()
    +    name = Path(file_path).name.lower()
    +    if name in _EXT_TO_LANG:
    +        return _EXT_TO_LANG[name]
    +    return _EXT_TO_LANG.get(ext, "plaintext")
    +
    +
    +def _parse_file_blocks(text: str) -> list[dict]:
    +    """Parse file blocks from builder output.
    +
    +    Expected format:
    +        === FILE: path/to/file.py ===
    +        <file contents>
    +        === END FILE ===
    +
    +    Returns list of {path, content} dicts.
    +    """
    +    blocks: list[dict] = []
    +    pos = 0
    +    while pos < len(text):
    +        start_match = FILE_START_PATTERN.search(text, pos)
    +        if not start_match:
    +            break
    +        file_path = start_match.group(1).strip()
    +        content_start = start_match.end()
    +
    +        end_match = FILE_END_PATTERN.search(text, content_start)
    +        if not end_match:
    +            # No closing delimiter -- skip this block
    +            pos = content_start
    +            break
    +
    +        raw_content = text[content_start:end_match.start()]
    +        # Strip optional code fence wrapping (```lang ... ```)
    +        content = _strip_code_fence(raw_content)
    +
    +        blocks.append({"path": file_path, "content": content})
    +        pos = end_match.end()
    +
    +    return blocks
    +
    +
    +def _strip_code_fence(text: str) -> str:
    +    """Strip optional markdown code fence wrapper from file content."""
    +    stripped = text.strip()
    +    if stripped.startswith("```"):
    +        # Remove opening fence (```lang or just ```)
    +        first_nl = stripped.find("\n")
    +        if first_nl >= 0:
    +            stripped = stripped[first_nl + 1:]
    +    if stripped.rstrip().endswith("```"):
    +        stripped = stripped.rstrip()[:-3]
    +    return stripped.rstrip("\n") + "\n" if stripped.strip() else ""
    +
    +
     # Active build tasks keyed by build_id
     _active_tasks: dict[str, asyncio.Task] = {}
     
    @@ -65,7 +147,13 @@ def _get_token_rates(model: str) -> tuple[Decimal, Decimal]:
     # ---------------------------------------------------------------------------
     
     
    -async def start_build(project_id: UUID, user_id: UUID) -> dict:
    +async def start_build(
    +    project_id: UUID,
    +    user_id: UUID,
    +    *,
    +    target_type: str | None = None,
    +    target_ref: str | None = None,
    +) -> dict:
         """Start a build for a project.
     
         Validates that contracts exist, creates a build record, and spawns
    @@ -74,6 +162,8 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
         Args:
             project_id: The project to build.
             user_id: The authenticated user (for ownership check).
    +        target_type: Build target -- 'github_new', 'github_existing', or 'local_path'.
    +        target_ref: Target reference -- repo name, full_name, or absolute path.
     
         Returns:
             The created build record.
    @@ -106,15 +196,43 @@ async def start_build(project_id: UUID, user_id: UUID) -> dict:
     
         audit_llm_enabled = (user or {}).get("audit_llm_enabled", True)
     
    +    # Validate target
    +    if target_type and target_type not in VALID_TARGET_TYPES:
    +        raise ValueError(f"Invalid target_type: {target_type}. Must be one of: {', '.join(VALID_TARGET_TYPES)}")
    +    if target_type and not target_ref:
    +        raise ValueError("target_ref is required when target_type is specified")
    +
    +    # Resolve working directory based on target type
    +    working_dir: str | None = None
    +    if target_type == "local_path":
    +        working_dir = str(Path(target_ref).resolve()) if target_ref else None
    +        if working_dir:
    +            Path(working_dir).mkdir(parents=True, exist_ok=True)
    +    elif target_type in ("github_new", "github_existing"):
    +        # Use a temp directory; clone/init happens in _run_build
    +        working_dir = tempfile.mkdtemp(prefix="forgeguard_build_")
    +
         # Create build record
    -    build = await build_repo.create_build(project_id)
    +    build = await build_repo.create_build(
    +        project_id,
    +        target_type=target_type,
    +        target_ref=target_ref,
    +        working_dir=working_dir,
    +    )
     
         # Update project status
         await project_repo.update_project_status(project_id, "building")
     
         # Spawn background task
         task = asyncio.create_task(
    -        _run_build(build["id"], project_id, user_id, contracts, user_api_key, audit_llm_enabled)
    +        _run_build(
    +            build["id"], project_id, user_id, contracts,
    +            user_api_key, audit_llm_enabled,
    +            target_type=target_type,
    +            target_ref=target_ref,
    +            working_dir=working_dir,
    +            access_token=(user or {}).get("access_token", ""),
    +        )
         )
         _active_tasks[str(build["id"])] = task
     
    @@ -232,11 +350,18 @@ async def _run_build(
         contracts: list[dict],
         api_key: str,
         audit_llm_enabled: bool = True,
    +    *,
    +    target_type: str | None = None,
    +    target_ref: str | None = None,
    +    working_dir: str | None = None,
    +    access_token: str = "",
     ) -> None:
         """Background task that orchestrates the full build lifecycle.
     
         Streams agent output, detects phase completion signals, runs inline
         audits, handles loopback, and advances through phases.
    +    When a build target is configured, parses file blocks from the
    +    builder output and writes them to the working directory.
         """
         try:
             now = datetime.now(timezone.utc)
    @@ -255,6 +380,66 @@ async def _run_build(
             # Build the directive from contracts
             directive = _build_directive(contracts)
     
    +        # Set up working directory for file writing
    +        if target_type == "github_new" and target_ref and working_dir:
    +            try:
    +                # Create a new GitHub repo
    +                repo_data = await github_client.create_github_repo(
    +                    access_token, target_ref,
    +                    description=f"Built by ForgeGuard",
    +                    private=False,
    +                )
    +                clone_url = f"https://github.com/{repo_data['full_name']}.git"
    +                await git_client.clone_repo(
    +                    clone_url, working_dir,
    +                    access_token=access_token, shallow=False,
    +                )
    +                await build_repo.append_build_log(
    +                    build_id,
    +                    f"Created GitHub repo: {repo_data['full_name']}",
    +                    source="system", level="info",
    +                )
    +                await _broadcast_build_event(user_id, build_id, "build_log", {
    +                    "message": f"Created GitHub repo: {repo_data['full_name']}",
    +                    "source": "system", "level": "info",
    +                })
    +            except Exception as exc:
    +                await _fail_build(build_id, user_id, f"Failed to create GitHub repo: {exc}")
    +                return
    +        elif target_type == "github_existing" and target_ref and working_dir:
    +            try:
    +                clone_url = f"https://github.com/{target_ref}.git"
    +                await git_client.clone_repo(
    +                    clone_url, working_dir,
    +                    access_token=access_token, shallow=False,
    +                )
    +                await build_repo.append_build_log(
    +                    build_id,
    +                    f"Cloned existing repo: {target_ref}",
    +                    source="system", level="info",
    +                )
    +            except Exception as exc:
    +                await _fail_build(build_id, user_id, f"Failed to clone repo: {exc}")
    +                return
    +        elif target_type == "local_path" and working_dir:
    +            try:
    +                Path(working_dir).mkdir(parents=True, exist_ok=True)
    +                # Initialize git repo if not already one
    +                git_dir = Path(working_dir) / ".git"
    +                if not git_dir.exists():
    +                    await git_client.init_repo(working_dir)
    +                await build_repo.append_build_log(
    +                    build_id,
    +                    f"Using local path: {working_dir}",
    +                    source="system", level="info",
    +                )
    +            except Exception as exc:
    +                await _fail_build(build_id, user_id, f"Failed to initialize local path: {exc}")
    +                return
    +
    +        # Track files written during this build
    +        files_written: list[dict] = []
    +
             # Conversation history for the agent
             messages: list[dict] = [
                 {"role": "user", "content": directive},
    @@ -289,6 +474,17 @@ async def _run_build(
                         }
                     )
     
    +            # Detect and write file blocks
    +            new_blocks = _parse_file_blocks(accumulated_text)
    +            already_written_count = len(files_written)
    +            if len(new_blocks) > already_written_count and working_dir:
    +                for block in new_blocks[already_written_count:]:
    +                    await _write_file_block(
    +                        build_id, user_id, working_dir,
    +                        block["path"], block["content"],
    +                        files_written,
    +                    )
    +
                 # Detect phase completion
                 if PHASE_COMPLETE_SIGNAL in accumulated_text:
                     phase_match = re.search(
    @@ -337,6 +533,22 @@ async def _run_build(
                                 "phase": current_phase,
                             }
                         )
    +
    +                    # Git commit after phase audit passes
    +                    if working_dir and files_written:
    +                        try:
    +                            sha = await git_client.commit(
    +                                working_dir,
    +                                f"forge: {current_phase} complete",
    +                            )
    +                            if sha:
    +                                await build_repo.append_build_log(
    +                                    build_id,
    +                                    f"Committed {current_phase}: {sha[:8]}",
    +                                    source="system", level="info",
    +                                )
    +                        except Exception as exc:
    +                            logger.warning("Git commit failed for %s: %s", current_phase, exc)
                     else:
                         loop_count = await build_repo.increment_loop_count(build_id)
                         await build_repo.append_build_log(
    @@ -383,6 +595,35 @@ async def _run_build(
                 build_id, "Build completed successfully", source="system", level="info"
             )
     
    +        # Final commit + push for GitHub targets
    +        if working_dir and files_written:
    +            try:
    +                sha = await git_client.commit(working_dir, "forge: build complete")
    +                if sha:
    +                    await build_repo.append_build_log(
    +                        build_id, f"Final commit: {sha[:8]}", source="system", level="info",
    +                    )
    +            except Exception as exc:
    +                logger.warning("Final git commit failed: %s", exc)
    +
    +            if target_type in ("github_new", "github_existing") and access_token:
    +                try:
    +                    await git_client.push(
    +                        working_dir, access_token=access_token,
    +                    )
    +                    await build_repo.append_build_log(
    +                        build_id, "Pushed to GitHub", source="system", level="info",
    +                    )
    +                    await _broadcast_build_event(user_id, build_id, "build_log", {
    +                        "message": "Pushed all commits to GitHub",
    +                        "source": "system", "level": "info",
    +                    })
    +                except Exception as exc:
    +                    logger.error("Git push failed: %s", exc)
    +                    await build_repo.append_build_log(
    +                        build_id, f"Git push failed: {exc}", source="system", level="error",
    +                    )
    +
             # Gather total cost summary for the final event
             cost_summary = await build_repo.get_build_cost_summary(build_id)
             await _broadcast_build_event(user_id, build_id, "build_complete", {
    @@ -401,6 +642,120 @@ async def _run_build(
             await _fail_build(build_id, user_id, str(exc))
         finally:
             _active_tasks.pop(str(build_id), None)
    +        # Cleanup temp working dir for GitHub targets on failure/cancel
    +        # (keep on success so user can inspect; they'll be cleaned up later)
    +
    +
    +# ---------------------------------------------------------------------------
    +# File Writing Helpers
    +# ---------------------------------------------------------------------------
    +
    +
    +async def _write_file_block(
    +    build_id: UUID,
    +    user_id: UUID,
    +    working_dir: str,
    +    file_path: str,
    +    content: str,
    +    files_written: list[dict],
    +) -> None:
    +    """Write a file block to the working directory and emit events."""
    +    try:
    +        # Sanitize path -- prevent directory traversal
    +        clean_path = Path(file_path).as_posix()
    +        if clean_path.startswith("/") or ".." in clean_path:
    +            logger.warning("Skipping suspicious file path: %s", file_path)
    +            return
    +
    +        full_path = Path(working_dir) / clean_path
    +        full_path.parent.mkdir(parents=True, exist_ok=True)
    +        full_path.write_text(content, encoding="utf-8")
    +
    +        size_bytes = len(content.encode("utf-8"))
    +        language = _detect_language(clean_path)
    +
    +        file_info = {
    +            "path": clean_path,
    +            "size_bytes": size_bytes,
    +            "language": language,
    +        }
    +        files_written.append(file_info)
    +
    +        # Log as structured file entry (source='file' for querying)
    +        await build_repo.append_build_log(
    +            build_id,
    +            json.dumps(file_info),
    +            source="file",
    +            level="info",
    +        )
    +
    +        # Broadcast file_created event
    +        await _broadcast_build_event(user_id, build_id, "file_created", file_info)
    +
    +        logger.info("Wrote file: %s (%d bytes)", clean_path, size_bytes)
    +
    +    except Exception as exc:
    +        logger.error("Failed to write file %s: %s", file_path, exc)
    +        await build_repo.append_build_log(
    +            build_id,
    +            f"Failed to write file {file_path}: {exc}",
    +            source="system",
    +            level="error",
    +        )
    +
    +
    +async def get_build_files(
    +    project_id: UUID, user_id: UUID
    +) -> list[dict]:
    +    """Get list of files written during the latest build.
    +
    +    Returns list of {path, size_bytes, language, created_at}.
    +    """
    +    project = await project_repo.get_project_by_id(project_id)
    +    if not project or str(project["user_id"]) != str(user_id):
    +        raise ValueError("Project not found")
    +
    +    latest = await build_repo.get_latest_build_for_project(project_id)
    +    if not latest:
    +        raise ValueError("No builds found for this project")
    +
    +    return await build_repo.get_build_file_logs(latest["id"])
    +
    +
    +async def get_build_file_content(
    +    project_id: UUID, user_id: UUID, file_path: str
    +) -> dict:
    +    """Get content of a specific file from the build working directory.
    +
    +    Returns {path, content, size_bytes, language}.
    +    """
    +    project = await project_repo.get_project_by_id(project_id)
    +    if not project or str(project["user_id"]) != str(user_id):
    +        raise ValueError("Project not found")
    +
    +    latest = await build_repo.get_latest_build_for_project(project_id)
    +    if not latest:
    +        raise ValueError("No builds found for this project")
    +
    +    working_dir = latest.get("working_dir")
    +    if not working_dir:
    +        raise ValueError("Build has no working directory")
    +
    +    clean_path = Path(file_path).as_posix()
    +    if ".." in clean_path:
    +        raise ValueError("Invalid file path")
    +
    +    full_path = Path(working_dir) / clean_path
    +    if not full_path.exists():
    +        raise ValueError(f"File not found: {clean_path}")
    +
    +    content = full_path.read_text(encoding="utf-8")
    +    return {
    +        "path": clean_path,
    +        "content": content,
    +        "size_bytes": len(content.encode("utf-8")),
    +        "language": _detect_language(clean_path),
    +    }
     
     
     # ---------------------------------------------------------------------------
    diff --git a/db/migrations/008_build_targets.sql b/db/migrations/008_build_targets.sql
    new file mode 100644
    index 0000000..eb29b44
    --- /dev/null
    +++ b/db/migrations/008_build_targets.sql
    @@ -0,0 +1,7 @@
    +-- Phase 12: Build Target & File Writing
    +-- Adds target columns to builds table so builds can write files
    +-- to a GitHub repo (new or existing) or a local directory.
    +
    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS target_type VARCHAR(20);
    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS target_ref TEXT;
    +ALTER TABLE builds ADD COLUMN IF NOT EXISTS working_dir TEXT;
    diff --git a/tests/test_build_repo.py b/tests/test_build_repo.py
    index 218e2b3..efcff9d 100644
    --- a/tests/test_build_repo.py
    +++ b/tests/test_build_repo.py
    @@ -264,3 +264,90 @@ async def test_get_build_cost_summary(mock_get_pool):
     
         assert summary["total_input_tokens"] == 5000
         assert summary["phase_count"] == 3
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: get_build_file_logs
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.repos.build_repo.get_pool")
    +async def test_get_build_file_logs(mock_get_pool):
    +    """get_build_file_logs returns parsed file entries."""
    +    import json
    +    pool = _fake_pool()
    +    pool.fetch.return_value = [
    +        {
    +            "message": json.dumps({"path": "src/main.py", "size_bytes": 42, "language": "python"}),
    +            "created_at": datetime.now(timezone.utc),
    +        },
    +        {
    +            "message": json.dumps({"path": "package.json", "size_bytes": 200, "language": "json"}),
    +            "created_at": datetime.now(timezone.utc),
    +        },
    +    ]
    +    mock_get_pool.return_value = pool
    +
    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +
    +    assert len(files) == 2
    +    assert files[0]["path"] == "src/main.py"
    +    assert files[0]["language"] == "python"
    +    assert files[1]["path"] == "package.json"
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.repos.build_repo.get_pool")
    +async def test_get_build_file_logs_invalid_json(mock_get_pool):
    +    """get_build_file_logs skips invalid JSON messages."""
    +    pool = _fake_pool()
    +    pool.fetch.return_value = [
    +        {
    +            "message": "not valid json",
    +            "created_at": datetime.now(timezone.utc),
    +        },
    +    ]
    +    mock_get_pool.return_value = pool
    +
    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +
    +    assert len(files) == 0
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.repos.build_repo.get_pool")
    +async def test_get_build_file_logs_empty(mock_get_pool):
    +    """get_build_file_logs returns empty list when no file logs."""
    +    pool = _fake_pool()
    +    pool.fetch.return_value = []
    +    mock_get_pool.return_value = pool
    +
    +    files = await build_repo.get_build_file_logs(uuid.uuid4())
    +
    +    assert files == []
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: create_build with target params
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.repos.build_repo.get_pool")
    +async def test_create_build_with_target(mock_get_pool):
    +    """create_build passes target params to the query."""
    +    pool = _fake_pool()
    +    row = _build_row()
    +    pool.fetchrow.return_value = row
    +    mock_get_pool.return_value = pool
    +
    +    result = await build_repo.create_build(
    +        row["project_id"],
    +        target_type="local_path",
    +        target_ref="/tmp/test",
    +        working_dir="/tmp/test",
    +    )
    +
    +    pool.fetchrow.assert_called_once()
    +    assert result["project_id"] == row["project_id"]
    diff --git a/tests/test_build_service.py b/tests/test_build_service.py
    index 2ea1cc9..61ebf81 100644
    --- a/tests/test_build_service.py
    +++ b/tests/test_build_service.py
    @@ -77,7 +77,12 @@ async def test_start_build_success(mock_get_user, mock_build_repo, mock_project_
         result = await build_service.start_build(_PROJECT_ID, _USER_ID)
     
         assert result["status"] == "pending"
    -    mock_build_repo.create_build.assert_called_once_with(_PROJECT_ID)
    +    mock_build_repo.create_build.assert_called_once_with(
    +        _PROJECT_ID,
    +        target_type=None,
    +        target_ref=None,
    +        working_dir=None,
    +    )
         mock_project_repo.update_project_status.assert_called_once_with(
             _PROJECT_ID, "building"
         )
    @@ -484,3 +489,318 @@ def test_get_token_rates_model_aware():
         unk_in, unk_out = build_service._get_token_rates("some-unknown-model")
         assert unk_in == Decimal("0.000015")
         assert unk_out == Decimal("0.000075")
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: _detect_language
    +# ---------------------------------------------------------------------------
    +
    +
    +def test_detect_language_python():
    +    assert build_service._detect_language("src/main.py") == "python"
    +
    +
    +def test_detect_language_typescript():
    +    assert build_service._detect_language("src/App.tsx") == "typescriptreact"
    +
    +
    +def test_detect_language_json():
    +    assert build_service._detect_language("package.json") == "json"
    +
    +
    +def test_detect_language_unknown():
    +    assert build_service._detect_language("data.xyz") == "plaintext"
    +
    +
    +def test_detect_language_dotenv():
    +    assert build_service._detect_language(".env") == "dotenv"
    +
    +
    +def test_detect_language_gitignore():
    +    assert build_service._detect_language(".gitignore") == "ignore"
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: _parse_file_blocks
    +# ---------------------------------------------------------------------------
    +
    +
    +def test_parse_file_blocks_single():
    +    """Single file block parsed correctly."""
    +    text = """Some preamble text
    +=== FILE: src/main.py ===
    +print("hello")
    +=== END FILE ===
    +Some trailing text"""
    +
    +    blocks = build_service._parse_file_blocks(text)
    +    assert len(blocks) == 1
    +    assert blocks[0]["path"] == "src/main.py"
    +    assert 'print("hello")' in blocks[0]["content"]
    +
    +
    +def test_parse_file_blocks_multiple():
    +    """Multiple consecutive file blocks parsed."""
    +    text = """
    +=== FILE: file1.py ===
    +content1
    +=== END FILE ===
    +=== FILE: file2.ts ===
    +content2
    +=== END FILE ===
    +"""
    +    blocks = build_service._parse_file_blocks(text)
    +    assert len(blocks) == 2
    +    assert blocks[0]["path"] == "file1.py"
    +    assert blocks[1]["path"] == "file2.ts"
    +    assert "content1" in blocks[0]["content"]
    +    assert "content2" in blocks[1]["content"]
    +
    +
    +def test_parse_file_blocks_with_code_fence():
    +    """File block wrapped in code fence gets fence stripped."""
    +    text = """=== FILE: test.py ===
    +```python
    +def hello():
    +    pass
    +```
    +=== END FILE ==="""
    +
    +    blocks = build_service._parse_file_blocks(text)
    +    assert len(blocks) == 1
    +    assert "def hello" in blocks[0]["content"]
    +    assert "```" not in blocks[0]["content"]
    +
    +
    +def test_parse_file_blocks_no_end_marker():
    +    """Missing END FILE marker ÔÇö block is skipped."""
    +    text = """=== FILE: orphan.py ===
    +some content without end marker
    +"""
    +    blocks = build_service._parse_file_blocks(text)
    +    assert len(blocks) == 0
    +
    +
    +def test_parse_file_blocks_empty_input():
    +    """Empty string returns empty list."""
    +    assert build_service._parse_file_blocks("") == []
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: _strip_code_fence
    +# ---------------------------------------------------------------------------
    +
    +
    +def test_strip_code_fence_basic():
    +    """Strip a basic code fence wrapper."""
    +    text = "```python\nprint('hi')\n```"
    +    result = build_service._strip_code_fence(text)
    +    assert "print('hi')" in result
    +    assert "```" not in result
    +
    +
    +def test_strip_code_fence_no_fence():
    +    """No code fence ÔÇö content passes through."""
    +    text = "plain content\n"
    +    result = build_service._strip_code_fence(text)
    +    assert "plain content" in result
    +
    +
    +def test_strip_code_fence_empty():
    +    """Empty string returns empty."""
    +    assert build_service._strip_code_fence("") == ""
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: _write_file_block
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +@patch("app.services.build_service.build_repo")
    +async def test_write_file_block_success(mock_build_repo, mock_broadcast, tmp_path):
    +    """_write_file_block writes a file and emits events."""
    +    mock_build_repo.append_build_log = AsyncMock()
    +    files_written: list[dict] = []
    +
    +    await build_service._write_file_block(
    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +        "src/hello.py", "print('hello')\n", files_written,
    +    )
    +
    +    # File should exist on disk
    +    written_file = tmp_path / "src" / "hello.py"
    +    assert written_file.exists()
    +    assert written_file.read_text() == "print('hello')\n"
    +
    +    # File info should be appended to files_written
    +    assert len(files_written) == 1
    +    assert files_written[0]["path"] == "src/hello.py"
    +    assert files_written[0]["language"] == "python"
    +    assert files_written[0]["size_bytes"] == len("print('hello')\n".encode())
    +
    +    # Build log should be recorded
    +    mock_build_repo.append_build_log.assert_called_once()
    +
    +    # WS event should be broadcast
    +    mock_broadcast.assert_called_once()
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +@patch("app.services.build_service.build_repo")
    +async def test_write_file_block_traversal_rejected(mock_build_repo, mock_broadcast, tmp_path):
    +    """_write_file_block rejects paths with directory traversal."""
    +    files_written: list[dict] = []
    +
    +    await build_service._write_file_block(
    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +        "../../../etc/passwd", "bad content", files_written,
    +    )
    +
    +    # No file should be written
    +    assert len(files_written) == 0
    +    mock_build_repo.append_build_log.assert_not_called()
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service._broadcast_build_event", new_callable=AsyncMock)
    +@patch("app.services.build_service.build_repo")
    +async def test_write_file_block_absolute_rejected(mock_build_repo, mock_broadcast, tmp_path):
    +    """_write_file_block rejects absolute paths."""
    +    files_written: list[dict] = []
    +
    +    await build_service._write_file_block(
    +        _BUILD_ID, _USER_ID, str(tmp_path),
    +        "/etc/passwd", "bad content", files_written,
    +    )
    +
    +    assert len(files_written) == 0
    +    mock_build_repo.append_build_log.assert_not_called()
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: get_build_files
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service.project_repo")
    +@patch("app.services.build_service.build_repo")
    +async def test_get_build_files(mock_build_repo, mock_project_repo):
    +    """get_build_files returns file list from build logs."""
    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +        return_value=_build(status="completed")
    +    )
    +    mock_build_repo.get_build_file_logs = AsyncMock(return_value=[
    +        {"path": "src/main.py", "size_bytes": 100, "language": "python", "created_at": "2025-01-01T00:00:00Z"},
    +    ])
    +
    +    result = await build_service.get_build_files(_PROJECT_ID, _USER_ID)
    +
    +    assert len(result) == 1
    +    assert result[0]["path"] == "src/main.py"
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service.project_repo")
    +@patch("app.services.build_service.build_repo")
    +async def test_get_build_files_no_project(mock_build_repo, mock_project_repo):
    +    """get_build_files raises ValueError for missing project."""
    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=None)
    +
    +    with pytest.raises(ValueError, match="not found"):
    +        await build_service.get_build_files(_PROJECT_ID, _USER_ID)
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: get_build_file_content
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service.project_repo")
    +@patch("app.services.build_service.build_repo")
    +async def test_get_build_file_content(mock_build_repo, mock_project_repo, tmp_path):
    +    """get_build_file_content reads file from working directory."""
    +    # Write a file to tmp_path
    +    (tmp_path / "src").mkdir()
    +    (tmp_path / "src" / "app.py").write_text("print('hi')\n")
    +
    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +        return_value=_build(status="completed", working_dir=str(tmp_path))
    +    )
    +
    +    result = await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "src/app.py")
    +
    +    assert result["path"] == "src/app.py"
    +    assert "print('hi')" in result["content"]
    +    assert result["language"] == "python"
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service.project_repo")
    +@patch("app.services.build_service.build_repo")
    +async def test_get_build_file_content_traversal(mock_build_repo, mock_project_repo, tmp_path):
    +    """get_build_file_content rejects directory traversal paths."""
    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +        return_value=_build(status="completed", working_dir=str(tmp_path))
    +    )
    +
    +    with pytest.raises(ValueError, match="Invalid file path"):
    +        await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "../../../etc/passwd")
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service.project_repo")
    +@patch("app.services.build_service.build_repo")
    +async def test_get_build_file_content_not_found(mock_build_repo, mock_project_repo, tmp_path):
    +    """get_build_file_content raises ValueError for non-existent file."""
    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    mock_build_repo.get_latest_build_for_project = AsyncMock(
    +        return_value=_build(status="completed", working_dir=str(tmp_path))
    +    )
    +
    +    with pytest.raises(ValueError, match="File not found"):
    +        await build_service.get_build_file_content(_PROJECT_ID, _USER_ID, "nonexistent.py")
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: start_build with target params
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service.asyncio.create_task")
    +@patch("app.services.build_service.project_repo")
    +@patch("app.services.build_service.build_repo")
    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +async def test_start_build_invalid_target_type(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    """start_build rejects invalid target_type."""
    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    +
    +    with pytest.raises(ValueError, match="Invalid target_type"):
    +        await build_service.start_build(_PROJECT_ID, _USER_ID, target_type="invalid_type")
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.services.build_service.asyncio.create_task")
    +@patch("app.services.build_service.project_repo")
    +@patch("app.services.build_service.build_repo")
    +@patch("app.services.build_service.get_user_by_id", new_callable=AsyncMock)
    +async def test_start_build_target_type_without_ref(mock_get_user, mock_build_repo, mock_project_repo, mock_create_task):
    +    """start_build raises ValueError when target_type given without target_ref."""
    +    mock_project_repo.get_project_by_id = AsyncMock(return_value=_project())
    +    mock_project_repo.get_contracts_by_project = AsyncMock(return_value=_contracts())
    +    mock_build_repo.get_latest_build_for_project = AsyncMock(return_value=None)
    +    mock_get_user.return_value = {"id": _USER_ID, "anthropic_api_key": "sk-ant-test123"}
    +
    +    with pytest.raises(ValueError, match="target_ref is required"):
    +        await build_service.start_build(_PROJECT_ID, _USER_ID, target_type="local_path")
    diff --git a/tests/test_builds_router.py b/tests/test_builds_router.py
    index cea1ab7..42ea0d3 100644
    --- a/tests/test_builds_router.py
    +++ b/tests/test_builds_router.py
    @@ -81,7 +81,10 @@ def test_start_build(mock_get_user, mock_start, client):
     
         assert resp.status_code == 200
         assert resp.json()["status"] == "pending"
    -    mock_start.assert_called_once_with(_PROJECT_ID, _USER["id"])
    +    mock_start.assert_called_once_with(
    +        _PROJECT_ID, _USER["id"],
    +        target_type=None, target_ref=None,
    +    )
     
     
     @patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    @@ -327,3 +330,127 @@ def test_start_build_rate_limited(mock_get_user, mock_start, mock_limiter, clien
     
         assert resp.status_code == 429
         mock_start.assert_not_called()
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: POST /projects/{id}/build with target params
    +# ---------------------------------------------------------------------------
    +
    +
    +@patch("app.api.routers.builds.build_limiter")
    +@patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +def test_start_build_with_target(mock_get_user, mock_start, mock_limiter, client):
    +    """POST /projects/{id}/build with target_type and target_ref."""
    +    mock_get_user.return_value = _USER
    +    mock_start.return_value = _build()
    +    mock_limiter.is_allowed.return_value = True
    +
    +    resp = client.post(
    +        f"/projects/{_PROJECT_ID}/build",
    +        headers=_auth_header(),
    +        json={"target_type": "local_path", "target_ref": "/tmp/test"},
    +    )
    +
    +    assert resp.status_code == 200
    +    mock_start.assert_called_once()
    +    call_kwargs = mock_start.call_args
    +    assert call_kwargs.kwargs.get("target_type") == "local_path"
    +    assert call_kwargs.kwargs.get("target_ref") == "/tmp/test"
    +
    +
    +@patch("app.api.routers.builds.build_limiter")
    +@patch("app.api.routers.builds.build_service.start_build", new_callable=AsyncMock)
    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +def test_start_build_with_github_target(mock_get_user, mock_start, mock_limiter, client):
    +    """POST /projects/{id}/build with github_new target."""
    +    mock_get_user.return_value = _USER
    +    mock_start.return_value = _build()
    +    mock_limiter.is_allowed.return_value = True
    +
    +    resp = client.post(
    +        f"/projects/{_PROJECT_ID}/build",
    +        headers=_auth_header(),
    +        json={"target_type": "github_new", "target_ref": "my-new-repo"},
    +    )
    +
    +    assert resp.status_code == 200
    +    mock_start.assert_called_once()
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: GET /projects/{id}/build/files
    +# ---------------------------------------------------------------------------
    +
    +
    +@patch("app.api.routers.builds.build_service.get_build_files", new_callable=AsyncMock)
    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +def test_get_build_files(mock_get_user, mock_files, client):
    +    """GET /projects/{id}/build/files returns file list."""
    +    mock_get_user.return_value = _USER
    +    mock_files.return_value = [
    +        {"path": "src/main.py", "size_bytes": 42, "language": "python", "created_at": "2025-01-01T00:00:00Z"},
    +        {"path": "package.json", "size_bytes": 200, "language": "json", "created_at": "2025-01-01T00:00:01Z"},
    +    ]
    +
    +    resp = client.get(f"/projects/{_PROJECT_ID}/build/files", headers=_auth_header())
    +
    +    assert resp.status_code == 200
    +    data = resp.json()
    +    assert len(data["items"]) == 2
    +    assert data["items"][0]["path"] == "src/main.py"
    +
    +
    +@patch("app.api.routers.builds.build_service.get_build_files", new_callable=AsyncMock)
    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +def test_get_build_files_not_found(mock_get_user, mock_files, client):
    +    """GET /projects/{id}/build/files returns 404 for missing project."""
    +    mock_get_user.return_value = _USER
    +    mock_files.side_effect = ValueError("Project not found")
    +
    +    resp = client.get(f"/projects/{_PROJECT_ID}/build/files", headers=_auth_header())
    +
    +    assert resp.status_code == 404
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: GET /projects/{id}/build/files/{path}
    +# ---------------------------------------------------------------------------
    +
    +
    +@patch("app.api.routers.builds.build_service.get_build_file_content", new_callable=AsyncMock)
    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +def test_get_build_file_content(mock_get_user, mock_content, client):
    +    """GET /projects/{id}/build/files/{path} returns file content."""
    +    mock_get_user.return_value = _USER
    +    mock_content.return_value = {
    +        "path": "src/main.py",
    +        "content": "print('hello')\n",
    +        "size_bytes": 16,
    +        "language": "python",
    +    }
    +
    +    resp = client.get(
    +        f"/projects/{_PROJECT_ID}/build/files/src/main.py",
    +        headers=_auth_header(),
    +    )
    +
    +    assert resp.status_code == 200
    +    data = resp.json()
    +    assert data["path"] == "src/main.py"
    +    assert "print('hello')" in data["content"]
    +
    +
    +@patch("app.api.routers.builds.build_service.get_build_file_content", new_callable=AsyncMock)
    +@patch("app.api.deps.get_user_by_id", new_callable=AsyncMock)
    +def test_get_build_file_content_not_found(mock_get_user, mock_content, client):
    +    """GET /projects/{id}/build/files/{path} returns 404 for missing file."""
    +    mock_get_user.return_value = _USER
    +    mock_content.side_effect = ValueError("File not found: nonexistent.py")
    +
    +    resp = client.get(
    +        f"/projects/{_PROJECT_ID}/build/files/nonexistent.py",
    +        headers=_auth_header(),
    +    )
    +
    +    assert resp.status_code == 404
    diff --git a/tests/test_git_client.py b/tests/test_git_client.py
    new file mode 100644
    index 0000000..ed053e1
    --- /dev/null
    +++ b/tests/test_git_client.py
    @@ -0,0 +1,177 @@
    +"""Tests for app/clients/git_client.py -- thin async git wrapper."""
    +
    +import asyncio
    +from unittest.mock import AsyncMock, patch, MagicMock
    +
    +import pytest
    +
    +from app.clients import git_client
    +
    +
    +# ---------------------------------------------------------------------------
    +# Helpers
    +# ---------------------------------------------------------------------------
    +
    +def _mock_process(returncode: int = 0, stdout: str = "", stderr: str = ""):
    +    proc = AsyncMock()
    +    proc.returncode = returncode
    +    proc.communicate = AsyncMock(return_value=(stdout.encode(), stderr.encode()))
    +    return proc
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: _run_git
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client.asyncio.create_subprocess_exec")
    +async def test_run_git_success(mock_exec):
    +    """_run_git runs a command and returns stdout."""
    +    mock_exec.return_value = _mock_process(0, "ok", "")
    +
    +    result = await git_client._run_git(["status"], cwd="/tmp/test")
    +
    +    mock_exec.assert_called_once()
    +    assert result == "ok"
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client.asyncio.create_subprocess_exec")
    +async def test_run_git_failure(mock_exec):
    +    """_run_git raises RuntimeError on non-zero exit."""
    +    mock_exec.return_value = _mock_process(128, "", "fatal: not a git repo")
    +
    +    with pytest.raises(RuntimeError, match="not a git repo"):
    +        await git_client._run_git(["status"], cwd="/tmp/test")
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: init_repo
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +async def test_init_repo(mock_run):
    +    """init_repo runs git init and sets committer identity."""
    +    await git_client.init_repo("/tmp/test")
    +
    +    # Should make multiple calls (init + config)
    +    assert mock_run.call_count >= 1
    +    # First call should be 'init'
    +    first_args = mock_run.call_args_list[0][0][0]
    +    assert "init" in first_args
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: add_all
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +async def test_add_all(mock_run):
    +    """add_all stages all changes."""
    +    await git_client.add_all("/tmp/test")
    +
    +    mock_run.assert_called_once()
    +    args = mock_run.call_args[0][0]  # First positional arg is the command list
    +    assert "add" in args
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: commit
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +async def test_commit(mock_run):
    +    """commit runs git commit with the given message."""
    +    await git_client.commit("/tmp/test", "test commit")
    +
    +    # commit may call _run_git multiple times (status check + commit)
    +    assert mock_run.call_count >= 1
    +    # Find the call that includes 'commit'
    +    commit_calls = [c for c in mock_run.call_args_list if "commit" in c[0][0]]
    +    assert len(commit_calls) >= 1
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: clone_repo
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +async def test_clone_repo(mock_run):
    +    """clone_repo clones with access token injected into URL."""
    +    await git_client.clone_repo("https://github.com/owner/repo.git", "/tmp/dest", access_token="ghp_testtoken")
    +
    +    mock_run.assert_called_once()
    +    args = mock_run.call_args[0][0]  # command list
    +    assert "clone" in args
    +    # Token should be in the URL arg
    +    url_arg = [a for a in args if "github.com" in str(a)]
    +    assert len(url_arg) > 0
    +    assert "ghp_testtoken" in str(url_arg[0])
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: push
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +async def test_push(mock_run):
    +    """push runs git push."""
    +    await git_client.push("/tmp/test")
    +
    +    mock_run.assert_called_once()
    +    args = mock_run.call_args[0][0]
    +    assert "push" in args
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: set_remote
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +async def test_set_remote(mock_run):
    +    """set_remote sets the origin remote."""
    +    await git_client.set_remote("/tmp/test", "https://github.com/owner/repo.git")
    +
    +    mock_run.assert_called_once()
    +    args = mock_run.call_args[0][0]
    +    assert "remote" in args
    +
    +
    +# ---------------------------------------------------------------------------
    +# Tests: get_file_list
    +# ---------------------------------------------------------------------------
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +async def test_get_file_list(mock_run):
    +    """get_file_list returns list of tracked files."""
    +    mock_run.return_value = "file1.py\nfile2.ts\n"
    +
    +    result = await git_client.get_file_list("/tmp/test")
    +
    +    assert result == ["file1.py", "file2.ts"]
    +
    +
    +@pytest.mark.asyncio
    +@patch("app.clients.git_client._run_git", new_callable=AsyncMock)
    +async def test_get_file_list_empty(mock_run):
    +    """get_file_list returns empty list when no files."""
    +    mock_run.return_value = ""
    +
    +    result = await git_client.get_file_list("/tmp/test")
    +
    +    assert result == []
    diff --git a/web/src/__tests__/BuildTargetModal.test.tsx b/web/src/__tests__/BuildTargetModal.test.tsx
    new file mode 100644
    index 0000000..432c75d
    --- /dev/null
    +++ b/web/src/__tests__/BuildTargetModal.test.tsx
    @@ -0,0 +1,99 @@
    +import { describe, it, expect, vi, beforeEach } from 'vitest';
    +import { render, screen, fireEvent } from '@testing-library/react';
    +import BuildTargetModal from '../components/BuildTargetModal';
    +
    +describe('BuildTargetModal', () => {
    +  const mockConfirm = vi.fn();
    +  const mockCancel = vi.fn();
    +
    +  beforeEach(() => {
    +    vi.clearAllMocks();
    +  });
    +
    +  it('renders three target options', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    expect(screen.getByText('New GitHub Repo')).toBeInTheDocument();
    +    expect(screen.getByText('Existing GitHub Repo')).toBeInTheDocument();
    +    expect(screen.getByText('Local Directory')).toBeInTheDocument();
    +  });
    +
    +  it('renders the Build Target title', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    expect(screen.getByText('Build Target')).toBeInTheDocument();
    +  });
    +
    +  it('shows correct placeholder for github_new (default)', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    expect(input.placeholder).toBe('my-new-project');
    +  });
    +
    +  it('changes placeholder when selecting existing repo', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    fireEvent.click(screen.getByTestId('target-github_existing'));
    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    expect(input.placeholder).toBe('owner/repo-name');
    +  });
    +
    +  it('changes placeholder when selecting local path', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    fireEvent.click(screen.getByTestId('target-local_path'));
    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    expect(input.placeholder).toContain('Projects');
    +  });
    +
    +  it('disables Start Build when input is empty', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    const btn = screen.getByTestId('target-confirm-btn');
    +    expect(btn).toBeDisabled();
    +  });
    +
    +  it('enables Start Build when input has value', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    const input = screen.getByTestId('target-ref-input');
    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    const btn = screen.getByTestId('target-confirm-btn');
    +    expect(btn).not.toBeDisabled();
    +  });
    +
    +  it('calls onConfirm with target data', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    const input = screen.getByTestId('target-ref-input');
    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    fireEvent.click(screen.getByTestId('target-confirm-btn'));
    +    expect(mockConfirm).toHaveBeenCalledWith({
    +      target_type: 'github_new',
    +      target_ref: 'my-repo',
    +    });
    +  });
    +
    +  it('calls onCancel when cancel button clicked', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    fireEvent.click(screen.getByText('Cancel'));
    +    expect(mockCancel).toHaveBeenCalledOnce();
    +  });
    +
    +  it('calls onCancel when close button (Ô£ò) clicked', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    fireEvent.click(screen.getByText('Ô£ò'));
    +    expect(mockCancel).toHaveBeenCalledOnce();
    +  });
    +
    +  it('shows "Starting..." when starting prop is true', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} starting />);
    +    const input = screen.getByTestId('target-ref-input');
    +    fireEvent.change(input, { target: { value: 'blah' } });
    +    expect(screen.getByText('Starting...')).toBeInTheDocument();
    +  });
    +
    +  it('clears input when switching target types', () => {
    +    render(<BuildTargetModal onConfirm={mockConfirm} onCancel={mockCancel} />);
    +    const input = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    fireEvent.change(input, { target: { value: 'my-repo' } });
    +    expect(input.value).toBe('my-repo');
    +
    +    fireEvent.click(screen.getByTestId('target-local_path'));
    +    const inputAfter = screen.getByTestId('target-ref-input') as HTMLInputElement;
    +    expect(inputAfter.value).toBe('');
    +  });
    +});
    diff --git a/web/src/components/BuildTargetModal.tsx b/web/src/components/BuildTargetModal.tsx
    new file mode 100644
    index 0000000..81304a1
    --- /dev/null
    +++ b/web/src/components/BuildTargetModal.tsx
    @@ -0,0 +1,252 @@
    +/**
    + * BuildTargetModal -- lets user choose where the build writes files.
    + *
    + * Three target types:
    + *   - github_new     ÔÇö create a new GitHub repo and push generated code
    + *   - github_existing ÔÇö clone an existing repo, add generated code, push
    + *   - local_path     ÔÇö write files to a local directory
    + *
    + * Passes { target_type, target_ref } back to the caller.
    + */
    +import { useState } from 'react';
    +
    +export interface BuildTarget {
    +  target_type: string;
    +  target_ref: string;
    +}
    +
    +interface BuildTargetModalProps {
    +  onConfirm: (target: BuildTarget) => void;
    +  onCancel: () => void;
    +  starting?: boolean;
    +}
    +
    +type TargetOption = 'github_new' | 'github_existing' | 'local_path';
    +
    +const TARGET_OPTIONS: { value: TargetOption; label: string; description: string; placeholder: string }[] = [
    +  {
    +    value: 'github_new',
    +    label: 'New GitHub Repo',
    +    description: 'Create a new repository under your GitHub account and push generated code.',
    +    placeholder: 'my-new-project',
    +  },
    +  {
    +    value: 'github_existing',
    +    label: 'Existing GitHub Repo',
    +    description: 'Clone an existing repo, add generated files, and push.',
    +    placeholder: 'owner/repo-name',
    +  },
    +  {
    +    value: 'local_path',
    +    label: 'Local Directory',
    +    description: 'Write generated files to a directory on the server.',
    +    placeholder: 'C:\\Projects\\my-app  or  /home/user/projects/my-app',
    +  },
    +];
    +
    +const cardBase: React.CSSProperties = {
    +  background: '#0F172A',
    +  border: '2px solid #334155',
    +  borderRadius: '8px',
    +  padding: '14px 16px',
    +  cursor: 'pointer',
    +  transition: 'border-color 0.15s, background 0.15s',
    +};
    +
    +const cardSelected: React.CSSProperties = {
    +  ...cardBase,
    +  borderColor: '#2563EB',
    +  background: '#1E293B',
    +};
    +
    +export default function BuildTargetModal({ onConfirm, onCancel, starting }: BuildTargetModalProps) {
    +  const [selected, setSelected] = useState<TargetOption>('github_new');
    +  const [targetRef, setTargetRef] = useState('');
    +
    +  const currentOption = TARGET_OPTIONS.find((o) => o.value === selected)!;
    +
    +  const canConfirm = targetRef.trim().length > 0 && !starting;
    +
    +  return (
    +    <div
    +      style={{
    +        position: 'fixed',
    +        inset: 0,
    +        backgroundColor: 'rgba(0,0,0,0.65)',
    +        display: 'flex',
    +        alignItems: 'center',
    +        justifyContent: 'center',
    +        zIndex: 100,
    +      }}
    +      onClick={onCancel}
    +    >
    +      <div
    +        style={{
    +          background: '#1E293B',
    +          borderRadius: '10px',
    +          maxWidth: '540px',
    +          width: '95%',
    +          overflow: 'hidden',
    +        }}
    +        onClick={(e) => e.stopPropagation()}
    +      >
    +        {/* Header */}
    +        <div
    +          style={{
    +            padding: '16px 20px',
    +            borderBottom: '1px solid #334155',
    +            display: 'flex',
    +            alignItems: 'center',
    +            justifyContent: 'space-between',
    +          }}
    +        >
    +          <h3 style={{ margin: 0, fontSize: '1rem', color: '#F8FAFC' }}>Build Target</h3>
    +          <button
    +            onClick={onCancel}
    +            style={{
    +              background: 'transparent',
    +              border: 'none',
    +              color: '#94A3B8',
    +              fontSize: '1.2rem',
    +              cursor: 'pointer',
    +            }}
    +          >
    +            Ô£ò
    +          </button>
    +        </div>
    +
    +        {/* Body */}
    +        <div style={{ padding: '20px', display: 'flex', flexDirection: 'column', gap: '16px' }}>
    +          <p style={{ margin: 0, fontSize: '0.8rem', color: '#94A3B8' }}>
    +            Choose where ForgeGuard should write the generated files.
    +          </p>
    +
    +          {/* Target type cards */}
    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
    +            {TARGET_OPTIONS.map((opt) => (
    +              <div
    +                key={opt.value}
    +                style={selected === opt.value ? cardSelected : cardBase}
    +                onClick={() => {
    +                  setSelected(opt.value);
    +                  setTargetRef('');
    +                }}
    +                data-testid={`target-${opt.value}`}
    +              >
    +                <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '4px' }}>
    +                  <span
    +                    style={{
    +                      width: '16px',
    +                      height: '16px',
    +                      borderRadius: '50%',
    +                      border: `2px solid ${selected === opt.value ? '#2563EB' : '#475569'}`,
    +                      display: 'flex',
    +                      alignItems: 'center',
    +                      justifyContent: 'center',
    +                      flexShrink: 0,
    +                    }}
    +                  >
    +                    {selected === opt.value && (
    +                      <span
    +                        style={{
    +                          width: '8px',
    +                          height: '8px',
    +                          borderRadius: '50%',
    +                          background: '#2563EB',
    +                        }}
    +                      />
    +                    )}
    +                  </span>
    +                  <span style={{ fontWeight: 600, fontSize: '0.85rem', color: '#F8FAFC' }}>{opt.label}</span>
    +                </div>
    +                <p style={{ margin: '0 0 0 26px', fontSize: '0.72rem', color: '#94A3B8' }}>{opt.description}</p>
    +              </div>
    +            ))}
    +          </div>
    +
    +          {/* Target ref input */}
    +          <div>
    +            <label
    +              style={{ display: 'block', fontSize: '0.75rem', color: '#94A3B8', marginBottom: '6px' }}
    +            >
    +              {selected === 'github_new'
    +                ? 'Repository name'
    +                : selected === 'github_existing'
    +                  ? 'Repository (owner/name)'
    +                  : 'Directory path'}
    +            </label>
    +            <input
    +              type="text"
    +              value={targetRef}
    +              onChange={(e) => setTargetRef(e.target.value)}
    +              placeholder={currentOption.placeholder}
    +              data-testid="target-ref-input"
    +              style={{
    +                width: '100%',
    +                padding: '10px 12px',
    +                background: '#0F172A',
    +                border: '1px solid #334155',
    +                borderRadius: '6px',
    +                color: '#F8FAFC',
    +                fontSize: '0.85rem',
    +                outline: 'none',
    +                boxSizing: 'border-box',
    +              }}
    +              onFocus={(e) => (e.currentTarget.style.borderColor = '#2563EB')}
    +              onBlur={(e) => (e.currentTarget.style.borderColor = '#334155')}
    +              onKeyDown={(e) => {
    +                if (e.key === 'Enter' && canConfirm) {
    +                  onConfirm({ target_type: selected, target_ref: targetRef.trim() });
    +                }
    +              }}
    +              autoFocus
    +            />
    +          </div>
    +        </div>
    +
    +        {/* Footer */}
    +        <div
    +          style={{
    +            padding: '12px 20px',
    +            borderTop: '1px solid #334155',
    +            display: 'flex',
    +            justifyContent: 'flex-end',
    +            gap: '10px',
    +          }}
    +        >
    +          <button
    +            onClick={onCancel}
    +            style={{
    +              background: 'transparent',
    +              color: '#94A3B8',
    +              border: '1px solid #334155',
    +              borderRadius: '6px',
    +              padding: '8px 16px',
    +              cursor: 'pointer',
    +              fontSize: '0.8rem',
    +            }}
    +          >
    +            Cancel
    +          </button>
    +          <button
    +            onClick={() => onConfirm({ target_type: selected, target_ref: targetRef.trim() })}
    +            disabled={!canConfirm}
    +            data-testid="target-confirm-btn"
    +            style={{
    +              background: canConfirm ? '#2563EB' : '#1E293B',
    +              color: canConfirm ? '#fff' : '#475569',
    +              border: 'none',
    +              borderRadius: '6px',
    +              padding: '8px 20px',
    +              cursor: canConfirm ? 'pointer' : 'not-allowed',
    +              fontSize: '0.8rem',
    +              fontWeight: 600,
    +            }}
    +          >
    +            {starting ? 'Starting...' : 'Start Build'}
    +          </button>
    +        </div>
    +      </div>
    +    </div>
    +  );
    +}
    diff --git a/web/src/pages/BuildProgress.tsx b/web/src/pages/BuildProgress.tsx
    index 021b634..6e1e2e4 100644
    --- a/web/src/pages/BuildProgress.tsx
    +++ b/web/src/pages/BuildProgress.tsx
    @@ -79,6 +79,13 @@ interface ActivityEntry {
       level: 'info' | 'warn' | 'error' | 'system';
     }
     
    +interface BuildFile {
    +  path: string;
    +  size_bytes: number;
    +  language: string;
    +  created_at: string;
    +}
    +
     /* ------------------------------------------------------------------ */
     /*  Styles                                                            */
     /* ------------------------------------------------------------------ */
    @@ -174,6 +181,8 @@ function BuildProgress() {
       const [noBuild, setNoBuild] = useState(false);
       const [showCancelConfirm, setShowCancelConfirm] = useState(false);
       const [expandedPhase, setExpandedPhase] = useState<number | null>(null);
    +  const [buildFiles, setBuildFiles] = useState<BuildFile[]>([]);
    +  const [filesExpanded, setFilesExpanded] = useState(true);
       const [startTime] = useState(() => Date.now());
       const [elapsed, setElapsed] = useState(0);
       const feedEndRef = useRef<HTMLDivElement>(null);
    @@ -260,6 +269,17 @@ function BuildProgress() {
                   });
                 }
               } catch { /* best effort */ }
    +
    +          /* Seed build files */
    +          try {
    +            const filesRes = await fetch(`${API_BASE}/projects/${projectId}/build/files`, {
    +              headers: { Authorization: `Bearer ${token}` },
    +            });
    +            if (filesRes.ok) {
    +              const filesData = await filesRes.json();
    +              setBuildFiles(filesData.items ?? []);
    +            }
    +          } catch { /* best effort */ }
             } else {
               addToast('Failed to load build');
             }
    @@ -431,6 +451,21 @@ function BuildProgress() {
                 addActivity(`Audit FAIL for ${phase} (loop ${loop})`, 'warn');
                 break;
               }
    +
    +          case 'file_created': {
    +            const filePath = (payload.path ?? '') as string;
    +            const sizeBytes = (payload.size_bytes ?? 0) as number;
    +            const language = (payload.language ?? '') as string;
    +            if (filePath) {
    +              setBuildFiles((prev) => {
    +                // Avoid duplicates (same path)
    +                if (prev.some((f) => f.path === filePath)) return prev;
    +                return [...prev, { path: filePath, size_bytes: sizeBytes, language, created_at: new Date().toISOString() }];
    +              });
    +              addActivity(`File created: ${filePath} (${sizeBytes} bytes)`, 'info');
    +            }
    +            break;
    +          }
             }
           },
           [projectId, addActivity, addToast],
    @@ -610,7 +645,8 @@ function BuildProgress() {
             {/* ---- Two-column layout ---- */}
             <div style={twoColStyle}>
     
    -          {/* ======== LEFT: Phase Checklist ======== */}
    +          {/* ======== LEFT: Phase Checklist + Files ======== */}
    +          <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
               <div style={{ ...cardStyle, padding: '12px 16px' }}>
                 <h3 style={{ margin: '0 0 12px', fontSize: '0.9rem', color: '#F8FAFC' }}>
                   Phases ({doneCount}/{totalPhases})
    @@ -679,6 +715,47 @@ function BuildProgress() {
                 </div>
               </div>
     
    +          {/* ======== Files Panel ======== */}
    +          {buildFiles.length > 0 && (
    +            <div style={{ ...cardStyle, padding: '12px 16px' }}>
    +              <div
    +                style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', cursor: 'pointer', marginBottom: filesExpanded ? '10px' : 0 }}
    +                onClick={() => setFilesExpanded(!filesExpanded)}
    +              >
    +                <h3 style={{ margin: 0, fontSize: '0.9rem', color: '#F8FAFC' }}>
    +                  Files ({buildFiles.length})
    +                </h3>
    +                <span style={{ color: '#64748B', fontSize: '0.7rem', transition: 'transform 0.2s', transform: filesExpanded ? 'rotate(180deg)' : 'rotate(0)' }}>Ôû╝</span>
    +              </div>
    +              {filesExpanded && (
    +                <div style={{ display: 'flex', flexDirection: 'column', gap: '2px', maxHeight: '260px', overflowY: 'auto' }} data-testid="build-files-panel">
    +                  {buildFiles.map((f) => (
    +                    <div
    +                      key={f.path}
    +                      style={{
    +                        display: 'flex',
    +                        alignItems: 'center',
    +                        gap: '8px',
    +                        padding: '5px 8px',
    +                        borderRadius: '4px',
    +                        background: '#0F172A',
    +                        fontSize: '0.72rem',
    +                      }}
    +                    >
    +                      <span style={{ color: '#64748B', flexShrink: 0 }}>­ƒôä</span>
    +                      <span style={{ color: '#F8FAFC', flex: 1, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{f.path}</span>
    +                      <span style={{ color: '#475569', flexShrink: 0, fontSize: '0.65rem' }}>
    +                        {f.language && <span style={{ marginRight: '6px', color: '#64748B' }}>{f.language}</span>}
    +                        {f.size_bytes > 0 && `${(f.size_bytes / 1024).toFixed(1)}k`}
    +                      </span>
    +                    </div>
    +                  ))}
    +                </div>
    +              )}
    +            </div>
    +          )}
    +          </div>
    +
               {/* ======== RIGHT: Metrics + Activity Feed ======== */}
               <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
     
    diff --git a/web/src/pages/ProjectDetail.tsx b/web/src/pages/ProjectDetail.tsx
    index 873d603..14ae4bc 100644
    --- a/web/src/pages/ProjectDetail.tsx
    +++ b/web/src/pages/ProjectDetail.tsx
    @@ -11,6 +11,7 @@ import Skeleton from '../components/Skeleton';
     import ConfirmDialog from '../components/ConfirmDialog';
     import QuestionnaireModal from '../components/QuestionnaireModal';
     import ContractProgress from '../components/ContractProgress';
    +import BuildTargetModal, { type BuildTarget } from '../components/BuildTargetModal';
     
     const API_BASE = import.meta.env.VITE_API_URL ?? '';
     
    @@ -69,6 +70,7 @@ function ProjectDetail() {
       const [showQuestionnaire, setShowQuestionnaire] = useState(false);
       const [contractsExpanded, setContractsExpanded] = useState(false);
       const [showRegenerate, setShowRegenerate] = useState(false);
    +  const [showTargetPicker, setShowTargetPicker] = useState(false);
     
       useEffect(() => {
         const fetchProject = async () => {
    @@ -95,14 +97,23 @@ function ProjectDetail() {
           setShowQuestionnaire(true);
           return;
         }
    +    /* Show target picker modal */
    +    setShowTargetPicker(true);
    +  };
     
    +  const handleTargetConfirm = async (target: BuildTarget) => {
         setStarting(true);
         try {
           const res = await fetch(`${API_BASE}/projects/${projectId}/build`, {
             method: 'POST',
    -        headers: { Authorization: `Bearer ${token}` },
    +        headers: {
    +          Authorization: `Bearer ${token}`,
    +          'Content-Type': 'application/json',
    +        },
    +        body: JSON.stringify(target),
           });
           if (res.ok) {
    +        setShowTargetPicker(false);
             addToast('Build started', 'success');
             navigate(`/projects/${projectId}/build`);
           } else {
    @@ -482,6 +493,14 @@ function ProjectDetail() {
             />
           )}
     
    +      {showTargetPicker && (
    +        <BuildTargetModal
    +          onConfirm={handleTargetConfirm}
    +          onCancel={() => setShowTargetPicker(false)}
    +          starting={starting}
    +        />
    +      )}
    +
           {showRegenerate && project && (
             <div
               style={{

